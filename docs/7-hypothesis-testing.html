<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 7 Hypothesis Testing | Modern Biological Data Analysis</title>
  <meta name="description" content="An open-source and fully-reproducible electronic textbook for teaching statistical inference using tidyverse data science tools." />
  <meta name="generator" content="bookdown 0.35 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 7 Hypothesis Testing | Modern Biological Data Analysis" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://moderndive.com//images/logos/book_cover.png" />
  <meta property="og:description" content="An open-source and fully-reproducible electronic textbook for teaching statistical inference using tidyverse data science tools." />
  <meta name="github-repo" content="moderndive/ModernDive_book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 7 Hypothesis Testing | Modern Biological Data Analysis" />
  <meta name="twitter:site" content="@ModernDive" />
  <meta name="twitter:description" content="An open-source and fully-reproducible electronic textbook for teaching statistical inference using tidyverse data science tools." />
  <meta name="twitter:image" content="https://moderndive.com//images/logos/book_cover.png" />

<meta name="author" content="Chester Ismay and Albert Y. Kim   Foreword by Kelly S. McConville   Adapted by William R. Morgan" />


<meta name="date" content="2023-08-14" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  <link rel="apple-touch-icon-precomposed" sizes="152x152" href="images/logos/favicons/apple-touch-icon.png" />
  <link rel="shortcut icon" href="images/logos/favicons/favicon.ico" type="image/x-icon" />
<link rel="prev" href="6-confidence-intervals.html"/>
<link rel="next" href="8-regression.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<link href="libs/dygraphs-1.1.1/dygraph.css" rel="stylesheet" />
<script src="libs/dygraphs-1.1.1/dygraph-combined.js"></script>
<script src="libs/dygraphs-1.1.1/shapes.js"></script>
<script src="libs/moment-2.8.4/moment.js"></script>
<script src="libs/moment-timezone-0.2.5/moment-timezone-with-data.js"></script>
<script src="libs/moment-fquarter-1.0.0/moment-fquarter.min.js"></script>
<script src="libs/dygraphs-binding-1.1.1.6/dygraphs.js"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-89938436-1', 'auto');
  ga('send', 'pageview');

</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>ModernDive for Life Scientists</a></li>
<li class="chapter" data-level="" data-path="foreword.html"><a href="foreword.html"><i class="fa fa-check"></i>Foreword</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#introduction-for-students"><i class="fa fa-check"></i>Introduction for students</a>
<ul>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#what-we-hope-you-will-learn-from-this-book"><i class="fa fa-check"></i>What we hope you will learn from this book</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#datascience-pipeline"><i class="fa fa-check"></i>Data/science pipeline</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#reproducible-research"><i class="fa fa-check"></i>Reproducible research</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#final-note-for-students"><i class="fa fa-check"></i>Final note for students</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#introduction-for-instructors"><i class="fa fa-check"></i>Introduction for instructors</a>
<ul>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#resources"><i class="fa fa-check"></i>Resources</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#why-did-we-write-this-book"><i class="fa fa-check"></i>Why did we write this book?</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#who-is-this-book-for"><i class="fa fa-check"></i>Who is this book for?</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#connect-and-contribute"><i class="fa fa-check"></i>Connect and contribute</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#acknowledgements"><i class="fa fa-check"></i>Acknowledgements</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#about-this-book"><i class="fa fa-check"></i>About this book</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="about-the-authors.html"><a href="about-the-authors.html"><i class="fa fa-check"></i>About the authors</a></li>
<li class="chapter" data-level="" data-path="about-the-adapting-author.html"><a href="about-the-adapting-author.html"><i class="fa fa-check"></i>About the adapting author</a></li>
<li class="chapter" data-level="1" data-path="1-getting-started.html"><a href="1-getting-started.html"><i class="fa fa-check"></i><b>1</b> Getting Started with Data in R</a>
<ul>
<li class="chapter" data-level="1.1" data-path="1-getting-started.html"><a href="1-getting-started.html#r-rstudio"><i class="fa fa-check"></i><b>1.1</b> What are R and RStudio?</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="1-getting-started.html"><a href="1-getting-started.html#installing"><i class="fa fa-check"></i><b>1.1.1</b> Installing R and RStudio</a></li>
<li class="chapter" data-level="1.1.2" data-path="1-getting-started.html"><a href="1-getting-started.html#using-r-via-rstudio"><i class="fa fa-check"></i><b>1.1.2</b> Using R via RStudio</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="1-getting-started.html"><a href="1-getting-started.html#code"><i class="fa fa-check"></i><b>1.2</b> How do I code in R?</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="1-getting-started.html"><a href="1-getting-started.html#programming-concepts"><i class="fa fa-check"></i><b>1.2.1</b> Basic programming concepts and terminology</a></li>
<li class="chapter" data-level="1.2.2" data-path="1-getting-started.html"><a href="1-getting-started.html#messages"><i class="fa fa-check"></i><b>1.2.2</b> Errors, warnings, and messages</a></li>
<li class="chapter" data-level="1.2.3" data-path="1-getting-started.html"><a href="1-getting-started.html#tips-code"><i class="fa fa-check"></i><b>1.2.3</b> Tips on learning to code</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="1-getting-started.html"><a href="1-getting-started.html#packages"><i class="fa fa-check"></i><b>1.3</b> What are R packages?</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="1-getting-started.html"><a href="1-getting-started.html#package-installation"><i class="fa fa-check"></i><b>1.3.1</b> Package installation</a></li>
<li class="chapter" data-level="1.3.2" data-path="1-getting-started.html"><a href="1-getting-started.html#package-loading"><i class="fa fa-check"></i><b>1.3.2</b> Package loading</a></li>
<li class="chapter" data-level="1.3.3" data-path="1-getting-started.html"><a href="1-getting-started.html#package-use"><i class="fa fa-check"></i><b>1.3.3</b> Package use</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="1-getting-started.html"><a href="1-getting-started.html#mammalsdb"><i class="fa fa-check"></i><b>1.4</b> Explore your first data sets</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="1-getting-started.html"><a href="1-getting-started.html#openintropackage"><i class="fa fa-check"></i><b>1.4.1</b> <code>openintro</code> package</a></li>
<li class="chapter" data-level="1.4.2" data-path="1-getting-started.html"><a href="1-getting-started.html#mammalsdataframe"><i class="fa fa-check"></i><b>1.4.2</b> <code>mammals</code> data frame</a></li>
<li class="chapter" data-level="1.4.3" data-path="1-getting-started.html"><a href="1-getting-started.html#exploredataframes"><i class="fa fa-check"></i><b>1.4.3</b> Exploring data frames</a></li>
<li class="chapter" data-level="1.4.4" data-path="1-getting-started.html"><a href="1-getting-started.html#identification-vs-measurement-variables"><i class="fa fa-check"></i><b>1.4.4</b> Identification and measurement variables</a></li>
<li class="chapter" data-level="1.4.5" data-path="1-getting-started.html"><a href="1-getting-started.html#help-files"><i class="fa fa-check"></i><b>1.4.5</b> Help files</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="1-getting-started.html"><a href="1-getting-started.html#csv"><i class="fa fa-check"></i><b>1.5</b> Importing data</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="1-getting-started.html"><a href="1-getting-started.html#using-the-console"><i class="fa fa-check"></i><b>1.5.1</b> Using the console</a></li>
<li class="chapter" data-level="1.5.2" data-path="1-getting-started.html"><a href="1-getting-started.html#using-rstudios-interface"><i class="fa fa-check"></i><b>1.5.2</b> Using RStudio’s interface</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="1-getting-started.html"><a href="1-getting-started.html#conclusion"><i class="fa fa-check"></i><b>1.6</b> Conclusion</a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="1-getting-started.html"><a href="1-getting-started.html#additional-resources"><i class="fa fa-check"></i><b>1.6.1</b> Additional resources</a></li>
<li class="chapter" data-level="1.6.2" data-path="1-getting-started.html"><a href="1-getting-started.html#whats-to-come"><i class="fa fa-check"></i><b>1.6.2</b> What’s to come?</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>I Data Science with tidyverse</b></span></li>
<li class="chapter" data-level="2" data-path="2-viz.html"><a href="2-viz.html"><i class="fa fa-check"></i><b>2</b> Data Visualization</a>
<ul>
<li class="chapter" data-level="" data-path="2-viz.html"><a href="2-viz.html#needed-packages"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="2.1" data-path="2-viz.html"><a href="2-viz.html#grammarofgraphics"><i class="fa fa-check"></i><b>2.1</b> The grammar of graphics</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="2-viz.html"><a href="2-viz.html#components-of-the-grammar"><i class="fa fa-check"></i><b>2.1.1</b> Components of the grammar</a></li>
<li class="chapter" data-level="2.1.2" data-path="2-viz.html"><a href="2-viz.html#gapminder"><i class="fa fa-check"></i><b>2.1.2</b> Gapminder data</a></li>
<li class="chapter" data-level="2.1.3" data-path="2-viz.html"><a href="2-viz.html#other-components"><i class="fa fa-check"></i><b>2.1.3</b> Other components</a></li>
<li class="chapter" data-level="2.1.4" data-path="2-viz.html"><a href="2-viz.html#ggplot2-package"><i class="fa fa-check"></i><b>2.1.4</b> ggplot2 package</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="2-viz.html"><a href="2-viz.html#FiveNG"><i class="fa fa-check"></i><b>2.2</b> Five named graphs - the 5NG</a></li>
<li class="chapter" data-level="2.3" data-path="2-viz.html"><a href="2-viz.html#scatterplots"><i class="fa fa-check"></i><b>2.3</b> 5NG#1: Scatterplots</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="2-viz.html"><a href="2-viz.html#geompoint"><i class="fa fa-check"></i><b>2.3.1</b> Scatterplots via <code>geom_point</code></a></li>
<li class="chapter" data-level="2.3.2" data-path="2-viz.html"><a href="2-viz.html#overplotting"><i class="fa fa-check"></i><b>2.3.2</b> Overplotting</a></li>
<li class="chapter" data-level="2.3.3" data-path="2-viz.html"><a href="2-viz.html#summary"><i class="fa fa-check"></i><b>2.3.3</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="2-viz.html"><a href="2-viz.html#linegraphs"><i class="fa fa-check"></i><b>2.4</b> 5NG#2: Linegraphs</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="2-viz.html"><a href="2-viz.html#geomline"><i class="fa fa-check"></i><b>2.4.1</b> Linegraphs via <code>geom_line</code></a></li>
<li class="chapter" data-level="2.4.2" data-path="2-viz.html"><a href="2-viz.html#summary-1"><i class="fa fa-check"></i><b>2.4.2</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="2-viz.html"><a href="2-viz.html#histograms"><i class="fa fa-check"></i><b>2.5</b> 5NG#3: Histograms</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="2-viz.html"><a href="2-viz.html#geomhistogram"><i class="fa fa-check"></i><b>2.5.1</b> Histograms via <code>geom_histogram</code></a></li>
<li class="chapter" data-level="2.5.2" data-path="2-viz.html"><a href="2-viz.html#adjustbins"><i class="fa fa-check"></i><b>2.5.2</b> Adjusting the bins</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="2-viz.html"><a href="2-viz.html#facets"><i class="fa fa-check"></i><b>2.6</b> Facets</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="2-viz.html"><a href="2-viz.html#summary-2"><i class="fa fa-check"></i><b>2.6.1</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="2-viz.html"><a href="2-viz.html#boxplots"><i class="fa fa-check"></i><b>2.7</b> 5NG#4: Boxplots</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="2-viz.html"><a href="2-viz.html#geomboxplot"><i class="fa fa-check"></i><b>2.7.1</b> Boxplots via <code>geom_boxplot</code></a></li>
<li class="chapter" data-level="2.7.2" data-path="2-viz.html"><a href="2-viz.html#summary-3"><i class="fa fa-check"></i><b>2.7.2</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="2-viz.html"><a href="2-viz.html#geombar"><i class="fa fa-check"></i><b>2.8</b> 5NG#5: Barplots</a>
<ul>
<li class="chapter" data-level="2.8.1" data-path="2-viz.html"><a href="2-viz.html#barplots-via-geom_bar-or-geom_col"><i class="fa fa-check"></i><b>2.8.1</b> Barplots via <code>geom_bar</code> or <code>geom_col</code></a></li>
<li class="chapter" data-level="2.8.2" data-path="2-viz.html"><a href="2-viz.html#two-categ-barplot"><i class="fa fa-check"></i><b>2.8.2</b> Two categorical variables</a></li>
<li class="chapter" data-level="2.8.3" data-path="2-viz.html"><a href="2-viz.html#summary-4"><i class="fa fa-check"></i><b>2.8.3</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="2-viz.html"><a href="2-viz.html#plots-to-avoid"><i class="fa fa-check"></i><b>2.9</b> Plots to avoid!</a>
<ul>
<li class="chapter" data-level="2.9.1" data-path="2-viz.html"><a href="2-viz.html#barplots-with-a-continuous-variable"><i class="fa fa-check"></i><b>2.9.1</b> Barplots with a continuous variable</a></li>
<li class="chapter" data-level="2.9.2" data-path="2-viz.html"><a href="2-viz.html#pie-charts"><i class="fa fa-check"></i><b>2.9.2</b> Pie charts</a></li>
</ul></li>
<li class="chapter" data-level="2.10" data-path="2-viz.html"><a href="2-viz.html#data-vis-conclusion"><i class="fa fa-check"></i><b>2.10</b> Conclusion</a>
<ul>
<li class="chapter" data-level="2.10.1" data-path="2-viz.html"><a href="2-viz.html#summary-table"><i class="fa fa-check"></i><b>2.10.1</b> Summary table</a></li>
<li class="chapter" data-level="2.10.2" data-path="2-viz.html"><a href="2-viz.html#function-argument-specification"><i class="fa fa-check"></i><b>2.10.2</b> Function argument specification</a></li>
<li class="chapter" data-level="2.10.3" data-path="2-viz.html"><a href="2-viz.html#additional-resources-1"><i class="fa fa-check"></i><b>2.10.3</b> Additional resources</a></li>
<li class="chapter" data-level="2.10.4" data-path="2-viz.html"><a href="2-viz.html#whats-to-come-3"><i class="fa fa-check"></i><b>2.10.4</b> What’s to come</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="3-wrangling.html"><a href="3-wrangling.html"><i class="fa fa-check"></i><b>3</b> Data Wrangling</a>
<ul>
<li class="chapter" data-level="" data-path="3-wrangling.html"><a href="3-wrangling.html#wrangling-packages"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="3.1" data-path="3-wrangling.html"><a href="3-wrangling.html#piping"><i class="fa fa-check"></i><b>3.1</b> The pipe operator: <code>%&gt;%</code></a></li>
<li class="chapter" data-level="3.2" data-path="3-wrangling.html"><a href="3-wrangling.html#filter"><i class="fa fa-check"></i><b>3.2</b> <code>filter</code> rows</a></li>
<li class="chapter" data-level="3.3" data-path="3-wrangling.html"><a href="3-wrangling.html#slice-rows"><i class="fa fa-check"></i><b>3.3</b> <code>slice</code> rows</a></li>
<li class="chapter" data-level="3.4" data-path="3-wrangling.html"><a href="3-wrangling.html#select"><i class="fa fa-check"></i><b>3.4</b> <code>select</code> variables</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="3-wrangling.html"><a href="3-wrangling.html#rename"><i class="fa fa-check"></i><b>3.4.1</b> <code>rename</code> variables</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="3-wrangling.html"><a href="3-wrangling.html#summarize"><i class="fa fa-check"></i><b>3.5</b> <code>summarize</code> variables</a></li>
<li class="chapter" data-level="3.6" data-path="3-wrangling.html"><a href="3-wrangling.html#groupby"><i class="fa fa-check"></i><b>3.6</b> <code>group_by</code> rows</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="3-wrangling.html"><a href="3-wrangling.html#grouping-by-more-than-one-variable"><i class="fa fa-check"></i><b>3.6.1</b> Grouping by more than one variable</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="3-wrangling.html"><a href="3-wrangling.html#mutate"><i class="fa fa-check"></i><b>3.7</b> <code>mutate</code> existing variables</a></li>
<li class="chapter" data-level="3.8" data-path="3-wrangling.html"><a href="3-wrangling.html#arrange"><i class="fa fa-check"></i><b>3.8</b> <code>arrange</code> and sort rows</a></li>
<li class="chapter" data-level="3.9" data-path="3-wrangling.html"><a href="3-wrangling.html#wrangling-conclusion"><i class="fa fa-check"></i><b>3.9</b> Conclusion</a>
<ul>
<li class="chapter" data-level="3.9.1" data-path="3-wrangling.html"><a href="3-wrangling.html#summary-table-1"><i class="fa fa-check"></i><b>3.9.1</b> Summary table</a></li>
<li class="chapter" data-level="3.9.2" data-path="3-wrangling.html"><a href="3-wrangling.html#additional-resources-2"><i class="fa fa-check"></i><b>3.9.2</b> Additional resources</a></li>
<li class="chapter" data-level="3.9.3" data-path="3-wrangling.html"><a href="3-wrangling.html#whats-to-come-1"><i class="fa fa-check"></i><b>3.9.3</b> What’s to come?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="4-tidy.html"><a href="4-tidy.html"><i class="fa fa-check"></i><b>4</b> “Tidy” Data</a>
<ul>
<li class="chapter" data-level="" data-path="4-tidy.html"><a href="4-tidy.html#tidy-packages"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="4.1" data-path="4-tidy.html"><a href="4-tidy.html#tidy-data-ex"><i class="fa fa-check"></i><b>4.1</b> “Tidy” data</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="4-tidy.html"><a href="4-tidy.html#tidy-definition"><i class="fa fa-check"></i><b>4.1.1</b> Definition of “tidy” data</a></li>
<li class="chapter" data-level="4.1.2" data-path="4-tidy.html"><a href="4-tidy.html#converting-to-tidy-data"><i class="fa fa-check"></i><b>4.1.2</b> Converting to “tidy” data</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="4-tidy.html"><a href="4-tidy.html#case-study-tidy"><i class="fa fa-check"></i><b>4.2</b> Case study: Weight loss data</a></li>
<li class="chapter" data-level="4.3" data-path="4-tidy.html"><a href="4-tidy.html#tidyverse-package"><i class="fa fa-check"></i><b>4.3</b> <code>tidyverse</code> package</a></li>
<li class="chapter" data-level="4.4" data-path="4-tidy.html"><a href="4-tidy.html#tidy-data-conclusion"><i class="fa fa-check"></i><b>4.4</b> Conclusion</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="4-tidy.html"><a href="4-tidy.html#additional-resources-3"><i class="fa fa-check"></i><b>4.4.1</b> Additional resources</a></li>
<li class="chapter" data-level="4.4.2" data-path="4-tidy.html"><a href="4-tidy.html#whats-to-come-2"><i class="fa fa-check"></i><b>4.4.2</b> What’s to come?</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Statistical Inference with infer</b></span></li>
<li class="chapter" data-level="5" data-path="5-sampling.html"><a href="5-sampling.html"><i class="fa fa-check"></i><b>5</b> Sampling</a>
<ul>
<li class="chapter" data-level="" data-path="5-sampling.html"><a href="5-sampling.html#sampling-packages"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="5.1" data-path="5-sampling.html"><a href="5-sampling.html#sampling-activity"><i class="fa fa-check"></i><b>5.1</b> Sampling bowl activity</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="5-sampling.html"><a href="5-sampling.html#what-proportion-of-this-bowls-balls-are-red"><i class="fa fa-check"></i><b>5.1.1</b> What proportion of this bowl’s balls are red?</a></li>
<li class="chapter" data-level="5.1.2" data-path="5-sampling.html"><a href="5-sampling.html#using-the-shovel-once"><i class="fa fa-check"></i><b>5.1.2</b> Using the shovel once</a></li>
<li class="chapter" data-level="5.1.3" data-path="5-sampling.html"><a href="5-sampling.html#student-shovels"><i class="fa fa-check"></i><b>5.1.3</b> Using the shovel 33 times</a></li>
<li class="chapter" data-level="5.1.4" data-path="5-sampling.html"><a href="5-sampling.html#sampling-what-did-we-just-do"><i class="fa fa-check"></i><b>5.1.4</b> What did we just do?</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="5-sampling.html"><a href="5-sampling.html#sampling-simulation"><i class="fa fa-check"></i><b>5.2</b> Virtual sampling</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="5-sampling.html"><a href="5-sampling.html#using-the-virtual-shovel-once"><i class="fa fa-check"></i><b>5.2.1</b> Using the virtual shovel once</a></li>
<li class="chapter" data-level="5.2.2" data-path="5-sampling.html"><a href="5-sampling.html#using-the-virtual-shovel-33-times"><i class="fa fa-check"></i><b>5.2.2</b> Using the virtual shovel 33 times</a></li>
<li class="chapter" data-level="5.2.3" data-path="5-sampling.html"><a href="5-sampling.html#shovel-1000-times"><i class="fa fa-check"></i><b>5.2.3</b> Using the virtual shovel 1000 times</a></li>
<li class="chapter" data-level="5.2.4" data-path="5-sampling.html"><a href="5-sampling.html#the-normal-distribution"><i class="fa fa-check"></i><b>5.2.4</b> The Normal Distribution</a></li>
<li class="chapter" data-level="5.2.5" data-path="5-sampling.html"><a href="5-sampling.html#different-shovels"><i class="fa fa-check"></i><b>5.2.5</b> Using different shovels</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="5-sampling.html"><a href="5-sampling.html#sampling-framework"><i class="fa fa-check"></i><b>5.3</b> Sampling framework</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="5-sampling.html"><a href="5-sampling.html#terminology-and-notation"><i class="fa fa-check"></i><b>5.3.1</b> Terminology and notation</a></li>
<li class="chapter" data-level="5.3.2" data-path="5-sampling.html"><a href="5-sampling.html#sampling-definitions"><i class="fa fa-check"></i><b>5.3.2</b> Statistical definitions</a></li>
<li class="chapter" data-level="5.3.3" data-path="5-sampling.html"><a href="5-sampling.html#moral-of-the-story"><i class="fa fa-check"></i><b>5.3.3</b> The moral of the story</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="5-sampling.html"><a href="5-sampling.html#sampling-case-study"><i class="fa fa-check"></i><b>5.4</b> Case study: Genetic crosses</a></li>
<li class="chapter" data-level="5.5" data-path="5-sampling.html"><a href="5-sampling.html#sampling-conclusion-central-limit-theorem"><i class="fa fa-check"></i><b>5.5</b> Central Limit Theorem</a></li>
<li class="chapter" data-level="5.6" data-path="5-sampling.html"><a href="5-sampling.html#sampling-conclusion-table"><i class="fa fa-check"></i><b>5.6</b> Sampling scenarios</a></li>
<li class="chapter" data-level="5.7" data-path="5-sampling.html"><a href="5-sampling.html#sampling-conclusion"><i class="fa fa-check"></i><b>5.7</b> Conclusion</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="5-sampling.html"><a href="5-sampling.html#whats-to-come-4"><i class="fa fa-check"></i><b>5.7.1</b> What’s to come?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html"><i class="fa fa-check"></i><b>6</b> Bootstrapping and Confidence Intervals</a>
<ul>
<li class="chapter" data-level="" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#CI-packages"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="6.1" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#resampling-tactile"><i class="fa fa-check"></i><b>6.1</b> Pennies activity</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#what-is-the-average-year-on-us-pennies-in-2019"><i class="fa fa-check"></i><b>6.1.1</b> What is the average year on US pennies in 2019?</a></li>
<li class="chapter" data-level="6.1.2" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#resampling-once"><i class="fa fa-check"></i><b>6.1.2</b> Resampling once</a></li>
<li class="chapter" data-level="6.1.3" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#student-resamples"><i class="fa fa-check"></i><b>6.1.3</b> Resampling 35 times</a></li>
<li class="chapter" data-level="6.1.4" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#ci-what-did-we-just-do"><i class="fa fa-check"></i><b>6.1.4</b> What did we just do?</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#resampling-simulation"><i class="fa fa-check"></i><b>6.2</b> Computer simulation of resampling</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#virtually-resampling-once"><i class="fa fa-check"></i><b>6.2.1</b> Virtually resampling once</a></li>
<li class="chapter" data-level="6.2.2" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#bootstrap-35-replicates"><i class="fa fa-check"></i><b>6.2.2</b> Virtually resampling 35 times</a></li>
<li class="chapter" data-level="6.2.3" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#bootstrap-1000-replicates"><i class="fa fa-check"></i><b>6.2.3</b> Virtually resampling 1000 times</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#ci-build-up"><i class="fa fa-check"></i><b>6.3</b> Understanding confidence intervals</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#percentile-method"><i class="fa fa-check"></i><b>6.3.1</b> Percentile method</a></li>
<li class="chapter" data-level="6.3.2" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#se-method"><i class="fa fa-check"></i><b>6.3.2</b> Standard error method</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#bootstrap-process"><i class="fa fa-check"></i><b>6.4</b> Constructing confidence intervals</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#original-workflow"><i class="fa fa-check"></i><b>6.4.1</b> Original workflow</a></li>
<li class="chapter" data-level="6.4.2" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#infer-workflow"><i class="fa fa-check"></i><b>6.4.2</b> <code>infer</code> package workflow</a></li>
<li class="chapter" data-level="6.4.3" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#percentile-method-infer"><i class="fa fa-check"></i><b>6.4.3</b> Percentile method with <code>infer</code></a></li>
<li class="chapter" data-level="6.4.4" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#infer-se"><i class="fa fa-check"></i><b>6.4.4</b> Standard error method with <code>infer</code></a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#one-prop-ci"><i class="fa fa-check"></i><b>6.5</b> Interpreting confidence intervals</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#ilyas-yohan"><i class="fa fa-check"></i><b>6.5.1</b> Did the net capture the fish?</a></li>
<li class="chapter" data-level="6.5.2" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#shorthand"><i class="fa fa-check"></i><b>6.5.2</b> Precise and shorthand interpretation</a></li>
<li class="chapter" data-level="6.5.3" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#ci-width"><i class="fa fa-check"></i><b>6.5.3</b> Width of confidence intervals</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#case-study-two-prop-ci"><i class="fa fa-check"></i><b>6.6</b> Case study: Is yawning contagious?</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#mythbusters-study-data"><i class="fa fa-check"></i><b>6.6.1</b> <em>Mythbusters</em> study data</a></li>
<li class="chapter" data-level="6.6.2" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#sampling-scenario"><i class="fa fa-check"></i><b>6.6.2</b> Sampling scenario</a></li>
<li class="chapter" data-level="6.6.3" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#ci-build"><i class="fa fa-check"></i><b>6.6.3</b> Constructing the confidence interval</a></li>
<li class="chapter" data-level="6.6.4" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#interpreting-the-confidence-interval"><i class="fa fa-check"></i><b>6.6.4</b> Interpreting the confidence interval</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#bootstrap-vs-sampling"><i class="fa fa-check"></i><b>6.7</b> Comparing bootstrap and sampling distributions</a>
<ul>
<li class="chapter" data-level="" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#sampling-distribution"><i class="fa fa-check"></i>Sampling distribution</a></li>
<li class="chapter" data-level="" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#bootstrap-distribution"><i class="fa fa-check"></i>Bootstrap distribution</a></li>
<li class="chapter" data-level="" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#comparison"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="6.8" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#theory-ci"><i class="fa fa-check"></i><b>6.8</b> Theory-based confidence intervals</a>
<ul>
<li class="chapter" data-level="" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#theory-based-method-for-computing-standard-errors"><i class="fa fa-check"></i>Theory-based method for computing standard errors</a></li>
<li class="chapter" data-level="" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#theory-based-method-for-constructing-confidence-intervals"><i class="fa fa-check"></i>Theory-based method for constructing confidence intervals</a></li>
<li class="chapter" data-level="" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#confidence-intervals-based-on-33-tactile-samples"><i class="fa fa-check"></i>Confidence intervals based on 33 tactile samples</a></li>
</ul></li>
<li class="chapter" data-level="6.9" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#ci-conclusion"><i class="fa fa-check"></i><b>6.9</b> Conclusion</a>
<ul>
<li class="chapter" data-level="6.9.1" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#additional-resources-4"><i class="fa fa-check"></i><b>6.9.1</b> Additional resources</a></li>
<li class="chapter" data-level="6.9.2" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#whats-to-come-5"><i class="fa fa-check"></i><b>6.9.2</b> What’s to come?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html"><i class="fa fa-check"></i><b>7</b> Hypothesis Testing</a>
<ul>
<li class="chapter" data-level="" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#nhst-packages"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="7.1" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#ht-activity"><i class="fa fa-check"></i><b>7.1</b> Clutch size and malaria resistance</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#is-there-a-tradeoff-between-reproduction-and-immune-defense"><i class="fa fa-check"></i><b>7.1.1</b> Is there a tradeoff between reproduction and immune defense?</a></li>
<li class="chapter" data-level="7.1.2" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#shuffling-once"><i class="fa fa-check"></i><b>7.1.2</b> Shuffling once</a></li>
<li class="chapter" data-level="7.1.3" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#shuffling-99-more-times"><i class="fa fa-check"></i><b>7.1.3</b> Shuffling 99 more times</a></li>
<li class="chapter" data-level="7.1.4" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#ht-what-did-we-just-do"><i class="fa fa-check"></i><b>7.1.4</b> What did we just do?</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#understanding-ht"><i class="fa fa-check"></i><b>7.2</b> Understanding hypothesis tests</a></li>
<li class="chapter" data-level="7.3" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#ht-infer"><i class="fa fa-check"></i><b>7.3</b> Conducting hypothesis tests</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#infer-workflow-ht"><i class="fa fa-check"></i><b>7.3.1</b> <code>infer</code> package workflow</a></li>
<li class="chapter" data-level="7.3.2" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#comparing-infer-workflows"><i class="fa fa-check"></i><b>7.3.2</b> Comparison with confidence intervals</a></li>
<li class="chapter" data-level="7.3.3" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#only-one-test"><i class="fa fa-check"></i><b>7.3.3</b> “There is only one test”</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#ht-interpretation"><i class="fa fa-check"></i><b>7.4</b> Interpreting hypothesis tests</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#trial"><i class="fa fa-check"></i><b>7.4.1</b> Two possible outcomes</a></li>
<li class="chapter" data-level="7.4.2" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#types-of-errors"><i class="fa fa-check"></i><b>7.4.2</b> Types of errors</a></li>
<li class="chapter" data-level="7.4.3" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#choosing-alpha"><i class="fa fa-check"></i><b>7.4.3</b> How do we choose alpha?</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#ht-case-study"><i class="fa fa-check"></i><b>7.5</b> Case study: Do living lizards have longer horns than dead lizards?</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#imdb-data"><i class="fa fa-check"></i><b>7.5.1</b> Horned lizards dataset</a></li>
<li class="chapter" data-level="7.5.2" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#sampling-scenario-1"><i class="fa fa-check"></i><b>7.5.2</b> Sampling scenario</a></li>
<li class="chapter" data-level="7.5.3" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#conducting-the-hypothesis-test"><i class="fa fa-check"></i><b>7.5.3</b> Conducting the hypothesis test</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#theory-hypo"><i class="fa fa-check"></i><b>7.6</b> Theory-based hypothesis tests</a>
<ul>
<li class="chapter" data-level="" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#two-sample-t-statistic"><i class="fa fa-check"></i>Two-sample t-statistic</a></li>
<li class="chapter" data-level="" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#null-distribution"><i class="fa fa-check"></i>Null distribution</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#problems-with-p-values"><i class="fa fa-check"></i><b>7.7</b> Problems with p-values</a></li>
<li class="chapter" data-level="7.8" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#nhst-conclusion"><i class="fa fa-check"></i><b>7.8</b> Conclusion</a>
<ul>
<li class="chapter" data-level="7.8.1" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#additional-resources-5"><i class="fa fa-check"></i><b>7.8.1</b> Additional resources</a></li>
<li class="chapter" data-level="7.8.2" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#whats-to-come-6"><i class="fa fa-check"></i><b>7.8.2</b> What’s to come</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Data Modeling with moderndive</b></span></li>
<li class="chapter" data-level="8" data-path="8-regression.html"><a href="8-regression.html"><i class="fa fa-check"></i><b>8</b> Basic Regression</a>
<ul>
<li class="chapter" data-level="" data-path="8-regression.html"><a href="8-regression.html#reg-modeling"><i class="fa fa-check"></i>Modeling for explanation or prediction</a></li>
<li class="chapter" data-level="" data-path="8-regression.html"><a href="8-regression.html#reg-packages"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="8.1" data-path="8-regression.html"><a href="8-regression.html#model1"><i class="fa fa-check"></i><b>8.1</b> One numerical explanatory variable</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="8-regression.html"><a href="8-regression.html#model1EDA"><i class="fa fa-check"></i><b>8.1.1</b> Exploratory data analysis</a></li>
<li class="chapter" data-level="8.1.2" data-path="8-regression.html"><a href="8-regression.html#model1table"><i class="fa fa-check"></i><b>8.1.2</b> Simple linear regression</a></li>
<li class="chapter" data-level="8.1.3" data-path="8-regression.html"><a href="8-regression.html#model1points"><i class="fa fa-check"></i><b>8.1.3</b> Observed/fitted values and residuals</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="8-regression.html"><a href="8-regression.html#model2"><i class="fa fa-check"></i><b>8.2</b> One categorical explanatory variable</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="8-regression.html"><a href="8-regression.html#model2EDA"><i class="fa fa-check"></i><b>8.2.1</b> Exploratory data analysis</a></li>
<li class="chapter" data-level="8.2.2" data-path="8-regression.html"><a href="8-regression.html#model2table"><i class="fa fa-check"></i><b>8.2.2</b> Linear regression</a></li>
<li class="chapter" data-level="8.2.3" data-path="8-regression.html"><a href="8-regression.html#model2points"><i class="fa fa-check"></i><b>8.2.3</b> Observed/fitted values and residuals</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="8-regression.html"><a href="8-regression.html#reg-related-topics"><i class="fa fa-check"></i><b>8.3</b> Related topics</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="8-regression.html"><a href="8-regression.html#correlation-is-not-causation"><i class="fa fa-check"></i><b>8.3.1</b> Correlation is not necessarily causation</a></li>
<li class="chapter" data-level="8.3.2" data-path="8-regression.html"><a href="8-regression.html#leastsquares"><i class="fa fa-check"></i><b>8.3.2</b> Best-fitting line</a></li>
<li class="chapter" data-level="8.3.3" data-path="8-regression.html"><a href="8-regression.html#underthehood"><i class="fa fa-check"></i><b>8.3.3</b> <code>get_regression_x()</code> functions</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="8-regression.html"><a href="8-regression.html#reg-conclusion"><i class="fa fa-check"></i><b>8.4</b> Conclusion</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="8-regression.html"><a href="8-regression.html#whats-to-come-7"><i class="fa fa-check"></i><b>8.4.1</b> What’s to come?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html"><i class="fa fa-check"></i><b>9</b> Inference for Regression</a>
<ul>
<li class="chapter" data-level="" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#inf-packages"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="9.1" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#regression-refresher"><i class="fa fa-check"></i><b>9.1</b> Regression refresher</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#lion-age-and-nose-coloration"><i class="fa fa-check"></i><b>9.1.1</b> Lion age and nose coloration</a></li>
<li class="chapter" data-level="9.1.2" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#sampling-scenario-2"><i class="fa fa-check"></i><b>9.1.2</b> Sampling scenario</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#regression-interp"><i class="fa fa-check"></i><b>9.2</b> Interpreting regression tables</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#regression-se"><i class="fa fa-check"></i><b>9.2.1</b> Standard error</a></li>
<li class="chapter" data-level="9.2.2" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#regression-test-statistic"><i class="fa fa-check"></i><b>9.2.2</b> Test statistic</a></li>
<li class="chapter" data-level="9.2.3" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#p-value"><i class="fa fa-check"></i><b>9.2.3</b> p-value</a></li>
<li class="chapter" data-level="9.2.4" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#confidence-interval"><i class="fa fa-check"></i><b>9.2.4</b> Confidence interval</a></li>
<li class="chapter" data-level="9.2.5" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#regression-table-computation"><i class="fa fa-check"></i><b>9.2.5</b> How does R compute the table?</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#regression-conditions"><i class="fa fa-check"></i><b>9.3</b> Conditions for inference for regression</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#residuals-refresher"><i class="fa fa-check"></i><b>9.3.1</b> Residuals refresher</a></li>
<li class="chapter" data-level="9.3.2" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#linearity-of-relationship"><i class="fa fa-check"></i><b>9.3.2</b> Linearity of relationship</a></li>
<li class="chapter" data-level="9.3.3" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#independence-of-residuals"><i class="fa fa-check"></i><b>9.3.3</b> Independence of residuals</a></li>
<li class="chapter" data-level="9.3.4" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#normality-of-residuals"><i class="fa fa-check"></i><b>9.3.4</b> Normality of residuals</a></li>
<li class="chapter" data-level="9.3.5" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#equality-of-variance"><i class="fa fa-check"></i><b>9.3.5</b> Equality of variance</a></li>
<li class="chapter" data-level="9.3.6" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#what-is-the-conclusion"><i class="fa fa-check"></i><b>9.3.6</b> What’s the conclusion?</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#infer-regression"><i class="fa fa-check"></i><b>9.4</b> Simulation-based inference for regression</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#confidence-interval-for-slope"><i class="fa fa-check"></i><b>9.4.1</b> Confidence interval for slope</a></li>
<li class="chapter" data-level="9.4.2" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#hypothesis-test-for-slope"><i class="fa fa-check"></i><b>9.4.2</b> Hypothesis test for slope</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#theory-regression"><i class="fa fa-check"></i><b>9.5</b> Theory-based inference for regression</a></li>
<li class="chapter" data-level="9.6" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#inference-conclusion"><i class="fa fa-check"></i><b>9.6</b> Conclusion</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#summary-of-statistical-inference"><i class="fa fa-check"></i><b>9.6.1</b> Summary of statistical inference</a></li>
<li class="chapter" data-level="9.6.2" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#whats-to-come-8"><i class="fa fa-check"></i><b>9.6.2</b> What’s to come</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="10-multiple-regression.html"><a href="10-multiple-regression.html"><i class="fa fa-check"></i><b>10</b> Multiple Regression</a>
<ul>
<li class="chapter" data-level="" data-path="10-multiple-regression.html"><a href="10-multiple-regression.html#mult-reg-packages"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="10.1" data-path="10-multiple-regression.html"><a href="10-multiple-regression.html#model4"><i class="fa fa-check"></i><b>10.1</b> One numerical and one categorical explanatory variable</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="10-multiple-regression.html"><a href="10-multiple-regression.html#model4EDA"><i class="fa fa-check"></i><b>10.1.1</b> Exploratory data analysis</a></li>
<li class="chapter" data-level="10.1.2" data-path="10-multiple-regression.html"><a href="10-multiple-regression.html#model4interactiontable"><i class="fa fa-check"></i><b>10.1.2</b> Interaction model</a></li>
<li class="chapter" data-level="10.1.3" data-path="10-multiple-regression.html"><a href="10-multiple-regression.html#model4table"><i class="fa fa-check"></i><b>10.1.3</b> Parallel slopes model</a></li>
<li class="chapter" data-level="10.1.4" data-path="10-multiple-regression.html"><a href="10-multiple-regression.html#model4points"><i class="fa fa-check"></i><b>10.1.4</b> Observed/fitted values and residuals</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="10-multiple-regression.html"><a href="10-multiple-regression.html#model3"><i class="fa fa-check"></i><b>10.2</b> Two categorical explanatory variables</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="10-multiple-regression.html"><a href="10-multiple-regression.html#model3EDA"><i class="fa fa-check"></i><b>10.2.1</b> Exploratory data analysis</a></li>
<li class="chapter" data-level="10.2.2" data-path="10-multiple-regression.html"><a href="10-multiple-regression.html#model3table"><i class="fa fa-check"></i><b>10.2.2</b> Regression lines</a></li>
<li class="chapter" data-level="10.2.3" data-path="10-multiple-regression.html"><a href="10-multiple-regression.html#model3points"><i class="fa fa-check"></i><b>10.2.3</b> Observed/fitted values and residuals</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="10-multiple-regression.html"><a href="10-multiple-regression.html#mult-reg-related-topics"><i class="fa fa-check"></i><b>10.3</b> Related topics</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="10-multiple-regression.html"><a href="10-multiple-regression.html#model-selection"><i class="fa fa-check"></i><b>10.3.1</b> Model selection using visualizations</a></li>
<li class="chapter" data-level="10.3.2" data-path="10-multiple-regression.html"><a href="10-multiple-regression.html#rsquared"><i class="fa fa-check"></i><b>10.3.2</b> Model selection using R-squared</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="10-multiple-regression.html"><a href="10-multiple-regression.html#mult-reg-conclusion"><i class="fa fa-check"></i><b>10.4</b> Conclusion</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="10-multiple-regression.html"><a href="10-multiple-regression.html#whats-to-come-9"><i class="fa fa-check"></i><b>10.4.1</b> What’s to come?</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>IV Conclusion</b></span></li>
<li class="chapter" data-level="11" data-path="11-thinking-with-data.html"><a href="11-thinking-with-data.html"><i class="fa fa-check"></i><b>11</b> Tell Your Story with Data</a>
<ul>
<li class="chapter" data-level="11.1" data-path="11-thinking-with-data.html"><a href="11-thinking-with-data.html#review"><i class="fa fa-check"></i><b>11.1</b> Review</a></li>
<li class="chapter" data-level="11.2" data-path="11-thinking-with-data.html"><a href="11-thinking-with-data.html#data-journalism"><i class="fa fa-check"></i><b>11.2</b> Case study: Effective data storytelling</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="11-thinking-with-data.html"><a href="11-thinking-with-data.html#us-births-in-1999"><i class="fa fa-check"></i><b>11.2.1</b> US Births in 1999</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="11-thinking-with-data.html"><a href="11-thinking-with-data.html#concluding-remarks"><i class="fa fa-check"></i>Concluding remarks</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="A-appendixA.html"><a href="A-appendixA.html"><i class="fa fa-check"></i><b>A</b> Statistical Background</a>
<ul>
<li class="chapter" data-level="A.1" data-path="A-appendixA.html"><a href="A-appendixA.html#appendix-stat-terms"><i class="fa fa-check"></i><b>A.1</b> Basic statistical terms</a>
<ul>
<li class="chapter" data-level="A.1.1" data-path="A-appendixA.html"><a href="A-appendixA.html#mean"><i class="fa fa-check"></i><b>A.1.1</b> Mean</a></li>
<li class="chapter" data-level="A.1.2" data-path="A-appendixA.html"><a href="A-appendixA.html#median"><i class="fa fa-check"></i><b>A.1.2</b> Median</a></li>
<li class="chapter" data-level="A.1.3" data-path="A-appendixA.html"><a href="A-appendixA.html#appendix-sd-variance"><i class="fa fa-check"></i><b>A.1.3</b> Standard deviation and variance</a></li>
<li class="chapter" data-level="A.1.4" data-path="A-appendixA.html"><a href="A-appendixA.html#five-number-summary"><i class="fa fa-check"></i><b>A.1.4</b> Five-number summary</a></li>
<li class="chapter" data-level="A.1.5" data-path="A-appendixA.html"><a href="A-appendixA.html#distribution"><i class="fa fa-check"></i><b>A.1.5</b> Distribution</a></li>
<li class="chapter" data-level="A.1.6" data-path="A-appendixA.html"><a href="A-appendixA.html#outliers"><i class="fa fa-check"></i><b>A.1.6</b> Outliers</a></li>
</ul></li>
<li class="chapter" data-level="A.2" data-path="A-appendixA.html"><a href="A-appendixA.html#appendix-normal-curve"><i class="fa fa-check"></i><b>A.2</b> Normal distribution</a></li>
<li class="chapter" data-level="A.3" data-path="A-appendixA.html"><a href="A-appendixA.html#appendix-log10-transformations"><i class="fa fa-check"></i><b>A.3</b> log10 transformations</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="B-appendixB.html"><a href="B-appendixB.html"><i class="fa fa-check"></i><b>B</b> Inference Examples</a>
<ul>
<li class="chapter" data-level="" data-path="B-appendixB.html"><a href="B-appendixB.html#needed-packages-1"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="B.1" data-path="B-appendixB.html"><a href="B-appendixB.html#inference-mind-map"><i class="fa fa-check"></i><b>B.1</b> Inference mind map</a></li>
<li class="chapter" data-level="B.2" data-path="B-appendixB.html"><a href="B-appendixB.html#one-mean"><i class="fa fa-check"></i><b>B.2</b> One mean</a>
<ul>
<li class="chapter" data-level="B.2.1" data-path="B-appendixB.html"><a href="B-appendixB.html#problem-statement"><i class="fa fa-check"></i><b>B.2.1</b> Problem statement</a></li>
<li class="chapter" data-level="B.2.2" data-path="B-appendixB.html"><a href="B-appendixB.html#competing-hypotheses"><i class="fa fa-check"></i><b>B.2.2</b> Competing hypotheses</a></li>
<li class="chapter" data-level="B.2.3" data-path="B-appendixB.html"><a href="B-appendixB.html#exploring-the-sample-data"><i class="fa fa-check"></i><b>B.2.3</b> Exploring the sample data</a></li>
<li class="chapter" data-level="B.2.4" data-path="B-appendixB.html"><a href="B-appendixB.html#non-traditional-methods"><i class="fa fa-check"></i><b>B.2.4</b> Non-traditional methods</a></li>
<li class="chapter" data-level="B.2.5" data-path="B-appendixB.html"><a href="B-appendixB.html#traditional-methods"><i class="fa fa-check"></i><b>B.2.5</b> Traditional methods</a></li>
<li class="chapter" data-level="B.2.6" data-path="B-appendixB.html"><a href="B-appendixB.html#comparing-results"><i class="fa fa-check"></i><b>B.2.6</b> Comparing results</a></li>
</ul></li>
<li class="chapter" data-level="B.3" data-path="B-appendixB.html"><a href="B-appendixB.html#one-proportion"><i class="fa fa-check"></i><b>B.3</b> One proportion</a>
<ul>
<li class="chapter" data-level="B.3.1" data-path="B-appendixB.html"><a href="B-appendixB.html#problem-statement-1"><i class="fa fa-check"></i><b>B.3.1</b> Problem statement</a></li>
<li class="chapter" data-level="B.3.2" data-path="B-appendixB.html"><a href="B-appendixB.html#competing-hypotheses-1"><i class="fa fa-check"></i><b>B.3.2</b> Competing hypotheses</a></li>
<li class="chapter" data-level="B.3.3" data-path="B-appendixB.html"><a href="B-appendixB.html#exploring-the-sample-data-1"><i class="fa fa-check"></i><b>B.3.3</b> Exploring the sample data</a></li>
<li class="chapter" data-level="B.3.4" data-path="B-appendixB.html"><a href="B-appendixB.html#non-traditional-methods-1"><i class="fa fa-check"></i><b>B.3.4</b> Non-traditional methods</a></li>
<li class="chapter" data-level="B.3.5" data-path="B-appendixB.html"><a href="B-appendixB.html#traditional-methods-1"><i class="fa fa-check"></i><b>B.3.5</b> Traditional methods</a></li>
<li class="chapter" data-level="B.3.6" data-path="B-appendixB.html"><a href="B-appendixB.html#comparing-results-1"><i class="fa fa-check"></i><b>B.3.6</b> Comparing results</a></li>
</ul></li>
<li class="chapter" data-level="B.4" data-path="B-appendixB.html"><a href="B-appendixB.html#two-proportions"><i class="fa fa-check"></i><b>B.4</b> Two proportions</a>
<ul>
<li class="chapter" data-level="B.4.1" data-path="B-appendixB.html"><a href="B-appendixB.html#problem-statement-2"><i class="fa fa-check"></i><b>B.4.1</b> Problem statement</a></li>
<li class="chapter" data-level="B.4.2" data-path="B-appendixB.html"><a href="B-appendixB.html#competing-hypotheses-2"><i class="fa fa-check"></i><b>B.4.2</b> Competing hypotheses</a></li>
<li class="chapter" data-level="B.4.3" data-path="B-appendixB.html"><a href="B-appendixB.html#exploring-the-sample-data-2"><i class="fa fa-check"></i><b>B.4.3</b> Exploring the sample data</a></li>
<li class="chapter" data-level="B.4.4" data-path="B-appendixB.html"><a href="B-appendixB.html#non-traditional-methods-2"><i class="fa fa-check"></i><b>B.4.4</b> Non-traditional methods</a></li>
<li class="chapter" data-level="B.4.5" data-path="B-appendixB.html"><a href="B-appendixB.html#traditional-methods-2"><i class="fa fa-check"></i><b>B.4.5</b> Traditional methods</a></li>
<li class="chapter" data-level="B.4.6" data-path="B-appendixB.html"><a href="B-appendixB.html#test-statistic-2"><i class="fa fa-check"></i><b>B.4.6</b> Test statistic</a></li>
<li class="chapter" data-level="B.4.7" data-path="B-appendixB.html"><a href="B-appendixB.html#state-conclusion-2"><i class="fa fa-check"></i><b>B.4.7</b> State conclusion</a></li>
<li class="chapter" data-level="B.4.8" data-path="B-appendixB.html"><a href="B-appendixB.html#comparing-results-2"><i class="fa fa-check"></i><b>B.4.8</b> Comparing results</a></li>
</ul></li>
<li class="chapter" data-level="B.5" data-path="B-appendixB.html"><a href="B-appendixB.html#two-means-independent-samples"><i class="fa fa-check"></i><b>B.5</b> Two means (independent samples)</a>
<ul>
<li class="chapter" data-level="B.5.1" data-path="B-appendixB.html"><a href="B-appendixB.html#problem-statement-3"><i class="fa fa-check"></i><b>B.5.1</b> Problem statement</a></li>
<li class="chapter" data-level="B.5.2" data-path="B-appendixB.html"><a href="B-appendixB.html#competing-hypotheses-3"><i class="fa fa-check"></i><b>B.5.2</b> Competing hypotheses</a></li>
<li class="chapter" data-level="B.5.3" data-path="B-appendixB.html"><a href="B-appendixB.html#exploring-the-sample-data-3"><i class="fa fa-check"></i><b>B.5.3</b> Exploring the sample data</a></li>
<li class="chapter" data-level="B.5.4" data-path="B-appendixB.html"><a href="B-appendixB.html#non-traditional-methods-3"><i class="fa fa-check"></i><b>B.5.4</b> Non-traditional methods</a></li>
<li class="chapter" data-level="B.5.5" data-path="B-appendixB.html"><a href="B-appendixB.html#traditional-methods-3"><i class="fa fa-check"></i><b>B.5.5</b> Traditional methods</a></li>
<li class="chapter" data-level="B.5.6" data-path="B-appendixB.html"><a href="B-appendixB.html#test-statistic-3"><i class="fa fa-check"></i><b>B.5.6</b> Test statistic</a></li>
<li class="chapter" data-level="B.5.7" data-path="B-appendixB.html"><a href="B-appendixB.html#compute-p-value-1"><i class="fa fa-check"></i><b>B.5.7</b> Compute <span class="math inline">\(p\)</span>-value</a></li>
<li class="chapter" data-level="B.5.8" data-path="B-appendixB.html"><a href="B-appendixB.html#state-conclusion-3"><i class="fa fa-check"></i><b>B.5.8</b> State conclusion</a></li>
<li class="chapter" data-level="B.5.9" data-path="B-appendixB.html"><a href="B-appendixB.html#comparing-results-3"><i class="fa fa-check"></i><b>B.5.9</b> Comparing results</a></li>
</ul></li>
<li class="chapter" data-level="B.6" data-path="B-appendixB.html"><a href="B-appendixB.html#two-means-paired-samples"><i class="fa fa-check"></i><b>B.6</b> Two means (paired samples)</a>
<ul>
<li class="chapter" data-level="" data-path="B-appendixB.html"><a href="B-appendixB.html#problem-statement-4"><i class="fa fa-check"></i>Problem statement</a></li>
<li class="chapter" data-level="B.6.1" data-path="B-appendixB.html"><a href="B-appendixB.html#competing-hypotheses-4"><i class="fa fa-check"></i><b>B.6.1</b> Competing hypotheses</a></li>
<li class="chapter" data-level="B.6.2" data-path="B-appendixB.html"><a href="B-appendixB.html#exploring-the-sample-data-4"><i class="fa fa-check"></i><b>B.6.2</b> Exploring the sample data</a></li>
<li class="chapter" data-level="B.6.3" data-path="B-appendixB.html"><a href="B-appendixB.html#non-traditional-methods-4"><i class="fa fa-check"></i><b>B.6.3</b> Non-traditional methods</a></li>
<li class="chapter" data-level="B.6.4" data-path="B-appendixB.html"><a href="B-appendixB.html#traditional-methods-4"><i class="fa fa-check"></i><b>B.6.4</b> Traditional methods</a></li>
<li class="chapter" data-level="B.6.5" data-path="B-appendixB.html"><a href="B-appendixB.html#comparing-results-4"><i class="fa fa-check"></i><b>B.6.5</b> Comparing results</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="C" data-path="C-appendixC.html"><a href="C-appendixC.html"><i class="fa fa-check"></i><b>C</b> Tips and Tricks</a>
<ul>
<li class="chapter" data-level="" data-path="C-appendixC.html"><a href="C-appendixC.html#needed-packages-2"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="C.1" data-path="C-appendixC.html"><a href="C-appendixC.html#data-wrangling"><i class="fa fa-check"></i><b>C.1</b> Data wrangling</a>
<ul>
<li class="chapter" data-level="C.1.1" data-path="C-appendixC.html"><a href="C-appendixC.html#appendix-missing-values"><i class="fa fa-check"></i><b>C.1.1</b> Dealing with missing values</a></li>
<li class="chapter" data-level="C.1.2" data-path="C-appendixC.html"><a href="C-appendixC.html#appendix-reordering-bars"><i class="fa fa-check"></i><b>C.1.2</b> Reordering bars in a barplot</a></li>
<li class="chapter" data-level="C.1.3" data-path="C-appendixC.html"><a href="C-appendixC.html#appendix-money-on-axis"><i class="fa fa-check"></i><b>C.1.3</b> Showing money on an axis</a></li>
<li class="chapter" data-level="C.1.4" data-path="C-appendixC.html"><a href="C-appendixC.html#appendix-changing-values"><i class="fa fa-check"></i><b>C.1.4</b> Changing values inside cells</a></li>
<li class="chapter" data-level="C.1.5" data-path="C-appendixC.html"><a href="C-appendixC.html#appendix-convert-numerical-categorical"><i class="fa fa-check"></i><b>C.1.5</b> Converting a numerical variable to a categorical one</a></li>
<li class="chapter" data-level="C.1.6" data-path="C-appendixC.html"><a href="C-appendixC.html#appendix-prop"><i class="fa fa-check"></i><b>C.1.6</b> Computing proportions</a></li>
<li class="chapter" data-level="C.1.7" data-path="C-appendixC.html"><a href="C-appendixC.html#appendix-commas"><i class="fa fa-check"></i><b>C.1.7</b> Dealing with %, commas, and $</a></li>
</ul></li>
<li class="chapter" data-level="C.2" data-path="C-appendixC.html"><a href="C-appendixC.html#interactive-graphics"><i class="fa fa-check"></i><b>C.2</b> Interactive graphics</a>
<ul>
<li class="chapter" data-level="C.2.1" data-path="C-appendixC.html"><a href="C-appendixC.html#interactive-linegraphs"><i class="fa fa-check"></i><b>C.2.1</b> Interactive linegraphs</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Modern Biological Data Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<html>
<img src='https://moderndive.com/wide_format.png' alt="ModernDive">
</html>
<div id="hypothesis-testing" class="section level1 hasAnchor" number="7">
<h1><span class="header-section-number">Chapter 7</span> Hypothesis Testing<a href="7-hypothesis-testing.html#hypothesis-testing" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Now that we’ve studied confidence intervals in Chapter <a href="6-confidence-intervals.html#confidence-intervals">6</a>, let’s study another commonly used method for statistical inference: hypothesis testing. Hypothesis tests allow us to take a sample of data from a population and infer about the plausibility of competing hypotheses. For example, in the upcoming “clutch size” example in Section <a href="7-hypothesis-testing.html#ht-activity">7.1</a>, you’ll study the data collected from a study to investigate whether their was an association between egg production and a female’s susceptibility to parasites.</p>
<p>The good news is we’ve already covered many of the necessary concepts to understand hypothesis testing in Chapters <a href="5-sampling.html#sampling">5</a> and <a href="6-confidence-intervals.html#confidence-intervals">6</a>. We will expand further on these ideas here and also provide a general framework for understanding hypothesis tests. By understanding this general framework, you’ll be able to adapt it to many different scenarios.</p>
<p>The same can be said for confidence intervals. There was one general framework that applies to <em>all</em> confidence intervals and the <code>infer</code> package was designed around this framework. While the specifics may change slightly for different types of confidence intervals, the general framework stays the same.</p>
<p>We believe that this approach is much better for long-term learning than focusing on specific details for specific confidence intervals using theory-based approaches. As you’ll now see, we prefer this general framework for hypothesis tests as well.</p>
<p>If you’d like more practice or you’re curious to see how this framework applies to different scenarios, you can find fully-worked out examples for many common hypothesis tests and their corresponding confidence intervals in Appendix B. We recommend that you carefully review these examples as they also cover how the general frameworks apply to traditional theory-based methods like the <span class="math inline">\(t\)</span>-test and normal-theory confidence intervals. You’ll see there that these traditional methods are just approximations for the computer-based methods we’ve been focusing on. However, they also require conditions to be met for their results to be valid. Computer-based methods using randomization, simulation, and bootstrapping have much fewer restrictions. Furthermore, they help develop your computational thinking, which is one big reason they are emphasized throughout this book.</p>
<div class="review">
<p>
<strong><em>Chapter Learning Objectives</em></strong>
</p>
<p>
<em>At the end of this chapter, you should be able to…</em><br />
• State useful null and alternative statistical hypotheses.<br />
• Perform hypothesis testing in R using computer-based and theory-based
methods.<br />
• Properly interpret p-values to reach statistical conclusions.<br />
</p>
</div>
<div id="nhst-packages" class="section level3 unnumbered hasAnchor">
<h3>Needed packages<a href="7-hypothesis-testing.html#nhst-packages" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s load all the packages needed for this chapter (this assumes you’ve already installed them). Recall from our discussion in Section <a href="4-tidy.html#tidyverse-package">4.3</a> that loading the <code>tidyverse</code> package by running <code>library(tidyverse)</code> loads the following commonly used data science packages all at once:</p>
<ul>
<li><code>ggplot2</code> for data visualization</li>
<li><code>dplyr</code> for data wrangling</li>
<li><code>tidyr</code> for converting data to “tidy” format</li>
<li><code>readr</code> for importing spreadsheet data into R</li>
<li>As well as the more advanced <code>purrr</code>, <code>tibble</code>, <code>stringr</code>, and <code>forcats</code> packages</li>
</ul>
<p>Before you load the following packages, first check that they are installed by looking in RStudio’s Packages tab. The <code>abd</code> package also requires the <code>lattice</code>, <code>grid</code>, <code>mosaic</code>, and <code>nlme</code> packages, so look for these too. If any of the needed packages are missing, read Section <a href="1-getting-started.html#packages">1.3</a> for information on how to install R packages.</p>
<div class="sourceCode" id="cb286"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb286-1"><a href="7-hypothesis-testing.html#cb286-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb286-2"><a href="7-hypothesis-testing.html#cb286-2" tabindex="-1"></a><span class="fu">library</span>(infer)</span>
<span id="cb286-3"><a href="7-hypothesis-testing.html#cb286-3" tabindex="-1"></a><span class="fu">library</span>(moderndive)</span>
<span id="cb286-4"><a href="7-hypothesis-testing.html#cb286-4" tabindex="-1"></a><span class="fu">library</span>(abd)</span>
<span id="cb286-5"><a href="7-hypothesis-testing.html#cb286-5" tabindex="-1"></a><span class="fu">library</span>(ggmosaic)</span></code></pre></div>
</div>
<div id="ht-activity" class="section level2 hasAnchor" number="7.1">
<h2><span class="header-section-number">7.1</span> Clutch size and malaria resistance<a href="7-hypothesis-testing.html#ht-activity" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Let’s begin with a study investigating if there is an association between susceptibility of birds to parasites following increased egg production.</p>
<div id="is-there-a-tradeoff-between-reproduction-and-immune-defense" class="section level3 hasAnchor" number="7.1.1">
<h3><span class="header-section-number">7.1.1</span> Is there a tradeoff between reproduction and immune defense?<a href="7-hypothesis-testing.html#is-there-a-tradeoff-between-reproduction-and-immune-defense" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>What limits the number of offspring that an individual can produce? One idea is that there is a trade-off between devoting resources to reproduction versus devoting resources to systems for self-preservation, including defenses against parasites and other pathogens. To test this idea, Oppliger et al. (1996) removed the first two eggs laid in half the nests of a breeding population of the bird species <em>Paus major</em>. To compensate, the females in these nests produced one more egg, on average, than females in the control group, whose nests were left intact. Two weeks after egg hatching, the presence of malaria in each female parent was assessed. A summary of the results can be found in the <code>GreatTitMalaria</code> dataset of the <code>abd</code> package. Let’s have a look.</p>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb287-1"><a href="7-hypothesis-testing.html#cb287-1" tabindex="-1"></a>GreatTitMalaria</span></code></pre></div>
<pre><code>     treatment   response
1      Control    Malaria
2      Control    Malaria
3      Control    Malaria
4      Control    Malaria
5      Control    Malaria
6      Control    Malaria
7      Control    Malaria
8      Control No Malaria
9      Control No Malaria
10     Control No Malaria
11     Control No Malaria
12     Control No Malaria
13     Control No Malaria
14     Control No Malaria
15     Control No Malaria
16     Control No Malaria
17     Control No Malaria
18     Control No Malaria
19     Control No Malaria
20     Control No Malaria
21     Control No Malaria
22     Control No Malaria
23     Control No Malaria
24     Control No Malaria
25     Control No Malaria
26     Control No Malaria
27     Control No Malaria
28     Control No Malaria
29     Control No Malaria
30     Control No Malaria
31     Control No Malaria
32     Control No Malaria
33     Control No Malaria
34     Control No Malaria
35     Control No Malaria
36 Egg removal    Malaria
37 Egg removal    Malaria
38 Egg removal    Malaria
39 Egg removal    Malaria
40 Egg removal    Malaria
41 Egg removal    Malaria
42 Egg removal    Malaria
43 Egg removal    Malaria
44 Egg removal    Malaria
45 Egg removal    Malaria
46 Egg removal    Malaria
47 Egg removal    Malaria
48 Egg removal    Malaria
49 Egg removal    Malaria
50 Egg removal    Malaria
51 Egg removal No Malaria
52 Egg removal No Malaria
53 Egg removal No Malaria
54 Egg removal No Malaria
55 Egg removal No Malaria
56 Egg removal No Malaria
57 Egg removal No Malaria
58 Egg removal No Malaria
59 Egg removal No Malaria
60 Egg removal No Malaria
61 Egg removal No Malaria
62 Egg removal No Malaria
63 Egg removal No Malaria
64 Egg removal No Malaria
65 Egg removal No Malaria</code></pre>
<p>Let’s perform an exploratory data analysis of the relationship between the two categorical variables malaria and <code>treatment</code>. Recall that we saw in Subsection <a href="2-viz.html#two-categ-barplot">2.8.2</a> that one way we can visualize such a relationship is by using a stacked barplot.</p>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb289-1"><a href="7-hypothesis-testing.html#cb289-1" tabindex="-1"></a><span class="fu">ggplot</span>(GreatTitMalaria, <span class="fu">aes</span>(<span class="at">x =</span> treatment, <span class="at">fill =</span> response)) <span class="sc">+</span></span>
<span id="cb289-2"><a href="7-hypothesis-testing.html#cb289-2" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb289-3"><a href="7-hypothesis-testing.html#cb289-3" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Treatment&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:BirdMalaria-barplot"></span>
<img src="ModernDive_files/figure-html/BirdMalaria-barplot-1.png" alt="Barplot relating bird treatment to malaria infection." width="\textwidth" />
<p class="caption">
FIGURE 7.1: Barplot relating bird treatment to malaria infection.
</p>
</div>
<p>Observe in Figure <a href="7-hypothesis-testing.html#fig:BirdMalaria-barplot">7.1</a> that while some of the females on the control nests were infected with the malaria parasite, a greater fraction of females on the experimentally-manipulated nests were infected.</p>
<p>Because of the difference in the number of females in the two treatment groups, it’s a little difficult to compare the rates of infection. To see this better, let’s introduce another type of plot called a mosaic plot, which uses <code>geom_mosaic()</code> from the <code>ggmosaic</code> package.</p>
<div class="sourceCode" id="cb290"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb290-1"><a href="7-hypothesis-testing.html#cb290-1" tabindex="-1"></a><span class="fu">ggplot</span>(GreatTitMalaria) <span class="sc">+</span></span>
<span id="cb290-2"><a href="7-hypothesis-testing.html#cb290-2" tabindex="-1"></a>  <span class="fu">geom_mosaic</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">product</span>(treatment), </span>
<span id="cb290-3"><a href="7-hypothesis-testing.html#cb290-3" tabindex="-1"></a>                  <span class="at">fill =</span> response)) <span class="sc">+</span></span>
<span id="cb290-4"><a href="7-hypothesis-testing.html#cb290-4" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Treatment&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Relative frequency&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:BirdMalaria-mosaicplot"></span>
<img src="ModernDive_files/figure-html/BirdMalaria-mosaicplot-1.png" alt="Mosaic plot relating bird treatment to frequency of malaria infection." width="\textwidth" />
<p class="caption">
FIGURE 7.2: Mosaic plot relating bird treatment to frequency of malaria infection.
</p>
</div>
<p>While the bars are also stacked in a mosaic plot, the width of each bar on the x-axis indicates the size of each group. Furthermore, proportions are displayed on the y-axis, rather than counts. In this mosaic plot, it’s easier to see that a larger proportion of the experimentally treated females were infected with malaria compared to the control females.</p>
<p>To summarize, of the 35 control females, 7 became infected with the malaria parasite, for a proportion of 7/35 = 0.2 = 20%. On the other hand, of the 30 females in the experimental group, 15 became infected with the malaria parasite, for a proportion of 15/30 = 0.5 = 50%. Comparing these two rates of malaria parasite infection, it appears that experimentally-manipulated females were infected at a rate 0.5 - 0.2 = 0.3 = 30% higher than control females. This is highly suggestive of an increased sensitivity of treated females to malaria infection.</p>
<p>The question is, however, does this provide <em>conclusive</em> evidence that there is difference in susceptibility to parasite infection as a result of this experimental manipulation? Could a difference in infection rates of 30% still occur by chance, even in a hypothetical world where egg removal didn’t increase the risk of malaria infection? In other words, what is the role of <em>sampling variation</em> in this hypothesized world? To answer this question, we’ll again rely on a computer to run <em>simulations</em>.</p>
</div>
<div id="shuffling-once" class="section level3 hasAnchor" number="7.1.2">
<h3><span class="header-section-number">7.1.2</span> Shuffling once<a href="7-hypothesis-testing.html#shuffling-once" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To run the simulations, we will work with the original <code>GreatTitMalaria</code> dataset. To understand the probability of the observed results, first try to imagine a hypothetical universe where egg removal didn’t affect the likelihood of a malaria infection. In such a hypothetical universe, the nest status of a female bird would have no bearing on their chances of becoming infected by a parasite. Bringing things back to our <code>GreatTitMalaria</code> data frame, the <code>treatment</code> variable would thus be an irrelevant label for predicting malaria infection. If these <code>treatment</code> labels were irrelevant, then we could randomly reassign them by “shuffling” them to no consequence!</p>
<p>To illustrate this idea, in Table <a href="7-hypothesis-testing.html#tab:compare-six">7.1</a> we narrow our focus to 6 arbitrarily chosen females of the 65 . The malaria column shows that 3 females were infected while 3 weren’t. The <code>treatment</code> column shows the nest treatment, control or egg removal.</p>
<p>However, in our hypothesized universe of no effect of egg removal, treatment is irrelevant and thus it is of no consequence to randomly “shuffle” the values of <code>treatment</code>. The <code>shuffled_treatment</code> column shows one such possible random shuffling. Observe in the last column how the number of females in the <code>Egg removal</code> group and the <code>Control</code> group remains the same at 3 each, but they are now listed in a different order.</p>
<table class="table" style="font-size: 16px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:compare-six">TABLE 7.1: </span>One example of shuffling treatment variable
</caption>
<thead>
<tr>
<th style="text-align:left;">
treatment
</th>
<th style="text-align:left;">
response
</th>
<th style="text-align:left;">
shuffled_treatment
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Egg removal
</td>
<td style="text-align:left;">
Malaria
</td>
<td style="text-align:left;">
Egg removal
</td>
</tr>
<tr>
<td style="text-align:left;">
Egg removal
</td>
<td style="text-align:left;">
Malaria
</td>
<td style="text-align:left;">
Control
</td>
</tr>
<tr>
<td style="text-align:left;">
Control
</td>
<td style="text-align:left;">
Malaria
</td>
<td style="text-align:left;">
Egg removal
</td>
</tr>
<tr>
<td style="text-align:left;">
Control
</td>
<td style="text-align:left;">
No Malaria
</td>
<td style="text-align:left;">
Control
</td>
</tr>
<tr>
<td style="text-align:left;">
Control
</td>
<td style="text-align:left;">
No Malaria
</td>
<td style="text-align:left;">
Control
</td>
</tr>
<tr>
<td style="text-align:left;">
Egg removal
</td>
<td style="text-align:left;">
No Malaria
</td>
<td style="text-align:left;">
Egg removal
</td>
</tr>
</tbody>
</table>
<p>Again, such random shuffling of the treatment label only makes sense in our hypothesized universe of no treatment effect. How could we extend this shuffling of the treatment variable to all 65 birds by hand? One way would be by using standard decks of playing cards, like the one displayed in Figure <a href="7-hypothesis-testing.html#fig:deck-of-cards">7.3</a>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:deck-of-cards"></span>
<img src="images/shutterstock/shutterstock_670789453.jpg" alt="Standard deck of 52 playing cards." width="100%" />
<p class="caption">
FIGURE 7.3: Standard deck of 52 playing cards.
</p>
</div>
<p>In our shuffling simulation, we will start with 35 red cards, the number of birds in the control group, and 30 black cards, the number of birds in the egg removal group. After shuffling these 65 cards as seen in Figure <a href="7-hypothesis-testing.html#fig:shuffling">7.4</a>, we can flip the cards over one-by-one, assigning <code>Control</code> to the <code>shuffled treatment</code> variable for each red card and <code>Egg removal</code> to the <code>shuffled treatment</code> variable for each black card.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:shuffling"></span>
<img src="images/shutterstock/shutterstock_128283971.jpg" alt="Shuffling a deck of cards." width="100%" height="100%" />
<p class="caption">
FIGURE 7.4: Shuffling a deck of cards.
</p>
</div>
<p>We’ve saved one such shuffling in the <code>GreatTitMalaria_shuffled</code> data frame. If you compare the original <code>GreatTitMalaria</code> and the shuffled <code>GreatTitMalaria_shuffled</code> data frames, you’ll see that while the malaria variable is identical, the <code>shuffled_treatment</code> variable differs from <code>treatment</code>.</p>
<p>Let’s repeat the same exploratory data analysis we did for the original <code>GreatTitMalaria</code> data on our <code>GreatTitMalaria_shuffled</code> data frame. Let’s create a bar plot visualizing the relationship between malaria and the new shuffled <code>treatment</code> variable and compare this to the original unshuffled version in Figure <a href="7-hypothesis-testing.html#fig:BirdMalaria-barplot-permuted">7.5</a>.</p>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb291-1"><a href="7-hypothesis-testing.html#cb291-1" tabindex="-1"></a><span class="fu">ggplot</span>(GreatTitMalaria_shuffled, </span>
<span id="cb291-2"><a href="7-hypothesis-testing.html#cb291-2" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> shuffled_treatment, <span class="at">fill =</span> response)) <span class="sc">+</span></span>
<span id="cb291-3"><a href="7-hypothesis-testing.html#cb291-3" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span> </span>
<span id="cb291-4"><a href="7-hypothesis-testing.html#cb291-4" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Shuffled treatment&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:BirdMalaria-barplot-permuted"></span>
<img src="ModernDive_files/figure-html/BirdMalaria-barplot-permuted-1.png" alt="Barplots of relationship of response with treatment (left) and shuffled treatment (right)." width="\textwidth" />
<p class="caption">
FIGURE 7.5: Barplots of relationship of response with treatment (left) and shuffled treatment (right).
</p>
</div>
<p>In the original data, in the left barplot, the rate of malaria (red) in females following egg removal is clearly much greater than the rate in control females. In comparison, with the new “shuffled” data visualized in the right barplot, the rates of malaria appear pretty similar between the females in the two groups.</p>
<p>Let’s also compute the proportion of female birds with malaria for each <code>shuffled_treatment</code> group:</p>
<div class="sourceCode" id="cb292"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb292-1"><a href="7-hypothesis-testing.html#cb292-1" tabindex="-1"></a>GreatTitMalaria_shuffled <span class="sc">%&gt;%</span> </span>
<span id="cb292-2"><a href="7-hypothesis-testing.html#cb292-2" tabindex="-1"></a>  <span class="fu">group_by</span>(shuffled_treatment, response) <span class="sc">%&gt;%</span> </span>
<span id="cb292-3"><a href="7-hypothesis-testing.html#cb292-3" tabindex="-1"></a>  <span class="fu">tally</span>() <span class="co"># Same as summarize(n = n())</span></span></code></pre></div>
<pre><code># A tibble: 4 × 3
# Groups:   shuffled_treatment [2]
  shuffled_treatment response       n
  &lt;fct&gt;              &lt;fct&gt;      &lt;int&gt;
1 Control            Malaria       13
2 Control            No Malaria    22
3 Egg removal        Malaria        9
4 Egg removal        No Malaria    21</code></pre>
<p>So in this hypothetical universe of no effect of egg removal, 9/30 = 0.3 = 30% of females following egg removal became infected with malaria. On the other hand, 13/35 = 0.371 = 37.1% of control females became infected with malaria.</p>
<p>Let’s next compare these two values. In this hypothetical universe of no effect of egg removal, it appears that females following egg removal were infected with malaria at a rate that was 0.3 - 0.371 = 0.071 = 7.1% different than control females.</p>
<p>Confirming what we visualized in the stacked barplot above, the malaria rate of female birds in the two groups is very similar. But why didn’t we see exactly the same malaria rates between the two groups. This is due to <em>sampling variation</em>. How can we better understand the effect of this sampling variation? By repeating this shuffling many more times!</p>
</div>
<div id="shuffling-99-more-times" class="section level3 hasAnchor" number="7.1.3">
<h3><span class="header-section-number">7.1.3</span> Shuffling 99 more times<a href="7-hypothesis-testing.html#shuffling-99-more-times" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Imagine that we repeated the shuffling process above 99 more times and recorded the values in 99 more <code>shuffled__treatment</code> columns. The <code>shuffled_results</code> dataset includes the results of one such scenario</p>
<p>For each of these 100 columns of <em>shuffles</em>, we computed the difference in malaria rates between control and experimentally treated birds, and in Figure <a href="7-hypothesis-testing.html#fig:null-distribution-1">7.6</a> we display their distribution in a histogram. We also mark the observed difference in malaria rate that occurred in real life of 0.3 = 30% with a dark line.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:null-distribution-1"></span>
<img src="ModernDive_files/figure-html/null-distribution-1-1.png" alt="Distribution of shuffled differences in GreatTitMalaria." width="\textwidth" />
<p class="caption">
FIGURE 7.6: Distribution of shuffled differences in GreatTitMalaria.
</p>
</div>
<p>Before we discuss the distribution of the histogram, we emphasize the key thing to remember: this histogram represents differences in malaria rates that one would observe in our <em>hypothesized universe</em> where egg removal has no effect on susceptibility to the malaria parasite.</p>
<p>Observe first that the histogram is roughly centered at 0. Saying that the difference in malaria rates is 0 is equivalent to saying that female birds in both groups had the same malaria rate. In other words, the center of these 100 values is consistent with what we would expect in our hypothesized universe of no effect of treatment on immune response.</p>
<p>However, while the values are centered at 0, there is variation about 0. This is because even in a hypothesized universe of no treatment effect, you will still likely observe small differences in malaria rates because of chance <em>sampling variation</em>. Looking at the histogram in Figure <a href="7-hypothesis-testing.html#fig:null-distribution-1">7.6</a>, such differences could even be as extreme as -0.319 or 0.238.</p>
<p>Turning our attention to what we observed in real life: the difference of 0.3 = 30% is marked with a vertical dark line. Ask yourself: in a hypothesized world of no effect of the treatment, how likely would it be that we observe this difference? Clearly, not often! Now ask yourself: what do these results say about our hypothesized universe of no effect of egg removal on susceptibility to malaria?</p>
<!--
v2 TODO: Consider adding;

Now each of our 33 friends does the following:

1. Takes the two decks of cards.
2. Shuffles the cards corresponding to treatment.
3. Assigns the shuffled cards to the original deck of supervisors' decisions.
4. Count how many cards fall into each of the four categories:
  - infected males
  - Non-infected males
  - infected females
  - Non-infected females
5. Determines the proportion of infected males out of 30.
6. Determines the proportion of infected females out of 30.
7. Subtracts those two differences to get a new value of the test statistic, assuming the null hypothesis is true.

Let's see what this leads to for our friends in terms of results and label where the observed test statistic falls in relation to our friends' statistics:


```r
obs_diff_prop <- BirdMalaria %>% 
  specify(response ~ treatment, success = "infected") %>% 
  calculate(stat = "diff in props", order = c("male", "female"))
obs_diff_prop
```



We see that of the 33 samples we selected only one is close to as extreme as what we observed. Thus, we might guess that we are starting to see some data suggesting that estrus discrimination might be at play. Many of the statistics calculated appear close to 0 with the vast remainder appearing around values of a difference of -0.1 and 0.1. So what further evidence would we need to make this suggestion a little clearer? More simulations! As we've done before in Chapters \@ref(sampling) and \@ref(confidence-intervals), we'll use the computer to simulate these permutations and calculations many times. Let's do just that with the `infer` package in the next section.
-->
</div>
<div id="ht-what-did-we-just-do" class="section level3 hasAnchor" number="7.1.4">
<h3><span class="header-section-number">7.1.4</span> What did we just do?<a href="7-hypothesis-testing.html#ht-what-did-we-just-do" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>What we just demonstrated in this activity is the statistical procedure known as <em>hypothesis testing</em> using a <em>permutation test</em>. The term “permutation” is the mathematical term for “shuffling”: taking a series of values and reordering them randomly, as you did with the playing cards.</p>
<p>In fact, permutations are another form of <em>resampling</em>, like the bootstrap method you performed in Chapter <a href="6-confidence-intervals.html#confidence-intervals">6</a>. While the bootstrap method involves resampling <em>with</em> replacement, permutation methods involve resampling <em>without</em> replacement.</p>
<p>Think of our exercise involving the slips of paper representing pennies and the hat in Section <a href="6-confidence-intervals.html#resampling-tactile">6.1</a>: after sampling a penny, you put it back in the hat. Now think of our deck of cards. After drawing a card, you laid it out in front of you, recorded the color, and then you <em>did not</em> put it back in the deck.</p>
<p>In our previous example, we tested the validity of the hypothesized universe of no effect of egg removal on malaria susceptibility. The evidence contained in our observed sample of 65 female birds was somewhat inconsistent with our hypothesized universe. Thus, we would be inclined to <em>reject</em> this hypothesized universe and declare that the evidence suggests there is an effect of egg removal on malaria susceptibility.</p>
<p>Recall our case study on whether yawning is contagious from Section <a href="6-confidence-intervals.html#case-study-two-prop-ci">6.6</a>. The previous example involves inference about an unknown difference of population proportions as well. This time, it will be <span class="math inline">\(p_{e} - p_{c}\)</span>, where <span class="math inline">\(p_{e}\)</span> is the population proportion of birds after egg removal becoming infected with malaria and <span class="math inline">\(p_{c}\)</span> is the equivalent for birds on control nests. Recall that this is one of the scenarios for inference we’ve seen so far in Table <a href="7-hypothesis-testing.html#tab:table-diff-prop">7.2</a>.</p>
<table class="table" style="font-size: 16px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:table-diff-prop">TABLE 7.2: </span>Scenarios of sampling for inference
</caption>
<thead>
<tr>
<th style="text-align:right;">
Scenario
</th>
<th style="text-align:left;">
Population parameter
</th>
<th style="text-align:left;">
Notation
</th>
<th style="text-align:left;">
Point estimate
</th>
<th style="text-align:left;">
Symbol(s)
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;width: 0.5in; ">
1
</td>
<td style="text-align:left;width: 0.7in; ">
Population proportion
</td>
<td style="text-align:left;width: 1in; ">
<span class="math inline">\(p\)</span>
</td>
<td style="text-align:left;width: 1.1in; ">
Sample proportion
</td>
<td style="text-align:left;width: 1in; ">
<span class="math inline">\(\widehat{p}\)</span>
</td>
</tr>
<tr>
<td style="text-align:right;width: 0.5in; ">
2
</td>
<td style="text-align:left;width: 0.7in; ">
Population mean
</td>
<td style="text-align:left;width: 1in; ">
<span class="math inline">\(\mu\)</span>
</td>
<td style="text-align:left;width: 1.1in; ">
Sample mean
</td>
<td style="text-align:left;width: 1in; ">
<span class="math inline">\(\overline{x}\)</span> or <span class="math inline">\(\widehat{\mu}\)</span>
</td>
</tr>
<tr>
<td style="text-align:right;width: 0.5in; ">
3
</td>
<td style="text-align:left;width: 0.7in; ">
Difference in population proportions
</td>
<td style="text-align:left;width: 1in; ">
<span class="math inline">\(p_1 - p_2\)</span>
</td>
<td style="text-align:left;width: 1.1in; ">
Difference in sample proportions
</td>
<td style="text-align:left;width: 1in; ">
<span class="math inline">\(\widehat{p}_1 - \widehat{p}_2\)</span>
</td>
</tr>
</tbody>
</table>
<p>So, based on our sample of <span class="math inline">\(n_w\)</span> = 30 experimental females and <span class="math inline">\(n_c\)</span> = 35 control females, the <em>point estimate</em> for <span class="math inline">\(p_{e} - p_{c}\)</span> is the <em>difference in sample proportions</em> <span class="math inline">\(\widehat{p}_{e} -\widehat{p}_{c}\)</span> = 0.5 - 0.2 = 0.3 = 30%. This difference in susceptibility of experimentally-treated females of 0.3 is greater than 0, suggesting that increased reproductive effort due to egg removal has an effect on malaria susceptibility.</p>
<p>However, the question we asked ourselves was “is this difference meaningfully greater than 0?”. In other words, is that difference indicative of a true effect, or can we just attribute it to <em>sampling variation</em>? Hypothesis testing allows us to make such distinctions.</p>
</div>
</div>
<div id="understanding-ht" class="section level2 hasAnchor" number="7.2">
<h2><span class="header-section-number">7.2</span> Understanding hypothesis tests<a href="7-hypothesis-testing.html#understanding-ht" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Much like the terminology, notation, and definitions relating to sampling you saw in Section <a href="5-sampling.html#sampling-framework">5.3</a>, there are a lot of terminology, notation, and definitions related to hypothesis testing as well. Learning these may seem like a very daunting task at first. However, with practice, practice, and more practice, anyone can master them.</p>
<p>First, a <strong>hypothesis</strong> is a statement about the value of an unknown population parameter. In the bird study, the population parameter of interest is the difference in population proportions <span class="math inline">\(p_{e} - p_{c}\)</span>. Hypothesis tests can involve any of the population parameters in Table <a href="5-sampling.html#tab:table-ch8">5.5</a> of the five inference scenarios we’ll cover in this book and also more advanced types we won’t cover here.</p>
<p>Second, a <strong>hypothesis test</strong> consists of a test between two competing hypotheses: (1) a <strong>null hypothesis</strong> <span class="math inline">\(H_0\)</span> (pronounced “H-naught”) versus (2) an <strong>alternative hypothesis</strong> <span class="math inline">\(H_A\)</span> (also denoted <span class="math inline">\(H_1\)</span>).</p>
<p>Generally, the null hypothesis is a claim that there is “no effect” or “no difference of interest.” In many cases, the null hypothesis represents the status quo or a situation that nothing interesting is happening. Furthermore, generally the alternative hypothesis is the claim that the experimenter or researcher wants to establish or find evidence to support. It is viewed as a “challenger” hypothesis to the null hypothesis <span class="math inline">\(H_0\)</span>. In the bird study, an appropriate hypothesis test would be:</p>
<p><span class="math display">\[
\begin{aligned}
H_0 &amp;: \text{control and experimental birds are infected at the same rate}\\
\text{vs } H_A &amp;: \text{experimental birds are infected at a higher rate than control birds}
\end{aligned}
\]</span></p>
<p>Note some of the choices we have made. First, we set the null hypothesis <span class="math inline">\(H_0\)</span> to be that there is no difference in infection rate and the “challenger” alternative hypothesis <span class="math inline">\(H_A\)</span> to be that there is a difference. While it would not be wrong in principle to reverse the two, it is a convention in statistical inference that the null hypothesis is set to reflect a “null” situation where “nothing is going on.” As we discussed earlier, in this case, <span class="math inline">\(H_0\)</span> corresponds to there being no difference in infection rates. Furthermore, we set <span class="math inline">\(H_A\)</span> to be that experimental birds are infected at a <em>higher</em> rate, a subjective choice reflecting a prior suspicion we have that this is the case. We call such alternative hypotheses <em>one-sided alternatives</em>. If someone else, however, does not share such suspicions and only wants to investigate that there is a difference, whether higher or lower, they would set what is known as a <em>two-sided alternative</em>.</p>
<p>We can re-express the formulation of the alternative hypothesis test using the mathematical notation for our population parameter of interest, the difference in population proportions <span class="math inline">\(p_{e} - p_{c}\)</span>:</p>
<p><span class="math display">\[
\begin{aligned}
H_0 &amp;: p_{e} - p_{c} = 0\\
\text{vs } H_A&amp;: p_{e} - p_{c} &gt; 0
\end{aligned}
\]</span></p>
<p>Observe how the alternative hypothesis <span class="math inline">\(H_A\)</span> is one-sided with <span class="math inline">\(p_{e} - p_{c} &gt; 0\)</span>. Had we opted for a two-sided alternative, we would have set <span class="math inline">\(p_{e} - p_{c} \neq 0\)</span>. To keep things simple for now, we’ll stick with the simpler one-sided alternative. We’ll present an example of a two-sided alternative in Section <a href="7-hypothesis-testing.html#ht-case-study">7.5</a>.</p>
<p>Third, a <strong>test statistic</strong> is a <em>point estimate/sample statistic</em> formula used for hypothesis testing. Note that a sample statistic is merely a summary statistic based on a sample of observations. Recall from Section <a href="3-wrangling.html#summarize">3.5</a> that a summary statistic takes in many values and returns only one. Here, the samples would be the <span class="math inline">\(n_e\)</span> = 30 experimentally-treated females and the <span class="math inline">\(n_c\)</span> = 35 control females. Hence, the point estimate of interest is the difference in sample proportions <span class="math inline">\(\widehat{p}_{e} - \widehat{p}_{c}\)</span>.</p>
<p>Fourth, the <strong>observed test statistic</strong> is the value of the test statistic that we observed in real life. In our case, we computed this value using the data saved in the <code>GreatTitMalaria</code> data frame. It was the observed difference of <span class="math inline">\(\widehat{p}_{e} -\widehat{p}_{c} = 0.5 - 0.2 = 0.3 = 30\%\)</span> in favor of control birds.</p>
<p>Fifth, the <strong>null distribution</strong> is the sampling distribution of the test statistic <em>assuming the null hypothesis <span class="math inline">\(H_0\)</span> is true</em>. Ooof! That’s a long one! Let’s unpack it slowly. The key to understanding the null distribution is that the null hypothesis <span class="math inline">\(H_0\)</span> is <em>assumed</em> to be true. We’re not saying that <span class="math inline">\(H_0\)</span> is true at this point, we’re only assuming it to be true for hypothesis testing purposes. In our case, this corresponds to our hypothesized universe of no effect of egg removal on infection rates. Assuming the null hypothesis <span class="math inline">\(H_0\)</span>, also stated as “Under <span class="math inline">\(H_0\)</span>,” how does the test statistic vary due to sampling variation? In our case, how will the difference in sample proportions <span class="math inline">\(\widehat{p}_{c} - \widehat{p}_{e}\)</span> vary due to sampling under <span class="math inline">\(H_0\)</span>? Recall from Subsection <a href="5-sampling.html#sampling-definitions">5.3.2</a> that distributions displaying how point estimates vary due to sampling variation are called <em>sampling distributions</em>. The only additional thing to keep in mind about null distributions is that they are sampling distributions <em>assuming the null hypothesis <span class="math inline">\(H_0\)</span> is true</em>.</p>
<p>In our case, we previously visualized a null distribution in Figure <a href="7-hypothesis-testing.html#fig:null-distribution-1">7.6</a>, which we re-display in Figure <a href="7-hypothesis-testing.html#fig:null-distribution-2">7.7</a> using our new notation and terminology. It is the distribution of the 100 differences in sample proportions our friends computed <em>assuming</em> a hypothetical universe of no treatment effect. We also mark the value of the observed test statistic of 0.3 with a vertical line.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:null-distribution-2"></span>
<img src="ModernDive_files/figure-html/null-distribution-2-1.png" alt="Null distribution and observed test statistic." width="\textwidth" />
<p class="caption">
FIGURE 7.7: Null distribution and observed test statistic.
</p>
</div>
<p>Sixth, the <strong><span class="math inline">\(p\)</span>-value</strong> is the probability of obtaining a test statistic just as extreme or more extreme than the observed test statistic <em>assuming the null hypothesis <span class="math inline">\(H_0\)</span> is true</em>. Double ooof! Let’s unpack this slowly as well. You can think of the <span class="math inline">\(p\)</span>-value as a quantification of “surprise”: assuming <span class="math inline">\(H_0\)</span> is true, how surprised are we with what we observed? Or in our case, in our hypothesized universe of no effect of the egg removal treatment, how surprised are we that we observed a difference in infection rates of 0.3 from our collected samples assuming <span class="math inline">\(H_0\)</span> is true? Very surprised? Somewhat surprised?</p>
<p>The <span class="math inline">\(p\)</span>-value quantifies this probability, or in the case of our 100 differences in sample proportions in Figure <a href="7-hypothesis-testing.html#fig:null-distribution-2">7.7</a>, what proportion had a more “extreme” result? Here, extreme is defined in terms of the alternative hypothesis <span class="math inline">\(H_A\)</span> that control birds are infected at a lower rate than experimental birds. In other words, how often was the infection rate of experimental birds <em>even more</em> pronounced than <span class="math inline">\(0.5 - 0.2 = 0.3 = 30\%\)</span>?</p>
<p>In this case, 100 times out of 100, we obtained a difference in proportion greater than or equal to the observed difference of 0.3 = 30%. A very rare (in fact, not occurring) outcome! Given the rarity of such a pronounced difference in infection rates in our hypothesized universe of no treatment effect, we’re inclined to <em>reject</em> our hypothesized universe. Instead, we favor the hypothesis stating there is an effect of egg removal on susceptibility to malaria infection. In other words, we reject <span class="math inline">\(H_0\)</span> in favor of <span class="math inline">\(H_A\)</span>.</p>
<!--
v2 TODO: Including observed test stat in p-value computation

We'll see later on however, the $p$-value isn't quite 1/100, but
rather (100 + 1)/(100 + 1) = 101/101 = 1 as
we need to include the observed test statistic in our calculation.
-->
<p>Seventh and lastly, in many hypothesis testing procedures, it is commonly recommended to set the <strong>significance level</strong> of the test beforehand. It is denoted by the Greek letter <span class="math inline">\(\alpha\)</span> (pronounced “alpha”). This value acts as a cutoff on the <span class="math inline">\(p\)</span>-value, where if the <span class="math inline">\(p\)</span>-value falls below <span class="math inline">\(\alpha\)</span>, we would “reject the null hypothesis <span class="math inline">\(H_0\)</span>.”</p>
<p>Alternatively, if the <span class="math inline">\(p\)</span>-value does not fall below <span class="math inline">\(\alpha\)</span>, we would “fail to reject <span class="math inline">\(H_0\)</span>.” Note the latter statement is not quite the same as saying we “accept <span class="math inline">\(H_0\)</span>.” This distinction is rather subtle and not immediately obvious. So we’ll revisit it later in Section <a href="7-hypothesis-testing.html#ht-interpretation">7.4</a>.</p>
<p>While different fields tend to use different values of <span class="math inline">\(\alpha\)</span>, some commonly used values for <span class="math inline">\(\alpha\)</span> are 0.1, 0.01, and 0.05; with 0.05 being the choice people often make without putting much thought into it. We’ll talk more about <span class="math inline">\(\alpha\)</span> significance levels in Section <a href="7-hypothesis-testing.html#ht-interpretation">7.4</a>, but first let’s fully conduct the hypothesis test corresponding to our GreatTitMalaria activity using the <code>infer</code> package.</p>
</div>
<div id="ht-infer" class="section level2 hasAnchor" number="7.3">
<h2><span class="header-section-number">7.3</span> Conducting hypothesis tests<a href="7-hypothesis-testing.html#ht-infer" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In Section <a href="6-confidence-intervals.html#bootstrap-process">6.4</a>, we showed you how to construct confidence intervals. We first illustrated how to do this using <code>dplyr</code> data wrangling verbs and the <code>rep_sample_n()</code> function from Subsection <a href="5-sampling.html#shovel-1000-times">5.2.3</a> which we used as a virtual shovel. In particular, we constructed confidence intervals by resampling with replacement by setting the <code>replace = TRUE</code> argument to the <code>rep_sample_n()</code> function.</p>
<p>We then showed you how to perform the same task using the <code>infer</code> package workflow. While both workflows resulted in the same bootstrap distribution from which we can construct confidence intervals, the <code>infer</code> package workflow emphasizes each of the steps in the overall process in Figure <a href="7-hypothesis-testing.html#fig:infer-ci">7.8</a>. It does so using function names that are intuitively named with verbs:</p>
<ol style="list-style-type: decimal">
<li><code>specify()</code> the variables of interest in your data frame.</li>
<li><code>generate()</code> replicates of bootstrap resamples with replacement.</li>
<li><code>calculate()</code> the summary statistic of interest.</li>
<li><code>visualize()</code> the resulting bootstrap distribution and confidence interval.</li>
</ol>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:infer-ci"></span>
<img src="images/flowcharts/infer/visualize.png" alt="Confidence intervals with the infer package." width="90%" height="90%" />
<p class="caption">
FIGURE 7.8: Confidence intervals with the infer package.
</p>
</div>
<p>In this section, we’ll now show you how to seamlessly modify the previously seen <code>infer</code> code for constructing confidence intervals to conduct hypothesis tests. You’ll notice that the basic outline of the workflow is almost identical, except for an additional <code>hypothesize()</code> step between the <code>specify()</code> and <code>generate()</code> steps, as can be seen in Figure <a href="7-hypothesis-testing.html#fig:inferht">7.9</a>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:inferht"></span>
<img src="images/flowcharts/infer/ht.png" alt="Hypothesis testing with the infer package." width="90%" height="90%" />
<p class="caption">
FIGURE 7.9: Hypothesis testing with the infer package.
</p>
</div>
<p>Furthermore, we’ll use a pre-specified significance level <span class="math inline">\(\alpha\)</span> = 0.05 for this hypothesis test. Let’s leave discussion on the choice of this <span class="math inline">\(\alpha\)</span> value until later on in Section <a href="7-hypothesis-testing.html#ht-interpretation">7.4</a>.</p>
<div id="infer-workflow-ht" class="section level3 hasAnchor" number="7.3.1">
<h3><span class="header-section-number">7.3.1</span> <code>infer</code> package workflow<a href="7-hypothesis-testing.html#infer-workflow-ht" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="specify-variables-3" class="section level4 unnumbered hasAnchor">
<h4>1. <code>specify</code> variables<a href="7-hypothesis-testing.html#specify-variables-3" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Recall that we use the <code>specify()</code> verb to specify the response variable and, if needed, any explanatory variables for our study. In this case, since we are interested in any potential effects of treatment on infection rates, we set <code>response</code> as the response variable and <code>treatment</code> as the explanatory variable. We do so using <code>formula = response ~ explanatory</code> where <code>response</code> is the name of the response variable in the data frame and <code>treatment</code> is the name of the explanatory variable. So in our case it is <code>response ~ treatment</code>.</p>
<p>Furthermore, since we are interested in the proportion of female birds with <code>"Malaria"</code>, and not the proportion of birds with <code>"No Malaria"</code>, we set the argument <code>success</code> to <code>"Malaria"</code>.</p>
<div class="sourceCode" id="cb294"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb294-1"><a href="7-hypothesis-testing.html#cb294-1" tabindex="-1"></a>GreatTitMalaria <span class="sc">%&gt;%</span> </span>
<span id="cb294-2"><a href="7-hypothesis-testing.html#cb294-2" tabindex="-1"></a>  <span class="fu">specify</span>(<span class="at">formula =</span> response <span class="sc">~</span> treatment, <span class="at">success =</span> <span class="st">&quot;Malaria&quot;</span>) </span></code></pre></div>
<pre><code>Response: response (factor)
Explanatory: treatment (factor)
# A tibble: 65 × 2
   response   treatment
   &lt;fct&gt;      &lt;fct&gt;    
 1 Malaria    Control  
 2 Malaria    Control  
 3 Malaria    Control  
 4 Malaria    Control  
 5 Malaria    Control  
 6 Malaria    Control  
 7 Malaria    Control  
 8 No Malaria Control  
 9 No Malaria Control  
10 No Malaria Control  
# ℹ 55 more rows</code></pre>
<p>Again, notice how the <code>GreatTitMalaria</code> data itself doesn’t change, but the <code>Response: response (factor)</code> and <code>Explanatory: treatment (factor)</code> <em>meta-data</em> do. This is similar to how the <code>group_by()</code> verb from <code>dplyr</code> doesn’t change the data, but only adds “grouping” meta-data, as we saw in Section <a href="3-wrangling.html#groupby">3.6</a>.</p>
</div>
<div id="hypothesize-the-null" class="section level4 unnumbered hasAnchor">
<h4>2. <code>hypothesize</code> the null<a href="7-hypothesis-testing.html#hypothesize-the-null" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In order to conduct hypothesis tests using the <code>infer</code> workflow, we need a new step not present for confidence intervals: <code>hypothesize()</code>. Recall from Section <a href="7-hypothesis-testing.html#understanding-ht">7.2</a> that our hypothesis test was</p>
<p><span class="math display">\[
\begin{aligned}
H_0 &amp;: p_{e} - p_{c} = 0\\
\text{vs. } H_A&amp;: p_{e} - p_{c} &gt; 0
\end{aligned}
\]</span></p>
<p>In other words, the null hypothesis <span class="math inline">\(H_0\)</span> corresponding to our “hypothesized universe” stated that there was no difference in treatment-based infection rates. We set this null hypothesis <span class="math inline">\(H_0\)</span> in our <code>infer</code> workflow using the <code>null</code> argument of the <code>hypothesize()</code> function to either:</p>
<ul>
<li><code>"point"</code> for hypotheses involving a single sample or</li>
<li><code>"independence"</code> for hypotheses involving two samples.</li>
</ul>
<p>In our case, since we have two samples (the birds on control nests and those on nests with egg removal), we set <code>null = "independence"</code>.</p>
<div class="sourceCode" id="cb296"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb296-1"><a href="7-hypothesis-testing.html#cb296-1" tabindex="-1"></a>GreatTitMalaria <span class="sc">%&gt;%</span> </span>
<span id="cb296-2"><a href="7-hypothesis-testing.html#cb296-2" tabindex="-1"></a>  <span class="fu">specify</span>(<span class="at">formula =</span> response <span class="sc">~</span> treatment, <span class="at">success =</span> <span class="st">&quot;Malaria&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb296-3"><a href="7-hypothesis-testing.html#cb296-3" tabindex="-1"></a>  <span class="fu">hypothesize</span>(<span class="at">null =</span> <span class="st">&quot;independence&quot;</span>)</span></code></pre></div>
<pre><code>Response: response (factor)
Explanatory: treatment (factor)
Null Hypothesis: independence
# A tibble: 65 × 2
   response   treatment
   &lt;fct&gt;      &lt;fct&gt;    
 1 Malaria    Control  
 2 Malaria    Control  
 3 Malaria    Control  
 4 Malaria    Control  
 5 Malaria    Control  
 6 Malaria    Control  
 7 Malaria    Control  
 8 No Malaria Control  
 9 No Malaria Control  
10 No Malaria Control  
# ℹ 55 more rows</code></pre>
<p>Again, the data has not changed yet. This will occur at the upcoming <code>generate()</code> step; we’re merely setting meta-data for now.</p>
<p>Where do the terms <code>"point"</code> and <code>"independence"</code> come from? These are two technical statistical terms. The term “point” relates from the fact that for a single group of observations, you will test the value of a single point. Going back to the pennies example from Chapter <a href="6-confidence-intervals.html#confidence-intervals">6</a>, say we wanted to test if the mean year of all US pennies was equal to 1993 or not. We would be testing the value of a “point” <span class="math inline">\(\mu\)</span>, the mean year of <em>all</em> US pennies, as follows</p>
<p><span class="math display">\[
\begin{aligned}
H_0 &amp;: \mu = 1993\\
\text{vs } H_A&amp;: \mu \neq 1993
\end{aligned}
\]</span></p>
<p>The term “independence” relates to the fact that for two groups of observations, you are testing whether or not the response variable is <em>independent</em> of the explanatory variable that assigns the groups. In our case, we are testing whether the malaria <code>response</code> variable is “independent” of the explanatory variable <code>treatment</code> that assigns each female bird to either of the two groups.</p>
</div>
<div id="generate-replicates-3" class="section level4 unnumbered hasAnchor">
<h4>3. <code>generate</code> replicates<a href="7-hypothesis-testing.html#generate-replicates-3" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>After we <code>hypothesize()</code> the null hypothesis, we <code>generate()</code> replicates of “shuffled” datasets assuming the null hypothesis is true. We do this by repeating the shuffling exercise you performed in Section <a href="7-hypothesis-testing.html#ht-activity">7.1</a> several times. Instead of merely doing it 100 times as our groups of friends did, let’s use the computer to repeat this 1000 times by setting <code>reps = 1000</code> in the <code>generate()</code> function. However, unlike for confidence intervals where we generated replicates using <code>type = "bootstrap"</code> resampling with replacement, we’ll now perform shuffles/permutations by setting <code>type = "permute"</code>. Recall that shuffles/permutations are a kind of resampling, but unlike the bootstrap method, they involve resampling <em>without</em> replacement.</p>
<div class="sourceCode" id="cb298"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb298-1"><a href="7-hypothesis-testing.html#cb298-1" tabindex="-1"></a>GreatTitMalaria_generate <span class="ot">&lt;-</span> GreatTitMalaria <span class="sc">%&gt;%</span> </span>
<span id="cb298-2"><a href="7-hypothesis-testing.html#cb298-2" tabindex="-1"></a>  <span class="fu">specify</span>(<span class="at">formula =</span> response <span class="sc">~</span> treatment, <span class="at">success =</span> <span class="st">&quot;Malaria&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb298-3"><a href="7-hypothesis-testing.html#cb298-3" tabindex="-1"></a>  <span class="fu">hypothesize</span>(<span class="at">null =</span> <span class="st">&quot;independence&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb298-4"><a href="7-hypothesis-testing.html#cb298-4" tabindex="-1"></a>  <span class="fu">generate</span>(<span class="at">reps =</span> <span class="dv">1000</span>, <span class="at">type =</span> <span class="st">&quot;permute&quot;</span>)</span>
<span id="cb298-5"><a href="7-hypothesis-testing.html#cb298-5" tabindex="-1"></a><span class="fu">nrow</span>(GreatTitMalaria_generate)</span></code></pre></div>
<pre><code>[1] 65000</code></pre>
<!-- 
v2 TODO: Consider:

infer:::permute_once() shuffles the y variable instead of the x. This ends up being the same thing but isn't as intuitive
to explain given how we set up the cards tactile example before. I think it's best to avoid displaying `BirdMalaria_generate`
here since it has malaria shuffled. 
-->
<p>Observe that the resulting data frame has 65,000 rows. This is because we performed shuffles/permutations for each of the 65 rows 1000 times and <span class="math inline">\(65,000 = 1000 \cdot 65\)</span>. If you explore the <code>GreatTitMalaria_generate</code> data frame with <code>View()</code>, you’ll notice that the variable <code>replicate</code> indicates which resample each row belongs to. So it has the value <code>1</code> 65 times, the value <code>2</code> 65 times, all the way through to the value 1000, again 65 times.</p>
</div>
<div id="calculate-summary-statistics-3" class="section level4 unnumbered hasAnchor">
<h4>4. <code>calculate</code> summary statistics<a href="7-hypothesis-testing.html#calculate-summary-statistics-3" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Now that we have generated 1000 replicates of “shuffles” assuming the null hypothesis is true, let’s <code>calculate()</code> the appropriate summary statistic for each of our 1000 shuffles. From Section <a href="7-hypothesis-testing.html#understanding-ht">7.2</a>, point estimates related to hypothesis testing have a specific name: <em>test statistics</em>. Since the unknown population parameter of interest is the difference in population proportions <span class="math inline">\(p_{e} - p_{c}\)</span>, the test statistic here is the difference in sample proportions <span class="math inline">\(\widehat{p}_{e} - \widehat{p}_{c}\)</span>.</p>
<p>For each of our 1000 shuffles, we can calculate this test statistic by setting <code>stat = "diff in props"</code>. Furthermore, since we are interested in <span class="math inline">\(\widehat{p}_{e} - \widehat{p}_{c}\)</span> we set <code>order = c("Egg removal", "Control")</code>. As we stated earlier, the order of the subtraction does not matter, so long as you stay consistent throughout your analysis and tailor your interpretations accordingly.</p>
<p>Let’s save the result in a data frame called <code>null_distribution</code>:</p>
<div class="sourceCode" id="cb300"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb300-1"><a href="7-hypothesis-testing.html#cb300-1" tabindex="-1"></a>null_distribution <span class="ot">&lt;-</span> GreatTitMalaria <span class="sc">%&gt;%</span> </span>
<span id="cb300-2"><a href="7-hypothesis-testing.html#cb300-2" tabindex="-1"></a>  <span class="fu">specify</span>(<span class="at">formula =</span> response <span class="sc">~</span> treatment, <span class="at">success =</span> <span class="st">&quot;Malaria&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb300-3"><a href="7-hypothesis-testing.html#cb300-3" tabindex="-1"></a>  <span class="fu">hypothesize</span>(<span class="at">null =</span> <span class="st">&quot;independence&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb300-4"><a href="7-hypothesis-testing.html#cb300-4" tabindex="-1"></a>  <span class="fu">generate</span>(<span class="at">reps =</span> <span class="dv">1000</span>, <span class="at">type =</span> <span class="st">&quot;permute&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb300-5"><a href="7-hypothesis-testing.html#cb300-5" tabindex="-1"></a>  <span class="fu">calculate</span>(<span class="at">stat =</span> <span class="st">&quot;diff in props&quot;</span>, <span class="at">order =</span> <span class="fu">c</span>(<span class="st">&quot;Egg removal&quot;</span>, <span class="st">&quot;Control&quot;</span>))</span>
<span id="cb300-6"><a href="7-hypothesis-testing.html#cb300-6" tabindex="-1"></a>null_distribution</span></code></pre></div>
<pre><code>Response: response (factor)
Explanatory: treatment (factor)
Null Hypothesis: independence
# A tibble: 1,000 × 2
   replicate       stat
       &lt;int&gt;      &lt;dbl&gt;
 1         1  0.176190 
 2         2 -0.0714286
 3         3 -0.319048 
 4         4 -0.0714286
 5         5 -0.0714286
 6         6  0.0523810
 7         7 -0.195238 
 8         8  0.0523810
 9         9 -0.0714286
10        10  0.114286 
# ℹ 990 more rows</code></pre>
<p>Observe that we have 1000 values of <code>stat</code>, each representing one instance of <span class="math inline">\(\widehat{p}_{e} - \widehat{p}_{c}\)</span> in a hypothesized world of no treatment effect. Observe as well that we chose the name of this data frame carefully: <code>null_distribution</code>. Recall once again from Section <a href="7-hypothesis-testing.html#understanding-ht">7.2</a> that sampling distributions when the null hypothesis <span class="math inline">\(H_0\)</span> is assumed to be true have a special name: the <em>null distribution</em>.</p>
<p>What was the <em>observed</em> difference in infection rates? In other words, what was the <em>observed test statistic</em> <span class="math inline">\(\widehat{p}_{e} - \widehat{p}_{c}\)</span>? Recall from Section <a href="7-hypothesis-testing.html#ht-activity">7.1</a> that we computed this observed difference by hand to be 0.5 - 0.2 = 0.3 = 30%. We can also compute this value using the previous <code>infer</code> code but with the <code>hypothesize()</code> and <code>generate()</code> steps removed. Let’s save this in <code>obs_diff_prop</code>:</p>
<div class="sourceCode" id="cb302"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb302-1"><a href="7-hypothesis-testing.html#cb302-1" tabindex="-1"></a>obs_diff_prop <span class="ot">&lt;-</span> GreatTitMalaria <span class="sc">%&gt;%</span> </span>
<span id="cb302-2"><a href="7-hypothesis-testing.html#cb302-2" tabindex="-1"></a>  <span class="fu">specify</span>(response <span class="sc">~</span> treatment, <span class="at">success =</span> <span class="st">&quot;Malaria&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb302-3"><a href="7-hypothesis-testing.html#cb302-3" tabindex="-1"></a>  <span class="fu">calculate</span>(<span class="at">stat =</span> <span class="st">&quot;diff in props&quot;</span>, <span class="at">order =</span> <span class="fu">c</span>(<span class="st">&quot;Egg removal&quot;</span>, <span class="st">&quot;Control&quot;</span>))</span>
<span id="cb302-4"><a href="7-hypothesis-testing.html#cb302-4" tabindex="-1"></a>obs_diff_prop</span></code></pre></div>
<pre><code>Response: response (factor)
Explanatory: treatment (factor)
# A tibble: 1 × 1
   stat
  &lt;dbl&gt;
1   0.3</code></pre>
</div>
<div id="visualize-the-p-value" class="section level4 unnumbered hasAnchor">
<h4>5. <code>visualize</code> the p-value<a href="7-hypothesis-testing.html#visualize-the-p-value" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The final step is to measure how surprised we are by a malaria infection difference of 30% in a hypothesized universe of no treatment effect. If the observed difference of 0.3 is highly unlikely, then we would be inclined to reject the validity of our hypothesized universe.</p>
<p>We start by visualizing the <em>null distribution</em> of our 1000 values of <span class="math inline">\(\widehat{p}_{c} - \widehat{p}_{e}\)</span> using <code>visualize()</code> in Figure <a href="7-hypothesis-testing.html#fig:null-distribution-infer">7.10</a>. Recall that these are values of the difference in infection rates assuming <span class="math inline">\(H_0\)</span> is true. This corresponds to being in our hypothesized universe of no treatment effect.</p>
<div class="sourceCode" id="cb304"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb304-1"><a href="7-hypothesis-testing.html#cb304-1" tabindex="-1"></a><span class="fu">visualize</span>(null_distribution, <span class="at">bins =</span> <span class="dv">10</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:null-distribution-infer"></span>
<img src="ModernDive_files/figure-html/null-distribution-infer-1.png" alt="Null distribution." width="\textwidth" />
<p class="caption">
FIGURE 7.10: Null distribution.
</p>
</div>
<p>Let’s now add what happened in real life to Figure <a href="7-hypothesis-testing.html#fig:null-distribution-infer">7.10</a>, the observed difference in infection rates of 0.5 - 0.2 = 0.3 = 30%. However, instead of merely adding a vertical line using <code>geom_vline()</code>, let’s use the <code>shade_p_value()</code> function with <code>obs_stat</code> set to the observed test statistic value we saved in <code>obs_diff_prop</code>.</p>
<p>Furthermore, we’ll set the <code>direction = "right"</code> reflecting our alternative hypothesis <span class="math inline">\(H_A: p_{e} - p_{c} &gt; 0\)</span>. Recall our alternative hypothesis <span class="math inline">\(H_A\)</span> is that <span class="math inline">\(p_{e} - p_{c} &gt; 0\)</span>, stating that there is a higher infection rate in experimental females compared to control females. “More extreme” here corresponds to differences that are “greater” or “more positive” or “more to the right” Hence we set the <code>direction</code> argument of <code>shade_p_value()</code> to be <code>"right"</code>.</p>
<p>On the other hand, had our alternative hypothesis <span class="math inline">\(H_A\)</span> been the other possible one-sided alternative <span class="math inline">\(p_{e} - p_{c} &lt; 0\)</span>, suggesting that the experimental treatment decreases susceptibility to infection, we would’ve set <code>direction = "left"</code>. Had our alternative hypothesis <span class="math inline">\(H_A\)</span> been two-sided <span class="math inline">\(p_{e} - p_{c} \neq 0\)</span>, suggesting an effect in either direction, we would’ve set <code>direction = "both"</code>.</p>
<div class="sourceCode" id="cb305"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb305-1"><a href="7-hypothesis-testing.html#cb305-1" tabindex="-1"></a><span class="fu">visualize</span>(null_distribution, <span class="at">bins =</span> <span class="dv">10</span>) <span class="sc">+</span> </span>
<span id="cb305-2"><a href="7-hypothesis-testing.html#cb305-2" tabindex="-1"></a>  <span class="fu">shade_p_value</span>(<span class="at">obs_stat =</span> obs_diff_prop, <span class="at">direction =</span> <span class="st">&quot;right&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:null-distribution-infer-2"></span>
<img src="ModernDive_files/figure-html/null-distribution-infer-2-1.png" alt="Shaded histogram to show $p$-value." width="\textwidth" />
<p class="caption">
FIGURE 7.11: Shaded histogram to show <span class="math inline">\(p\)</span>-value.
</p>
</div>
<p>In the resulting Figure <a href="7-hypothesis-testing.html#fig:null-distribution-infer-2">7.11</a>, the solid dark line marks 0.3 = 30%. However, what does the shaded-region correspond to? This is the <em><span class="math inline">\(p\)</span>-value</em>. Recall the definition of the <span class="math inline">\(p\)</span>-value from Section <a href="7-hypothesis-testing.html#understanding-ht">7.2</a>:</p>
<blockquote>
<p>A <span class="math inline">\(p\)</span>-value is the probability of obtaining a test statistic just as or more extreme than the observed test statistic <em>assuming the null hypothesis <span class="math inline">\(H_0\)</span> is true</em>.</p>
</blockquote>
<p>So judging by the shaded region in Figure <a href="7-hypothesis-testing.html#fig:null-distribution-infer-2">7.11</a>, it seems we would rarely observe differences in infection rates of 0.3 = 30% or more in a hypothesized universe of no treatment effect. In other words, the <span class="math inline">\(p\)</span>-value is very small. Hence, we would be inclined to reject this hypothesized universe, or using statistical language we would “reject <span class="math inline">\(H_0\)</span>.”</p>
<p>What fraction of the null distribution is shaded? In other words, what is the exact value of the <span class="math inline">\(p\)</span>-value? We can compute it using the <code>get_p_value()</code> function with the same arguments as the previous <code>shade_p_value()</code> code:</p>
<div class="sourceCode" id="cb306"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb306-1"><a href="7-hypothesis-testing.html#cb306-1" tabindex="-1"></a>null_distribution <span class="sc">%&gt;%</span> </span>
<span id="cb306-2"><a href="7-hypothesis-testing.html#cb306-2" tabindex="-1"></a>  <span class="fu">get_p_value</span>(<span class="at">obs_stat =</span> obs_diff_prop, <span class="at">direction =</span> <span class="st">&quot;right&quot;</span>)</span></code></pre></div>
<pre><code># A tibble: 1 × 1
  p_value
    &lt;dbl&gt;
1   0.007</code></pre>
<p>Keeping the definition of a <span class="math inline">\(p\)</span>-value in mind, the probability of observing a difference in infection rates as large as 0.3 = 30% due to sampling variation alone in the null distribution is 0.007 = 0.7%. Since this <span class="math inline">\(p\)</span>-value is smaller than our pre-specified significance level <span class="math inline">\(\alpha\)</span> = 0.05, we reject the null hypothesis <span class="math inline">\(H_0: p_{e} - p_{c} = 0\)</span>. In other words, this <span class="math inline">\(p\)</span>-value is sufficiently small to reject our hypothesized universe of no treatment effect. We instead have enough evidence to change our mind in favor of the egg removal treatment having an effect on susceptibility to malaria infection. Observe that whether we reject the null hypothesis <span class="math inline">\(H_0\)</span> or not depends in large part on our choice of significance level <span class="math inline">\(\alpha\)</span>. We’ll discuss this more in Subsection <a href="7-hypothesis-testing.html#choosing-alpha">7.4.3</a>.</p>
</div>
</div>
<div id="comparing-infer-workflows" class="section level3 hasAnchor" number="7.3.2">
<h3><span class="header-section-number">7.3.2</span> Comparison with confidence intervals<a href="7-hypothesis-testing.html#comparing-infer-workflows" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>One of the great things about the <code>infer</code> package is that we can jump seamlessly between conducting hypothesis tests and constructing confidence intervals with minimal changes! Recall the code from the previous section that creates the null distribution, which in turn is needed to compute the <span class="math inline">\(p\)</span>-value:</p>
<div class="sourceCode" id="cb308"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb308-1"><a href="7-hypothesis-testing.html#cb308-1" tabindex="-1"></a>null_distribution <span class="ot">&lt;-</span> GreatTitMalaria <span class="sc">%&gt;%</span> </span>
<span id="cb308-2"><a href="7-hypothesis-testing.html#cb308-2" tabindex="-1"></a>  <span class="fu">specify</span>(<span class="at">formula =</span> response <span class="sc">~</span> treatment, <span class="at">success =</span> <span class="st">&quot;Malaria&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb308-3"><a href="7-hypothesis-testing.html#cb308-3" tabindex="-1"></a>  <span class="fu">hypothesize</span>(<span class="at">null =</span> <span class="st">&quot;independence&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb308-4"><a href="7-hypothesis-testing.html#cb308-4" tabindex="-1"></a>  <span class="fu">generate</span>(<span class="at">reps =</span> <span class="dv">1000</span>, <span class="at">type =</span> <span class="st">&quot;permute&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb308-5"><a href="7-hypothesis-testing.html#cb308-5" tabindex="-1"></a>  <span class="fu">calculate</span>(<span class="at">stat =</span> <span class="st">&quot;diff in props&quot;</span>, <span class="at">order =</span> <span class="fu">c</span>(<span class="st">&quot;Egg removal&quot;</span>, <span class="st">&quot;Control&quot;</span>))</span></code></pre></div>
<p>To create the corresponding bootstrap distribution needed to construct a 95% confidence interval for <span class="math inline">\(p_{e} - p_{c}\)</span>, we only need to make two changes. First, we remove the <code>hypothesize()</code> step since we are no longer assuming a null hypothesis <span class="math inline">\(H_0\)</span> is true. We can do this by deleting or commenting out the <code>hypothesize()</code> line of code. Second, we switch the <code>type</code> of resampling in the <code>generate()</code> step to be <code>"bootstrap"</code> instead of <code>"permute"</code>.</p>
<div class="sourceCode" id="cb309"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb309-1"><a href="7-hypothesis-testing.html#cb309-1" tabindex="-1"></a>bootstrap_distribution <span class="ot">&lt;-</span> GreatTitMalaria <span class="sc">%&gt;%</span> </span>
<span id="cb309-2"><a href="7-hypothesis-testing.html#cb309-2" tabindex="-1"></a>  <span class="fu">specify</span>(<span class="at">formula =</span> response <span class="sc">~</span> treatment, <span class="at">success =</span> <span class="st">&quot;Malaria&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb309-3"><a href="7-hypothesis-testing.html#cb309-3" tabindex="-1"></a>  <span class="co"># Change 1 - Remove hypothesize():</span></span>
<span id="cb309-4"><a href="7-hypothesis-testing.html#cb309-4" tabindex="-1"></a>  <span class="co"># hypothesize(null = &quot;independence&quot;) %&gt;% </span></span>
<span id="cb309-5"><a href="7-hypothesis-testing.html#cb309-5" tabindex="-1"></a>  <span class="co"># Change 2 - Switch type from &quot;permute&quot; to &quot;bootstrap&quot;:</span></span>
<span id="cb309-6"><a href="7-hypothesis-testing.html#cb309-6" tabindex="-1"></a>  <span class="fu">generate</span>(<span class="at">reps =</span> <span class="dv">1000</span>, <span class="at">type =</span> <span class="st">&quot;bootstrap&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb309-7"><a href="7-hypothesis-testing.html#cb309-7" tabindex="-1"></a>  <span class="fu">calculate</span>(<span class="at">stat =</span> <span class="st">&quot;diff in props&quot;</span>, <span class="at">order =</span> <span class="fu">c</span>(<span class="st">&quot;Egg removal&quot;</span>, <span class="st">&quot;Control&quot;</span>))</span></code></pre></div>
<p>Using this <code>bootstrap_distribution</code>, let’s first compute the percentile-based confidence intervals, as we did in Section <a href="6-confidence-intervals.html#bootstrap-process">6.4</a>:</p>
<div class="sourceCode" id="cb310"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb310-1"><a href="7-hypothesis-testing.html#cb310-1" tabindex="-1"></a>percentile_ci <span class="ot">&lt;-</span> bootstrap_distribution <span class="sc">%&gt;%</span> </span>
<span id="cb310-2"><a href="7-hypothesis-testing.html#cb310-2" tabindex="-1"></a>  <span class="fu">get_confidence_interval</span>(<span class="at">level =</span> <span class="fl">0.95</span>, <span class="at">type =</span> <span class="st">&quot;percentile&quot;</span>)</span>
<span id="cb310-3"><a href="7-hypothesis-testing.html#cb310-3" tabindex="-1"></a>percentile_ci</span></code></pre></div>
<pre><code># A tibble: 1 × 2
   lower_ci upper_ci
      &lt;dbl&gt;    &lt;dbl&gt;
1 0.0700739 0.505840</code></pre>
<p>Using our shorthand interpretation for 95% confidence intervals from Subsection <a href="6-confidence-intervals.html#shorthand">6.5.2</a>, we are 95% “confident” that the true difference in population proportions <span class="math inline">\(p_{e} - p_{c}\)</span> is between (0.07, 0.506). Let’s visualize <code>bootstrap_distribution</code> and this percentile-based 95% confidence interval for <span class="math inline">\(p_{e} - p_{c}\)</span> in Figure <a href="7-hypothesis-testing.html#fig:bootstrap-distribution-two-prop-percentile">7.12</a>.</p>
<div class="sourceCode" id="cb312"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb312-1"><a href="7-hypothesis-testing.html#cb312-1" tabindex="-1"></a><span class="fu">visualize</span>(bootstrap_distribution) <span class="sc">+</span> </span>
<span id="cb312-2"><a href="7-hypothesis-testing.html#cb312-2" tabindex="-1"></a>  <span class="fu">shade_confidence_interval</span>(<span class="at">endpoints =</span> percentile_ci)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:bootstrap-distribution-two-prop-percentile"></span>
<img src="ModernDive_files/figure-html/bootstrap-distribution-two-prop-percentile-1.png" alt="Percentile-based 95\% confidence interval." width="\textwidth" />
<p class="caption">
FIGURE 7.12: Percentile-based 95% confidence interval.
</p>
</div>
<p>Notice a key value that is not included in the 95% confidence interval for <span class="math inline">\(p_{e} - p_{c}\)</span>: the value 0. In other words, a difference of 0 is not included in our net, suggesting that <span class="math inline">\(p_{e}\)</span> and <span class="math inline">\(p_{c}\)</span> are truly different! Furthermore, observe how the entirety of the 95% confidence interval for <span class="math inline">\(p_{e} - p_{c}\)</span> lies above 0, suggesting that this difference is positive for the experimental birds.</p>
<p>Since the bootstrap distribution appears to be roughly normally shaped, we can also use the standard error method as we did in Section <a href="6-confidence-intervals.html#bootstrap-process">6.4</a>. In this case, we must specify the <code>point_estimate</code> argument as the observed difference in infection rates 0.3 = 30% saved in <code>obs_diff_prop</code>. This value acts as the center of the confidence interval.</p>
<div class="sourceCode" id="cb313"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb313-1"><a href="7-hypothesis-testing.html#cb313-1" tabindex="-1"></a>se_ci <span class="ot">&lt;-</span> bootstrap_distribution <span class="sc">%&gt;%</span> </span>
<span id="cb313-2"><a href="7-hypothesis-testing.html#cb313-2" tabindex="-1"></a>  <span class="fu">get_confidence_interval</span>(<span class="at">level =</span> <span class="fl">0.95</span>, <span class="at">type =</span> <span class="st">&quot;se&quot;</span>, </span>
<span id="cb313-3"><a href="7-hypothesis-testing.html#cb313-3" tabindex="-1"></a>                          <span class="at">point_estimate =</span> obs_diff_prop)</span>
<span id="cb313-4"><a href="7-hypothesis-testing.html#cb313-4" tabindex="-1"></a>se_ci</span></code></pre></div>
<pre><code># A tibble: 1 × 2
   lower_ci upper_ci
      &lt;dbl&gt;    &lt;dbl&gt;
1 0.0752680 0.524732</code></pre>
<p>Let’s visualize <code>bootstrap_distribution</code> again, but now the standard error based 95% confidence interval for <span class="math inline">\(p_{e} - p_{c}\)</span> in Figure <a href="7-hypothesis-testing.html#fig:bootstrap-distribution-two-prop-se">7.13</a>. Again, notice how the value 0 is not included in our confidence interval, again suggesting that <span class="math inline">\(p_{e}\)</span> and <span class="math inline">\(p_{c}\)</span> are truly different!</p>
<div class="sourceCode" id="cb315"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb315-1"><a href="7-hypothesis-testing.html#cb315-1" tabindex="-1"></a><span class="fu">visualize</span>(bootstrap_distribution) <span class="sc">+</span> </span>
<span id="cb315-2"><a href="7-hypothesis-testing.html#cb315-2" tabindex="-1"></a>  <span class="fu">shade_confidence_interval</span>(<span class="at">endpoints =</span> se_ci)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:bootstrap-distribution-two-prop-se"></span>
<img src="ModernDive_files/figure-html/bootstrap-distribution-two-prop-se-1.png" alt="Standard error-based 95\% confidence interval." width="\textwidth" />
<p class="caption">
FIGURE 7.13: Standard error-based 95% confidence interval.
</p>
</div>
<div class="learncheck">
<p>
<strong><em>Learning check</em></strong>
</p>
</div>
<p><strong>(LC7.1)</strong> Why does the following code produce an error? In other words, what about the response and predictor variables make this not a possible computation with the <code>infer</code> package?</p>
<div class="sourceCode" id="cb316"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb316-1"><a href="7-hypothesis-testing.html#cb316-1" tabindex="-1"></a><span class="fu">library</span>(moderndive)</span>
<span id="cb316-2"><a href="7-hypothesis-testing.html#cb316-2" tabindex="-1"></a><span class="fu">library</span>(infer)</span>
<span id="cb316-3"><a href="7-hypothesis-testing.html#cb316-3" tabindex="-1"></a>null_distribution_cean <span class="ot">&lt;-</span> GreatTitMalaria <span class="sc">%&gt;%</span></span>
<span id="cb316-4"><a href="7-hypothesis-testing.html#cb316-4" tabindex="-1"></a>  <span class="fu">specify</span>(<span class="at">formula =</span> response <span class="sc">~</span> treatment, <span class="at">success =</span> <span class="st">&quot;Malaria&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb316-5"><a href="7-hypothesis-testing.html#cb316-5" tabindex="-1"></a>  <span class="fu">hypothesize</span>(<span class="at">null =</span> <span class="st">&quot;independence&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb316-6"><a href="7-hypothesis-testing.html#cb316-6" tabindex="-1"></a>  <span class="fu">generate</span>(<span class="at">reps =</span> <span class="dv">1000</span>, <span class="at">type =</span> <span class="st">&quot;permute&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb316-7"><a href="7-hypothesis-testing.html#cb316-7" tabindex="-1"></a>  <span class="fu">calculate</span>(<span class="at">stat =</span> <span class="st">&quot;diff in means&quot;</span>, <span class="at">order =</span> <span class="fu">c</span>(<span class="st">&quot;Egg removal&quot;</span>, <span class="st">&quot;Control&quot;</span>))</span></code></pre></div>
<p><strong>(LC7.2)</strong> Why are we relatively confident that the distributions of the sample proportions will be good approximations of the population distributions of infection proportions for the two treatment groups?</p>
<p><strong>(LC7.3)</strong> Using the definition of <em>p-value</em>, write in words what the <span class="math inline">\(p\)</span>-value represents for the hypothesis test comparing the infection rates for control and experimental birds.</p>
<div class="learncheck">

</div>
</div>
<div id="only-one-test" class="section level3 hasAnchor" number="7.3.3">
<h3><span class="header-section-number">7.3.3</span> “There is only one test”<a href="7-hypothesis-testing.html#only-one-test" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s recap the steps necessary to conduct a hypothesis test using the terminology, notation, and definitions related to sampling you saw in Section <a href="7-hypothesis-testing.html#understanding-ht">7.2</a> and the <code>infer</code> workflow from Subsection <a href="7-hypothesis-testing.html#infer-workflow-ht">7.3.1</a>:</p>
<ol style="list-style-type: decimal">
<li><code>specify()</code> the variables of interest in your data frame.</li>
<li><code>hypothesize()</code> the null hypothesis <span class="math inline">\(H_0\)</span>. In other words, set a “model for the universe” assuming <span class="math inline">\(H_0\)</span> is true.</li>
<li><code>generate()</code> shuffles assuming <span class="math inline">\(H_0\)</span> is true. In other words, <em>simulate</em> data assuming <span class="math inline">\(H_0\)</span> is true.</li>
<li><code>calculate()</code> the <em>test statistic</em> of interest, both for the observed data and your <em>simulated</em> data.</li>
<li><code>visualize()</code> the resulting <em>null distribution</em> and compute the <em><span class="math inline">\(p\)</span>-value</em> by comparing the null distribution to the observed test statistic.</li>
</ol>
<p>While this is a lot to digest, especially the first time you encounter hypothesis testing, the nice thing is that once you understand this general framework, then you can understand <em>any</em> hypothesis test. In a famous blog post, computer scientist Allen Downey called this the <a href="http://allendowney.blogspot.com/2016/06/there-is-still-only-one-test.html">“There is only one test”</a> framework, for which he created the flowchart displayed in Figure <a href="7-hypothesis-testing.html#fig:htdowney">7.14</a>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:htdowney"></span>
<img src="images/copyright/there_is_only_one_test.png" alt="Allen Downey's hypothesis testing framework." width="110%" />
<p class="caption">
FIGURE 7.14: Allen Downey’s hypothesis testing framework.
</p>
</div>
<p>Notice its similarity with the “hypothesis testing with <code>infer</code>” diagram you saw in Figure <a href="7-hypothesis-testing.html#fig:inferht">7.9</a>. That’s because the <code>infer</code> package was explicitly designed to match the “There is only one test” framework. So if you can understand the framework, you can easily generalize these ideas for all hypothesis testing scenarios. Whether for population proportions <span class="math inline">\(p\)</span>, for population means <span class="math inline">\(\mu\)</span>,for differences in population proportions <span class="math inline">\(p_1 - p_2\)</span>, and as you’ll see later, for differences in population means <span class="math inline">\(\mu_1 - \mu_2\)</span> (Section <a href="7-hypothesis-testing.html#ht-case-study">7.5</a>), and for population regression slopes <span class="math inline">\(\beta_1\)</span> (Chapter <a href="9-inference-for-regression.html#inference-for-regression">9</a>). In fact, it applies more generally even than just these examples to more complicated hypothesis tests and test statistics as well, many of which are explored in <a href="https://infer.netlify.app/articles/observed_stat_examples.html">“Full infer Pipeline Examples”</a>.</p>
<div class="learncheck">
<p>
<strong><em>Learning check</em></strong>
</p>
</div>
<p><strong>(LC7.4)</strong> Describe in a paragraph how we used Allen Downey’s diagram to conclude if a statistical difference existed between the infection rate of control and experimental birds using this study.</p>
<div class="learncheck">

</div>
</div>
</div>
<div id="ht-interpretation" class="section level2 hasAnchor" number="7.4">
<h2><span class="header-section-number">7.4</span> Interpreting hypothesis tests<a href="7-hypothesis-testing.html#ht-interpretation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Interpreting the results of hypothesis tests is one of the more challenging aspects of this method for statistical inference. In this section, we’ll focus on ways to help with deciphering the process and address some common misconceptions.</p>
<div id="trial" class="section level3 hasAnchor" number="7.4.1">
<h3><span class="header-section-number">7.4.1</span> Two possible outcomes<a href="7-hypothesis-testing.html#trial" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In Section <a href="7-hypothesis-testing.html#understanding-ht">7.2</a>, we mentioned that given a pre-specified significance level <span class="math inline">\(\alpha\)</span> there are two possible outcomes of a hypothesis test:</p>
<ul>
<li>If the <span class="math inline">\(p\)</span>-value is less than <span class="math inline">\(\alpha\)</span>, then we <em>reject</em> the null hypothesis <span class="math inline">\(H_0\)</span> in favor of <span class="math inline">\(H_A\)</span>.</li>
<li>If the <span class="math inline">\(p\)</span>-value is greater than or equal to <span class="math inline">\(\alpha\)</span>, we <em>fail to reject</em> the null hypothesis <span class="math inline">\(H_0\)</span>.</li>
</ul>
<p>Unfortunately, the latter result is often misinterpreted as “accepting the null hypothesis <span class="math inline">\(H_0\)</span>.” While at first glance it may seem that the statements “failing to reject <span class="math inline">\(H_0\)</span>” and “accepting <span class="math inline">\(H_0\)</span>” are equivalent, there actually is a subtle difference. Saying that we “accept the null hypothesis <span class="math inline">\(H_0\)</span>” is equivalent to stating that “we think the null hypothesis <span class="math inline">\(H_0\)</span> is true.” However, saying that we “fail to reject the null hypothesis <span class="math inline">\(H_0\)</span>” is saying something else: “While <span class="math inline">\(H_0\)</span> might still be false, we don’t have enough evidence to say so.” In other words, there is an absence of enough proof. However, the absence of proof is not proof of absence.</p>
<p>To further shed light on this distinction, let’s use the United States criminal justice system as an analogy. A criminal trial in the United States is a similar situation to hypothesis tests whereby a choice between two contradictory claims must be made about a defendant who is on trial:</p>
<ol style="list-style-type: decimal">
<li>The defendant is truly either “innocent” or “guilty.”</li>
<li>The defendant is presumed “innocent until proven guilty.”</li>
<li>The defendant is found guilty only if there is <em>strong evidence</em> that the defendant is guilty. The phrase “beyond a reasonable doubt” is often used as a guideline for determining a cutoff for when enough evidence exists to find the defendant guilty.</li>
<li>The defendant is found to be either “not guilty” or “guilty” in the ultimate verdict.</li>
</ol>
<p>In other words, <em>not guilty</em> verdicts are not suggesting the defendant is <em>innocent</em>, but instead that “while the defendant may still actually be guilty, there wasn’t enough evidence to prove this fact.” Now let’s make the connection with hypothesis tests:</p>
<ol style="list-style-type: decimal">
<li>Either the null hypothesis <span class="math inline">\(H_0\)</span> or the alternative hypothesis <span class="math inline">\(H_A\)</span> is true.</li>
<li>Hypothesis tests are conducted assuming the null hypothesis <span class="math inline">\(H_0\)</span> is true.</li>
<li>We reject the null hypothesis <span class="math inline">\(H_0\)</span> in favor of <span class="math inline">\(H_A\)</span> only if the evidence found in the sample suggests that <span class="math inline">\(H_A\)</span> is true. The significance level <span class="math inline">\(\alpha\)</span> is used as a guideline to set the threshold on just how strong of evidence we require.</li>
<li>We ultimately decide to either “fail to reject <span class="math inline">\(H_0\)</span>” or “reject <span class="math inline">\(H_0\)</span>.”</li>
</ol>
<p>So while gut instinct may suggest “failing to reject <span class="math inline">\(H_0\)</span>” and “accepting <span class="math inline">\(H_0\)</span>” are equivalent statements, they are not. “Accepting <span class="math inline">\(H_0\)</span>” is equivalent to finding a defendant innocent. However, courts do not find defendants “innocent,” but rather they find them “not guilty.” Putting things differently, defense attorneys do not need to prove that their clients are innocent, rather they only need to prove that clients are not “guilty beyond a reasonable doubt”.</p>
<p>So going back to our bird study in Section <a href="7-hypothesis-testing.html#ht-infer">7.3</a>, recall that our hypothesis test was <span class="math inline">\(H_0: p_{e} - p_{c} = 0\)</span> versus <span class="math inline">\(H_A: p_{e} - p_{c} &gt; 0\)</span> and that we used a pre-specified significance level of <span class="math inline">\(\alpha\)</span> = 0.05. We found a <span class="math inline">\(p\)</span>-value of 0.007. Since the <span class="math inline">\(p\)</span>-value was smaller than <span class="math inline">\(\alpha\)</span> = 0.05, we rejected <span class="math inline">\(H_0\)</span>. In other words, we found needed levels of evidence in this particular sample to say that <span class="math inline">\(H_0\)</span> is false at the <span class="math inline">\(\alpha\)</span> = 0.05 significance level. We also state this conclusion using non-statistical language: we found enough evidence in this data to suggest that there was a treatment effect at play.</p>
</div>
<div id="types-of-errors" class="section level3 hasAnchor" number="7.4.2">
<h3><span class="header-section-number">7.4.2</span> Types of errors<a href="7-hypothesis-testing.html#types-of-errors" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Unfortunately, there is some chance a jury or a judge can make an incorrect response in a criminal trial by reaching the wrong verdict. For example, finding a truly innocent defendant “guilty”. Or on the other hand, finding a truly guilty defendant “not guilty.” This can often stem from the fact that prosecutors don’t have access to all the relevant evidence, but instead are limited to whatever evidence the police can find.</p>
<p>The same holds for hypothesis tests. We can make incorrect decisions about a population parameter because we only have a sample of data from the population and thus sampling variation can lead us to incorrect conclusions.</p>
<p>There are two possible erroneous conclusions in a criminal trial: either (1) a truly innocent person is found guilty or (2) a truly guilty person is found not guilty. Similarly, there are two possible errors in a hypothesis test: either (1) rejecting <span class="math inline">\(H_0\)</span> when in fact <span class="math inline">\(H_0\)</span> is true, called a <strong>Type I error</strong> or (2) failing to reject <span class="math inline">\(H_0\)</span> when in fact <span class="math inline">\(H_0\)</span> is false, called a <strong>Type II error</strong>. Another term used for “Type I error” is “false positive,” while another term for “Type II error” is “false negative.”</p>
<p>This risk of error is the price researchers pay for basing inference on a sample instead of performing a census on the entire population. But as we’ve seen in our numerous examples and activities so far, censuses are often very expensive and other times impossible, and thus researchers have no choice but to use a sample. Thus in any hypothesis test based on a sample, we have no choice but to tolerate some chance that a Type I error will be made and some chance that a Type II error will occur.</p>
<p>To help understand the concepts of Type I error and Type II errors, we apply these terms to our criminal justice analogy in Figure <a href="7-hypothesis-testing.html#fig:trial-errors-table">7.15</a>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:trial-errors-table"></span>
<img src="images/gt_error_table.png" alt="Type I and Type II errors in criminal trials." width="\textwidth" />
<p class="caption">
FIGURE 7.15: Type I and Type II errors in criminal trials.
</p>
</div>
<p>Thus a Type I error corresponds to incorrectly putting a truly innocent person in jail, whereas a Type II error corresponds to letting a truly guilty person go free. Let’s show the corresponding table in Figure <a href="7-hypothesis-testing.html#fig:trial-errors-table-ht">7.16</a> for hypothesis tests.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:trial-errors-table-ht"></span>
<img src="images/gt_error_table_ht.png" alt="Type I and Type II errors in hypothesis tests." width="\textwidth" />
<p class="caption">
FIGURE 7.16: Type I and Type II errors in hypothesis tests.
</p>
</div>
</div>
<div id="choosing-alpha" class="section level3 hasAnchor" number="7.4.3">
<h3><span class="header-section-number">7.4.3</span> How do we choose alpha?<a href="7-hypothesis-testing.html#choosing-alpha" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>If we are using a sample to make inferences about a population, we run the risk of making errors. For confidence intervals, a corresponding “error” would be constructing a confidence interval that does not contain the true value of the population parameter. For hypothesis tests, this would be making either a Type I or Type II error. Obviously, we want to minimize the probability of either error; we want a small probability of making an incorrect conclusion:</p>
<ul>
<li>The probability of a Type I Error occurring is denoted by <span class="math inline">\(\alpha\)</span>. The value of <span class="math inline">\(\alpha\)</span> is called the <em>significance level</em> of the hypothesis test, which we defined in Section <a href="7-hypothesis-testing.html#understanding-ht">7.2</a>.</li>
<li>The probability of a Type II Error is denoted by <span class="math inline">\(\beta\)</span>. The value of <span class="math inline">\(1-\beta\)</span> is known as the <em>power</em> of the hypothesis test.</li>
</ul>
<p>In other words, <span class="math inline">\(\alpha\)</span> corresponds to the probability of incorrectly rejecting <span class="math inline">\(H_0\)</span> when in fact <span class="math inline">\(H_0\)</span> is true. On the other hand, <span class="math inline">\(\beta\)</span> corresponds to the probability of incorrectly failing to reject <span class="math inline">\(H_0\)</span> when in fact <span class="math inline">\(H_0\)</span> is false.</p>
<p>Ideally, we want <span class="math inline">\(\alpha = 0\)</span> and <span class="math inline">\(\beta = 0\)</span>, meaning that the chance of making either error is 0. However, this can never be the case in any situation where we are sampling for inference. There will always be the possibility of making either error when we use sample data. Furthermore, these two error probabilities are inversely related. As the probability of a Type I error goes down, the probability of a Type II error goes up.</p>
<p>What is typically done in practice is to fix the probability of a Type I error by pre-specifying a significance level <span class="math inline">\(\alpha\)</span> and then try to minimize <span class="math inline">\(\beta\)</span>. In other words, we will tolerate a certain fraction of incorrect rejections of the null hypothesis <span class="math inline">\(H_0\)</span>, and then try to minimize the fraction of incorrect non-rejections of <span class="math inline">\(H_0\)</span>.</p>
<p>So for example if we used <span class="math inline">\(\alpha\)</span> = 0.01, we would be using a hypothesis testing procedure that in the long run would incorrectly reject the null hypothesis <span class="math inline">\(H_0\)</span> one percent of the time. This is analogous to setting the confidence level of a confidence interval.</p>
<p>So what value should you use for <span class="math inline">\(\alpha\)</span>? Different fields have different conventions, but some commonly used values include 0.10, 0.05, 0.01, and 0.001. However, it is important to keep in mind that if you use a relatively small value of <span class="math inline">\(\alpha\)</span>, then all things being equal, <span class="math inline">\(p\)</span>-values will have a harder time being less than <span class="math inline">\(\alpha\)</span>. Thus we would reject the null hypothesis less often. In other words, we would reject the null hypothesis <span class="math inline">\(H_0\)</span> only if we have <em>very strong</em> evidence to do so. This is known as a “conservative” test.</p>
<p>On the other hand, if we used a relatively large value of <span class="math inline">\(\alpha\)</span>, then all things being equal, <span class="math inline">\(p\)</span>-values will have an easier time being less than <span class="math inline">\(\alpha\)</span>. Thus we would reject the null hypothesis more often. In other words, we would reject the null hypothesis <span class="math inline">\(H_0\)</span> even if we only have <em>mild</em> evidence to do so. This is known as a “liberal” test.</p>
<div class="learncheck">
<p>
<strong><em>Learning check</em></strong>
</p>
</div>
<p><strong>(LC7.5)</strong> What is wrong about saying, “The defendant is innocent.” based on the US system of criminal trials?</p>
<p><strong>(LC7.6)</strong> What is the purpose of hypothesis testing?</p>
<p><strong>(LC7.7)</strong> What are some flaws with hypothesis testing? How could we alleviate them?</p>
<p><strong>(LC7.8)</strong> Consider two <span class="math inline">\(\alpha\)</span> significance levels of 0.1 and 0.01. Of the two, which would lead to a more <em>liberal</em> hypothesis testing procedure? In other words, one that will, all things being equal, lead to more rejections of the null hypothesis <span class="math inline">\(H_0\)</span>.</p>
<div class="learncheck">

</div>
</div>
</div>
<div id="ht-case-study" class="section level2 hasAnchor" number="7.5">
<h2><span class="header-section-number">7.5</span> Case study: Do living lizards have longer horns than dead lizards?<a href="7-hypothesis-testing.html#ht-case-study" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Let’s apply our knowledge of hypothesis testing to answer the question: “Are lizards with longer horns more likely to survive?”. Horned lizards possess an elaborate crown of bony horns that were presumed to provide protection against predators. To test this hypothesis, a team of herpetologists examined flat-tailed horned lizards (<em>Phrynosoma mcalli</em>), which are often eaten by loggerhead shrikes (such a pretty bird – and yet quite lethal!). The researchers examined the length of horns of both living and shrike-killed horned lizards to see if there was an association between horn length and predation status.</p>
<div id="imdb-data" class="section level3 hasAnchor" number="7.5.1">
<h3><span class="header-section-number">7.5.1</span> Horned lizards dataset<a href="7-hypothesis-testing.html#imdb-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>HornedLizards</code> dataset in the <code>abd</code> package contains information on 184 horned lizards. The <code>group</code> variable indicates the predation status (living or killed) and the <code>horn.length</code> variable indicates the squamosal horn length (in mm) of each lizard. We are interested in whether <code>living</code> horned lizards have a greater <code>horn.length</code> on average than <code>killed</code> ones.</p>
<div class="sourceCode" id="cb317"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb317-1"><a href="7-hypothesis-testing.html#cb317-1" tabindex="-1"></a>HornedLizards <span class="sc">%&gt;%</span> <span class="fu">tibble</span>()</span></code></pre></div>
<pre><code># A tibble: 184 × 2
   horn.length group 
         &lt;dbl&gt; &lt;fct&gt; 
 1        25.2 living
 2        26.9 living
 3        26.6 living
 4        25.6 living
 5        25.7 living
 6        25.9 living
 7        27.3 living
 8        25.1 living
 9        30.3 living
10        25.6 living
# ℹ 174 more rows</code></pre>
<p>Let’s perform an exploratory data analysis of this data. Recall from Subsection <a href="2-viz.html#geomboxplot">2.7.1</a> that a boxplot is a visualization we can use to show the relationship between a numerical and a categorical variable. Another option you saw in Section <a href="2-viz.html#facets">2.6</a> would be to use a faceted histogram. However, in the interest of brevity, let’s only present the boxplot in Figure <a href="7-hypothesis-testing.html#fig:killed-living-boxplot">7.17</a>.</p>
<div class="sourceCode" id="cb319"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb319-1"><a href="7-hypothesis-testing.html#cb319-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> HornedLizards, <span class="fu">aes</span>(<span class="at">x =</span> group, <span class="at">y =</span> horn.length)) <span class="sc">+</span></span>
<span id="cb319-2"><a href="7-hypothesis-testing.html#cb319-2" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb319-3"><a href="7-hypothesis-testing.html#cb319-3" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Squamosal horn length&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:killed-living-boxplot"></span>
<img src="ModernDive_files/figure-html/killed-living-boxplot-1.png" alt="Boxplot of squamosal horn length vs. group." width="\textwidth" />
<p class="caption">
FIGURE 7.17: Boxplot of squamosal horn length vs. group.
</p>
</div>
<p>Eyeballing Figure <a href="7-hypothesis-testing.html#fig:killed-living-boxplot">7.17</a>, living horned lizards have a greater median horn length than killed. Do we have reason to believe, however, that there is a <em>significant</em> difference between the mean <code>horn.length</code> for killed horned lizards compared to living horned lizards? Although the boxplot does show that the median sample horn length is higher for living horned lizards, it’s hard to conclude if this difference is statistically significant or due to random chance in the sample of horned lizards studied. After all, there is a fair amount of overlap between the boxes. Recall that the median isn’t necessarily the same as the mean either, depending on whether the distribution is skewed.</p>
<p>Did you notice the warning above that one row contains “non-finite” values? Apparently one row has missing values – which explains why the dataset has 185 rows instead of the expected 184 observations. Before we proceed further, let’s use <code>tidyr::drop_na</code> to drop the row with missing data to potentially avoid trouble later on.</p>
<div class="sourceCode" id="cb320"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb320-1"><a href="7-hypothesis-testing.html#cb320-1" tabindex="-1"></a>HornedLizards <span class="ot">&lt;-</span> HornedLizards <span class="sc">%&gt;%</span> tidyr<span class="sc">::</span><span class="fu">drop_na</span>()</span></code></pre></div>
<p>Let’s calculate some summary statistics – the number of horned lizards, the mean horn length, and the standard deviation – split by the binary categorical variable <code>group</code>. We’ll do this using <code>dplyr</code> data wrangling verbs. Notice in particular how we count the number of each type of lizard using the <code>n()</code> summary function.</p>
<div class="sourceCode" id="cb321"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb321-1"><a href="7-hypothesis-testing.html#cb321-1" tabindex="-1"></a>HornedLizards <span class="sc">%&gt;%</span> </span>
<span id="cb321-2"><a href="7-hypothesis-testing.html#cb321-2" tabindex="-1"></a>  <span class="fu">group_by</span>(group) <span class="sc">%&gt;%</span> </span>
<span id="cb321-3"><a href="7-hypothesis-testing.html#cb321-3" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n =</span> <span class="fu">n</span>(), <span class="at">mean_length =</span> <span class="fu">mean</span>(horn.length), <span class="at">std_dev =</span> <span class="fu">sd</span>(horn.length))</span></code></pre></div>
<pre><code># A tibble: 2 × 4
  group      n mean_length std_dev
  &lt;fct&gt;  &lt;int&gt;       &lt;dbl&gt;   &lt;dbl&gt;
1 killed    30     21.9867 2.70946
2 living   154     24.2812 2.63078</code></pre>
<p>Observe that we have 154 living HornedLizards with an average horn.length of 24.281 mm and 30 killed HornedLizards with an average horn.length of 21.987 mm. The difference in these average ratings is thus 24.281 - 21.987 = 2.295. So there appears to be an edge of 2.295 mm in favor of living horned lizards. The question is, however, are these results indicative of a true difference for <em>all</em> living and killed horned lizards? Or could we attribute this difference to chance <em>sampling variation</em>?</p>
</div>
<div id="sampling-scenario-1" class="section level3 hasAnchor" number="7.5.2">
<h3><span class="header-section-number">7.5.2</span> Sampling scenario<a href="7-hypothesis-testing.html#sampling-scenario-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s now revisit this study in terms of terminology and notation related to sampling we studied in Subsection <a href="5-sampling.html#terminology-and-notation">5.3.1</a>. The <em>study population</em> is all horned lizards, either living or killed. The <em>sample</em> from this population is the 184 HornedLizards included in the <code>HornedLizards</code> dataset.</p>
<p>Since this sample was randomly taken from the population <code>HornedLizards</code>, it is presumably representative of all living and killed horned lizards. Thus, any analysis and results based on <code>HornedLizards</code> can generalize to the entire population. What are the relevant <em>population parameter</em> and <em>point estimates</em>? We introduce the fourth sampling scenario in Table <a href="7-hypothesis-testing.html#tab:summarytable-ch10">7.3</a>.</p>
<table class="table" style="font-size: 16px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:summarytable-ch10">TABLE 7.3: </span>Scenarios of sampling for inference
</caption>
<thead>
<tr>
<th style="text-align:right;">
Scenario
</th>
<th style="text-align:left;">
Population parameter
</th>
<th style="text-align:left;">
Notation
</th>
<th style="text-align:left;">
Point estimate
</th>
<th style="text-align:left;">
Symbol(s)
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;width: 0.5in; ">
1
</td>
<td style="text-align:left;width: 0.7in; ">
Population proportion
</td>
<td style="text-align:left;width: 1in; ">
<span class="math inline">\(p\)</span>
</td>
<td style="text-align:left;width: 1.1in; ">
Sample proportion
</td>
<td style="text-align:left;width: 1in; ">
<span class="math inline">\(\widehat{p}\)</span>
</td>
</tr>
<tr>
<td style="text-align:right;width: 0.5in; ">
2
</td>
<td style="text-align:left;width: 0.7in; ">
Population mean
</td>
<td style="text-align:left;width: 1in; ">
<span class="math inline">\(\mu\)</span>
</td>
<td style="text-align:left;width: 1.1in; ">
Sample mean
</td>
<td style="text-align:left;width: 1in; ">
<span class="math inline">\(\overline{x}\)</span> or <span class="math inline">\(\widehat{\mu}\)</span>
</td>
</tr>
<tr>
<td style="text-align:right;width: 0.5in; ">
3
</td>
<td style="text-align:left;width: 0.7in; ">
Difference in population proportions
</td>
<td style="text-align:left;width: 1in; ">
<span class="math inline">\(p_1 - p_2\)</span>
</td>
<td style="text-align:left;width: 1.1in; ">
Difference in sample proportions
</td>
<td style="text-align:left;width: 1in; ">
<span class="math inline">\(\widehat{p}_1 - \widehat{p}_2\)</span>
</td>
</tr>
<tr>
<td style="text-align:right;width: 0.5in; ">
4
</td>
<td style="text-align:left;width: 0.7in; ">
Difference in population means
</td>
<td style="text-align:left;width: 1in; ">
<span class="math inline">\(\mu_1 - \mu_2\)</span>
</td>
<td style="text-align:left;width: 1.1in; ">
Difference in sample means
</td>
<td style="text-align:left;width: 1in; ">
<span class="math inline">\(\overline{x}_1 - \overline{x}_2\)</span>
</td>
</tr>
</tbody>
</table>
<p>So, whereas the sampling bowl exercise in Section <a href="5-sampling.html#sampling-activity">5.1</a> concerned <em>proportions</em>, the pennies exercise in Section <a href="6-confidence-intervals.html#resampling-tactile">6.1</a> concerned <em>means</em>, the case study on whether yawning is contagious in Section <a href="6-confidence-intervals.html#case-study-two-prop-ci">6.6</a> and the GreatTitMalaria activity in Section <a href="7-hypothesis-testing.html#ht-activity">7.1</a> concerned <em>differences in proportions</em>, we are now concerned with <em>differences in means</em>.</p>
<p>In other words, the population parameter of interest is the difference in population mean ratings <span class="math inline">\(\mu_k - \mu_l\)</span>, where <span class="math inline">\(\mu_k\)</span> is the mean horn length of all killed horned lizards and similarly <span class="math inline">\(\mu_l\)</span> is the mean horn length of all living horned lizards. Additionally the point estimate/sample statistic of interest is the difference in sample means <span class="math inline">\(\overline{x}_k - \overline{x}_l\)</span>, where <span class="math inline">\(\overline{x}_k\)</span> is the mean horn.length of the <span class="math inline">\(n_k\)</span> = 30 horned lizards in our sample and <span class="math inline">\(\overline{x}_l\)</span> is the mean horn length of the <span class="math inline">\(n_l\)</span> = 154 in our sample. Based on our earlier exploratory data analysis, our estimate <span class="math inline">\(\overline{x}_k - \overline{x}_l\)</span> is <span class="math inline">\(21.987 - 24.281 = -2.295\)</span>.</p>
<p>So there appears to be a difference of -2.295 in favor of living horned lizards. The question is, however, could this difference of -2.295 be merely due to chance and sampling variation? Or are these results indicative of a true difference in mean ratings for <em>all</em> living and killed horned lizards? To answer this question, we’ll use hypothesis testing.</p>
</div>
<div id="conducting-the-hypothesis-test" class="section level3 hasAnchor" number="7.5.3">
<h3><span class="header-section-number">7.5.3</span> Conducting the hypothesis test<a href="7-hypothesis-testing.html#conducting-the-hypothesis-test" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We’ll be testing:</p>
<p><span class="math display">\[
\begin{aligned}
H_0 &amp;: \mu_k - \mu_l = 0\\
\text{vs } H_A&amp;: \mu_k - \mu_l \neq 0
\end{aligned}
\]</span></p>
<p>In other words, the null hypothesis <span class="math inline">\(H_0\)</span> suggests that both living and killed horned lizards have the same mean horn.length. This is the “hypothesized universe” we’ll <em>assume</em> is true. On the other hand, the alternative hypothesis <span class="math inline">\(H_A\)</span> suggests that there is a difference. Unlike the one-sided alternative we used in the GreatTitMalaria exercise <span class="math inline">\(H_A: p_e - p_c &gt; 0\)</span>, we are now considering a two-sided alternative of <span class="math inline">\(H_A: \mu_k - \mu_l \neq 0\)</span>.</p>
<p>Furthermore, we’ll pre-specify a low significance level of <span class="math inline">\(\alpha\)</span> = 0.01. By setting this value low, all things being equal, there is a lower chance that the <span class="math inline">\(p\)</span>-value will be less than <span class="math inline">\(\alpha\)</span>. Thus, there is a lower chance that we’ll reject the null hypothesis <span class="math inline">\(H_0\)</span> in favor of the alternative hypothesis <span class="math inline">\(H_A\)</span>. In other words, we’ll reject the hypothesis that there is no difference in mean ratings for all killed and living horned lizards, only if we have quite strong evidence.</p>
<div id="specify-variables-4" class="section level4 unnumbered hasAnchor">
<h4>1. <code>specify</code> variables<a href="7-hypothesis-testing.html#specify-variables-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Let’s now perform all the steps of the <code>infer</code> workflow. We first <code>specify()</code> the variables of interest in the <code>HornedLizards</code> data frame using the formula <code>horn.length ~ group</code>. This tells <code>infer</code> that the numerical variable <code>horn.length</code> is the outcome variable, while the binary variable <code>group</code> is the explanatory variable. Note that unlike previously when we were interested in proportions, since we are now interested in the mean of a numerical variable, we do not need to set the <code>success</code> argument.</p>
<div class="sourceCode" id="cb323"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb323-1"><a href="7-hypothesis-testing.html#cb323-1" tabindex="-1"></a>HornedLizards <span class="sc">%&gt;%</span> </span>
<span id="cb323-2"><a href="7-hypothesis-testing.html#cb323-2" tabindex="-1"></a>  <span class="fu">specify</span>(<span class="at">formula =</span> horn.length <span class="sc">~</span> group)</span></code></pre></div>
<pre><code>Response: horn.length (numeric)
Explanatory: group (factor)
# A tibble: 184 × 2
   horn.length group 
         &lt;dbl&gt; &lt;fct&gt; 
 1        25.2 living
 2        26.9 living
 3        26.6 living
 4        25.6 living
 5        25.7 living
 6        25.9 living
 7        27.3 living
 8        25.1 living
 9        30.3 living
10        25.6 living
# ℹ 174 more rows</code></pre>
<p>Observe at this point that the data in <code>HornedLizards</code> has not changed. The only change so far is the newly defined <code>Response: horn.length (numeric)</code> and <code>Explanatory: group (factor)</code> <em>meta-data</em>.</p>
</div>
<div id="hypothesize-the-null-1" class="section level4 unnumbered hasAnchor">
<h4>2. <code>hypothesize</code> the null<a href="7-hypothesis-testing.html#hypothesize-the-null-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We set the null hypothesis <span class="math inline">\(H_0: \mu_k - \mu_l = 0\)</span> by using the <code>hypothesize()</code> function. Since we have two samples, killed and living horned lizards, we set <code>null</code> to be <code>"independence"</code> as we described in Section <a href="7-hypothesis-testing.html#ht-infer">7.3</a>.</p>
<div class="sourceCode" id="cb325"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb325-1"><a href="7-hypothesis-testing.html#cb325-1" tabindex="-1"></a>HornedLizards <span class="sc">%&gt;%</span> </span>
<span id="cb325-2"><a href="7-hypothesis-testing.html#cb325-2" tabindex="-1"></a>  <span class="fu">specify</span>(<span class="at">formula =</span> horn.length <span class="sc">~</span> group) <span class="sc">%&gt;%</span> </span>
<span id="cb325-3"><a href="7-hypothesis-testing.html#cb325-3" tabindex="-1"></a>  <span class="fu">hypothesize</span>(<span class="at">null =</span> <span class="st">&quot;independence&quot;</span>)</span></code></pre></div>
<pre><code>Response: horn.length (numeric)
Explanatory: group (factor)
Null Hypothesis: independence
# A tibble: 184 × 2
   horn.length group 
         &lt;dbl&gt; &lt;fct&gt; 
 1        25.2 living
 2        26.9 living
 3        26.6 living
 4        25.6 living
 5        25.7 living
 6        25.9 living
 7        27.3 living
 8        25.1 living
 9        30.3 living
10        25.6 living
# ℹ 174 more rows</code></pre>
</div>
<div id="generate-replicates-4" class="section level4 unnumbered hasAnchor">
<h4>3. <code>generate</code> replicates<a href="7-hypothesis-testing.html#generate-replicates-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>After we have set the null hypothesis, we generate “shuffled” replicates assuming the null hypothesis is true by repeating the shuffling/permutation exercise you performed in Section <a href="7-hypothesis-testing.html#ht-activity">7.1</a>.</p>
<p>We’ll repeat this resampling without replacement of <code>type = "permute"</code> a total of <code>reps = 1000</code> times. Feel free to run the code below to check out what the <code>generate()</code> step produces.</p>
<div class="sourceCode" id="cb327"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb327-1"><a href="7-hypothesis-testing.html#cb327-1" tabindex="-1"></a>HornedLizards <span class="sc">%&gt;%</span> </span>
<span id="cb327-2"><a href="7-hypothesis-testing.html#cb327-2" tabindex="-1"></a>  <span class="fu">specify</span>(<span class="at">formula =</span> horn.length <span class="sc">~</span> group) <span class="sc">%&gt;%</span> </span>
<span id="cb327-3"><a href="7-hypothesis-testing.html#cb327-3" tabindex="-1"></a>  <span class="fu">hypothesize</span>(<span class="at">null =</span> <span class="st">&quot;independence&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb327-4"><a href="7-hypothesis-testing.html#cb327-4" tabindex="-1"></a>  <span class="fu">generate</span>(<span class="at">reps =</span> <span class="dv">1000</span>, <span class="at">type =</span> <span class="st">&quot;permute&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb327-5"><a href="7-hypothesis-testing.html#cb327-5" tabindex="-1"></a>  <span class="fu">View</span>()</span></code></pre></div>
</div>
<div id="calculate-summary-statistics-4" class="section level4 unnumbered hasAnchor">
<h4>4. <code>calculate</code> summary statistics<a href="7-hypothesis-testing.html#calculate-summary-statistics-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Now that we have 1000 replicated “shuffles” assuming the null hypothesis <span class="math inline">\(H_0\)</span> that both <code>killed</code> and <code>living</code> HornedLizards on average have the same horn lengths, let’s <code>calculate()</code> the appropriate summary statistic for these 1000 replicated shuffles. From Section <a href="7-hypothesis-testing.html#understanding-ht">7.2</a>, summary statistics relating to hypothesis testing have a specific name: <em>test statistics</em>. Since the unknown population parameter of interest is the difference in population means <span class="math inline">\(\mu_{k} - \mu_{l}\)</span>, the test statistic of interest here is the difference in sample means <span class="math inline">\(\overline{x}_{k} - \overline{x}_{l}\)</span>.</p>
<p>For each of our 1000 shuffles, we can calculate this test statistic by setting <code>stat = "diff in means"</code>. Furthermore, since we are interested in <span class="math inline">\(\overline{x}_{k} - \overline{x}_{l}\)</span>, we set <code>order = c("killed", "living")</code>. Let’s save the results in a data frame called <code>null_distribution_HornedLizards</code>:</p>
<div class="sourceCode" id="cb328"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb328-1"><a href="7-hypothesis-testing.html#cb328-1" tabindex="-1"></a>null_distribution_HornedLizards <span class="ot">&lt;-</span> HornedLizards <span class="sc">%&gt;%</span> </span>
<span id="cb328-2"><a href="7-hypothesis-testing.html#cb328-2" tabindex="-1"></a>  <span class="fu">specify</span>(<span class="at">formula =</span> horn.length <span class="sc">~</span> group) <span class="sc">%&gt;%</span> </span>
<span id="cb328-3"><a href="7-hypothesis-testing.html#cb328-3" tabindex="-1"></a>  <span class="fu">hypothesize</span>(<span class="at">null =</span> <span class="st">&quot;independence&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb328-4"><a href="7-hypothesis-testing.html#cb328-4" tabindex="-1"></a>  <span class="fu">generate</span>(<span class="at">reps =</span> <span class="dv">1000</span>, <span class="at">type =</span> <span class="st">&quot;permute&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb328-5"><a href="7-hypothesis-testing.html#cb328-5" tabindex="-1"></a>  <span class="fu">calculate</span>(<span class="at">stat =</span> <span class="st">&quot;diff in means&quot;</span>, <span class="at">order =</span> <span class="fu">c</span>(<span class="st">&quot;killed&quot;</span>, <span class="st">&quot;living&quot;</span>))</span>
<span id="cb328-6"><a href="7-hypothesis-testing.html#cb328-6" tabindex="-1"></a>null_distribution_HornedLizards</span></code></pre></div>
<pre><code># A tibble: 1,000 × 2
   replicate       stat
       &lt;int&gt;      &lt;dbl&gt;
 1         1  0.545152 
 2         2  0.700476 
 3         3  0.489394 
 4         4  0.0512987
 5         5  0.334069 
 6         6  0.0353680
 7         7 -0.494329 
 8         8 -0.104026 
 9         9  0.999177 
10        10  0.616840 
# ℹ 990 more rows</code></pre>
<p>Observe that we have 1000 values of <code>stat</code>, each representing one instance of <span class="math inline">\(\overline{x}_{k} - \overline{x}_{l}\)</span>. The 1000 values form the <em>null distribution</em>, which is the technical term for the sampling distribution of the difference in sample means <span class="math inline">\(\overline{x}_{k} - \overline{x}_{l}\)</span> assuming <span class="math inline">\(H_0\)</span> is true. What happened in real life? What was the observed difference in horn lengths? What was the <em>observed test statistic</em> <span class="math inline">\(\overline{x}_{k} - \overline{x}_{l}\)</span>? Recall from our earlier data wrangling, this observed difference in means was <span class="math inline">\(21.987 - 24.281 = -2.295\)</span>. We can also achieve this using the code that constructed the null distribution <code>null_distribution_HornedLizards</code> but with the <code>hypothesize()</code> and <code>generate()</code> steps removed. Let’s save this in <code>obs_diff_means</code>:</p>
<div class="sourceCode" id="cb330"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb330-1"><a href="7-hypothesis-testing.html#cb330-1" tabindex="-1"></a>obs_diff_means <span class="ot">&lt;-</span> HornedLizards <span class="sc">%&gt;%</span> </span>
<span id="cb330-2"><a href="7-hypothesis-testing.html#cb330-2" tabindex="-1"></a>  <span class="fu">specify</span>(<span class="at">formula =</span> horn.length <span class="sc">~</span> group) <span class="sc">%&gt;%</span> </span>
<span id="cb330-3"><a href="7-hypothesis-testing.html#cb330-3" tabindex="-1"></a>  <span class="fu">calculate</span>(<span class="at">stat =</span> <span class="st">&quot;diff in means&quot;</span>, <span class="at">order =</span> <span class="fu">c</span>(<span class="st">&quot;killed&quot;</span>, <span class="st">&quot;living&quot;</span>))</span>
<span id="cb330-4"><a href="7-hypothesis-testing.html#cb330-4" tabindex="-1"></a>obs_diff_means</span></code></pre></div>
<pre><code>Response: horn.length (numeric)
Explanatory: group (factor)
# A tibble: 1 × 1
      stat
     &lt;dbl&gt;
1 -2.29450</code></pre>
</div>
<div id="visualize-the-p-value-1" class="section level4 unnumbered hasAnchor">
<h4>5. <code>visualize</code> the p-value<a href="7-hypothesis-testing.html#visualize-the-p-value-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Lastly, in order to compute the <span class="math inline">\(p\)</span>-value, we have to assess how “extreme” the observed difference in means of -2.295 is. We do this by comparing -2.295 to our null distribution, which was constructed in a hypothesized universe of no true difference in average horn lengths between the two groups. Let’s visualize both the null distribution and the <span class="math inline">\(p\)</span>-value in Figure <a href="7-hypothesis-testing.html#fig:null-distribution-HornedLizards-2">7.18</a>. Unlike our example in Subsection <a href="7-hypothesis-testing.html#infer-workflow-ht">7.3.1</a> involving GreatTitMalaria, since we have a two-sided <span class="math inline">\(H_A: \mu_k - \mu_l \neq 0\)</span>, we have to allow for both possibilities for <em>more extreme</em>, so we set <code>direction = "both"</code>.</p>
<div class="sourceCode" id="cb332"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb332-1"><a href="7-hypothesis-testing.html#cb332-1" tabindex="-1"></a><span class="fu">visualize</span>(null_distribution_HornedLizards, <span class="at">bins =</span> <span class="dv">10</span>) <span class="sc">+</span> </span>
<span id="cb332-2"><a href="7-hypothesis-testing.html#cb332-2" tabindex="-1"></a>  <span class="fu">shade_p_value</span>(<span class="at">obs_stat =</span> obs_diff_means, <span class="at">direction =</span> <span class="st">&quot;both&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:null-distribution-HornedLizards-2"></span>
<img src="ModernDive_files/figure-html/null-distribution-HornedLizards-2-1.png" alt="Null distribution, observed test statistic, and $p$-value." width="\textwidth" />
<p class="caption">
FIGURE 7.18: Null distribution, observed test statistic, and <span class="math inline">\(p\)</span>-value.
</p>
</div>
<p>Let’s go over the elements of this plot. First, the histogram is the <em>null distribution</em>. Second, the solid line is the <em>observed test statistic</em>, or the difference in sample means we observed in real life of <span class="math inline">\(21.987 - 24.281 = -2.295\)</span>. Third, the two shaded areas of the histogram form the <em><span class="math inline">\(p\)</span>-value</em>, or the probability of obtaining a test statistic just as or more extreme than the observed test statistic <em>assuming the null hypothesis <span class="math inline">\(H_0\)</span> is true</em>.</p>
<p>What proportion of the null distribution is shaded? In other words, what is the numerical value of the <span class="math inline">\(p\)</span>-value? We use the <code>get_p_value()</code> function to compute this value:</p>
<div class="sourceCode" id="cb333"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb333-1"><a href="7-hypothesis-testing.html#cb333-1" tabindex="-1"></a>null_distribution_HornedLizards <span class="sc">%&gt;%</span> </span>
<span id="cb333-2"><a href="7-hypothesis-testing.html#cb333-2" tabindex="-1"></a>  <span class="fu">get_p_value</span>(<span class="at">obs_stat =</span> obs_diff_means, <span class="at">direction =</span> <span class="st">&quot;both&quot;</span>)</span></code></pre></div>
<pre><code># A tibble: 1 × 1
  p_value
    &lt;dbl&gt;
1       0</code></pre>
<p>This <span class="math inline">\(p\)</span>-value of 0 is extremely small. In other words, there is an extremely small chance that we’d observe a difference of 21.987 - 24.281 = -2.295 in a hypothesized universe where there was truly no difference in ratings.</p>
<p>In particular, this <span class="math inline">\(p\)</span>-value is less than our pre-specified <span class="math inline">\(\alpha\)</span> significance level of 0.01. Thus, we are inclined to reject the null hypothesis <span class="math inline">\(H_0: \mu_k - \mu_l = 0\)</span>. In non-statistical language, the conclusion is: we have the evidence needed in this sample of data to suggest that we should reject the hypothesis that there is no difference in mean horn lengths between living and killed horned lizards. We, thus, can say that a difference exists in living and killed horned lizards, on average, for all horned lizards.</p>
<div class="learncheck">
<p>
<strong><em>Learning check</em></strong>
</p>
</div>
<p><strong>(LC7.9)</strong> Conduct the same analysis comparing killed horned lizards versus living HornedLizards using the median horn.length instead of the mean horn.length. What was different and what was the same?</p>
<p><strong>(LC7.10)</strong> What conclusions, if any, can you make from viewing the faceted histogram looking at <code>horn.length</code> versus <code>group</code> that you couldn’t see when looking at the boxplot?</p>
<p><strong>(LC7.11)</strong> Describe in a paragraph how we used Allen Downey’s diagram to conclude if a statistical difference existed between mean horned lizards for killed and living horned lizards.</p>
<p><strong>(LC7.12)</strong> Why are we relatively confident that the distributions of the sample horn lengths will be good approximations of the population distributions of horn lengths for the two groups?</p>
<p><strong>(LC7.13)</strong> Using the definition of <span class="math inline">\(p\)</span>-value, write in words what the <span class="math inline">\(p\)</span>-value represents for the hypothesis test comparing the mean horn length of living to killed horned lizards.</p>
<p><strong>(LC7.14)</strong> What is the value of the <span class="math inline">\(p\)</span>-value for the hypothesis test comparing the mean horn length of living to killed horned lizards?</p>
<div class="learncheck">

</div>
</div>
</div>
</div>
<div id="theory-hypo" class="section level2 hasAnchor" number="7.6">
<h2><span class="header-section-number">7.6</span> Theory-based hypothesis tests<a href="7-hypothesis-testing.html#theory-hypo" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Much as we did in Subsection <a href="6-confidence-intervals.html#theory-ci">6.8</a> when we showed you a theory-based method for constructing confidence intervals that involved mathematical formulas, we now present an example of a traditional theory-based method to conduct hypothesis tests. This method relies on probability models, probability distributions, and a few assumptions to construct the null distribution. This is in contrast to the approach we’ve been using throughout this book where we relied on computer simulations to construct the null distribution.</p>
<p>These traditional theory-based methods have been used for decades mostly because researchers didn’t have access to computers that could run thousands of calculations quickly and efficiently. Now that computing power is much cheaper and more accessible, simulation-based methods are much more feasible. However, researchers in many fields continue to use theory-based methods. Hence, we make it a point to include an example here.</p>
<p>As we’ll show in this section, any theory-based method is ultimately an approximation to the simulation-based method. The theory-based method we’ll focus on is known as the <em>two-sample <span class="math inline">\(t\)</span>-test</em> for testing differences in sample means. However, the test statistic we’ll use won’t be the difference in sample means <span class="math inline">\(\overline{x}_1 - \overline{x}_2\)</span>, but rather the related <em>two-sample <span class="math inline">\(t\)</span>-statistic</em>. The data we’ll use will once again be the <code>HornedLizards</code> data of killed and living horned lizards from Section <a href="7-hypothesis-testing.html#ht-case-study">7.5</a>.</p>
<div id="two-sample-t-statistic" class="section level3 unnumbered hasAnchor">
<h3>Two-sample t-statistic<a href="7-hypothesis-testing.html#two-sample-t-statistic" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A common task in statistics is the process of “standardizing a variable.” By standardizing different variables, we make them more comparable. For example, say you are interested in studying the distribution of temperature recordings from Portland, Oregon, USA and comparing it to that of the temperature recordings in Montreal, Quebec, Canada. Given that US temperatures are generally recorded in degrees Fahrenheit and Canadian temperatures are generally recorded in degrees Celsius, how can we make them comparable? One approach would be to convert degrees Fahrenheit into Celsius, or vice versa. Another approach would be to convert them both to a common “standardized” scale, like Kelvin units of temperature.</p>
<p>One common method for standardizing a variable from probability and statistics theory is to compute the <span class="math inline">\(z\)</span>-score:</p>
<p><span class="math display">\[z = \frac{x - \mu}{\sigma}\]</span></p>
<p>where <span class="math inline">\(x\)</span> represents one value of a variable, <span class="math inline">\(\mu\)</span> represents the mean of that variable, and <span class="math inline">\(\sigma\)</span> represents the standard deviation of that variable. You first subtract the mean <span class="math inline">\(\mu\)</span> from each value of <span class="math inline">\(x\)</span> and then divide <span class="math inline">\(x - \mu\)</span> by the standard deviation <span class="math inline">\(\sigma\)</span>. These operations will have the effect of <em>re-centering</em> your variable around 0 and <em>re-scaling</em> your variable <span class="math inline">\(x\)</span> so that they have what are known as “standard units.” Thus for every value that your variable can take, it has a corresponding <span class="math inline">\(z\)</span>-score that gives how many standard units away that value is from the mean <span class="math inline">\(\mu\)</span>. <span class="math inline">\(z\)</span>-scores are normally distributed with mean 0 and standard deviation 1. This curve is called a “<span class="math inline">\(z\)</span>-distribution” or “standard normal” curve and has the common, bell-shaped pattern from Figure <a href="7-hypothesis-testing.html#fig:zcurve">7.19</a> discussed in Appendix <a href="A-appendixA.html#appendix-normal-curve">A.2</a>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:zcurve"></span>
<img src="ModernDive_files/figure-html/zcurve-1.png" alt="Standard normal z curve." width="100%" />
<p class="caption">
FIGURE 7.19: Standard normal z curve.
</p>
</div>
<p>Bringing these back to the difference of sample mean horn lengths <span class="math inline">\(\overline{x}_k - \overline{x}_l\)</span> of killed versus living horned lizards, how would we standardize this variable? By once again subtracting its mean and dividing by its standard deviation. Recall two facts from Subsection <a href="5-sampling.html#moral-of-the-story">5.3.3</a>. First, if the sampling was done in a representative fashion, then the sampling distribution of <span class="math inline">\(\overline{x}_k - \overline{x}_l\)</span> will be centered at the true population parameter <span class="math inline">\(\mu_k - \mu_l\)</span>. Second, the standard deviation of point estimates like <span class="math inline">\(\overline{x}_k - \overline{x}_l\)</span> has a special name: the standard error.</p>
<p>Applying these ideas, we present the <em>two-sample <span class="math inline">\(t\)</span>-statistic</em>:</p>
<p><span class="math display">\[t = \dfrac{ (\bar{x}_k - \bar{x}_l) - (\mu_k - \mu_l)}{ \text{SE}_{\bar{x}_k - \bar{x}_l} } = \dfrac{ (\bar{x}_k - \bar{x}_l) - (\mu_k - \mu_l)}{ \sqrt{\dfrac{{s_k}^2}{n_k} + \dfrac{{s_l}^2}{n_l}}  }\]</span></p>
<p>Oofda! There is a lot to try to unpack here! Let’s go slowly. In the numerator, <span class="math inline">\(\bar{x}_k-\bar{x}_l\)</span> is the difference in sample means, while <span class="math inline">\(\mu_k - \mu_l\)</span> is the difference in population means. In the denominator, <span class="math inline">\(s_k\)</span> and <span class="math inline">\(s_l\)</span> are the <em>sample standard deviations</em> of the killed and living horned lizards in our sample <code>HornedLizards</code>. Lastly, <span class="math inline">\(n_k\)</span> and <span class="math inline">\(n_l\)</span> are the sample sizes of the killed and living horned lizards. Putting this together under the square root gives us the standard error <span class="math inline">\(\text{SE}_{\bar{x}_k - \bar{x}_l}\)</span>.</p>
<p>Observe that the formula for <span class="math inline">\(\text{SE}_{\bar{x}_k - \bar{x}_l}\)</span> has the sample sizes <span class="math inline">\(n_k\)</span> and <span class="math inline">\(n_l\)</span> in them. So as the sample sizes increase, the standard error goes down. We’ve seen this concept numerous times now, in particular in our simulations using the three virtual shovels with <span class="math inline">\(n\)</span> = 25, 50, and 100 slots in Figure <a href="5-sampling.html#fig:comparing-sampling-distributions-3">5.16</a> and in Subsection <a href="6-confidence-intervals.html#ci-width">6.5.3</a> where we studied the effect of using larger sample sizes on the widths of confidence intervals.</p>
<p>So how can we use the two-sample <span class="math inline">\(t\)</span>-statistic as a test statistic in our hypothesis test? First, assuming the null hypothesis <span class="math inline">\(H_0: \mu_k - \mu_l = 0\)</span> is true, the right-hand side of the numerator (to the right of the <span class="math inline">\(-\)</span> sign), <span class="math inline">\(\mu_k - \mu_l\)</span>, becomes 0.</p>
<p>Second, similarly to how the Central Limit Theorem from Subsection <a href="5-sampling.html#sampling-conclusion-central-limit-theorem">5.5</a> states that sample means follow a normal distribution, it can be mathematically proven that the two-sample <span class="math inline">\(t\)</span>-statistic follows a <em><span class="math inline">\(t\)</span> distribution with degrees of freedom</em> “roughly equal” to <span class="math inline">\(df = n_k + n_l - 2\)</span>. To better understand this concept of <em>degrees of freedom</em>, we next display three examples of <span class="math inline">\(t\)</span>-distributions in Figure <a href="7-hypothesis-testing.html#fig:t-distributions">7.20</a> along with the standard normal <span class="math inline">\(z\)</span> curve.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:t-distributions"></span>
<img src="ModernDive_files/figure-html/t-distributions-1.png" alt="Examples of t-distributions and the z curve." width="100%" />
<p class="caption">
FIGURE 7.20: Examples of t-distributions and the z curve.
</p>
</div>
<p>Begin by looking at the center of the plot at 0 on the horizontal axis. As you move up from the value of 0, follow along with the labels and note that the bottom curve corresponds to 1 degree of freedom, the curve above it is for 3 degrees of freedom, the curve above that is for 10 degrees of freedom, and lastly the dotted curve is the standard normal <span class="math inline">\(z\)</span> curve.</p>
<p>Observe that all four curves have a bell shape, are centered at 0, and that as the degrees of freedom increase, the <span class="math inline">\(t\)</span>-distribution more and more resembles the standard normal <span class="math inline">\(z\)</span> curve. The “degrees of freedom” measures how different the <span class="math inline">\(t\)</span> distribution will be from a normal distribution. <span class="math inline">\(t\)</span>-distributions tend to have more values in the tails of their distributions than the standard normal <span class="math inline">\(z\)</span> curve.</p>
<p>This “roughly equal” statement indicates that the equation <span class="math inline">\(df = n_k + n_l - 2\)</span> is a “good enough” approximation to the true degrees of freedom (although the approximation becomes weaker when the sample sizes differ significantly, as in this study). The true <a href="https://en.wikipedia.org/wiki/Student%27s_t-test#Equal_or_unequal_sample_sizes,_unequal_variances">formula</a> is a bit more complicated than this simple expression, but we’ve found the formula to be beyond the reach of those new to statistical inference and it does little to build the intuition of the <span class="math inline">\(t\)</span>-test.</p>
<p>The message to retain, however, is that small sample sizes lead to small degrees of freedom and thus small sample sizes lead to <span class="math inline">\(t\)</span>-distributions that are different than the <span class="math inline">\(z\)</span> curve. On the other hand, large sample sizes correspond to large degrees of freedom and thus produce <span class="math inline">\(t\)</span> distributions that closely align with the standard normal <span class="math inline">\(z\)</span>-curve.</p>
<p>So, assuming the null hypothesis <span class="math inline">\(H_0\)</span> is true, our formula for the test statistic simplifies a bit:</p>
<p><span class="math display">\[t = \dfrac{ (\bar{x}_k - \bar{x}_l) - 0}{ \sqrt{\dfrac{{s_k}^2}{n_k} + \dfrac{{s_l}^2}{n_l}}  } = \dfrac{ \bar{x}_k - \bar{x}_l}{ \sqrt{\dfrac{{s_k}^2}{n_k} + \dfrac{{s_l}^2}{n_l}}  }\]</span></p>
<p>Let’s compute the values necessary for this two-sample <span class="math inline">\(t\)</span>-statistic. Recall the summary statistics we computed during our exploratory data analysis in Section <a href="7-hypothesis-testing.html#imdb-data">7.5.1</a>.</p>
<div class="sourceCode" id="cb335"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb335-1"><a href="7-hypothesis-testing.html#cb335-1" tabindex="-1"></a>HornedLizards <span class="sc">%&gt;%</span> </span>
<span id="cb335-2"><a href="7-hypothesis-testing.html#cb335-2" tabindex="-1"></a>  <span class="fu">group_by</span>(group) <span class="sc">%&gt;%</span> </span>
<span id="cb335-3"><a href="7-hypothesis-testing.html#cb335-3" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n =</span> <span class="fu">n</span>(), <span class="at">mean_rating =</span> <span class="fu">mean</span>(horn.length), <span class="at">std_dev =</span> <span class="fu">sd</span>(horn.length))</span></code></pre></div>
<pre><code># A tibble: 2 × 4
  group      n mean_rating std_dev
  &lt;fct&gt;  &lt;int&gt;       &lt;dbl&gt;   &lt;dbl&gt;
1 killed    30     21.9867 2.70946
2 living   154     24.2812 2.63078</code></pre>
<p>Using these values, the observed two-sample <span class="math inline">\(t\)</span>-test statistic is</p>
<p><span class="math display">\[
\dfrac{ \bar{x}_k - \bar{x}_l}{ \sqrt{\dfrac{{s_k}^2}{n_k} + \dfrac{{s_l}^2}{n_l}}  } =
\dfrac{21.987 - 24.281}{ \sqrt{\dfrac{{2.709}^2}{30} + \dfrac{{2.631}^2}{154}}  } =
-4.263
\]</span></p>
<p>Great! How can we compute the <span class="math inline">\(p\)</span>-value using this theory-based test statistic? We need to compare it to a null distribution, which we construct next.</p>
</div>
<div id="null-distribution" class="section level3 unnumbered hasAnchor">
<h3>Null distribution<a href="7-hypothesis-testing.html#null-distribution" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s revisit the null distribution for the test statistic <span class="math inline">\(\bar{x}_k - \bar{x}_l\)</span> we constructed in Section <a href="7-hypothesis-testing.html#ht-case-study">7.5</a>. Let’s visualize this in the left-hand plot of Figure <a href="7-hypothesis-testing.html#fig:comparing-diff-means-t-stat">7.21</a>.</p>
<div class="sourceCode" id="cb337"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb337-1"><a href="7-hypothesis-testing.html#cb337-1" tabindex="-1"></a><span class="co"># Construct null distribution of xbar_a - xbar_r:</span></span>
<span id="cb337-2"><a href="7-hypothesis-testing.html#cb337-2" tabindex="-1"></a>null_distribution_HornedLizards <span class="ot">&lt;-</span> HornedLizards <span class="sc">%&gt;%</span> </span>
<span id="cb337-3"><a href="7-hypothesis-testing.html#cb337-3" tabindex="-1"></a>  <span class="fu">specify</span>(<span class="at">formula =</span> horn.length <span class="sc">~</span> group) <span class="sc">%&gt;%</span> </span>
<span id="cb337-4"><a href="7-hypothesis-testing.html#cb337-4" tabindex="-1"></a>  <span class="fu">hypothesize</span>(<span class="at">null =</span> <span class="st">&quot;independence&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb337-5"><a href="7-hypothesis-testing.html#cb337-5" tabindex="-1"></a>  <span class="fu">generate</span>(<span class="at">reps =</span> <span class="dv">1000</span>, <span class="at">type =</span> <span class="st">&quot;permute&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb337-6"><a href="7-hypothesis-testing.html#cb337-6" tabindex="-1"></a>  <span class="fu">calculate</span>(<span class="at">stat =</span> <span class="st">&quot;diff in means&quot;</span>, <span class="at">order =</span> <span class="fu">c</span>(<span class="st">&quot;killed&quot;</span>, <span class="st">&quot;living&quot;</span>))</span>
<span id="cb337-7"><a href="7-hypothesis-testing.html#cb337-7" tabindex="-1"></a><span class="fu">visualize</span>(null_distribution_HornedLizards, <span class="at">bins =</span> <span class="dv">10</span>)</span></code></pre></div>
<p>The <code>infer</code> package also includes some built-in theory-based test statistics as well. So instead of calculating the test statistic of interest as the <code>"diff in means"</code> <span class="math inline">\(\bar{x}_k - \bar{x}_l\)</span>, we can calculate this defined two-sample <span class="math inline">\(t\)</span>-statistic by setting <code>stat = "t"</code>. Let’s visualize this in the right-hand plot of Figure <a href="7-hypothesis-testing.html#fig:comparing-diff-means-t-stat">7.21</a>.</p>
<div class="sourceCode" id="cb338"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb338-1"><a href="7-hypothesis-testing.html#cb338-1" tabindex="-1"></a><span class="co"># Construct null distribution of t:</span></span>
<span id="cb338-2"><a href="7-hypothesis-testing.html#cb338-2" tabindex="-1"></a>null_distribution_HornedLizards_t <span class="ot">&lt;-</span> HornedLizards <span class="sc">%&gt;%</span> </span>
<span id="cb338-3"><a href="7-hypothesis-testing.html#cb338-3" tabindex="-1"></a>  <span class="fu">specify</span>(<span class="at">formula =</span> horn.length <span class="sc">~</span> group) <span class="sc">%&gt;%</span> </span>
<span id="cb338-4"><a href="7-hypothesis-testing.html#cb338-4" tabindex="-1"></a>  <span class="fu">hypothesize</span>(<span class="at">null =</span> <span class="st">&quot;independence&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb338-5"><a href="7-hypothesis-testing.html#cb338-5" tabindex="-1"></a>  <span class="fu">generate</span>(<span class="at">reps =</span> <span class="dv">1000</span>, <span class="at">type =</span> <span class="st">&quot;permute&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb338-6"><a href="7-hypothesis-testing.html#cb338-6" tabindex="-1"></a>  <span class="co"># Notice we switched stat from &quot;diff in means&quot; to &quot;t&quot;</span></span>
<span id="cb338-7"><a href="7-hypothesis-testing.html#cb338-7" tabindex="-1"></a>  <span class="fu">calculate</span>(<span class="at">stat =</span> <span class="st">&quot;t&quot;</span>, <span class="at">order =</span> <span class="fu">c</span>(<span class="st">&quot;killed&quot;</span>, <span class="st">&quot;living&quot;</span>))</span>
<span id="cb338-8"><a href="7-hypothesis-testing.html#cb338-8" tabindex="-1"></a><span class="fu">visualize</span>(null_distribution_HornedLizards_t, <span class="at">bins =</span> <span class="dv">10</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:comparing-diff-means-t-stat"></span>
<img src="ModernDive_files/figure-html/comparing-diff-means-t-stat-1.png" alt="Comparing the null distributions of two test statistics." width="\textwidth" />
<p class="caption">
FIGURE 7.21: Comparing the null distributions of two test statistics.
</p>
</div>
<p>Observe that while the shape of the null distributions of both the difference in means <span class="math inline">\(\bar{x}_k - \bar{x}_l\)</span> and the two-sample <span class="math inline">\(t\)</span>-statistics are similar, the scales on the x-axis are different. The two-sample <span class="math inline">\(t\)</span>-statistic values are spread out over a larger range.</p>
<p>However, a traditional theory-based <span class="math inline">\(t\)</span>-test doesn’t look at the simulated histogram in <code>null_distribution_HornedLizards_t</code>, but instead it looks at the <span class="math inline">\(t\)</span>-distribution curve with the appropriate degrees of freedom equal. Since the samples sizes here differ significantly, the degrees of freedom was calculated using the complicated formula referenced previously, and hence is significantly different from the “close enough approximation” that works when the sample sizes are equal. Let’s overlay this <span class="math inline">\(t\)</span>-distribution curve over the top of our simulated two-sample <span class="math inline">\(t\)</span>-statistics using the <code>method = "both"</code> argument in <code>visualize()</code>.</p>
<div class="sourceCode" id="cb339"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb339-1"><a href="7-hypothesis-testing.html#cb339-1" tabindex="-1"></a><span class="fu">visualize</span>(null_distribution_HornedLizards_t, <span class="at">bins =</span> <span class="dv">10</span>, <span class="at">method =</span> <span class="st">&quot;both&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:t-stat-3"></span>
<img src="ModernDive_files/figure-html/t-stat-3-1.png" alt="Null distribution using t-statistic and t-distribution." width="\textwidth" />
<p class="caption">
FIGURE 7.22: Null distribution using t-statistic and t-distribution.
</p>
</div>
<p>Observe that the curve does a good job of approximating the histogram here. To calculate the <span class="math inline">\(p\)</span>-value in this case, we need to figure out how much of the total area under the <span class="math inline">\(t\)</span>-distribution curve is at or “more extreme” than our observed two-sample <span class="math inline">\(t\)</span>-statistic. Since <span class="math inline">\(H_A: \mu_k - \mu_l \neq 0\)</span> is a two-sided alternative, we need to add up the areas in both tails.</p>
<p>We first compute the observed two-sample <span class="math inline">\(t\)</span>-statistic using <code>infer</code> verbs. This shortcut calculation further assumes that the null hypothesis is true: that the population of killed and living horned lizards have an equal average horn.length.</p>
<div class="sourceCode" id="cb340"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb340-1"><a href="7-hypothesis-testing.html#cb340-1" tabindex="-1"></a>obs_two_sample_t <span class="ot">&lt;-</span> HornedLizards <span class="sc">%&gt;%</span> </span>
<span id="cb340-2"><a href="7-hypothesis-testing.html#cb340-2" tabindex="-1"></a>  <span class="fu">specify</span>(<span class="at">formula =</span> horn.length <span class="sc">~</span> group) <span class="sc">%&gt;%</span> </span>
<span id="cb340-3"><a href="7-hypothesis-testing.html#cb340-3" tabindex="-1"></a>  <span class="fu">calculate</span>(<span class="at">stat =</span> <span class="st">&quot;t&quot;</span>, <span class="at">order =</span> <span class="fu">c</span>(<span class="st">&quot;killed&quot;</span>, <span class="st">&quot;living&quot;</span>))</span>
<span id="cb340-4"><a href="7-hypothesis-testing.html#cb340-4" tabindex="-1"></a>obs_two_sample_t</span></code></pre></div>
<pre><code>Response: horn.length (numeric)
Explanatory: group (factor)
# A tibble: 1 × 1
      stat
     &lt;dbl&gt;
1 -4.26337</code></pre>
<p>We want to find the percentage of values that are at or below <code>obs_two_sample_t</code> <span class="math inline">\(= -4.263\)</span> or at or above <code>-obs_two_sample_t</code> <span class="math inline">\(= 4.263\)</span>. We use the <code>shade_p_value()</code> function with the <code>direction</code> argument set to <code>"both"</code> to do this:</p>
<div class="sourceCode" id="cb342"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb342-1"><a href="7-hypothesis-testing.html#cb342-1" tabindex="-1"></a><span class="fu">visualize</span>(null_distribution_HornedLizards_t, <span class="at">method =</span> <span class="st">&quot;both&quot;</span>) <span class="sc">+</span></span>
<span id="cb342-2"><a href="7-hypothesis-testing.html#cb342-2" tabindex="-1"></a>  <span class="fu">shade_p_value</span>(<span class="at">obs_stat =</span> obs_two_sample_t, <span class="at">direction =</span> <span class="st">&quot;both&quot;</span>)</span></code></pre></div>
<pre><code>Warning: Check to make sure the conditions have been met for the theoretical
method. {infer} currently does not check these for you.</code></pre>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:t-stat-4"></span>
<img src="ModernDive_files/figure-html/t-stat-4-1.png" alt="Null distribution using t-statistic and t-distribution with $p$-value shaded." width="\textwidth" />
<p class="caption">
FIGURE 7.23: Null distribution using t-statistic and t-distribution with <span class="math inline">\(p\)</span>-value shaded.
</p>
</div>
<p>(We’ll discuss this warning message shortly.) What is the <span class="math inline">\(p\)</span>-value? We apply <code>get_p_value()</code> to our null distribution saved in <code>null_distribution_HornedLizards_t</code>:</p>
<div class="sourceCode" id="cb344"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb344-1"><a href="7-hypothesis-testing.html#cb344-1" tabindex="-1"></a>null_distribution_HornedLizards_t <span class="sc">%&gt;%</span> </span>
<span id="cb344-2"><a href="7-hypothesis-testing.html#cb344-2" tabindex="-1"></a>  <span class="fu">get_p_value</span>(<span class="at">obs_stat =</span> obs_two_sample_t, <span class="at">direction =</span> <span class="st">&quot;both&quot;</span>)</span></code></pre></div>
<pre><code># A tibble: 1 × 1
  p_value
    &lt;dbl&gt;
1       0</code></pre>
<p>We have a very small <span class="math inline">\(p\)</span>-value, and thus it is very unlikely that these results are due to <em>sampling variation</em>. Thus, we are inclined to reject <span class="math inline">\(H_0\)</span>.</p>
<p>Let’s come back to that earlier warning message: <code>Check to make sure the conditions have been met for the theoretical method. {infer} currently does not check these for you.</code> To be able to use the <span class="math inline">\(t\)</span>-test and other such theoretical methods, there are always a few conditions to check. The <code>infer</code> package does not automatically check these conditions, hence the warning message we received. These conditions are necessary so that the underlying mathematical theory holds. In order for the results of our two-sample <span class="math inline">\(t\)</span>-test to be valid, three conditions must be met:</p>
<ol style="list-style-type: decimal">
<li>Nearly normal populations or large sample sizes. A general rule of thumb that works in many (but not all) situations is that the sample size <span class="math inline">\(n\)</span> should be greater than 30.</li>
<li>Both samples are selected independently of each other.</li>
<li>All observations are independent from each other.</li>
</ol>
<p>Let’s see if these conditions hold for our <code>HornedLizards</code> data:</p>
<ol style="list-style-type: decimal">
<li>This is met since <span class="math inline">\(n_k\)</span> = 30 and <span class="math inline">\(n_l\)</span> = 154 are both 30 or larger, satisfying our rule of thumb.</li>
<li>This is presumably met since we sampled the killed and living horned lizards at random and in an unbiased fashion from the populatiion of all horned lizards.</li>
<li>Unfortunately, we can’t be sure that observations are completely independent of each other. For example, if living horned lizards were all found at one location, then those observations might be related and hence not independent.</li>
</ol>
<p>Assuming all three conditions are roughly met, we can be reasonably certain that the theory-based <span class="math inline">\(t\)</span>-test results are valid. If any of the conditions were clearly not met, we couldn’t put as much trust into any conclusions reached. On the other hand, in most scenarios, the only assumption that needs to be met in the simulation-based method is that the sample is selected at random. Thus, in our experience, we prefer simulation-based methods as they have fewer assumptions, are conceptually easier to understand, and since computing power has recently become easily accessible, they can be run quickly. That being said since much of the world’s research still relies on traditional theory-based methods, we also believe it is important to understand them.</p>
<p>You may be wondering why we chose <code>reps = 1000</code> for these simulation-based methods. We’ve noticed that after around 1000 replicates for the null distribution and the bootstrap distribution for most problems you can start to get a general sense for how the statistic behaves. You can change this value to something like 10,000 though for <code>reps</code> if you would like even finer detail but this will take more time to compute. Feel free to iterate on this as you like to get an even better idea about the shape of the null and bootstrap distributions as you wish.</p>
</div>
</div>
<div id="problems-with-p-values" class="section level2 hasAnchor" number="7.7">
<h2><span class="header-section-number">7.7</span> Problems with p-values<a href="7-hypothesis-testing.html#problems-with-p-values" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>On top of the many common misunderstandings about hypothesis testing and <span class="math inline">\(p\)</span>-values we listed in Section <a href="7-hypothesis-testing.html#ht-interpretation">7.4</a>, another unfortunate consequence of the expanded use of <span class="math inline">\(p\)</span>-values and hypothesis testing is a phenomenon known as “p-hacking.” p-hacking is the act of “cherry-picking” only results that are “statistically significant” while dismissing those that aren’t, even if at the expense of the scientific ideas. There are lots of articles written recently about misunderstandings and the problems with <span class="math inline">\(p\)</span>-values. We encourage you to check some of them out:</p>
<ol style="list-style-type: decimal">
<li><a href="https://en.wikipedia.org/wiki/Misunderstandings_of_p-values">Misunderstandings of <span class="math inline">\(p\)</span>-values</a></li>
<li><a href="https://www.vox.com/science-and-health/2017/7/31/16021654/p-values-statistical-significance-redefine-0005">What a nerdy debate about <span class="math inline">\(p\)</span>-values shows about science - and how to fix it</a></li>
<li><a href="https://www.nature.com/news/statisticians-issue-warning-over-misuse-of-p-values-1.19503">Statisticians issue warning over misuse of <span class="math inline">\(P\)</span> values</a></li>
<li><a href="https://fivethirtyeight.com/features/you-cant-trust-what-you-read-about-nutrition/">You Can’t Trust What You Read About Nutrition</a></li>
<li><a href="http://www.fharrell.com/post/pval-litany/">A Litany of Problems with p-values</a></li>
</ol>
<p>Such issues were getting so problematic that the American Statistical Association (ASA) put out a statement in 2016 titled, <a href="https://www.amstat.org/asa/files/pdfs/P-ValueStatement.pdf">“The ASA Statement on Statistical Significance and <span class="math inline">\(P\)</span>-Values,”</a> with six principles underlying the proper use and interpretation of <span class="math inline">\(p\)</span>-values. The ASA released this guidance on <span class="math inline">\(p\)</span>-values to improve the conduct and interpretation of quantitative science and to inform the growing emphasis on reproducibility of science research.</p>
<p>We as authors much prefer the use of confidence intervals for statistical inference, since in our opinion they are much less prone to large misinterpretation. However, many fields still exclusively use <span class="math inline">\(p\)</span>-values for statistical inference and this is one reason for including them in this text. We encourage you to learn more about “p-hacking” as well and its implication for science.</p>
</div>
<div id="nhst-conclusion" class="section level2 hasAnchor" number="7.8">
<h2><span class="header-section-number">7.8</span> Conclusion<a href="7-hypothesis-testing.html#nhst-conclusion" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="review">
<p>
<strong><em>Chapter Learning Summary</em></strong>
</p>
<ul>
<li>
Hypothesis testing is used to determine how likely an observed
difference of a test statistic between two groups is due to
chance.<br />
</li>
<li>
A statistical hypothesis states the expected values of an unknown
population parameter.<br />
</li>
<li>
The null hypothesis supposes that there is no difference of
interest; the alternative hypothesis supposes that there is a difference
of interest.<br />
</li>
<li>
The null distribution is the sampling distribution of a test
statistic in a hypothesized universe where there is no difference
between the two groups.<br />
</li>
<li>
The null distribution of a test statistic can be calculated using
computer simulations or theories based on mathematical formulas.<br />
</li>
<li>
Permutations (shuffling) are a form of resampling without
replacement.<br />
</li>
<li>
Hypothesis testing compares the observed test statistic to its null
distribution to determine the likelihood of the observed value (or more
extreme values) assuming the null hypothesis is true.<br />
</li>
<li>
If the p-value is below a pre-selected threshold, called the
significance level or alpha, then the null hypothesis is rejected;
otherwise, it cannot be rejected (which doesn’t mean that it’s
accepted).<br />
</li>
<li>
Computer-based methods of hypothesis testing with different test
statistics use one consistent framework and require fewer specific
conditions compared to theory-based methods.<br />
</li>
<li>
A Type I error (false positive) occurs when the null hypothesis is
rejected although it is actually true; the probability of a type I error
is denoted by alpha.<br />
</li>
<li>
A type II error (false negative) occurs when the null hypothesis is
not rejected although it is not true; the probability of a type II error
is denoted by beta.<br />
</li>
<li>
Power, 1 - beta, is the probability of rejecting the null hypothesis
when it is not true (true positive).<br />
</li>
<li>
The theory-based method of hypothesis testing uses probability
models, probability distributions and some assumptions to construct the
null distribution.<br />
</li>
<li>
Compared to computer based methods, theory-based methods require
that additional conditions be met to trust the conclusions.<br />
</li>
<li>
While p-values are commonly used as evidence for scientific
conclusions, they can be easily misunderstood or even misused; in
contrast, confidence intervals better indicate the uncertainty
associated with a sample statistic.<br />
</li>
</ul>
</div>
<div id="additional-resources-5" class="section level3 hasAnchor" number="7.8.1">
<h3><span class="header-section-number">7.8.1</span> Additional resources<a href="7-hypothesis-testing.html#additional-resources-5" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For more examples of the <code>infer</code> workflow for conducting hypothesis tests, we suggest you check out the <code>infer</code> package homepage, in particular, a series of example analyses available at <a href="https://infer.netlify.app/articles/" class="uri">https://infer.netlify.app/articles/</a>.</p>
<p><strong>(LC7.15)</strong> In Section <a href="7-hypothesis-testing.html#ht-activity">7.1</a>, you used “diff in props” to conduct a hypothesis test comparing two proportions (malaria rates in control and experimental birds). Referring to the <a href="https://infer.netlify.app/articles/observed_stat_examples.html">“Full infer Pipeline Examples”</a> article, what other test statistics can be used to compare two proportions? (Hint: Click “Hypothesis tests” in the right side bar and then select from the Contents listed.)</p>
<p><strong>(LC7.16)</strong> The case study in Section <a href="5-sampling.html#sampling-case-study">5.4</a> examined if a sample of <em>Drosophila</em> fruit flies produced the expected Mendelian proportions of 3/4 dominant phenotype to 1/4 recessive phenotype. Referring to the <a href="https://infer.netlify.app/articles/observed_stat_examples.html">“Full infer Pipeline Examples”</a> article, what test statistics can be used to compare the observed phenotypic proportions to the expected?</p>
<p><strong>(LC7.17)</strong> The case study in Section <a href="7-hypothesis-testing.html#ht-case-study">7.5</a> asked if living lizards have longer horns than dead lizards. Referring to the <a href="https://infer.netlify.app/articles/observed_stat_examples.html">“Full infer Pipeline Examples”</a> article, what other test statistic, besides “diff in means” and “t”, could be used to compare horn length in the two groups?</p>
<p><strong>(LC7.18)</strong> The case study in Section <a href="7-hypothesis-testing.html#ht-case-study">7.5</a> compared the means of two populations. Referring to the <a href="https://infer.netlify.app/articles/observed_stat_examples.html">“Full infer Pipeline Examples”</a> article, what test statistic can be used to compare the means of more than two groups?</p>
</div>
<div id="whats-to-come-6" class="section level3 hasAnchor" number="7.8.2">
<h3><span class="header-section-number">7.8.2</span> What’s to come<a href="7-hypothesis-testing.html#whats-to-come-6" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We conclude with the <code>infer</code> pipeline for hypothesis testing in Figure <a href="7-hypothesis-testing.html#fig:infer-workflow-ht">7.24</a>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:infer-workflow-ht"></span>
<img src="images/flowcharts/infer/ht_diagram_trimmed.png" alt="infer package workflow for hypothesis testing." width="100%" height="100%" />
<p class="caption">
FIGURE 7.24: infer package workflow for hypothesis testing.
</p>
</div>
<p>We’ll now move to the “Data modeling with moderndive” portion of this book in Chapters <a href="8-regression.html#regression">8</a> and <a href="10-multiple-regression.html#multiple-regression">10</a>, where you’ll leverage your data visualization and wrangling skills to model relationships between different variables in data frames. Then, you’ll use your understanding of confidence intervals from Chapter <a href="6-confidence-intervals.html#confidence-intervals">6</a> and hypothesis tests from this chapter, to explore inference for regression in Chapter <a href="9-inference-for-regression.html#inference-for-regression">9</a>.</p>
<p>Onwards and upwards into Data Modeling as shown in Figure <a href="7-hypothesis-testing.html#fig:part3">7.25</a>!</p>
<p><em>ModernDive for Life Scientists</em> flowchart - on to Part II! <em>ModernDive for Life Scientists</em> flowchart - on to Part III!</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:part3"></span>
<img src="images/flowcharts/flowchart/flowchart_ModDiveLifeSci_04.png" alt="ModernDive for Life Scientists flowchart - on to Part II!" width="\textwidth" />
<p class="caption">
FIGURE 7.25: <em>ModernDive for Life Scientists</em> flowchart - on to Part II!
</p>
</div>


</div>
</div>
</div>



            </section>

          </div>
        </div>
      </div>
<a href="6-confidence-intervals.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="8-regression.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/moderndive/moderndive_book/edit/master/07-hypothesis-testing.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
