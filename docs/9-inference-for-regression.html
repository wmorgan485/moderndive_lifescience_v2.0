<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 9 Inference for Regression | Modern Biological Data Analysis</title>
  <meta name="description" content="An open-source and fully-reproducible electronic textbook for teaching statistical inference using tidyverse data science tools." />
  <meta name="generator" content="bookdown 0.35 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 9 Inference for Regression | Modern Biological Data Analysis" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://moderndive.com//images/logos/book_cover.png" />
  <meta property="og:description" content="An open-source and fully-reproducible electronic textbook for teaching statistical inference using tidyverse data science tools." />
  <meta name="github-repo" content="moderndive/ModernDive_book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 9 Inference for Regression | Modern Biological Data Analysis" />
  <meta name="twitter:site" content="@ModernDive" />
  <meta name="twitter:description" content="An open-source and fully-reproducible electronic textbook for teaching statistical inference using tidyverse data science tools." />
  <meta name="twitter:image" content="https://moderndive.com//images/logos/book_cover.png" />

<meta name="author" content="Chester Ismay and Albert Y. Kim   Foreword by Kelly S. McConville   Adapted by William R. Morgan" />


<meta name="date" content="2023-10-22" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  <link rel="apple-touch-icon-precomposed" sizes="152x152" href="images/logos/favicons/apple-touch-icon.png" />
  <link rel="shortcut icon" href="images/logos/favicons/favicon.ico" type="image/x-icon" />
<link rel="prev" href="8-regression.html"/>
<link rel="next" href="10-multiple-regression.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<link href="libs/dygraphs-1.1.1/dygraph.css" rel="stylesheet" />
<script src="libs/dygraphs-1.1.1/dygraph-combined.js"></script>
<script src="libs/dygraphs-1.1.1/shapes.js"></script>
<script src="libs/moment-2.8.4/moment.js"></script>
<script src="libs/moment-timezone-0.2.5/moment-timezone-with-data.js"></script>
<script src="libs/moment-fquarter-1.0.0/moment-fquarter.min.js"></script>
<script src="libs/dygraphs-binding-1.1.1.6/dygraphs.js"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-89938436-1', 'auto');
  ga('send', 'pageview');

</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>ModernDive for Life Scientists</a></li>
<li class="chapter" data-level="" data-path="foreword.html"><a href="foreword.html"><i class="fa fa-check"></i>Foreword</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#introduction-for-students"><i class="fa fa-check"></i>Introduction for students</a>
<ul>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#what-we-hope-you-will-learn-from-this-book"><i class="fa fa-check"></i>What we hope you will learn from this book</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#datascience-pipeline"><i class="fa fa-check"></i>Data/science pipeline</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#reproducible-research"><i class="fa fa-check"></i>Reproducible research</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#final-note-for-students"><i class="fa fa-check"></i>Final note for students</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#introduction-for-instructors"><i class="fa fa-check"></i>Introduction for instructors</a>
<ul>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#resources"><i class="fa fa-check"></i>Resources</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#why-did-we-write-this-book"><i class="fa fa-check"></i>Why did we write this book?</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#who-is-this-book-for"><i class="fa fa-check"></i>Who is this book for?</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#connect-and-contribute"><i class="fa fa-check"></i>Connect and contribute</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#acknowledgements"><i class="fa fa-check"></i>Acknowledgements</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#about-this-book"><i class="fa fa-check"></i>About this book</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="about-the-authors.html"><a href="about-the-authors.html"><i class="fa fa-check"></i>About the authors</a></li>
<li class="chapter" data-level="" data-path="about-the-adapting-author.html"><a href="about-the-adapting-author.html"><i class="fa fa-check"></i>About the adapting author</a></li>
<li class="chapter" data-level="1" data-path="1-getting-started.html"><a href="1-getting-started.html"><i class="fa fa-check"></i><b>1</b> Getting Started with Data in R</a>
<ul>
<li class="chapter" data-level="1.1" data-path="1-getting-started.html"><a href="1-getting-started.html#r-rstudio"><i class="fa fa-check"></i><b>1.1</b> What are R and RStudio?</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="1-getting-started.html"><a href="1-getting-started.html#installing"><i class="fa fa-check"></i><b>1.1.1</b> Installing R and RStudio</a></li>
<li class="chapter" data-level="1.1.2" data-path="1-getting-started.html"><a href="1-getting-started.html#using-r-via-rstudio"><i class="fa fa-check"></i><b>1.1.2</b> Using R via RStudio</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="1-getting-started.html"><a href="1-getting-started.html#code"><i class="fa fa-check"></i><b>1.2</b> How do I code in R?</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="1-getting-started.html"><a href="1-getting-started.html#programming-concepts"><i class="fa fa-check"></i><b>1.2.1</b> Basic programming concepts and terminology</a></li>
<li class="chapter" data-level="1.2.2" data-path="1-getting-started.html"><a href="1-getting-started.html#messages"><i class="fa fa-check"></i><b>1.2.2</b> Errors, warnings, and messages</a></li>
<li class="chapter" data-level="1.2.3" data-path="1-getting-started.html"><a href="1-getting-started.html#tips-code"><i class="fa fa-check"></i><b>1.2.3</b> Tips on learning to code</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="1-getting-started.html"><a href="1-getting-started.html#packages"><i class="fa fa-check"></i><b>1.3</b> What are R packages?</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="1-getting-started.html"><a href="1-getting-started.html#package-installation"><i class="fa fa-check"></i><b>1.3.1</b> Package installation</a></li>
<li class="chapter" data-level="1.3.2" data-path="1-getting-started.html"><a href="1-getting-started.html#package-loading"><i class="fa fa-check"></i><b>1.3.2</b> Package loading</a></li>
<li class="chapter" data-level="1.3.3" data-path="1-getting-started.html"><a href="1-getting-started.html#package-use"><i class="fa fa-check"></i><b>1.3.3</b> Package use</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="1-getting-started.html"><a href="1-getting-started.html#mammalsdb"><i class="fa fa-check"></i><b>1.4</b> Explore your first data sets</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="1-getting-started.html"><a href="1-getting-started.html#openintropackage"><i class="fa fa-check"></i><b>1.4.1</b> <code>openintro</code> package</a></li>
<li class="chapter" data-level="1.4.2" data-path="1-getting-started.html"><a href="1-getting-started.html#mammalsdataframe"><i class="fa fa-check"></i><b>1.4.2</b> <code>mammals</code> data frame</a></li>
<li class="chapter" data-level="1.4.3" data-path="1-getting-started.html"><a href="1-getting-started.html#exploredataframes"><i class="fa fa-check"></i><b>1.4.3</b> Exploring data frames</a></li>
<li class="chapter" data-level="1.4.4" data-path="1-getting-started.html"><a href="1-getting-started.html#identification-vs-measurement-variables"><i class="fa fa-check"></i><b>1.4.4</b> Identification and measurement variables</a></li>
<li class="chapter" data-level="1.4.5" data-path="1-getting-started.html"><a href="1-getting-started.html#help-files"><i class="fa fa-check"></i><b>1.4.5</b> Help files</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="1-getting-started.html"><a href="1-getting-started.html#csv"><i class="fa fa-check"></i><b>1.5</b> Importing data</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="1-getting-started.html"><a href="1-getting-started.html#using-the-console"><i class="fa fa-check"></i><b>1.5.1</b> Using the console</a></li>
<li class="chapter" data-level="1.5.2" data-path="1-getting-started.html"><a href="1-getting-started.html#using-rstudios-interface"><i class="fa fa-check"></i><b>1.5.2</b> Using RStudio’s interface</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="1-getting-started.html"><a href="1-getting-started.html#conclusion"><i class="fa fa-check"></i><b>1.6</b> Conclusion</a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="1-getting-started.html"><a href="1-getting-started.html#additional-resources"><i class="fa fa-check"></i><b>1.6.1</b> Additional resources</a></li>
<li class="chapter" data-level="1.6.2" data-path="1-getting-started.html"><a href="1-getting-started.html#whats-to-come"><i class="fa fa-check"></i><b>1.6.2</b> What’s to come?</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>I Data Science with tidyverse</b></span></li>
<li class="chapter" data-level="2" data-path="2-viz.html"><a href="2-viz.html"><i class="fa fa-check"></i><b>2</b> Data Visualization</a>
<ul>
<li class="chapter" data-level="" data-path="2-viz.html"><a href="2-viz.html#needed-packages"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="2.1" data-path="2-viz.html"><a href="2-viz.html#grammarofgraphics"><i class="fa fa-check"></i><b>2.1</b> The grammar of graphics</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="2-viz.html"><a href="2-viz.html#components-of-the-grammar"><i class="fa fa-check"></i><b>2.1.1</b> Components of the grammar</a></li>
<li class="chapter" data-level="2.1.2" data-path="2-viz.html"><a href="2-viz.html#gapminder"><i class="fa fa-check"></i><b>2.1.2</b> Gapminder data</a></li>
<li class="chapter" data-level="2.1.3" data-path="2-viz.html"><a href="2-viz.html#other-components"><i class="fa fa-check"></i><b>2.1.3</b> Other components</a></li>
<li class="chapter" data-level="2.1.4" data-path="2-viz.html"><a href="2-viz.html#ggplot2-package"><i class="fa fa-check"></i><b>2.1.4</b> ggplot2 package</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="2-viz.html"><a href="2-viz.html#FiveNG"><i class="fa fa-check"></i><b>2.2</b> Five named graphs - the 5NG</a></li>
<li class="chapter" data-level="2.3" data-path="2-viz.html"><a href="2-viz.html#scatterplots"><i class="fa fa-check"></i><b>2.3</b> 5NG#1: Scatterplots</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="2-viz.html"><a href="2-viz.html#geompoint"><i class="fa fa-check"></i><b>2.3.1</b> Scatterplots via <code>geom_point</code></a></li>
<li class="chapter" data-level="2.3.2" data-path="2-viz.html"><a href="2-viz.html#overplotting"><i class="fa fa-check"></i><b>2.3.2</b> Overplotting</a></li>
<li class="chapter" data-level="2.3.3" data-path="2-viz.html"><a href="2-viz.html#summary"><i class="fa fa-check"></i><b>2.3.3</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="2-viz.html"><a href="2-viz.html#linegraphs"><i class="fa fa-check"></i><b>2.4</b> 5NG#2: Linegraphs</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="2-viz.html"><a href="2-viz.html#geomline"><i class="fa fa-check"></i><b>2.4.1</b> Linegraphs via <code>geom_line</code></a></li>
<li class="chapter" data-level="2.4.2" data-path="2-viz.html"><a href="2-viz.html#summary-1"><i class="fa fa-check"></i><b>2.4.2</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="2-viz.html"><a href="2-viz.html#histograms"><i class="fa fa-check"></i><b>2.5</b> 5NG#3: Histograms</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="2-viz.html"><a href="2-viz.html#geomhistogram"><i class="fa fa-check"></i><b>2.5.1</b> Histograms via <code>geom_histogram</code></a></li>
<li class="chapter" data-level="2.5.2" data-path="2-viz.html"><a href="2-viz.html#adjustbins"><i class="fa fa-check"></i><b>2.5.2</b> Adjusting the bins</a></li>
<li class="chapter" data-level="2.5.3" data-path="2-viz.html"><a href="2-viz.html#summary-2"><i class="fa fa-check"></i><b>2.5.3</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="2-viz.html"><a href="2-viz.html#facets"><i class="fa fa-check"></i><b>2.6</b> Facets</a></li>
<li class="chapter" data-level="2.7" data-path="2-viz.html"><a href="2-viz.html#boxplots"><i class="fa fa-check"></i><b>2.7</b> 5NG#4: Boxplots</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="2-viz.html"><a href="2-viz.html#geomboxplot"><i class="fa fa-check"></i><b>2.7.1</b> Boxplots via <code>geom_boxplot</code></a></li>
<li class="chapter" data-level="2.7.2" data-path="2-viz.html"><a href="2-viz.html#summary-3"><i class="fa fa-check"></i><b>2.7.2</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="2-viz.html"><a href="2-viz.html#geombar"><i class="fa fa-check"></i><b>2.8</b> 5NG#5: Barplots</a>
<ul>
<li class="chapter" data-level="2.8.1" data-path="2-viz.html"><a href="2-viz.html#barplots-via-geom_bar-or-geom_col"><i class="fa fa-check"></i><b>2.8.1</b> Barplots via <code>geom_bar</code> or <code>geom_col</code></a></li>
<li class="chapter" data-level="2.8.2" data-path="2-viz.html"><a href="2-viz.html#two-categ-barplot"><i class="fa fa-check"></i><b>2.8.2</b> Two categorical variables</a></li>
<li class="chapter" data-level="2.8.3" data-path="2-viz.html"><a href="2-viz.html#summary-4"><i class="fa fa-check"></i><b>2.8.3</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="2-viz.html"><a href="2-viz.html#plots-to-avoid"><i class="fa fa-check"></i><b>2.9</b> Plots to avoid!</a>
<ul>
<li class="chapter" data-level="2.9.1" data-path="2-viz.html"><a href="2-viz.html#barplots-with-a-continuous-variable"><i class="fa fa-check"></i><b>2.9.1</b> Barplots with a continuous variable</a></li>
<li class="chapter" data-level="2.9.2" data-path="2-viz.html"><a href="2-viz.html#pie-charts"><i class="fa fa-check"></i><b>2.9.2</b> Pie charts</a></li>
</ul></li>
<li class="chapter" data-level="2.10" data-path="2-viz.html"><a href="2-viz.html#data-vis-conclusion"><i class="fa fa-check"></i><b>2.10</b> Conclusion</a>
<ul>
<li class="chapter" data-level="2.10.1" data-path="2-viz.html"><a href="2-viz.html#summary-table"><i class="fa fa-check"></i><b>2.10.1</b> Summary table</a></li>
<li class="chapter" data-level="2.10.2" data-path="2-viz.html"><a href="2-viz.html#function-argument-specification"><i class="fa fa-check"></i><b>2.10.2</b> Function argument specification</a></li>
<li class="chapter" data-level="2.10.3" data-path="2-viz.html"><a href="2-viz.html#additional-resources-1"><i class="fa fa-check"></i><b>2.10.3</b> Additional resources</a></li>
<li class="chapter" data-level="2.10.4" data-path="2-viz.html"><a href="2-viz.html#whats-to-come-3"><i class="fa fa-check"></i><b>2.10.4</b> What’s to come</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="3-wrangling.html"><a href="3-wrangling.html"><i class="fa fa-check"></i><b>3</b> Data Wrangling</a>
<ul>
<li class="chapter" data-level="" data-path="3-wrangling.html"><a href="3-wrangling.html#wrangling-packages"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="3.1" data-path="3-wrangling.html"><a href="3-wrangling.html#piping"><i class="fa fa-check"></i><b>3.1</b> The pipe operator: <code>%&gt;%</code></a></li>
<li class="chapter" data-level="3.2" data-path="3-wrangling.html"><a href="3-wrangling.html#filter"><i class="fa fa-check"></i><b>3.2</b> <code>filter</code> rows</a></li>
<li class="chapter" data-level="3.3" data-path="3-wrangling.html"><a href="3-wrangling.html#slice-rows"><i class="fa fa-check"></i><b>3.3</b> <code>slice</code> rows</a></li>
<li class="chapter" data-level="3.4" data-path="3-wrangling.html"><a href="3-wrangling.html#select"><i class="fa fa-check"></i><b>3.4</b> <code>select</code> variables</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="3-wrangling.html"><a href="3-wrangling.html#rename"><i class="fa fa-check"></i><b>3.4.1</b> <code>rename</code> variables</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="3-wrangling.html"><a href="3-wrangling.html#summarize"><i class="fa fa-check"></i><b>3.5</b> <code>summarize</code> variables</a></li>
<li class="chapter" data-level="3.6" data-path="3-wrangling.html"><a href="3-wrangling.html#groupby"><i class="fa fa-check"></i><b>3.6</b> <code>group_by</code> rows</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="3-wrangling.html"><a href="3-wrangling.html#grouping-by-more-than-one-variable"><i class="fa fa-check"></i><b>3.6.1</b> Grouping by more than one variable</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="3-wrangling.html"><a href="3-wrangling.html#mutate"><i class="fa fa-check"></i><b>3.7</b> <code>mutate</code> existing variables</a></li>
<li class="chapter" data-level="3.8" data-path="3-wrangling.html"><a href="3-wrangling.html#arrange"><i class="fa fa-check"></i><b>3.8</b> <code>arrange</code> and sort rows</a></li>
<li class="chapter" data-level="3.9" data-path="3-wrangling.html"><a href="3-wrangling.html#wrangling-conclusion"><i class="fa fa-check"></i><b>3.9</b> Conclusion</a>
<ul>
<li class="chapter" data-level="3.9.1" data-path="3-wrangling.html"><a href="3-wrangling.html#summary-table-1"><i class="fa fa-check"></i><b>3.9.1</b> Summary table</a></li>
<li class="chapter" data-level="3.9.2" data-path="3-wrangling.html"><a href="3-wrangling.html#additional-resources-2"><i class="fa fa-check"></i><b>3.9.2</b> Additional resources</a></li>
<li class="chapter" data-level="3.9.3" data-path="3-wrangling.html"><a href="3-wrangling.html#whats-to-come-1"><i class="fa fa-check"></i><b>3.9.3</b> What’s to come?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="4-tidy.html"><a href="4-tidy.html"><i class="fa fa-check"></i><b>4</b> “Tidy” Data</a>
<ul>
<li class="chapter" data-level="" data-path="4-tidy.html"><a href="4-tidy.html#tidy-packages"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="4.1" data-path="4-tidy.html"><a href="4-tidy.html#tidy-data-ex"><i class="fa fa-check"></i><b>4.1</b> “Tidy” data</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="4-tidy.html"><a href="4-tidy.html#tidy-definition"><i class="fa fa-check"></i><b>4.1.1</b> Definition of “tidy” data</a></li>
<li class="chapter" data-level="4.1.2" data-path="4-tidy.html"><a href="4-tidy.html#converting-to-tidy-data"><i class="fa fa-check"></i><b>4.1.2</b> Converting to “tidy” data</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="4-tidy.html"><a href="4-tidy.html#case-study-tidy"><i class="fa fa-check"></i><b>4.2</b> Case study: Weight loss data</a></li>
<li class="chapter" data-level="4.3" data-path="4-tidy.html"><a href="4-tidy.html#tidyverse-package"><i class="fa fa-check"></i><b>4.3</b> <code>tidyverse</code> package</a></li>
<li class="chapter" data-level="4.4" data-path="4-tidy.html"><a href="4-tidy.html#tidy-data-conclusion"><i class="fa fa-check"></i><b>4.4</b> Conclusion</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="4-tidy.html"><a href="4-tidy.html#additional-resources-3"><i class="fa fa-check"></i><b>4.4.1</b> Additional resources</a></li>
<li class="chapter" data-level="4.4.2" data-path="4-tidy.html"><a href="4-tidy.html#whats-to-come-2"><i class="fa fa-check"></i><b>4.4.2</b> What’s to come?</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Statistical Inference with infer</b></span></li>
<li class="chapter" data-level="5" data-path="5-sampling.html"><a href="5-sampling.html"><i class="fa fa-check"></i><b>5</b> Sampling</a>
<ul>
<li class="chapter" data-level="" data-path="5-sampling.html"><a href="5-sampling.html#sampling-packages"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="5.1" data-path="5-sampling.html"><a href="5-sampling.html#sampling-activity"><i class="fa fa-check"></i><b>5.1</b> Sampling bowl activity</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="5-sampling.html"><a href="5-sampling.html#what-proportion-of-this-bowls-balls-are-red"><i class="fa fa-check"></i><b>5.1.1</b> What proportion of this bowl’s balls are red?</a></li>
<li class="chapter" data-level="5.1.2" data-path="5-sampling.html"><a href="5-sampling.html#using-the-shovel-once"><i class="fa fa-check"></i><b>5.1.2</b> Using the shovel once</a></li>
<li class="chapter" data-level="5.1.3" data-path="5-sampling.html"><a href="5-sampling.html#student-shovels"><i class="fa fa-check"></i><b>5.1.3</b> Using the shovel 33 times</a></li>
<li class="chapter" data-level="5.1.4" data-path="5-sampling.html"><a href="5-sampling.html#sampling-what-did-we-just-do"><i class="fa fa-check"></i><b>5.1.4</b> What did we just do?</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="5-sampling.html"><a href="5-sampling.html#sampling-simulation"><i class="fa fa-check"></i><b>5.2</b> Virtual sampling</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="5-sampling.html"><a href="5-sampling.html#using-the-virtual-shovel-once"><i class="fa fa-check"></i><b>5.2.1</b> Using the virtual shovel once</a></li>
<li class="chapter" data-level="5.2.2" data-path="5-sampling.html"><a href="5-sampling.html#using-the-virtual-shovel-33-times"><i class="fa fa-check"></i><b>5.2.2</b> Using the virtual shovel 33 times</a></li>
<li class="chapter" data-level="5.2.3" data-path="5-sampling.html"><a href="5-sampling.html#shovel-1000-times"><i class="fa fa-check"></i><b>5.2.3</b> Using the virtual shovel 1000 times</a></li>
<li class="chapter" data-level="5.2.4" data-path="5-sampling.html"><a href="5-sampling.html#the-normal-distribution"><i class="fa fa-check"></i><b>5.2.4</b> The Normal Distribution</a></li>
<li class="chapter" data-level="5.2.5" data-path="5-sampling.html"><a href="5-sampling.html#different-shovels"><i class="fa fa-check"></i><b>5.2.5</b> Using different shovels</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="5-sampling.html"><a href="5-sampling.html#sampling-framework"><i class="fa fa-check"></i><b>5.3</b> Sampling framework</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="5-sampling.html"><a href="5-sampling.html#terminology-and-notation"><i class="fa fa-check"></i><b>5.3.1</b> Terminology and notation</a></li>
<li class="chapter" data-level="5.3.2" data-path="5-sampling.html"><a href="5-sampling.html#sampling-definitions"><i class="fa fa-check"></i><b>5.3.2</b> Statistical definitions</a></li>
<li class="chapter" data-level="5.3.3" data-path="5-sampling.html"><a href="5-sampling.html#moral-of-the-story"><i class="fa fa-check"></i><b>5.3.3</b> The moral of the story</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="5-sampling.html"><a href="5-sampling.html#sampling-case-study"><i class="fa fa-check"></i><b>5.4</b> Case study: Genetic crosses</a></li>
<li class="chapter" data-level="5.5" data-path="5-sampling.html"><a href="5-sampling.html#sampling-conclusion-central-limit-theorem"><i class="fa fa-check"></i><b>5.5</b> Central Limit Theorem</a></li>
<li class="chapter" data-level="5.6" data-path="5-sampling.html"><a href="5-sampling.html#sampling-conclusion-table"><i class="fa fa-check"></i><b>5.6</b> Sampling scenarios</a></li>
<li class="chapter" data-level="5.7" data-path="5-sampling.html"><a href="5-sampling.html#sampling-conclusion"><i class="fa fa-check"></i><b>5.7</b> Conclusion</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="5-sampling.html"><a href="5-sampling.html#whats-to-come-4"><i class="fa fa-check"></i><b>5.7.1</b> What’s to come?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html"><i class="fa fa-check"></i><b>6</b> Bootstrapping and Confidence Intervals</a>
<ul>
<li class="chapter" data-level="" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#CI-packages"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="6.1" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#resampling-tactile"><i class="fa fa-check"></i><b>6.1</b> Pennies activity</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#what-is-the-average-year-on-us-pennies-in-2019"><i class="fa fa-check"></i><b>6.1.1</b> What is the average year on US pennies in 2019?</a></li>
<li class="chapter" data-level="6.1.2" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#resampling-once"><i class="fa fa-check"></i><b>6.1.2</b> Resampling once</a></li>
<li class="chapter" data-level="6.1.3" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#student-resamples"><i class="fa fa-check"></i><b>6.1.3</b> Resampling 35 times</a></li>
<li class="chapter" data-level="6.1.4" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#ci-what-did-we-just-do"><i class="fa fa-check"></i><b>6.1.4</b> What did we just do?</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#resampling-simulation"><i class="fa fa-check"></i><b>6.2</b> Computer simulation of resampling</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#virtually-resampling-once"><i class="fa fa-check"></i><b>6.2.1</b> Virtually resampling once</a></li>
<li class="chapter" data-level="6.2.2" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#bootstrap-35-replicates"><i class="fa fa-check"></i><b>6.2.2</b> Virtually resampling 35 times</a></li>
<li class="chapter" data-level="6.2.3" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#bootstrap-1000-replicates"><i class="fa fa-check"></i><b>6.2.3</b> Virtually resampling 1000 times</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#ci-build-up"><i class="fa fa-check"></i><b>6.3</b> Understanding confidence intervals</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#percentile-method"><i class="fa fa-check"></i><b>6.3.1</b> Percentile method</a></li>
<li class="chapter" data-level="6.3.2" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#se-method"><i class="fa fa-check"></i><b>6.3.2</b> Standard error method</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#bootstrap-process"><i class="fa fa-check"></i><b>6.4</b> Constructing confidence intervals</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#original-workflow"><i class="fa fa-check"></i><b>6.4.1</b> Original workflow</a></li>
<li class="chapter" data-level="6.4.2" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#infer-workflow"><i class="fa fa-check"></i><b>6.4.2</b> <code>infer</code> package workflow</a></li>
<li class="chapter" data-level="6.4.3" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#percentile-method-infer"><i class="fa fa-check"></i><b>6.4.3</b> Percentile method with <code>infer</code></a></li>
<li class="chapter" data-level="6.4.4" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#infer-se"><i class="fa fa-check"></i><b>6.4.4</b> Standard error method with <code>infer</code></a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#one-prop-ci"><i class="fa fa-check"></i><b>6.5</b> Interpreting confidence intervals</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#ilyas-yohan"><i class="fa fa-check"></i><b>6.5.1</b> Did the net capture the fish?</a></li>
<li class="chapter" data-level="6.5.2" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#shorthand"><i class="fa fa-check"></i><b>6.5.2</b> Precise and shorthand interpretation</a></li>
<li class="chapter" data-level="6.5.3" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#ci-width"><i class="fa fa-check"></i><b>6.5.3</b> Width of confidence intervals</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#case-study-two-prop-ci"><i class="fa fa-check"></i><b>6.6</b> Case study: Is yawning contagious?</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#mythbusters-study-data"><i class="fa fa-check"></i><b>6.6.1</b> <em>Mythbusters</em> study data</a></li>
<li class="chapter" data-level="6.6.2" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#sampling-scenario"><i class="fa fa-check"></i><b>6.6.2</b> Sampling scenario</a></li>
<li class="chapter" data-level="6.6.3" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#ci-build"><i class="fa fa-check"></i><b>6.6.3</b> Constructing the confidence interval</a></li>
<li class="chapter" data-level="6.6.4" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#interpreting-the-confidence-interval"><i class="fa fa-check"></i><b>6.6.4</b> Interpreting the confidence interval</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#bootstrap-vs-sampling"><i class="fa fa-check"></i><b>6.7</b> Comparing bootstrap and sampling distributions</a>
<ul>
<li class="chapter" data-level="" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#sampling-distribution"><i class="fa fa-check"></i>Sampling distribution</a></li>
<li class="chapter" data-level="" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#bootstrap-distribution"><i class="fa fa-check"></i>Bootstrap distribution</a></li>
<li class="chapter" data-level="" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#comparison"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="6.8" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#theory-ci"><i class="fa fa-check"></i><b>6.8</b> Theory-based confidence intervals</a>
<ul>
<li class="chapter" data-level="" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#theory-based-method-for-computing-standard-errors"><i class="fa fa-check"></i>Theory-based method for computing standard errors</a></li>
<li class="chapter" data-level="" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#theory-based-method-for-constructing-confidence-intervals"><i class="fa fa-check"></i>Theory-based method for constructing confidence intervals</a></li>
<li class="chapter" data-level="" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#confidence-intervals-based-on-33-tactile-samples"><i class="fa fa-check"></i>Confidence intervals based on 33 tactile samples</a></li>
</ul></li>
<li class="chapter" data-level="6.9" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#ci-conclusion"><i class="fa fa-check"></i><b>6.9</b> Conclusion</a>
<ul>
<li class="chapter" data-level="6.9.1" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#additional-resources-4"><i class="fa fa-check"></i><b>6.9.1</b> Additional resources</a></li>
<li class="chapter" data-level="6.9.2" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#whats-to-come-5"><i class="fa fa-check"></i><b>6.9.2</b> What’s to come?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html"><i class="fa fa-check"></i><b>7</b> Hypothesis Testing</a>
<ul>
<li class="chapter" data-level="" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#nhst-packages"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="7.1" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#ht-activity"><i class="fa fa-check"></i><b>7.1</b> Clutch size and malaria resistance</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#is-there-a-tradeoff-between-reproduction-and-immune-defense"><i class="fa fa-check"></i><b>7.1.1</b> Is there a tradeoff between reproduction and immune defense?</a></li>
<li class="chapter" data-level="7.1.2" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#shuffling-once"><i class="fa fa-check"></i><b>7.1.2</b> Shuffling once</a></li>
<li class="chapter" data-level="7.1.3" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#shuffling-99-more-times"><i class="fa fa-check"></i><b>7.1.3</b> Shuffling 99 more times</a></li>
<li class="chapter" data-level="7.1.4" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#ht-what-did-we-just-do"><i class="fa fa-check"></i><b>7.1.4</b> What did we just do?</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#understanding-ht"><i class="fa fa-check"></i><b>7.2</b> Understanding hypothesis tests</a></li>
<li class="chapter" data-level="7.3" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#ht-infer"><i class="fa fa-check"></i><b>7.3</b> Conducting hypothesis tests</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#infer-workflow-ht"><i class="fa fa-check"></i><b>7.3.1</b> <code>infer</code> package workflow</a></li>
<li class="chapter" data-level="7.3.2" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#comparing-infer-workflows"><i class="fa fa-check"></i><b>7.3.2</b> Comparison with confidence intervals</a></li>
<li class="chapter" data-level="7.3.3" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#only-one-test"><i class="fa fa-check"></i><b>7.3.3</b> “There is only one test”</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#ht-interpretation"><i class="fa fa-check"></i><b>7.4</b> Interpreting hypothesis tests</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#trial"><i class="fa fa-check"></i><b>7.4.1</b> Two possible outcomes</a></li>
<li class="chapter" data-level="7.4.2" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#types-of-errors"><i class="fa fa-check"></i><b>7.4.2</b> Types of errors</a></li>
<li class="chapter" data-level="7.4.3" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#choosing-alpha"><i class="fa fa-check"></i><b>7.4.3</b> How do we choose alpha?</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#ht-case-study"><i class="fa fa-check"></i><b>7.5</b> Case study: Do living lizards have longer horns than dead lizards?</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#imdb-data"><i class="fa fa-check"></i><b>7.5.1</b> Horned lizards dataset</a></li>
<li class="chapter" data-level="7.5.2" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#sampling-scenario-1"><i class="fa fa-check"></i><b>7.5.2</b> Sampling scenario</a></li>
<li class="chapter" data-level="7.5.3" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#conducting-the-hypothesis-test"><i class="fa fa-check"></i><b>7.5.3</b> Conducting the hypothesis test</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#theory-hypo"><i class="fa fa-check"></i><b>7.6</b> Theory-based hypothesis tests</a>
<ul>
<li class="chapter" data-level="" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#two-sample-t-statistic"><i class="fa fa-check"></i>Two-sample t-statistic</a></li>
<li class="chapter" data-level="" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#null-distribution"><i class="fa fa-check"></i>Null distribution</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#problems-with-p-values"><i class="fa fa-check"></i><b>7.7</b> Problems with p-values</a></li>
<li class="chapter" data-level="7.8" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#nhst-conclusion"><i class="fa fa-check"></i><b>7.8</b> Conclusion</a>
<ul>
<li class="chapter" data-level="7.8.1" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#additional-resources-5"><i class="fa fa-check"></i><b>7.8.1</b> Additional resources</a></li>
<li class="chapter" data-level="7.8.2" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#whats-to-come-6"><i class="fa fa-check"></i><b>7.8.2</b> What’s to come</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Data Modeling with moderndive</b></span></li>
<li class="chapter" data-level="8" data-path="8-regression.html"><a href="8-regression.html"><i class="fa fa-check"></i><b>8</b> Basic Regression</a>
<ul>
<li class="chapter" data-level="" data-path="8-regression.html"><a href="8-regression.html#reg-modeling"><i class="fa fa-check"></i>Modeling for explanation or prediction</a></li>
<li class="chapter" data-level="" data-path="8-regression.html"><a href="8-regression.html#reg-packages"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="8.1" data-path="8-regression.html"><a href="8-regression.html#model1"><i class="fa fa-check"></i><b>8.1</b> One numerical explanatory variable</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="8-regression.html"><a href="8-regression.html#model1EDA"><i class="fa fa-check"></i><b>8.1.1</b> Exploratory data analysis</a></li>
<li class="chapter" data-level="8.1.2" data-path="8-regression.html"><a href="8-regression.html#model1table"><i class="fa fa-check"></i><b>8.1.2</b> Simple linear regression</a></li>
<li class="chapter" data-level="8.1.3" data-path="8-regression.html"><a href="8-regression.html#model1points"><i class="fa fa-check"></i><b>8.1.3</b> Observed/fitted values and residuals</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="8-regression.html"><a href="8-regression.html#model2"><i class="fa fa-check"></i><b>8.2</b> One categorical explanatory variable</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="8-regression.html"><a href="8-regression.html#model2EDA"><i class="fa fa-check"></i><b>8.2.1</b> Exploratory data analysis</a></li>
<li class="chapter" data-level="8.2.2" data-path="8-regression.html"><a href="8-regression.html#model2table"><i class="fa fa-check"></i><b>8.2.2</b> Linear regression</a></li>
<li class="chapter" data-level="8.2.3" data-path="8-regression.html"><a href="8-regression.html#model2points"><i class="fa fa-check"></i><b>8.2.3</b> Observed/fitted values and residuals</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="8-regression.html"><a href="8-regression.html#reg-related-topics"><i class="fa fa-check"></i><b>8.3</b> Related topics</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="8-regression.html"><a href="8-regression.html#correlation-is-not-causation"><i class="fa fa-check"></i><b>8.3.1</b> Correlation is not necessarily causation</a></li>
<li class="chapter" data-level="8.3.2" data-path="8-regression.html"><a href="8-regression.html#leastsquares"><i class="fa fa-check"></i><b>8.3.2</b> Best-fitting line</a></li>
<li class="chapter" data-level="8.3.3" data-path="8-regression.html"><a href="8-regression.html#underthehood"><i class="fa fa-check"></i><b>8.3.3</b> <code>get_regression_x()</code> functions</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="8-regression.html"><a href="8-regression.html#reg-conclusion"><i class="fa fa-check"></i><b>8.4</b> Conclusion</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="8-regression.html"><a href="8-regression.html#whats-to-come-7"><i class="fa fa-check"></i><b>8.4.1</b> What’s to come?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html"><i class="fa fa-check"></i><b>9</b> Inference for Regression</a>
<ul>
<li class="chapter" data-level="" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#inf-packages"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="9.1" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#regression-refresher"><i class="fa fa-check"></i><b>9.1</b> Regression refresher</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#lion-age-and-nose-coloration"><i class="fa fa-check"></i><b>9.1.1</b> Lion age and nose coloration</a></li>
<li class="chapter" data-level="9.1.2" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#sampling-scenario-2"><i class="fa fa-check"></i><b>9.1.2</b> Sampling scenario</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#regression-interp"><i class="fa fa-check"></i><b>9.2</b> Interpreting regression tables</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#regression-se"><i class="fa fa-check"></i><b>9.2.1</b> Standard error</a></li>
<li class="chapter" data-level="9.2.2" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#regression-test-statistic"><i class="fa fa-check"></i><b>9.2.2</b> Test statistic</a></li>
<li class="chapter" data-level="9.2.3" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#p-value"><i class="fa fa-check"></i><b>9.2.3</b> p-value</a></li>
<li class="chapter" data-level="9.2.4" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#confidence-interval"><i class="fa fa-check"></i><b>9.2.4</b> Confidence interval</a></li>
<li class="chapter" data-level="9.2.5" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#regression-table-computation"><i class="fa fa-check"></i><b>9.2.5</b> How does R compute the table?</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#regression-conditions"><i class="fa fa-check"></i><b>9.3</b> Conditions for inference for regression</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#residuals-refresher"><i class="fa fa-check"></i><b>9.3.1</b> Residuals refresher</a></li>
<li class="chapter" data-level="9.3.2" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#linearity-of-relationship"><i class="fa fa-check"></i><b>9.3.2</b> Linearity of relationship</a></li>
<li class="chapter" data-level="9.3.3" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#independence-of-residuals"><i class="fa fa-check"></i><b>9.3.3</b> Independence of residuals</a></li>
<li class="chapter" data-level="9.3.4" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#normality-of-residuals"><i class="fa fa-check"></i><b>9.3.4</b> Normality of residuals</a></li>
<li class="chapter" data-level="9.3.5" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#equality-of-variance"><i class="fa fa-check"></i><b>9.3.5</b> Equality of variance</a></li>
<li class="chapter" data-level="9.3.6" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#what-is-the-conclusion"><i class="fa fa-check"></i><b>9.3.6</b> What’s the conclusion?</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#infer-regression"><i class="fa fa-check"></i><b>9.4</b> Simulation-based inference for regression</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#confidence-interval-for-slope"><i class="fa fa-check"></i><b>9.4.1</b> Confidence interval for slope</a></li>
<li class="chapter" data-level="9.4.2" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#hypothesis-test-for-slope"><i class="fa fa-check"></i><b>9.4.2</b> Hypothesis test for slope</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#theory-regression"><i class="fa fa-check"></i><b>9.5</b> Theory-based inference for regression</a></li>
<li class="chapter" data-level="9.6" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#inference-conclusion"><i class="fa fa-check"></i><b>9.6</b> Conclusion</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#summary-of-statistical-inference"><i class="fa fa-check"></i><b>9.6.1</b> Summary of statistical inference</a></li>
<li class="chapter" data-level="9.6.2" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#whats-to-come-8"><i class="fa fa-check"></i><b>9.6.2</b> What’s to come</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="10-multiple-regression.html"><a href="10-multiple-regression.html"><i class="fa fa-check"></i><b>10</b> Multiple Regression</a>
<ul>
<li class="chapter" data-level="" data-path="10-multiple-regression.html"><a href="10-multiple-regression.html#mult-reg-packages"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="10.1" data-path="10-multiple-regression.html"><a href="10-multiple-regression.html#model4"><i class="fa fa-check"></i><b>10.1</b> One numerical and one categorical explanatory variable</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="10-multiple-regression.html"><a href="10-multiple-regression.html#model4EDA"><i class="fa fa-check"></i><b>10.1.1</b> Exploratory data analysis</a></li>
<li class="chapter" data-level="10.1.2" data-path="10-multiple-regression.html"><a href="10-multiple-regression.html#model4interactiontable"><i class="fa fa-check"></i><b>10.1.2</b> Interaction model</a></li>
<li class="chapter" data-level="10.1.3" data-path="10-multiple-regression.html"><a href="10-multiple-regression.html#model4table"><i class="fa fa-check"></i><b>10.1.3</b> Parallel slopes model</a></li>
<li class="chapter" data-level="10.1.4" data-path="10-multiple-regression.html"><a href="10-multiple-regression.html#model4points"><i class="fa fa-check"></i><b>10.1.4</b> Observed/fitted values and residuals</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="10-multiple-regression.html"><a href="10-multiple-regression.html#model3"><i class="fa fa-check"></i><b>10.2</b> Two categorical explanatory variables</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="10-multiple-regression.html"><a href="10-multiple-regression.html#model3EDA"><i class="fa fa-check"></i><b>10.2.1</b> Exploratory data analysis</a></li>
<li class="chapter" data-level="10.2.2" data-path="10-multiple-regression.html"><a href="10-multiple-regression.html#model3table"><i class="fa fa-check"></i><b>10.2.2</b> Regression lines</a></li>
<li class="chapter" data-level="10.2.3" data-path="10-multiple-regression.html"><a href="10-multiple-regression.html#model3points"><i class="fa fa-check"></i><b>10.2.3</b> Observed/fitted values and residuals</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="10-multiple-regression.html"><a href="10-multiple-regression.html#mult-reg-related-topics"><i class="fa fa-check"></i><b>10.3</b> Related topics</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="10-multiple-regression.html"><a href="10-multiple-regression.html#model-selection"><i class="fa fa-check"></i><b>10.3.1</b> Model selection using visualizations</a></li>
<li class="chapter" data-level="10.3.2" data-path="10-multiple-regression.html"><a href="10-multiple-regression.html#rsquared"><i class="fa fa-check"></i><b>10.3.2</b> Model selection using R-squared</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="10-multiple-regression.html"><a href="10-multiple-regression.html#mult-reg-conclusion"><i class="fa fa-check"></i><b>10.4</b> Conclusion</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="10-multiple-regression.html"><a href="10-multiple-regression.html#whats-to-come-9"><i class="fa fa-check"></i><b>10.4.1</b> What’s to come?</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>IV Conclusion</b></span></li>
<li class="chapter" data-level="11" data-path="11-thinking-with-data.html"><a href="11-thinking-with-data.html"><i class="fa fa-check"></i><b>11</b> Tell Your Story with Data</a>
<ul>
<li class="chapter" data-level="11.1" data-path="11-thinking-with-data.html"><a href="11-thinking-with-data.html#review"><i class="fa fa-check"></i><b>11.1</b> Review</a></li>
<li class="chapter" data-level="11.2" data-path="11-thinking-with-data.html"><a href="11-thinking-with-data.html#data-journalism"><i class="fa fa-check"></i><b>11.2</b> Case study: Effective data storytelling</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="11-thinking-with-data.html"><a href="11-thinking-with-data.html#us-births-in-1999"><i class="fa fa-check"></i><b>11.2.1</b> US Births in 1999</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="11-thinking-with-data.html"><a href="11-thinking-with-data.html#concluding-remarks"><i class="fa fa-check"></i>Concluding remarks</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="A-appendixA.html"><a href="A-appendixA.html"><i class="fa fa-check"></i><b>A</b> Statistical Background</a>
<ul>
<li class="chapter" data-level="A.1" data-path="A-appendixA.html"><a href="A-appendixA.html#appendix-stat-terms"><i class="fa fa-check"></i><b>A.1</b> Basic statistical terms</a>
<ul>
<li class="chapter" data-level="A.1.1" data-path="A-appendixA.html"><a href="A-appendixA.html#mean"><i class="fa fa-check"></i><b>A.1.1</b> Mean</a></li>
<li class="chapter" data-level="A.1.2" data-path="A-appendixA.html"><a href="A-appendixA.html#median"><i class="fa fa-check"></i><b>A.1.2</b> Median</a></li>
<li class="chapter" data-level="A.1.3" data-path="A-appendixA.html"><a href="A-appendixA.html#appendix-sd-variance"><i class="fa fa-check"></i><b>A.1.3</b> Standard deviation and variance</a></li>
<li class="chapter" data-level="A.1.4" data-path="A-appendixA.html"><a href="A-appendixA.html#five-number-summary"><i class="fa fa-check"></i><b>A.1.4</b> Five-number summary</a></li>
<li class="chapter" data-level="A.1.5" data-path="A-appendixA.html"><a href="A-appendixA.html#distribution"><i class="fa fa-check"></i><b>A.1.5</b> Distribution</a></li>
<li class="chapter" data-level="A.1.6" data-path="A-appendixA.html"><a href="A-appendixA.html#outliers"><i class="fa fa-check"></i><b>A.1.6</b> Outliers</a></li>
</ul></li>
<li class="chapter" data-level="A.2" data-path="A-appendixA.html"><a href="A-appendixA.html#appendix-normal-curve"><i class="fa fa-check"></i><b>A.2</b> Normal distribution</a></li>
<li class="chapter" data-level="A.3" data-path="A-appendixA.html"><a href="A-appendixA.html#appendix-log10-transformations"><i class="fa fa-check"></i><b>A.3</b> log10 transformations</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="B-appendixB.html"><a href="B-appendixB.html"><i class="fa fa-check"></i><b>B</b> Inference Examples</a>
<ul>
<li class="chapter" data-level="" data-path="B-appendixB.html"><a href="B-appendixB.html#needed-packages-1"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="B.1" data-path="B-appendixB.html"><a href="B-appendixB.html#inference-mind-map"><i class="fa fa-check"></i><b>B.1</b> Inference mind map</a></li>
<li class="chapter" data-level="B.2" data-path="B-appendixB.html"><a href="B-appendixB.html#one-mean"><i class="fa fa-check"></i><b>B.2</b> One mean</a>
<ul>
<li class="chapter" data-level="B.2.1" data-path="B-appendixB.html"><a href="B-appendixB.html#problem-statement"><i class="fa fa-check"></i><b>B.2.1</b> Problem statement</a></li>
<li class="chapter" data-level="B.2.2" data-path="B-appendixB.html"><a href="B-appendixB.html#competing-hypotheses"><i class="fa fa-check"></i><b>B.2.2</b> Competing hypotheses</a></li>
<li class="chapter" data-level="B.2.3" data-path="B-appendixB.html"><a href="B-appendixB.html#exploring-the-sample-data"><i class="fa fa-check"></i><b>B.2.3</b> Exploring the sample data</a></li>
<li class="chapter" data-level="B.2.4" data-path="B-appendixB.html"><a href="B-appendixB.html#non-traditional-methods"><i class="fa fa-check"></i><b>B.2.4</b> Non-traditional methods</a></li>
<li class="chapter" data-level="B.2.5" data-path="B-appendixB.html"><a href="B-appendixB.html#traditional-methods"><i class="fa fa-check"></i><b>B.2.5</b> Traditional methods</a></li>
<li class="chapter" data-level="B.2.6" data-path="B-appendixB.html"><a href="B-appendixB.html#comparing-results"><i class="fa fa-check"></i><b>B.2.6</b> Comparing results</a></li>
</ul></li>
<li class="chapter" data-level="B.3" data-path="B-appendixB.html"><a href="B-appendixB.html#one-proportion"><i class="fa fa-check"></i><b>B.3</b> One proportion</a>
<ul>
<li class="chapter" data-level="B.3.1" data-path="B-appendixB.html"><a href="B-appendixB.html#problem-statement-1"><i class="fa fa-check"></i><b>B.3.1</b> Problem statement</a></li>
<li class="chapter" data-level="B.3.2" data-path="B-appendixB.html"><a href="B-appendixB.html#competing-hypotheses-1"><i class="fa fa-check"></i><b>B.3.2</b> Competing hypotheses</a></li>
<li class="chapter" data-level="B.3.3" data-path="B-appendixB.html"><a href="B-appendixB.html#exploring-the-sample-data-1"><i class="fa fa-check"></i><b>B.3.3</b> Exploring the sample data</a></li>
<li class="chapter" data-level="B.3.4" data-path="B-appendixB.html"><a href="B-appendixB.html#non-traditional-methods-1"><i class="fa fa-check"></i><b>B.3.4</b> Non-traditional methods</a></li>
<li class="chapter" data-level="B.3.5" data-path="B-appendixB.html"><a href="B-appendixB.html#traditional-methods-1"><i class="fa fa-check"></i><b>B.3.5</b> Traditional methods</a></li>
<li class="chapter" data-level="B.3.6" data-path="B-appendixB.html"><a href="B-appendixB.html#comparing-results-1"><i class="fa fa-check"></i><b>B.3.6</b> Comparing results</a></li>
</ul></li>
<li class="chapter" data-level="B.4" data-path="B-appendixB.html"><a href="B-appendixB.html#two-proportions"><i class="fa fa-check"></i><b>B.4</b> Two proportions</a>
<ul>
<li class="chapter" data-level="B.4.1" data-path="B-appendixB.html"><a href="B-appendixB.html#problem-statement-2"><i class="fa fa-check"></i><b>B.4.1</b> Problem statement</a></li>
<li class="chapter" data-level="B.4.2" data-path="B-appendixB.html"><a href="B-appendixB.html#competing-hypotheses-2"><i class="fa fa-check"></i><b>B.4.2</b> Competing hypotheses</a></li>
<li class="chapter" data-level="B.4.3" data-path="B-appendixB.html"><a href="B-appendixB.html#exploring-the-sample-data-2"><i class="fa fa-check"></i><b>B.4.3</b> Exploring the sample data</a></li>
<li class="chapter" data-level="B.4.4" data-path="B-appendixB.html"><a href="B-appendixB.html#non-traditional-methods-2"><i class="fa fa-check"></i><b>B.4.4</b> Non-traditional methods</a></li>
<li class="chapter" data-level="B.4.5" data-path="B-appendixB.html"><a href="B-appendixB.html#traditional-methods-2"><i class="fa fa-check"></i><b>B.4.5</b> Traditional methods</a></li>
<li class="chapter" data-level="B.4.6" data-path="B-appendixB.html"><a href="B-appendixB.html#test-statistic-2"><i class="fa fa-check"></i><b>B.4.6</b> Test statistic</a></li>
<li class="chapter" data-level="B.4.7" data-path="B-appendixB.html"><a href="B-appendixB.html#state-conclusion-2"><i class="fa fa-check"></i><b>B.4.7</b> State conclusion</a></li>
<li class="chapter" data-level="B.4.8" data-path="B-appendixB.html"><a href="B-appendixB.html#comparing-results-2"><i class="fa fa-check"></i><b>B.4.8</b> Comparing results</a></li>
</ul></li>
<li class="chapter" data-level="B.5" data-path="B-appendixB.html"><a href="B-appendixB.html#two-means-independent-samples"><i class="fa fa-check"></i><b>B.5</b> Two means (independent samples)</a>
<ul>
<li class="chapter" data-level="B.5.1" data-path="B-appendixB.html"><a href="B-appendixB.html#problem-statement-3"><i class="fa fa-check"></i><b>B.5.1</b> Problem statement</a></li>
<li class="chapter" data-level="B.5.2" data-path="B-appendixB.html"><a href="B-appendixB.html#competing-hypotheses-3"><i class="fa fa-check"></i><b>B.5.2</b> Competing hypotheses</a></li>
<li class="chapter" data-level="B.5.3" data-path="B-appendixB.html"><a href="B-appendixB.html#exploring-the-sample-data-3"><i class="fa fa-check"></i><b>B.5.3</b> Exploring the sample data</a></li>
<li class="chapter" data-level="B.5.4" data-path="B-appendixB.html"><a href="B-appendixB.html#non-traditional-methods-3"><i class="fa fa-check"></i><b>B.5.4</b> Non-traditional methods</a></li>
<li class="chapter" data-level="B.5.5" data-path="B-appendixB.html"><a href="B-appendixB.html#traditional-methods-3"><i class="fa fa-check"></i><b>B.5.5</b> Traditional methods</a></li>
<li class="chapter" data-level="B.5.6" data-path="B-appendixB.html"><a href="B-appendixB.html#test-statistic-3"><i class="fa fa-check"></i><b>B.5.6</b> Test statistic</a></li>
<li class="chapter" data-level="B.5.7" data-path="B-appendixB.html"><a href="B-appendixB.html#compute-p-value-1"><i class="fa fa-check"></i><b>B.5.7</b> Compute <span class="math inline">\(p\)</span>-value</a></li>
<li class="chapter" data-level="B.5.8" data-path="B-appendixB.html"><a href="B-appendixB.html#state-conclusion-3"><i class="fa fa-check"></i><b>B.5.8</b> State conclusion</a></li>
<li class="chapter" data-level="B.5.9" data-path="B-appendixB.html"><a href="B-appendixB.html#comparing-results-3"><i class="fa fa-check"></i><b>B.5.9</b> Comparing results</a></li>
</ul></li>
<li class="chapter" data-level="B.6" data-path="B-appendixB.html"><a href="B-appendixB.html#two-means-paired-samples"><i class="fa fa-check"></i><b>B.6</b> Two means (paired samples)</a>
<ul>
<li class="chapter" data-level="" data-path="B-appendixB.html"><a href="B-appendixB.html#problem-statement-4"><i class="fa fa-check"></i>Problem statement</a></li>
<li class="chapter" data-level="B.6.1" data-path="B-appendixB.html"><a href="B-appendixB.html#competing-hypotheses-4"><i class="fa fa-check"></i><b>B.6.1</b> Competing hypotheses</a></li>
<li class="chapter" data-level="B.6.2" data-path="B-appendixB.html"><a href="B-appendixB.html#exploring-the-sample-data-4"><i class="fa fa-check"></i><b>B.6.2</b> Exploring the sample data</a></li>
<li class="chapter" data-level="B.6.3" data-path="B-appendixB.html"><a href="B-appendixB.html#non-traditional-methods-4"><i class="fa fa-check"></i><b>B.6.3</b> Non-traditional methods</a></li>
<li class="chapter" data-level="B.6.4" data-path="B-appendixB.html"><a href="B-appendixB.html#traditional-methods-4"><i class="fa fa-check"></i><b>B.6.4</b> Traditional methods</a></li>
<li class="chapter" data-level="B.6.5" data-path="B-appendixB.html"><a href="B-appendixB.html#comparing-results-4"><i class="fa fa-check"></i><b>B.6.5</b> Comparing results</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="C" data-path="C-appendixC.html"><a href="C-appendixC.html"><i class="fa fa-check"></i><b>C</b> Tips and Tricks</a>
<ul>
<li class="chapter" data-level="" data-path="C-appendixC.html"><a href="C-appendixC.html#needed-packages-2"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="C.1" data-path="C-appendixC.html"><a href="C-appendixC.html#data-wrangling"><i class="fa fa-check"></i><b>C.1</b> Data wrangling</a>
<ul>
<li class="chapter" data-level="C.1.1" data-path="C-appendixC.html"><a href="C-appendixC.html#appendix-missing-values"><i class="fa fa-check"></i><b>C.1.1</b> Dealing with missing values</a></li>
<li class="chapter" data-level="C.1.2" data-path="C-appendixC.html"><a href="C-appendixC.html#appendix-reordering-bars"><i class="fa fa-check"></i><b>C.1.2</b> Reordering bars in a barplot</a></li>
<li class="chapter" data-level="C.1.3" data-path="C-appendixC.html"><a href="C-appendixC.html#appendix-money-on-axis"><i class="fa fa-check"></i><b>C.1.3</b> Showing money on an axis</a></li>
<li class="chapter" data-level="C.1.4" data-path="C-appendixC.html"><a href="C-appendixC.html#appendix-changing-values"><i class="fa fa-check"></i><b>C.1.4</b> Changing values inside cells</a></li>
<li class="chapter" data-level="C.1.5" data-path="C-appendixC.html"><a href="C-appendixC.html#appendix-convert-numerical-categorical"><i class="fa fa-check"></i><b>C.1.5</b> Converting a numerical variable to a categorical one</a></li>
<li class="chapter" data-level="C.1.6" data-path="C-appendixC.html"><a href="C-appendixC.html#appendix-prop"><i class="fa fa-check"></i><b>C.1.6</b> Computing proportions</a></li>
<li class="chapter" data-level="C.1.7" data-path="C-appendixC.html"><a href="C-appendixC.html#appendix-commas"><i class="fa fa-check"></i><b>C.1.7</b> Dealing with %, commas, and $</a></li>
</ul></li>
<li class="chapter" data-level="C.2" data-path="C-appendixC.html"><a href="C-appendixC.html#interactive-graphics"><i class="fa fa-check"></i><b>C.2</b> Interactive graphics</a>
<ul>
<li class="chapter" data-level="C.2.1" data-path="C-appendixC.html"><a href="C-appendixC.html#interactive-linegraphs"><i class="fa fa-check"></i><b>C.2.1</b> Interactive linegraphs</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Modern Biological Data Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<html>
<img src='https://moderndive.com/wide_format.png' alt="ModernDive">
</html>
<div id="inference-for-regression" class="section level1 hasAnchor" number="9">
<h1><span class="header-section-number">Chapter 9</span> Inference for Regression<a href="9-inference-for-regression.html#inference-for-regression" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In this chapter, we’ll further explore the regression models we first studied in Chapter <a href="8-regression.html#regression">8</a>. Armed with our knowledge of confidence intervals and hypothesis tests from Chapters <a href="6-confidence-intervals.html#confidence-intervals">6</a> and <a href="7-hypothesis-testing.html#hypothesis-testing">7</a>, we’ll be able to apply statistical inference to further our understanding of relationships between outcome and explanatory variables.</p>
<div class="review">
<p>
<strong><em>Chapter Learning Objectives</em></strong>
</p>
<p>
<em>At the end of this chapter, you should be able to…</em><br />
• Fully interpret a regression table to determine the p-value and 95%
confidence interval of the point estimates for the intercept and slope
of the regression line.<br />
• Check if data meets the necessary conditions to apply linear
regression.<br />
</p>
</div>
<div id="inf-packages" class="section level3 unnumbered hasAnchor">
<h3>Needed packages<a href="9-inference-for-regression.html#inf-packages" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s load all the packages needed for this chapter (this assumes you’ve already installed them). Recall from our discussion in Section <a href="4-tidy.html#tidyverse-package">4.3</a> that loading the <code>tidyverse</code> package by running <code>library(tidyverse)</code> loads the following commonly used data science packages all at once:</p>
<ul>
<li><code>ggplot2</code> for data visualization</li>
<li><code>dplyr</code> for data wrangling</li>
<li><code>tidyr</code> for converting data to “tidy” format</li>
<li><code>readr</code> for importing spreadsheet data into R</li>
<li>As well as the more advanced <code>purrr</code>, <code>tibble</code>, <code>stringr</code>, and <code>forcats</code> packages</li>
</ul>
<p>If needed, read Section <a href="1-getting-started.html#packages">1.3</a> for information on how to install and load R packages.</p>
<div class="sourceCode" id="cb378"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb378-1"><a href="9-inference-for-regression.html#cb378-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb378-2"><a href="9-inference-for-regression.html#cb378-2" tabindex="-1"></a><span class="fu">library</span>(moderndive)</span>
<span id="cb378-3"><a href="9-inference-for-regression.html#cb378-3" tabindex="-1"></a><span class="fu">library</span>(infer)</span>
<span id="cb378-4"><a href="9-inference-for-regression.html#cb378-4" tabindex="-1"></a><span class="fu">library</span>(abd)</span></code></pre></div>
</div>
<div id="regression-refresher" class="section level2 hasAnchor" number="9.1">
<h2><span class="header-section-number">9.1</span> Regression refresher<a href="9-inference-for-regression.html#regression-refresher" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Before jumping into inference for regression, let’s remind ourselves of the study to estimate nose coloration based on lion ages in Section <a href="8-regression.html#model1">8.1</a>.</p>
<div id="lion-age-and-nose-coloration" class="section level3 hasAnchor" number="9.1.1">
<h3><span class="header-section-number">9.1.1</span> Lion age and nose coloration<a href="9-inference-for-regression.html#lion-age-and-nose-coloration" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Recall using simple linear regression we modeled the relationship between</p>
<ol style="list-style-type: decimal">
<li>A numerical outcome variable <span class="math inline">\(y\)</span> (proportion of the nose that’s black) and</li>
<li>A single numerical explanatory variable <span class="math inline">\(x\)</span> (lion’s age).</li>
</ol>
<p>We started with the <code>LionNoses</code> data frame in the <code>abd</code> package, which contained the two variables of interest: <code>age</code> and <code>proportion.black</code>:</p>
<div class="sourceCode" id="cb379"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb379-1"><a href="9-inference-for-regression.html#cb379-1" tabindex="-1"></a><span class="fu">glimpse</span>(LionNoses)</span></code></pre></div>
<pre><code>Rows: 32
Columns: 2
$ age              &lt;dbl&gt; 1.1, 1.5, 1.9, 2.2, 2.6, 3.2, 3.2, 2.9, 2.4, 2.1, 1.9…
$ proportion.black &lt;dbl&gt; 0.21, 0.14, 0.11, 0.13, 0.12, 0.13, 0.12, 0.18, 0.23,…</code></pre>
<p>In Subsection <a href="8-regression.html#model1EDA">8.1.1</a>, we performed an exploratory data analysis of the relationship between these two variables of <code>age</code> and <code>proportion.black</code>. We saw there that a clearly positive correlation of 0.79 existed between the two variables.</p>
<p>This was evidenced in Figure <a href="9-inference-for-regression.html#fig:regline">9.1</a> of the scatterplot along with the “best-fitting” regression line that summarizes the linear relationship between the two variables of <code>proportion.black</code> and <code>age</code>. Recall in Subsection <a href="8-regression.html#leastsquares">8.3.2</a> that we defined a “best-fitting” line as the line that minimizes the <em>sum of squared residuals</em>.</p>
<div class="sourceCode" id="cb381"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb381-1"><a href="9-inference-for-regression.html#cb381-1" tabindex="-1"></a><span class="fu">ggplot</span>(LionNoses, </span>
<span id="cb381-2"><a href="9-inference-for-regression.html#cb381-2" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> proportion.black)) <span class="sc">+</span></span>
<span id="cb381-3"><a href="9-inference-for-regression.html#cb381-3" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb381-4"><a href="9-inference-for-regression.html#cb381-4" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Age (years)&quot;</span>, </span>
<span id="cb381-5"><a href="9-inference-for-regression.html#cb381-5" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Proportion of black nose&quot;</span>,</span>
<span id="cb381-6"><a href="9-inference-for-regression.html#cb381-6" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;Scatterplot of relationship of relative coloration and age of male lions.&quot;</span>) <span class="sc">+</span>  </span>
<span id="cb381-7"><a href="9-inference-for-regression.html#cb381-7" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:regline"></span>
<img src="ModernDive_files/figure-html/regline-1.png" alt="Relationship with regression line." width="\textwidth" />
<p class="caption">
FIGURE 9.1: Relationship with regression line.
</p>
</div>
<p>Looking at this plot again, you can see that the line has a positive slope, increasing from left to right as the <code>age</code> variable increases, but by how much? To get to this information, recall that we followed a two-step procedure:</p>
<ol style="list-style-type: decimal">
<li>We first “fit” the linear regression model using the <code>lm()</code> function with the formula <code>proportion.black ~ age</code>. We saved this model in <code>lion_model</code>.</li>
<li>We get the regression table by applying the <code>get_regression_table()</code> function from the <code>moderndive</code> package to <code>lion_model</code>.</li>
</ol>
<div class="sourceCode" id="cb382"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb382-1"><a href="9-inference-for-regression.html#cb382-1" tabindex="-1"></a><span class="co"># Fit regression model:</span></span>
<span id="cb382-2"><a href="9-inference-for-regression.html#cb382-2" tabindex="-1"></a>lion_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(proportion.black <span class="sc">~</span> age, <span class="at">data =</span> LionNoses)</span>
<span id="cb382-3"><a href="9-inference-for-regression.html#cb382-3" tabindex="-1"></a><span class="co"># Get regression table:</span></span>
<span id="cb382-4"><a href="9-inference-for-regression.html#cb382-4" tabindex="-1"></a><span class="fu">get_regression_table</span>(lion_model)</span></code></pre></div>
<table class="table" style="font-size: 16px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:regtable-11">TABLE 9.1: </span>Previously seen linear regression table
</caption>
<thead>
<tr>
<th style="text-align:left;">
term
</th>
<th style="text-align:right;">
estimate
</th>
<th style="text-align:right;">
std_error
</th>
<th style="text-align:right;">
statistic
</th>
<th style="text-align:right;">
p_value
</th>
<th style="text-align:right;">
lower_ci
</th>
<th style="text-align:right;">
upper_ci
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
intercept
</td>
<td style="text-align:right;">
0.070
</td>
<td style="text-align:right;">
0.042
</td>
<td style="text-align:right;">
1.66
</td>
<td style="text-align:right;">
0.107
</td>
<td style="text-align:right;">
-0.016
</td>
<td style="text-align:right;">
0.155
</td>
</tr>
<tr>
<td style="text-align:left;">
age
</td>
<td style="text-align:right;">
0.059
</td>
<td style="text-align:right;">
0.008
</td>
<td style="text-align:right;">
7.05
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.042
</td>
<td style="text-align:right;">
0.076
</td>
</tr>
</tbody>
</table>
<p>Using the values in the <code>estimate</code> column of the resulting regression table in Table <a href="9-inference-for-regression.html#tab:regtable-11">9.1</a>, we could then obtain the equation of the “best-fitting” regression line in Figure <a href="9-inference-for-regression.html#fig:regline">9.1</a>:</p>
<p><span class="math display">\[
\begin{aligned}
\widehat{y} &amp;= b_0 + b_1 \cdot x\\
\widehat{\text{proportion.black}} &amp;= b_0 + b_{\text{age}} \cdot\text{age}\\
&amp;= 0.070 + 0.059\cdot\text{age}
\end{aligned}
\]</span></p>
<p>where <span class="math inline">\(b_0\)</span> is the fitted intercept and <span class="math inline">\(b_1\)</span> is the fitted slope for <code>age</code>. Recall the interpretation of the <span class="math inline">\(b_1\)</span> = 0.059 value of the fitted slope:</p>
<blockquote>
<p>For every increase of one unit in lion age, there is an associated increase, on average, of 0.059 units of the black proportion of the nose.</p>
</blockquote>
<p>Thus, the slope value quantifies the relationship between the <span class="math inline">\(y\)</span> variable <code>proportion.black</code> and the <span class="math inline">\(x\)</span> variable <code>age</code>. We also discussed the intercept value of <span class="math inline">\(b_0\)</span> = 0.07 and its lack of practical interpretation, since the range of ages doesn’t include 0.</p>
</div>
<div id="sampling-scenario-2" class="section level3 hasAnchor" number="9.1.2">
<h3><span class="header-section-number">9.1.2</span> Sampling scenario<a href="9-inference-for-regression.html#sampling-scenario-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s now revisit this study in terms of the terminology and notation related to sampling we studied in Subsection <a href="5-sampling.html#terminology-and-notation">5.3.1</a>.</p>
<p>First, let’s view these 32 lions as a <em>representative sample</em> from a greater <em>study population</em>. In our case, let’s assume that the study population is <em>all</em> lions living in the wild and that this sample of 32 lions is a representative sample. Unfortunately, we can only <em>assume</em> these two facts without more knowledge of the <em>sampling methodology</em> used by the researchers.</p>
<p>Since we are viewing these <span class="math inline">\(n\)</span> = 32 lions as a sample, we can view our fitted slope <span class="math inline">\(b_1\)</span> = 0.059 as a <em>point estimate</em> of the <em>population slope</em> <span class="math inline">\(\beta_1\)</span>. In other words, <span class="math inline">\(\beta_1\)</span> quantifies the relationship between <code>proportion.black</code> and <code>age</code> for <em>all</em> lions in the wild. Similarly, we can view our fitted intercept <span class="math inline">\(b_0\)</span> = 0.07 as a <em>point estimate</em> of the <em>population intercept</em> <span class="math inline">\(\beta_0\)</span> for <em>all</em> lions in the wild.</p>
<p>Putting these two ideas together, we can view the equation of the fitted line <span class="math inline">\(\widehat{y}\)</span> = <span class="math inline">\(b_0 + b_1 \cdot x\)</span> = <span class="math inline">\(0.070 + 0.059 \cdot \text{age}\)</span> as an estimate of some true and unknown <em>population line</em> <span class="math inline">\(y = \beta_0 + \beta_1 \cdot x\)</span>. Thus we can draw parallels between our lion age analysis and all the sampling scenarios we’ve seen previously. In this chapter, we’ll focus on the final scenario of regression slopes as shown in Table <a href="9-inference-for-regression.html#tab:summarytable-ch11">9.2</a>.</p>
<table class="table" style="font-size: 16px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:summarytable-ch11">TABLE 9.2: </span>Scenarios of sampling for inference
</caption>
<thead>
<tr>
<th style="text-align:right;">
Scenario
</th>
<th style="text-align:left;">
Population parameter
</th>
<th style="text-align:left;">
Notation
</th>
<th style="text-align:left;">
Point estimate
</th>
<th style="text-align:left;">
Symbol(s)
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;width: 0.5in; ">
1
</td>
<td style="text-align:left;width: 0.7in; ">
Population proportion
</td>
<td style="text-align:left;width: 1in; ">
<span class="math inline">\(p\)</span>
</td>
<td style="text-align:left;width: 1.1in; ">
Sample proportion
</td>
<td style="text-align:left;width: 1in; ">
<span class="math inline">\(\widehat{p}\)</span>
</td>
</tr>
<tr>
<td style="text-align:right;width: 0.5in; ">
2
</td>
<td style="text-align:left;width: 0.7in; ">
Population mean
</td>
<td style="text-align:left;width: 1in; ">
<span class="math inline">\(\mu\)</span>
</td>
<td style="text-align:left;width: 1.1in; ">
Sample mean
</td>
<td style="text-align:left;width: 1in; ">
<span class="math inline">\(\overline{x}\)</span> or <span class="math inline">\(\widehat{\mu}\)</span>
</td>
</tr>
<tr>
<td style="text-align:right;width: 0.5in; ">
3
</td>
<td style="text-align:left;width: 0.7in; ">
Difference in population proportions
</td>
<td style="text-align:left;width: 1in; ">
<span class="math inline">\(p_1 - p_2\)</span>
</td>
<td style="text-align:left;width: 1.1in; ">
Difference in sample proportions
</td>
<td style="text-align:left;width: 1in; ">
<span class="math inline">\(\widehat{p}_1 - \widehat{p}_2\)</span>
</td>
</tr>
<tr>
<td style="text-align:right;width: 0.5in; ">
4
</td>
<td style="text-align:left;width: 0.7in; ">
Difference in population means
</td>
<td style="text-align:left;width: 1in; ">
<span class="math inline">\(\mu_1 - \mu_2\)</span>
</td>
<td style="text-align:left;width: 1.1in; ">
Difference in sample means
</td>
<td style="text-align:left;width: 1in; ">
<span class="math inline">\(\overline{x}_1 - \overline{x}_2\)</span>
</td>
</tr>
<tr>
<td style="text-align:right;width: 0.5in; ">
5
</td>
<td style="text-align:left;width: 0.7in; ">
Population regression slope
</td>
<td style="text-align:left;width: 1in; ">
<span class="math inline">\(\beta_1\)</span>
</td>
<td style="text-align:left;width: 1.1in; ">
Fitted regression slope
</td>
<td style="text-align:left;width: 1in; ">
<span class="math inline">\(b_1\)</span> or <span class="math inline">\(\widehat{\beta}_1\)</span>
</td>
</tr>
</tbody>
</table>
<p>Since we are now viewing our fitted slope <span class="math inline">\(b_1\)</span> and fitted intercept <span class="math inline">\(b_0\)</span> as <em>point estimates</em> based on a <em>sample</em>, these estimates will again be subject to <em>sampling variability</em>. In other words, if we collected a new sample of data on a different set of <span class="math inline">\(n\)</span> = 32 lions, the new fitted slope <span class="math inline">\(b_1\)</span> will likely differ from 0.059. The same goes for the new fitted intercept <span class="math inline">\(b_0\)</span>. But by how much will these estimates <em>vary</em>? This information is in the remaining columns of the regression table in Table <a href="9-inference-for-regression.html#tab:regtable-11">9.1</a>. Our knowledge of sampling from Chapter <a href="5-sampling.html#sampling">5</a>, confidence intervals from Chapter <a href="6-confidence-intervals.html#confidence-intervals">6</a>, and hypothesis tests from Chapter <a href="7-hypothesis-testing.html#hypothesis-testing">7</a> will help us interpret these remaining columns.</p>
</div>
</div>
<div id="regression-interp" class="section level2 hasAnchor" number="9.2">
<h2><span class="header-section-number">9.2</span> Interpreting regression tables<a href="9-inference-for-regression.html#regression-interp" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We’ve so far focused only on the two leftmost columns of the regression table in Table <a href="9-inference-for-regression.html#tab:regtable-11">9.1</a>: <code>term</code> and <code>estimate</code>. Let’s now shift our attention to the remaining columns: <code>std_error</code>, <code>statistic</code>, <code>p_value</code>, <code>lower_ci</code> and <code>upper_ci</code> in Table <a href="9-inference-for-regression.html#tab:proportion-black-model-part-deux">9.3</a>.</p>
<table class="table" style="font-size: 16px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:proportion-black-model-part-deux">TABLE 9.3: </span>Previously seen regression table
</caption>
<thead>
<tr>
<th style="text-align:left;">
term
</th>
<th style="text-align:right;">
estimate
</th>
<th style="text-align:right;">
std_error
</th>
<th style="text-align:right;">
statistic
</th>
<th style="text-align:right;">
p_value
</th>
<th style="text-align:right;">
lower_ci
</th>
<th style="text-align:right;">
upper_ci
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
intercept
</td>
<td style="text-align:right;">
0.070
</td>
<td style="text-align:right;">
0.042
</td>
<td style="text-align:right;">
1.66
</td>
<td style="text-align:right;">
0.107
</td>
<td style="text-align:right;">
-0.016
</td>
<td style="text-align:right;">
0.155
</td>
</tr>
<tr>
<td style="text-align:left;">
age
</td>
<td style="text-align:right;">
0.059
</td>
<td style="text-align:right;">
0.008
</td>
<td style="text-align:right;">
7.05
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.042
</td>
<td style="text-align:right;">
0.076
</td>
</tr>
</tbody>
</table>
<p>Given the lack of practical interpretation for the fitted intercept <span class="math inline">\(b_0\)</span>, in this section we’ll focus only on the second row of the table corresponding to the fitted slope <span class="math inline">\(b_1\)</span>. We’ll first interpret the <code>std_error</code>, <code>statistic</code>, <code>p_value</code>, <code>lower_ci</code> and <code>upper_ci</code> columns. Afterwards in the upcoming Subsection <a href="9-inference-for-regression.html#regression-table-computation">9.2.5</a>, we’ll discuss how R computes these values.</p>
<div id="regression-se" class="section level3 hasAnchor" number="9.2.1">
<h3><span class="header-section-number">9.2.1</span> Standard error<a href="9-inference-for-regression.html#regression-se" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The third column of the regression table in Table <a href="9-inference-for-regression.html#tab:regtable-11">9.1</a> <code>std_error</code> corresponds to the <em>standard error</em> of our estimates. Recall the definition of <strong>standard error</strong> we saw in Subsection <a href="5-sampling.html#sampling-definitions">5.3.2</a>:</p>
<blockquote>
<p>The <em>standard error</em> is the standard deviation of any point estimate computed from a sample.</p>
</blockquote>
<p>So what does this mean in terms of the fitted slope <span class="math inline">\(b_1\)</span> = 0.059? This value is just one possible value of the fitted slope resulting from <em>this particular sample</em> of <span class="math inline">\(n\)</span> = 32 pairs of black proportions and ages. However, if we collected a different sample of <span class="math inline">\(n\)</span> = 32 pairs of black proportions and ages, we will almost certainly obtain a different fitted slope <span class="math inline">\(b_1\)</span>. This is due to <em>sampling variability</em>.</p>
<p>Say we hypothetically collected 1000 such samples of pairs of black proportions and ages, computed the 1000 resulting values of the fitted slope <span class="math inline">\(b_1\)</span>, and visualized them in a histogram. This would be a visualization of the <em>sampling distribution</em> of <span class="math inline">\(b_1\)</span>, which we defined in Subsection <a href="5-sampling.html#sampling-definitions">5.3.2</a>. Further recall that the standard deviation of the <em>sampling distribution</em> of <span class="math inline">\(b_1\)</span> has a special name: the <em>standard error</em>.</p>
<p>Recall that we constructed three sampling distributions for the sample proportion <span class="math inline">\(\widehat{p}\)</span> using shovels of size 25, 50, and 100 in Figure <a href="5-sampling.html#fig:comparing-sampling-distributions">5.13</a>. We observed that as the sample size increased, the standard error decreased as evidenced by the narrowing sampling distribution.</p>
<p>The <em>standard error</em> of <span class="math inline">\(b_1\)</span> similarly quantifies how much variation in the fitted slope <span class="math inline">\(b_1\)</span> one would expect between different samples. So in our case, we can expect about 0.008 units of variation in the <code>age</code> slope variable. Recall that the <code>estimate</code> and <code>std_error</code> values play a key role in <em>inferring</em> the value of the unknown population slope <span class="math inline">\(\beta_1\)</span> relating to <em>all</em> lions.</p>
<p>In Section <a href="9-inference-for-regression.html#infer-regression">9.4</a>, we’ll perform a simulation using the <code>infer</code> package to construct the bootstrap distribution for <span class="math inline">\(b_1\)</span> in this case. Recall from Subsection <a href="6-confidence-intervals.html#bootstrap-vs-sampling">6.7</a> that the bootstrap distribution is an <em>approximation</em> to the sampling distribution in that they have a similar shape. Since they have a similar shape, they have similar <em>standard errors</em>. However, unlike the sampling distribution, the bootstrap distribution is constructed from a <em>single</em> sample, which is a practice more aligned with what’s done in real life.</p>
</div>
<div id="regression-test-statistic" class="section level3 hasAnchor" number="9.2.2">
<h3><span class="header-section-number">9.2.2</span> Test statistic<a href="9-inference-for-regression.html#regression-test-statistic" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The fourth column of the regression table in Table <a href="9-inference-for-regression.html#tab:regtable-11">9.1</a>, <code>statistic</code>, corresponds to a <em>test statistic</em> relating to the following <em>hypothesis test</em>:</p>
<p><span class="math display">\[
\begin{aligned}
H_0 &amp;: \beta_1 = 0\\
\text{vs } H_A&amp;: \beta_1 \neq 0.
\end{aligned}
\]</span></p>
<p>Recall our terminology, notation, and definitions related to hypothesis tests we introduced in Section <a href="7-hypothesis-testing.html#understanding-ht">7.2</a>.</p>
<blockquote>
<p>A <em>hypothesis test</em> consists of a test between two competing hypotheses: (1) a <em>null hypothesis</em> <span class="math inline">\(H_0\)</span> versus (2) an <em>alternative hypothesis</em> <span class="math inline">\(H_A\)</span>.</p>
<p>A <em>test statistic</em> is a point estimate/sample statistic formula used for hypothesis testing.</p>
</blockquote>
<p>Here, our <em>null hypothesis</em> <span class="math inline">\(H_0\)</span> assumes that the population slope <span class="math inline">\(\beta_1\)</span> is 0. If the population slope <span class="math inline">\(\beta_1\)</span> is truly 0, then this is saying that there is <em>no true relationship</em> between the black nose proportion and age for <em>all</em> lions in our population. In other words, <span class="math inline">\(x\)</span> = age would have no associated effect on <span class="math inline">\(y\)</span> = proportion.black.
The <em>alternative hypothesis</em> <span class="math inline">\(H_A\)</span>, on the other hand, assumes that the population slope <span class="math inline">\(\beta_1\)</span> is not 0, meaning it could be either positive or negative. This suggests either a positive or negative relationship between black nose proportion and lion age. Recall we called such alternative hypotheses <em>two-sided</em>. By convention, all hypothesis testing for regression assumes two-sided alternatives.</p>
<p>Recall our “hypothesized universe” of no effect of egg removal we <em>assumed</em> in our <code>BirdMalaria</code> activity in Section <a href="7-hypothesis-testing.html#ht-activity">7.1</a>. Similarly here when conducting this hypothesis test, we’ll assume a “hypothesized universe” where there is no relationship between black nose proportion and lion age. In other words, we’ll assume the null hypothesis <span class="math inline">\(H_0: \beta_1 = 0\)</span> is true.</p>
<p>The <code>statistic</code> column in the regression table is a tricky one, however. It corresponds to a standardized <em>t-test statistic</em>, much like the <em>two-sample <span class="math inline">\(t\)</span> statistic</em> we saw in Subsection <a href="7-hypothesis-testing.html#theory-hypo">7.6</a> where we used a theory-based method for conducting hypothesis tests. In both these cases, the <em>null distribution</em> can be mathematically proven to be a <em><span class="math inline">\(t\)</span>-distribution</em>. Since such test statistics are tricky for individuals new to statistical inference to study, we’ll skip this and jump into interpreting the <span class="math inline">\(p\)</span>-value. If you’re curious, we have included a discussion of this standardized <em>t-test statistic</em> in Subsection <a href="9-inference-for-regression.html#theory-regression">9.5</a>.</p>
</div>
<div id="p-value" class="section level3 hasAnchor" number="9.2.3">
<h3><span class="header-section-number">9.2.3</span> p-value<a href="9-inference-for-regression.html#p-value" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The fifth column of the regression table in Table <a href="9-inference-for-regression.html#tab:regtable-11">9.1</a> <code>p_value</code> corresponds to the <em>p-value</em> of the hypothesis test <span class="math inline">\(H_0: \beta_1 = 0\)</span> versus <span class="math inline">\(H_A: \beta_1 \neq 0\)</span>.</p>
<p>Again recalling our terminology, notation, and definitions related to hypothesis tests we introduced in Section <a href="7-hypothesis-testing.html#understanding-ht">7.2</a>, let’s focus on the definition of the <span class="math inline">\(p\)</span>-value:</p>
<blockquote>
<p>A <em>p-value</em> is the probability of obtaining a test statistic just as extreme or more extreme than the observed test statistic <em>assuming the null hypothesis <span class="math inline">\(H_0\)</span> is true</em>.</p>
</blockquote>
<p>Recall that you can intuitively think of the <span class="math inline">\(p\)</span>-value as quantifying how “extreme” the observed fitted slope of <span class="math inline">\(b_1\)</span> = 0.059 is in a “hypothesized universe” where there is no relationship between black nose proportions and lion ages.</p>
<p>Following the hypothesis testing procedure we outlined in Section <a href="7-hypothesis-testing.html#ht-interpretation">7.4</a>, since the <span class="math inline">\(p\)</span>-value in this case is 0, for any choice of significance level <span class="math inline">\(\alpha\)</span> we would reject <span class="math inline">\(H_0\)</span> in favor of <span class="math inline">\(H_A\)</span>. Using non-statistical language, this is saying: we reject the hypothesis that there is no relationship between black nose proportions and lion ages in favor of the hypothesis that there is. That is to say, the evidence suggests there is a significant relationship, one that is positive.</p>
<p>More precisely, however, the <span class="math inline">\(p\)</span>-value corresponds to how extreme the observed test statistic of 7.053 is when compared to the appropriate <em>null distribution</em>. In Section <a href="9-inference-for-regression.html#infer-regression">9.4</a>, we’ll perform a simulation using the <code>infer</code> package to construct the null distribution in this case.</p>
<p>An extra caveat here is that the results of this hypothesis test are only valid if certain “conditions for inference for regression” are met, which we’ll introduce shortly in Section <a href="9-inference-for-regression.html#regression-conditions">9.3</a>.</p>
</div>
<div id="confidence-interval" class="section level3 hasAnchor" number="9.2.4">
<h3><span class="header-section-number">9.2.4</span> Confidence interval<a href="9-inference-for-regression.html#confidence-interval" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The two rightmost columns of the regression table in Table <a href="9-inference-for-regression.html#tab:regtable-11">9.1</a> (<code>lower_ci</code> and <code>upper_ci</code>) correspond to the endpoints of the 95% <em>confidence interval</em> for the population slope <span class="math inline">\(\beta_1\)</span>. Recall our analogy of “nets are to fish” what “confidence intervals are to population parameters” from Section <a href="6-confidence-intervals.html#ci-build-up">6.3</a>. The resulting 95% confidence interval for <span class="math inline">\(\beta_1\)</span> of (0.042, 0.076) can be thought of as a range of plausible values for the population slope <span class="math inline">\(\beta_1\)</span> of the linear relationship between black nose proportions and lion ages.</p>
<p>As we introduced in Subsection <a href="6-confidence-intervals.html#shorthand">6.5.2</a> on the precise and shorthand interpretation of confidence intervals, the statistically precise interpretation of this confidence interval is: “if we repeated this sampling procedure a large number of times, we expect about 95% of the resulting confidence intervals to capture the value of the population slope <span class="math inline">\(\beta_1\)</span>.” However, we’ll summarize this using our shorthand interpretation that “we’re 95% ‘confident’ that the true population slope <span class="math inline">\(\beta_1\)</span> lies between 0.042 and 0.076.”</p>
<p>Notice in this case that the resulting 95% confidence interval for <span class="math inline">\(\beta_1\)</span> of <span class="math inline">\((0.042, \, 0.076)\)</span> does not contain a very particular value: <span class="math inline">\(\beta_1\)</span> equals 0. Recall we mentioned that if the population regression slope <span class="math inline">\(\beta_1\)</span> is 0, this is equivalent to saying there is <em>no</em> relationship between black nose proportions and lion ages. Since <span class="math inline">\(\beta_1\)</span> = 0 is not in our plausible range of values for <span class="math inline">\(\beta_1\)</span>, we are inclined to believe that there, in fact, <em>is</em> a relationship between black nose proportions and lion ages and a positive one at that. So in this case, the conclusion about the population slope <span class="math inline">\(\beta_1\)</span> from the 95% confidence interval matches the conclusion from the hypothesis test: evidence suggests that there is a meaningful relationship between black nose proportions and lion ages.</p>
<p>Recall from Subsection <a href="6-confidence-intervals.html#ci-width">6.5.3</a>, however, that the <em>confidence level</em> is one of many factors that determine confidence interval widths. So for example, say we used a higher confidence level of 99% instead of 95%. The resulting confidence interval for <span class="math inline">\(\beta_1\)</span> would be wider and thus might now include 0. The lesson to remember here is that any confidence-interval-based conclusion depends highly on the confidence level used.</p>
<p>What are the calculations that went into computing the two endpoints of the 95% confidence interval for <span class="math inline">\(\beta_1\)</span>?</p>
<p>Recall our sampling bowl example from Subsection <a href="6-confidence-intervals.html#theory-ci">6.8</a> discussing <code>lower_ci</code> and <code>upper_ci</code>. Since the sampling and bootstrap distributions of the sample proportion <span class="math inline">\(\widehat{p}\)</span> were roughly normal, we could use the rule of thumb for bell-shaped distributions from Appendix <a href="A-appendixA.html#appendix-normal-curve">A.2</a> to create a 95% confidence interval for <span class="math inline">\(p\)</span> with the following equation, where MoE is the margin of error:</p>
<p><span class="math display">\[\widehat{p} \pm \text{MoE}_{\widehat{p}} = \widehat{p} \pm 1.96 \cdot \text{SE}_{\widehat{p}} = \widehat{p} \pm 1.96 \cdot \sqrt{\frac{\widehat{p}(1-\widehat{p})}{n}}\]</span></p>
<p>We can generalize this to other point estimates that have roughly normally shaped sampling and/or bootstrap distributions:</p>
<p><span class="math display">\[\text{point estimate} \pm \text{MoE} = \text{point estimate} \pm 1.96 \cdot \text{SE}.\]</span></p>
<p>We’ll show in Section <a href="9-inference-for-regression.html#infer-regression">9.4</a> that the sampling/bootstrap distribution for the fitted slope <span class="math inline">\(b_1\)</span> is in fact bell-shaped as well. Thus we can construct a 95% confidence interval for <span class="math inline">\(\beta_1\)</span> with the following equation:</p>
<p><span class="math display">\[b_1 \pm \text{MoE}_{b_1} = b_1 \pm 1.96 \cdot \text{SE}_{b_1}.\]</span></p>
<p>What is the value of the standard error <span class="math inline">\(\text{SE}_{b_1}\)</span>? It is in fact in the third column of the regression table in Table <a href="9-inference-for-regression.html#tab:regtable-11">9.1</a>: 0.008. Thus</p>
<p><span class="math display">\[
\begin{aligned}
b_1 \pm 1.96 \cdot \text{SE}_{b_1} &amp;= 0.059 \pm 1.96 \cdot 0.008 = 0.059 \pm 0.016\\
&amp;= (0.043, 0.075)
\end{aligned}
\]</span></p>
<p>This closely matches the <span class="math inline">\((0.042, 0.076)\)</span> confidence interval in the last two columns of Table <a href="9-inference-for-regression.html#tab:regtable-11">9.1</a>.</p>
<p>Much like hypothesis tests, however, the results of this confidence interval also are only valid if the “conditions for inference for regression” to be discussed in Section <a href="9-inference-for-regression.html#regression-conditions">9.3</a> are met.</p>
</div>
<div id="regression-table-computation" class="section level3 hasAnchor" number="9.2.5">
<h3><span class="header-section-number">9.2.5</span> How does R compute the table?<a href="9-inference-for-regression.html#regression-table-computation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Since we didn’t perform the simulation to get the values of the standard error, test statistic, <span class="math inline">\(p\)</span>-value, and endpoints of the 95% confidence interval in Table <a href="9-inference-for-regression.html#tab:regtable-11">9.1</a>, you might be wondering how were these values computed. What did R do behind the scenes? Does R run simulations like we did using the <code>infer</code> package in Chapters <a href="6-confidence-intervals.html#confidence-intervals">6</a> and <a href="7-hypothesis-testing.html#hypothesis-testing">7</a> on confidence intervals and hypothesis testing?</p>
<p>The answer is no! Much like the theory-based method for constructing confidence intervals you saw in Subsection <a href="6-confidence-intervals.html#theory-ci">6.8</a> and the theory-based hypothesis test you saw in Subsection <a href="7-hypothesis-testing.html#theory-hypo">7.6</a>, there exist mathematical formulas that allow you to construct confidence intervals and conduct hypothesis tests for inference for regression. These formulas were derived in a time when computers didn’t exist, so it would’ve been impossible to run the extensive computer simulations we have in this book. We present these formulas in Subsection <a href="9-inference-for-regression.html#theory-regression">9.5</a> on “theory-based inference for regression.”</p>
<p>In Section <a href="9-inference-for-regression.html#infer-regression">9.4</a>, we’ll go over a simulation-based approach to constructing confidence intervals and conducting hypothesis tests using the <code>infer</code> package. In particular, we’ll convince you that the bootstrap distribution of the fitted slope <span class="math inline">\(b_1\)</span> is indeed bell-shaped.</p>
</div>
</div>
<div id="regression-conditions" class="section level2 hasAnchor" number="9.3">
<h2><span class="header-section-number">9.3</span> Conditions for inference for regression<a href="9-inference-for-regression.html#regression-conditions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Recall in Subsection <a href="6-confidence-intervals.html#se-method">6.3.2</a> we stated that we could only use the standard-error-based method for constructing confidence intervals if the bootstrap distribution was bell shaped. Similarly, there are certain conditions that need to be met in order for the results of our hypothesis tests and confidence intervals we described in Section <a href="9-inference-for-regression.html#regression-interp">9.2</a> to have valid meaning. These conditions must be met for the assumed underlying mathematical and probability theory to hold true.</p>
<p>For inference for regression, there are four conditions that need to be met. Note the first four letters of these conditions are highlighted in bold in what follows: <strong>LINE</strong>. This can serve as a nice reminder of what to check for whenever you perform linear regression. </p>
<ol style="list-style-type: decimal">
<li><strong>L</strong>inearity of relationship between variables</li>
<li><strong>I</strong>ndependence of the residuals</li>
<li><strong>N</strong>ormality of the residuals</li>
<li><strong>E</strong>quality of variance of the residuals</li>
</ol>
<p>Conditions <strong>L</strong>, <strong>N</strong>, and <strong>E</strong> can be verified through what is known as a <em>residual analysis</em>. Condition <strong>I</strong> can only be verified through an understanding of how the data was collected.</p>
<p>In this section, we’ll go over a refresher on residuals, verify whether each of the four <strong>LINE</strong> conditions hold true, and then discuss the implications.</p>
<div id="residuals-refresher" class="section level3 hasAnchor" number="9.3.1">
<h3><span class="header-section-number">9.3.1</span> Residuals refresher<a href="9-inference-for-regression.html#residuals-refresher" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Recall our definition of a residual from Subsection <a href="8-regression.html#model1points">8.1.3</a>: it is the <em>observed value</em> minus the <em>fitted value</em> denoted by <span class="math inline">\(y - \widehat{y}\)</span>. Recall that residuals can be thought of as the error or the “lack-of-fit” between the observed value <span class="math inline">\(y\)</span> and the fitted value <span class="math inline">\(\widehat{y}\)</span> on the regression line in Figure <a href="9-inference-for-regression.html#fig:regline">9.1</a>. In Figure <a href="9-inference-for-regression.html#fig:residual-example">9.2</a>, we illustrate one particular residual out of 32 using an arrow, as well as its corresponding observed and fitted values using a circle and a square, respectively.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:residual-example"></span>
<img src="ModernDive_files/figure-html/residual-example-1.png" alt="Example of observed value, fitted value, and residual." width="\textwidth" />
<p class="caption">
FIGURE 9.2: Example of observed value, fitted value, and residual.
</p>
</div>
<p>Furthermore, we can automate the calculation of all <span class="math inline">\(n\)</span> = 32 residuals by applying the <code>get_regression_points()</code> function to our saved regression model in <code>lion_model</code>. Observe how the resulting values of <code>residual</code> are roughly equal to <code>proportion.black - proportion.black_hat</code> (there is potentially a slight difference due to rounding error).</p>
<div class="sourceCode" id="cb383"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb383-1"><a href="9-inference-for-regression.html#cb383-1" tabindex="-1"></a><span class="co"># Fit regression model:</span></span>
<span id="cb383-2"><a href="9-inference-for-regression.html#cb383-2" tabindex="-1"></a>lion_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(proportion.black <span class="sc">~</span> age, <span class="at">data =</span> LionNoses)</span>
<span id="cb383-3"><a href="9-inference-for-regression.html#cb383-3" tabindex="-1"></a><span class="co"># Get regression points:</span></span>
<span id="cb383-4"><a href="9-inference-for-regression.html#cb383-4" tabindex="-1"></a>regression_points <span class="ot">&lt;-</span> <span class="fu">get_regression_points</span>(lion_model)</span>
<span id="cb383-5"><a href="9-inference-for-regression.html#cb383-5" tabindex="-1"></a>regression_points</span></code></pre></div>
<pre><code># A tibble: 32 × 5
      ID proportion.black   age proportion.black_hat residual
   &lt;int&gt;            &lt;dbl&gt; &lt;dbl&gt;                &lt;dbl&gt;    &lt;dbl&gt;
 1     1             0.21   1.1                0.134    0.076
 2     2             0.14   1.5                0.158   -0.018
 3     3             0.11   1.9                0.181   -0.071
 4     4             0.13   2.2                0.199   -0.069
 5     5             0.12   2.6                0.222   -0.102
 6     6             0.13   3.2                0.257   -0.127
 7     7             0.12   3.2                0.257   -0.137
 8     8             0.18   2.9                0.24    -0.06 
 9     9             0.23   2.4                0.21     0.02 
10    10             0.22   2.1                0.193    0.027
# ℹ 22 more rows</code></pre>
<p>A <em>residual analysis</em> is used to verify conditions <strong>L</strong>, <strong>N</strong>, and <strong>E</strong> and can be performed using appropriate data visualizations. While there are more sophisticated statistical approaches that can also be done, we’ll focus on the much simpler approach of looking at plots.</p>
</div>
<div id="linearity-of-relationship" class="section level3 hasAnchor" number="9.3.2">
<h3><span class="header-section-number">9.3.2</span> Linearity of relationship<a href="9-inference-for-regression.html#linearity-of-relationship" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The first condition is that the relationship between the outcome variable <span class="math inline">\(y\)</span> and the explanatory variable <span class="math inline">\(x\)</span> must be <strong>L</strong>inear. Recall the scatterplot in Figure <a href="9-inference-for-regression.html#fig:regline">9.1</a> where we had the explanatory variable <span class="math inline">\(x\)</span> as lion age and the outcome variable <span class="math inline">\(y\)</span> as proportion.black. Would you say that the relationship between <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> is linear? It’s hard to say because of the scatter of the points about the line, but in the authors’ opinions, this relationship is “linear enough.”</p>
<p>Let’s present an example where the relationship between <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> is clearly not linear in Figure <a href="9-inference-for-regression.html#fig:non-linear">9.3</a>. In this case, the points clearly do not form a line, but rather a U-shaped polynomial curve. In this case, any results from an inference for regression would not be valid.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:non-linear"></span>
<img src="ModernDive_files/figure-html/non-linear-1.png" alt="Example of a clearly non-linear relationship." width="\textwidth" />
<p class="caption">
FIGURE 9.3: Example of a clearly non-linear relationship.
</p>
</div>
</div>
<div id="independence-of-residuals" class="section level3 hasAnchor" number="9.3.3">
<h3><span class="header-section-number">9.3.3</span> Independence of residuals<a href="9-inference-for-regression.html#independence-of-residuals" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The second condition is that the residuals must be <strong>I</strong>ndependent. In other words, the different observations in our data must be independent of one another. Presumably, the observations are independent, but without further details about how the study was conducted, we can’t be certain. For example, if the black nose proportion of the same lion was measured multiple times at different ages, then there would be <em>dependence</em> between those observations. If this was the case, a proper analysis of the data would need to take into account that we have <em>repeated measures</em> for the same lions. We’ll presume, however, that the observations are independent of each other.</p>
</div>
<div id="normality-of-residuals" class="section level3 hasAnchor" number="9.3.4">
<h3><span class="header-section-number">9.3.4</span> Normality of residuals<a href="9-inference-for-regression.html#normality-of-residuals" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The third condition is that the residuals should follow a <strong>N</strong>ormal distribution. Furthermore, the center of this distribution should be 0. In other words, sometimes the regression model will make positive errors: <span class="math inline">\(y - \widehat{y} &gt; 0\)</span>. Other times, the regression model will make equally negative errors: <span class="math inline">\(y - \widehat{y} &lt; 0\)</span>. However, <em>on average</em> the errors should equal 0 and their shape should be similar to that of a bell.</p>
<p>The simplest way to check the normality of the residuals is to look at a histogram, which we visualize in Figure <a href="9-inference-for-regression.html#fig:model1residualshist">9.4</a>.</p>
<div class="sourceCode" id="cb385"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb385-1"><a href="9-inference-for-regression.html#cb385-1" tabindex="-1"></a><span class="fu">ggplot</span>(regression_points, <span class="fu">aes</span>(<span class="at">x =</span> residual)) <span class="sc">+</span></span>
<span id="cb385-2"><a href="9-inference-for-regression.html#cb385-2" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.05</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb385-3"><a href="9-inference-for-regression.html#cb385-3" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Residual&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:model1residualshist"></span>
<img src="ModernDive_files/figure-html/model1residualshist-1.png" alt="Histogram of residuals." width="\textwidth" />
<p class="caption">
FIGURE 9.4: Histogram of residuals.
</p>
</div>
<p>This histogram shows that we have more negative residuals than positive. Since the residual <span class="math inline">\(y-\widehat{y}\)</span> is positive when <span class="math inline">\(y &gt; \widehat{y}\)</span>, it seems our regression model’s fitted black nose proportions <span class="math inline">\(\widehat{y}\)</span> tend to <em>overestimate</em> the true <code>proportion.black</code> <span class="math inline">\(y\)</span>. Furthermore, this histogram has a slight <em>right-skew</em> in that there is a tail on the right. This is another way to say the residuals exhibit a <em>positive skew</em>.</p>
<p>Is this a problem? Again, there is a certain amount of subjectivity in the response. In the authors’ opinion, while there is a slight skew to the residuals, we feel it isn’t drastic. On the other hand, others might disagree with our assessment.</p>
<p>Let’s present examples where the residuals clearly do and don’t follow a normal distribution in Figure <a href="9-inference-for-regression.html#fig:normal-residuals">9.5</a>. In this case of the model yielding the clearly non-normal residuals on the right, any results from an inference for regression would not be valid.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:normal-residuals"></span>
<img src="ModernDive_files/figure-html/normal-residuals-1.png" alt="Example of clearly normal and clearly not normal residuals." width="\textwidth" />
<p class="caption">
FIGURE 9.5: Example of clearly normal and clearly not normal residuals.
</p>
</div>
</div>
<div id="equality-of-variance" class="section level3 hasAnchor" number="9.3.5">
<h3><span class="header-section-number">9.3.5</span> Equality of variance<a href="9-inference-for-regression.html#equality-of-variance" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The fourth and final condition is that the residuals should exhibit <strong>E</strong>qual variance across all values of the explanatory variable <span class="math inline">\(x\)</span>. In other words, the value and spread of the residuals should not depend on the value of the explanatory variable <span class="math inline">\(x\)</span>.</p>
<p>Recall the scatterplot in Figure <a href="9-inference-for-regression.html#fig:regline">9.1</a>: we had the explanatory variable <span class="math inline">\(x\)</span> of <code>age</code> on the x-axis and the outcome variable <span class="math inline">\(y\)</span> of <code>proportion.black</code> on the y-axis. Instead, let’s create a scatterplot that has the same values on the x-axis, but now with the residual <span class="math inline">\(y-\widehat{y}\)</span> on the y-axis as seen in Figure <a href="9-inference-for-regression.html#fig:numxplot6">9.6</a>.</p>
<div class="sourceCode" id="cb386"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb386-1"><a href="9-inference-for-regression.html#cb386-1" tabindex="-1"></a><span class="fu">ggplot</span>(regression_points, <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> residual)) <span class="sc">+</span></span>
<span id="cb386-2"><a href="9-inference-for-regression.html#cb386-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb386-3"><a href="9-inference-for-regression.html#cb386-3" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Age (years)&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Residual&quot;</span>) <span class="sc">+</span></span>
<span id="cb386-4"><a href="9-inference-for-regression.html#cb386-4" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:numxplot6"></span>
<img src="ModernDive_files/figure-html/numxplot6-1.png" alt="Plot of residuals over age." width="\textwidth" />
<p class="caption">
FIGURE 9.6: Plot of residuals over age.
</p>
</div>
<p>You can think of Figure <a href="9-inference-for-regression.html#fig:numxplot6">9.6</a> as a modified version of the plot with the regression line in Figure <a href="9-inference-for-regression.html#fig:regline">9.1</a>, but with the regression line flattened out to <span class="math inline">\(y=0\)</span>. Looking at this plot, would you say that the spread of the residuals around the line at <span class="math inline">\(y=0\)</span> is constant across all values of the explanatory variable <span class="math inline">\(x\)</span> of age? This question is rather qualitative and subjective in nature, thus different people may respond with different answers. For example, some people might say that there is slightly less variation in the residuals for smaller values of <span class="math inline">\(x\)</span> than for middle ones. However, it can be argued that there isn’t a <em>drastic</em> non-constancy.</p>
<p>In Figure <a href="9-inference-for-regression.html#fig:equal-variance-residuals">9.7</a> let’s present an example where the residuals clearly do not have equal variance across all values of the explanatory variable <span class="math inline">\(x\)</span>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:equal-variance-residuals"></span>
<img src="ModernDive_files/figure-html/equal-variance-residuals-1.png" alt="Example of clearly non-equal variance." width="\textwidth" />
<p class="caption">
FIGURE 9.7: Example of clearly non-equal variance.
</p>
</div>
<p>Observe how the spread of the residuals increases as the value of <span class="math inline">\(x\)</span> increases. This is a situation known as <em>heteroskedasticity</em>. Any inference for regression based on a model yielding such a pattern in the residuals would not be valid.</p>
</div>
<div id="what-is-the-conclusion" class="section level3 hasAnchor" number="9.3.6">
<h3><span class="header-section-number">9.3.6</span> What’s the conclusion?<a href="9-inference-for-regression.html#what-is-the-conclusion" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s list our four conditions for inference for regression again and indicate whether or not they were satisfied in our analysis:</p>
<ol style="list-style-type: decimal">
<li><strong>L</strong>inearity of relationship between variables: Yes</li>
<li><strong>I</strong>ndependence of residuals: Presumably</li>
<li><strong>N</strong>ormality of residuals: Somewhat</li>
<li><strong>E</strong>quality of variance: Yes</li>
</ol>
<p>So what does this mean for the results of our confidence intervals and hypothesis tests in Section <a href="9-inference-for-regression.html#regression-interp">9.2</a>?</p>
<p>First, the <strong>I</strong>ndependence condition. Since the observations are presumably independent, we can proceed. If there had been dependencies between different rows in <code>LionNoses</code>, then we would need to address this. In more advanced statistics courses, you’ll learn how to incorporate such dependencies into your regression models. One such technique is called <em>hierarchical/multilevel modeling</em>.</p>
<p>Second, when conditions <strong>L</strong>, <strong>N</strong>, <strong>E</strong> are not met, it often means there is a shortcoming in our model. For example, it may be the case that using only a single explanatory variable is insufficient, as we did with proportion.black. We may need to incorporate more explanatory variables in a multiple regression model as we did in Chapter <a href="10-multiple-regression.html#multiple-regression">10</a>.</p>
<p>The conditions for inference in regression problems are a key part of regression analysis that are of vital importance to the processes of constructing confidence intervals and conducting hypothesis tests. However, it is often the case with regression analysis in the real world that not all the conditions are completely met. Furthermore, as you saw, there is a level of subjectivity in the residual analyses to verify the <strong>L</strong>, <strong>N</strong>, and <strong>E</strong> conditions. So what can you do? We as authors advocate for transparency in communicating all results. This lets the stakeholders of any analysis know about a model’s shortcomings or whether the model is “good enough.” So while the checking of assumptions may lead to some fuzzy “it depends” results, you should be prepared for difficult statistical decisions you may need to make down the road.</p>
<div class="learncheck">
<p>
<strong><em>Learning check</em></strong>
</p>
</div>
<p><strong>(LC9.1)</strong> Continuing with our regression using <code>age</code> as the explanatory variable and <code>proportion.black</code> as the outcome variable.</p>
<ul>
<li>Use the <code>get_regression_points()</code> function to get the observed values, fitted values, and residuals for all 32 lions</li>
<li>Perform a residual analysis and look for any systematic patterns in the residuals. Ideally, there should be little to no pattern but comment on what you find here.</li>
</ul>
<div class="learncheck">

</div>
</div>
</div>
<div id="infer-regression" class="section level2 hasAnchor" number="9.4">
<h2><span class="header-section-number">9.4</span> Simulation-based inference for regression<a href="9-inference-for-regression.html#infer-regression" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Recall in Subsection <a href="9-inference-for-regression.html#regression-table-computation">9.2.5</a> when we interpreted the third through seventh columns of a regression table, we stated that R doesn’t do simulations to compute these values. Rather R uses theory-based methods that involve mathematical formulas.</p>
<p>In this section, we’ll use the simulation-based methods you previously learned in Chapters <a href="6-confidence-intervals.html#confidence-intervals">6</a> and <a href="7-hypothesis-testing.html#hypothesis-testing">7</a> to recreate the values in the regression table in Table <a href="9-inference-for-regression.html#tab:regtable-11">9.1</a>. In particular, we’ll use the <code>infer</code> package workflow to</p>
<ul>
<li>Construct a 95% confidence interval for the population slope <span class="math inline">\(\beta_1\)</span> using bootstrap resampling with replacement. We did this previously in Sections <a href="6-confidence-intervals.html#bootstrap-process">6.4</a> with the <code>pennies</code> data and <a href="6-confidence-intervals.html#case-study-two-prop-ci">6.6</a> with the <code>mythbusters_yawn</code> data.</li>
<li>Conduct a hypothesis test of <span class="math inline">\(H_0: \beta_1 = 0\)</span> versus <span class="math inline">\(H_A: \beta_1 \neq 0\)</span> using a permutation test. We did this previously in Sections <a href="7-hypothesis-testing.html#ht-infer">7.3</a> with the <code>BirdMalaria</code> data and <a href="7-hypothesis-testing.html#ht-case-study">7.5</a> with the <code>HornedLizards</code> data.</li>
</ul>
<div id="confidence-interval-for-slope" class="section level3 hasAnchor" number="9.4.1">
<h3><span class="header-section-number">9.4.1</span> Confidence interval for slope<a href="9-inference-for-regression.html#confidence-interval-for-slope" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We’ll construct a 95% confidence interval for <span class="math inline">\(\beta_1\)</span> using the <code>infer</code> workflow outlined in Subsection <a href="6-confidence-intervals.html#infer-workflow">6.4.2</a>. Specifically, we’ll first construct the bootstrap distribution for the fitted slope <span class="math inline">\(b_1\)</span> using our single sample of 32 lions:</p>
<ol style="list-style-type: decimal">
<li><code>specify()</code> the variables of interest in <code>LionNoses</code> with the formula: <code>proportion.black ~ age</code>.</li>
<li><code>generate()</code> replicates by using <code>bootstrap</code> resampling with replacement from the original sample of 32 lions. We generate <code>reps = 1000</code> replicates using <code>type = "bootstrap"</code>.</li>
<li><code>calculate()</code> the summary statistic of interest: the fitted <code>slope</code> <span class="math inline">\(b_1\)</span>.</li>
</ol>
<p>Using this bootstrap distribution, we’ll construct the 95% confidence interval using the percentile method and (if appropriate) the standard error method as well. It is important to note in this case that the bootstrapping with replacement is done <em>row-by-row</em>. Thus, the original pairs of <code>proportion.black</code> and <code>age</code> values are always kept together, but different pairs of <code>proportion.black</code> and <code>age</code> values may be resampled multiple times. The resulting confidence interval will denote a range of plausible values for the unknown population slope <span class="math inline">\(\beta_1\)</span> quantifying the relationship between black nose proportions and lion ages for <em>all</em> lions in this wild population.</p>
<p>Let’s first construct the bootstrap distribution for the fitted slope <span class="math inline">\(b_1\)</span>:</p>
<div class="sourceCode" id="cb387"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb387-1"><a href="9-inference-for-regression.html#cb387-1" tabindex="-1"></a>bootstrap_distn_slope <span class="ot">&lt;-</span> LionNoses <span class="sc">%&gt;%</span> </span>
<span id="cb387-2"><a href="9-inference-for-regression.html#cb387-2" tabindex="-1"></a>  <span class="fu">specify</span>(<span class="at">formula =</span> proportion.black <span class="sc">~</span> age) <span class="sc">%&gt;%</span></span>
<span id="cb387-3"><a href="9-inference-for-regression.html#cb387-3" tabindex="-1"></a>  <span class="fu">generate</span>(<span class="at">reps =</span> <span class="dv">1000</span>, <span class="at">type =</span> <span class="st">&quot;bootstrap&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb387-4"><a href="9-inference-for-regression.html#cb387-4" tabindex="-1"></a>  <span class="fu">calculate</span>(<span class="at">stat =</span> <span class="st">&quot;slope&quot;</span>)</span>
<span id="cb387-5"><a href="9-inference-for-regression.html#cb387-5" tabindex="-1"></a>bootstrap_distn_slope</span></code></pre></div>
<pre><code># A tibble: 1,000 × 2
   replicate      stat
       &lt;int&gt;     &lt;dbl&gt;
 1         1 0.0651055
 2         2 0.0382313
 3         3 0.108056 
 4         4 0.0666601
 5         5 0.0715932
 6         6 0.0854565
 7         7 0.0624868
 8         8 0.0412859
 9         9 0.0796269
10        10 0.0761299
# ℹ 990 more rows</code></pre>
<p>Observe how we have 1000 values of the bootstrapped slope <span class="math inline">\(b_1\)</span> in the <code>stat</code> column. Let’s visualize the 1000 bootstrapped values in Figure <a href="9-inference-for-regression.html#fig:bootstrap-distribution-slope">9.8</a>.</p>
<div class="sourceCode" id="cb389"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb389-1"><a href="9-inference-for-regression.html#cb389-1" tabindex="-1"></a><span class="fu">visualize</span>(bootstrap_distn_slope)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:bootstrap-distribution-slope"></span>
<img src="ModernDive_files/figure-html/bootstrap-distribution-slope-1.png" alt="Bootstrap distribution of slope." width="\textwidth" />
<p class="caption">
FIGURE 9.8: Bootstrap distribution of slope.
</p>
</div>
<p>Observe how the bootstrap distribution is roughly bell-shaped. Recall from Subsection <a href="6-confidence-intervals.html#bootstrap-vs-sampling">6.7</a> that the shape of the bootstrap distribution of <span class="math inline">\(b_1\)</span> closely approximates the shape of the sampling distribution of <span class="math inline">\(b_1\)</span>.</p>
<div id="percentile-method-1" class="section level4 unnumbered hasAnchor">
<h4>Percentile-method<a href="9-inference-for-regression.html#percentile-method-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>First, let’s compute the 95% confidence interval for <span class="math inline">\(\beta_1\)</span> using the percentile method. We’ll do so by identifying the 2.5th and 97.5th percentiles which include the middle 95% of values. Recall that this method does not require the bootstrap distribution to be normally shaped.</p>
<div class="sourceCode" id="cb390"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb390-1"><a href="9-inference-for-regression.html#cb390-1" tabindex="-1"></a>percentile_ci <span class="ot">&lt;-</span> bootstrap_distn_slope <span class="sc">%&gt;%</span> </span>
<span id="cb390-2"><a href="9-inference-for-regression.html#cb390-2" tabindex="-1"></a>  <span class="fu">get_confidence_interval</span>(<span class="at">type =</span> <span class="st">&quot;percentile&quot;</span>, <span class="at">level =</span> <span class="fl">0.95</span>)</span>
<span id="cb390-3"><a href="9-inference-for-regression.html#cb390-3" tabindex="-1"></a>percentile_ci</span></code></pre></div>
<pre><code># A tibble: 1 × 2
   lower_ci  upper_ci
      &lt;dbl&gt;     &lt;dbl&gt;
1 0.0323411 0.0990027</code></pre>
<p>The resulting percentile-based 95% confidence interval for <span class="math inline">\(\beta_1\)</span> of (0.032, 0.099) is similar to the confidence interval in the regression Table <a href="9-inference-for-regression.html#tab:regtable-11">9.1</a> of (0.042, 0.076).</p>
</div>
<div id="standard-error-method" class="section level4 unnumbered hasAnchor">
<h4>Standard error method<a href="9-inference-for-regression.html#standard-error-method" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Since the bootstrap distribution in Figure <a href="9-inference-for-regression.html#fig:bootstrap-distribution-slope">9.8</a> appears to be roughly bell-shaped, we can also construct a 95% confidence interval for <span class="math inline">\(\beta_1\)</span> using the standard error method.</p>
<p>In order to do this, we need to first compute the fitted slope <span class="math inline">\(b_1\)</span>, which will act as the center of our standard error-based confidence interval. While we saw in the regression table in Table <a href="9-inference-for-regression.html#tab:regtable-11">9.1</a> that this was <span class="math inline">\(b_1\)</span> = 0.059, we can also use the <code>infer</code> pipeline with the <code>generate()</code> step removed to calculate it:</p>
<div class="sourceCode" id="cb392"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb392-1"><a href="9-inference-for-regression.html#cb392-1" tabindex="-1"></a>observed_slope <span class="ot">&lt;-</span> LionNoses <span class="sc">%&gt;%</span> </span>
<span id="cb392-2"><a href="9-inference-for-regression.html#cb392-2" tabindex="-1"></a>  <span class="fu">specify</span>(proportion.black <span class="sc">~</span> age) <span class="sc">%&gt;%</span> </span>
<span id="cb392-3"><a href="9-inference-for-regression.html#cb392-3" tabindex="-1"></a>  <span class="fu">calculate</span>(<span class="at">stat =</span> <span class="st">&quot;slope&quot;</span>)</span>
<span id="cb392-4"><a href="9-inference-for-regression.html#cb392-4" tabindex="-1"></a>observed_slope</span></code></pre></div>
<pre><code>Response: proportion.black (numeric)
Explanatory: age (numeric)
# A tibble: 1 × 1
       stat
      &lt;dbl&gt;
1 0.0585912</code></pre>
<p>We then use the <code>get_ci()</code> function with <code>level = 0.95</code> to compute the 95% confidence interval for <span class="math inline">\(\beta_1\)</span>. Note that setting the <code>point_estimate</code> argument to the <code>observed_slope</code> of 0.059 sets the center of the confidence interval.</p>
<div class="sourceCode" id="cb394"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb394-1"><a href="9-inference-for-regression.html#cb394-1" tabindex="-1"></a>se_ci <span class="ot">&lt;-</span> bootstrap_distn_slope <span class="sc">%&gt;%</span> </span>
<span id="cb394-2"><a href="9-inference-for-regression.html#cb394-2" tabindex="-1"></a>  <span class="fu">get_ci</span>(<span class="at">level =</span> <span class="fl">0.95</span>, <span class="at">type =</span> <span class="st">&quot;se&quot;</span>, <span class="at">point_estimate =</span> observed_slope)</span>
<span id="cb394-3"><a href="9-inference-for-regression.html#cb394-3" tabindex="-1"></a>se_ci</span></code></pre></div>
<pre><code># A tibble: 1 × 2
   lower_ci  upper_ci
      &lt;dbl&gt;     &lt;dbl&gt;
1 0.0253308 0.0918515</code></pre>
<p>The resulting standard error-based 95% confidence interval for <span class="math inline">\(\beta_1\)</span> of <span class="math inline">\((0.025, 0.092)\)</span> is slightly different than the confidence interval in the regression Table <a href="9-inference-for-regression.html#tab:regtable-11">9.1</a> of <span class="math inline">\((0.042, 0.076)\)</span>.</p>
</div>
<div id="comparing-all-three" class="section level4 unnumbered hasAnchor">
<h4>Comparing all three<a href="9-inference-for-regression.html#comparing-all-three" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Let’s compare all three confidence intervals in Figure <a href="9-inference-for-regression.html#fig:bootstrap-distribution-slope-CI">9.9</a>, where the percentile-based confidence interval is marked with solid lines, the standard error based confidence interval is marked with dashed lines, and the theory-based confidence interval (0.042, 0.076) from the regression table in Table <a href="9-inference-for-regression.html#tab:regtable-11">9.1</a> is marked with dotted lines.</p>
<div class="sourceCode" id="cb396"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb396-1"><a href="9-inference-for-regression.html#cb396-1" tabindex="-1"></a><span class="fu">visualize</span>(bootstrap_distn_slope) <span class="sc">+</span> </span>
<span id="cb396-2"><a href="9-inference-for-regression.html#cb396-2" tabindex="-1"></a>  <span class="fu">shade_confidence_interval</span>(<span class="at">endpoints =</span> percentile_ci, <span class="at">fill =</span> <span class="cn">NULL</span>, </span>
<span id="cb396-3"><a href="9-inference-for-regression.html#cb396-3" tabindex="-1"></a>                            <span class="at">linetype =</span> <span class="st">&quot;solid&quot;</span>, <span class="at">color =</span> <span class="st">&quot;grey90&quot;</span>) <span class="sc">+</span> </span>
<span id="cb396-4"><a href="9-inference-for-regression.html#cb396-4" tabindex="-1"></a>  <span class="fu">shade_confidence_interval</span>(<span class="at">endpoints =</span> se_ci, <span class="at">fill =</span> <span class="cn">NULL</span>, </span>
<span id="cb396-5"><a href="9-inference-for-regression.html#cb396-5" tabindex="-1"></a>                            <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;grey60&quot;</span>) <span class="sc">+</span></span>
<span id="cb396-6"><a href="9-inference-for-regression.html#cb396-6" tabindex="-1"></a>  <span class="fu">shade_confidence_interval</span>(<span class="at">endpoints =</span> <span class="fu">c</span>(<span class="fl">0.035</span>, <span class="fl">0.099</span>), <span class="at">fill =</span> <span class="cn">NULL</span>, </span>
<span id="cb396-7"><a href="9-inference-for-regression.html#cb396-7" tabindex="-1"></a>                            <span class="at">linetype =</span> <span class="st">&quot;dotted&quot;</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:bootstrap-distribution-slope-CI"></span>
<img src="ModernDive_files/figure-html/bootstrap-distribution-slope-CI-1.png" alt="Comparing three confidence intervals for the slope." width="\textwidth" />
<p class="caption">
FIGURE 9.9: Comparing three confidence intervals for the slope.
</p>
</div>
<p>Observe that all three are quite similar! Furthermore, none of the three confidence intervals for <span class="math inline">\(\beta_1\)</span> contain 0 and are entirely located above 0. This is suggesting that there is in fact a meaningful positive relationship between black nose proportions and lion ages.</p>
</div>
</div>
<div id="hypothesis-test-for-slope" class="section level3 hasAnchor" number="9.4.2">
<h3><span class="header-section-number">9.4.2</span> Hypothesis test for slope<a href="9-inference-for-regression.html#hypothesis-test-for-slope" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s now conduct a hypothesis test of <span class="math inline">\(H_0: \beta_1 = 0\)</span> vs. <span class="math inline">\(H_A: \beta_1 \neq 0\)</span>. We will use the <code>infer</code> package, which follows the hypothesis testing paradigm in the “There is only one test” diagram in Figure <a href="7-hypothesis-testing.html#fig:htdowney">7.14</a>.</p>
<p>Let’s first think about what it means for <span class="math inline">\(\beta_1\)</span> to be zero as assumed in the null hypothesis <span class="math inline">\(H_0\)</span>. Recall we said if <span class="math inline">\(\beta_1 = 0\)</span>, then this is saying there is no relationship between the black nose proportions and lion ages. Thus assuming this particular null hypothesis <span class="math inline">\(H_0\)</span> means that in our “hypothesized universe” there is no relationship between <code>proportion.black</code> and <code>age</code>. We can therefore shuffle/permute the <code>age</code> variable to no consequence.</p>
<p>We construct the null distribution of the fitted slope <span class="math inline">\(b_1\)</span> by performing the steps that follow. Recall from Section <a href="7-hypothesis-testing.html#understanding-ht">7.2</a> on terminology, notation, and definitions related to hypothesis testing where we defined the <em>null distribution</em>: the sampling distribution of our test statistic <span class="math inline">\(b_1\)</span> assuming the null hypothesis <span class="math inline">\(H_0\)</span> is true.</p>
<ol style="list-style-type: decimal">
<li><code>specify()</code> the variables of interest in <code>LionNoses</code> with the formula: <code>proportion.black ~ age</code>.</li>
<li><code>hypothesize()</code> the null hypothesis of <code>independence</code>. Recall from Section <a href="7-hypothesis-testing.html#ht-infer">7.3</a> that this is an additional step that needs to be added for hypothesis testing.</li>
<li><code>generate()</code> replicates by permuting/shuffling values from the original sample of 32 courses. We generate <code>reps = 1000</code> replicates using <code>type = "permute"</code> here.</li>
<li><code>calculate()</code> the test statistic of interest: the fitted <code>slope</code> <span class="math inline">\(b_1\)</span>.</li>
</ol>
<p>In this case, we <code>permute</code> the values of <code>age</code> across the values of <code>proportion.black</code> 1000 times. We can do this shuffling/permuting since we assumed a “hypothesized universe” of no relationship between these two variables. Then we <code>calculate</code> the <code>"slope"</code> coefficient for each of these 1000 <code>generate</code>d samples.</p>
<div class="sourceCode" id="cb397"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb397-1"><a href="9-inference-for-regression.html#cb397-1" tabindex="-1"></a>null_distn_slope <span class="ot">&lt;-</span> LionNoses <span class="sc">%&gt;%</span> </span>
<span id="cb397-2"><a href="9-inference-for-regression.html#cb397-2" tabindex="-1"></a>  <span class="fu">specify</span>(proportion.black <span class="sc">~</span> age) <span class="sc">%&gt;%</span></span>
<span id="cb397-3"><a href="9-inference-for-regression.html#cb397-3" tabindex="-1"></a>  <span class="fu">hypothesize</span>(<span class="at">null =</span> <span class="st">&quot;independence&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb397-4"><a href="9-inference-for-regression.html#cb397-4" tabindex="-1"></a>  <span class="fu">generate</span>(<span class="at">reps =</span> <span class="dv">1000</span>, <span class="at">type =</span> <span class="st">&quot;permute&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb397-5"><a href="9-inference-for-regression.html#cb397-5" tabindex="-1"></a>  <span class="fu">calculate</span>(<span class="at">stat =</span> <span class="st">&quot;slope&quot;</span>)</span></code></pre></div>
<p>Observe the resulting null distribution for the fitted slope <span class="math inline">\(b_1\)</span> in Figure <a href="9-inference-for-regression.html#fig:null-distribution-slope">9.10</a>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:null-distribution-slope"></span>
<img src="ModernDive_files/figure-html/null-distribution-slope-1.png" alt="Null distribution of slopes." width="\textwidth" />
<p class="caption">
FIGURE 9.10: Null distribution of slopes.
</p>
</div>
<p>Notice how it is centered at <span class="math inline">\(b_1\)</span> = 0. This is because in our hypothesized universe, there is no relationship between <code>proportion.black</code> and <code>age</code> and so <span class="math inline">\(\beta_1 = 0\)</span>. Thus, the most typical fitted slope <span class="math inline">\(b_1\)</span> we observe across our simulations is 0. Observe, furthermore, how there is variation around this central value of 0.</p>
<p>Let’s visualize the <span class="math inline">\(p\)</span>-value in the null distribution by comparing it to the observed test statistic of <span class="math inline">\(b_1\)</span> = 0.059 in Figure <a href="9-inference-for-regression.html#fig:p-value-slope">9.11</a>. We’ll do this by adding a <code>shade_p_value()</code> layer to the previous <code>visualize()</code> code.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:p-value-slope"></span>
<img src="ModernDive_files/figure-html/p-value-slope-1.png" alt="Null distribution and $p$-value." width="\textwidth" />
<p class="caption">
FIGURE 9.11: Null distribution and <span class="math inline">\(p\)</span>-value.
</p>
</div>
<p>Since the observed fitted slope 0.059 falls far to the right of this null distribution and thus the shaded region doesn’t overlap it, we’ll have a <span class="math inline">\(p\)</span>-value of 0. For completeness, however, let’s compute the numerical value of the <span class="math inline">\(p\)</span>-value anyways using the <code>get_p_value()</code> function. Recall that it takes the same inputs as the <code>shade_p_value()</code> function:</p>
<div class="sourceCode" id="cb398"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb398-1"><a href="9-inference-for-regression.html#cb398-1" tabindex="-1"></a>null_distn_slope <span class="sc">%&gt;%</span> </span>
<span id="cb398-2"><a href="9-inference-for-regression.html#cb398-2" tabindex="-1"></a>  <span class="fu">get_p_value</span>(<span class="at">obs_stat =</span> observed_slope, <span class="at">direction =</span> <span class="st">&quot;both&quot;</span>)</span></code></pre></div>
<pre><code># A tibble: 1 × 1
  p_value
    &lt;dbl&gt;
1       0</code></pre>
<p>This matches the <span class="math inline">\(p\)</span>-value of 0 in the regression table in Table <a href="9-inference-for-regression.html#tab:regtable-11">9.1</a>. We therefore reject the null hypothesis <span class="math inline">\(H_0: \beta_1 = 0\)</span> in favor of the alternative hypothesis <span class="math inline">\(H_A: \beta_1 \neq 0\)</span>. We thus have evidence that suggests there is a significant relationship between black nose proportions and lion ages for <em>all</em> lions in this population.</p>
<p>When the conditions for inference for regression are met and the null distribution has a bell shape, we are likely to see similar results between the simulation-based results we just demonstrated and the theory-based results shown in the regression table in Table <a href="9-inference-for-regression.html#tab:regtable-11">9.1</a>.</p>
<div class="learncheck">
<p>
<strong><em>Learning check</em></strong>
</p>
</div>
<p><strong>(LC9.2)</strong> Repeat the inference but this time for the correlation coefficient instead of the slope. Note the implementation of <code>stat = "correlation"</code> in the <code>calculate()</code> function of the <code>infer</code> package.</p>
<div class="learncheck">

</div>
</div>
</div>
<div id="theory-regression" class="section level2 hasAnchor" number="9.5">
<h2><span class="header-section-number">9.5</span> Theory-based inference for regression<a href="9-inference-for-regression.html#theory-regression" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Recall in Subsection <a href="9-inference-for-regression.html#regression-table-computation">9.2.5</a> when we interpreted the regression table in Table <a href="9-inference-for-regression.html#tab:regtable-11">9.1</a>, we mentioned that R does not compute its values using simulation-based methods for constructing confidence intervals and conducting hypothesis tests as we did in Chapters <a href="6-confidence-intervals.html#confidence-intervals">6</a> and <a href="7-hypothesis-testing.html#hypothesis-testing">7</a> using the <code>infer</code> package. Rather, R uses a theory-based approach using mathematical formulas, much like the theory-based confidence intervals you saw in Subsection <a href="6-confidence-intervals.html#theory-ci">6.8</a> and the theory-based hypothesis tests you saw in Subsection <a href="7-hypothesis-testing.html#theory-hypo">7.6</a>. These formulas were derived in a time when computers didn’t exist, so it would’ve been incredibly labor intensive to run extensive simulations.</p>
<p>In particular, there is a formula for the <em>standard error</em> of the fitted slope <span class="math inline">\(b_1\)</span>:</p>
<p><span class="math display">\[\text{SE}_{b_1} = \dfrac{\dfrac{s_y}{s_x} \cdot \sqrt{1-r^2}}{\sqrt{n-2}}\]</span></p>
<!-- Source: https://stats.stackexchange.com/questions/342632/how-to-understand-se-of-regression-slope-equation -->
<p>As with many formulas in statistics, there’s a lot going on here, so let’s first break down what each symbol represents. First <span class="math inline">\(s_x\)</span> and <span class="math inline">\(s_y\)</span> are the <em>sample standard deviations</em> of the explanatory variable <code>age</code> and the response variable <code>proportion.black</code>, respectively. Second, <span class="math inline">\(r\)</span> is the sample <em>correlation coefficient</em> between <code>proportion.black</code> and <code>age</code>. This was computed as 0.79 in Chapter <a href="8-regression.html#regression">8</a>. Lastly, <span class="math inline">\(n\)</span> is the number of pairs of points in the <code>LionNoses</code> data frame, here 32.</p>
<p>To put this formula into words, the standard error of <span class="math inline">\(b_1\)</span> depends on the relationship between the variability of the response variable and the variability of the explanatory variable as measured in the <span class="math inline">\(s_y / s_x\)</span> term. Next, it looks into how the two variables relate to each other in the <span class="math inline">\(\sqrt{1-r^2}\)</span> term.</p>
<p>However, the most important observation to make in the previous formula is that there is an <span class="math inline">\(n - 2\)</span> in the denominator. In other words, as the sample size <span class="math inline">\(n\)</span> increases, the standard error <span class="math inline">\(\text{SE}_{b_1}\)</span> decreases. Just as we demonstrated in Subsection <a href="5-sampling.html#moral-of-the-story">5.3.3</a> when we used shovels with <span class="math inline">\(n\)</span> = 25, 50, and 100 slots, the amount of sampling variation of the fitted slope <span class="math inline">\(b_1\)</span> will depend on the sample size <span class="math inline">\(n\)</span>. In particular, as the sample size increases, both the sampling and bootstrap distributions narrow and the standard error <span class="math inline">\(\text{SE}_{b_1}\)</span> decreases. Hence, our estimates of <span class="math inline">\(b_1\)</span> for the true population slope <span class="math inline">\(\beta_1\)</span> get more and more <em>precise</em>.</p>
<p>R then uses this formula for the standard error of <span class="math inline">\(b_1\)</span> in the third column of the regression table and subsequently to construct 95% confidence intervals. But what about the hypothesis test? Much like with our theory-based hypothesis test in Subsection <a href="7-hypothesis-testing.html#theory-hypo">7.6</a>, R uses the following <em><span class="math inline">\(t\)</span>-statistic</em> as the test statistic for hypothesis testing:</p>
<p><span class="math display">\[
t = \dfrac{ b_1 - \beta_1}{ \text{SE}_{b_1}}
\]</span></p>
<p>And since the null hypothesis <span class="math inline">\(H_0: \beta_1 = 0\)</span> is assumed during the hypothesis test, the <span class="math inline">\(t\)</span>-statistic becomes</p>
<p><span class="math display">\[
t = \dfrac{ b_1 - 0}{ \text{SE}_{b_1}} = \dfrac{ b_1 }{ \text{SE}_{b_1}}
\]</span></p>
<p>What are the values of <span class="math inline">\(b_1\)</span> and <span class="math inline">\(\text{SE}_{b_1}\)</span>? They are in the <code>estimate</code> and <code>std_error</code> column of the regression table in Table <a href="9-inference-for-regression.html#tab:regtable-11">9.1</a>. Thus the value of 7.053 in the table is computed as 0.059/0.008 = 7.375. Note there is a difference due to some rounding error here.</p>
<p>Lastly, to compute the <span class="math inline">\(p\)</span>-value, we need to compare the observed test statistic of 7.053 to the appropriate null distribution. Recall from Section <a href="7-hypothesis-testing.html#understanding-ht">7.2</a>, that a null distribution is the sampling distribution of the test statistic <em>assuming the null hypothesis <span class="math inline">\(H_0\)</span> is true</em>. Much like in our theory-based hypothesis test in Subsection <a href="7-hypothesis-testing.html#theory-hypo">7.6</a>, it can be mathematically proven that this distribution is a <span class="math inline">\(t\)</span>-distribution with degrees of freedom equal to <span class="math inline">\(df = n - 2 = 32 - 2 = 30\)</span>.</p>
<p>Don’t worry if you’re feeling a little overwhelmed at this point. There is a lot of background theory to understand before you can fully make sense of the equations for theory-based methods. That being said, theory-based methods and simulation-based methods for constructing confidence intervals and conducting hypothesis tests often yield consistent results. As mentioned before, in our opinion, two large benefits of simulation-based methods over theory-based are that (1) they are easier for people new to statistical inference to understand, and (2) they also work in situations where theory-based methods and mathematical formulas don’t exist.</p>
<!--
v2 TODO: Consider adding

### Relating regression to other methods

To conclude this chapter, we'll be investigating how regression relates to two different statistical techniques. One of them was covered already in this book, the difference in sample means, and the other is new to the text but is related, ANOVA. We'll see how both can be represented in the regression framework. The hope is that this closing section helps you to tie together many of the concepts you've seen in the Data Modeling and Statistical Inference parts of this book.

#### Two sample difference in means

#### ANOVA


-->
</div>
<div id="inference-conclusion" class="section level2 hasAnchor" number="9.6">
<h2><span class="header-section-number">9.6</span> Conclusion<a href="9-inference-for-regression.html#inference-conclusion" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="review">
<p>
<strong><em>Chapter Learning Summary</em></strong>
</p>
<ul>
<li>
The fitted intercept and slope for a regression line based on a
sample are point estimates of these values for the regression line of
the population.<br />
</li>
<li>
The standard errors of the fitted intercept <span class="math inline"><span class="math inline">\(b_0\)</span></span> and slope <span class="math inline"><span class="math inline">\(b_1\)</span></span> quantify the sampling
variability.<br />
</li>
<li>
The null hypothesis for linear regression is that the population
slope <span class="math inline"><span class="math inline">\(B_1\)</span></span> equals 0, indicating no
relationship between the response and explanatory variables.<br />
</li>
<li>
Linear regression compares the observed standardized <em>t</em>-test
statistic to its null distribution to determine the
<em>p</em>-value.<br />
</li>
<li>
Linear regression uses the standard errors of <span class="math inline"><span class="math inline">\(b_0\)</span></span> and <span class="math inline"><span class="math inline">\(b_1\)</span></span> to calculate the confidence intervals
of each coefficient.<br />
</li>
<li>
For linear regression results to be valid, the residuals must have a
linear relationship, be independent, and have a normal distribution and
equal variance across all <span class="math inline"><span class="math inline">\(x\)</span></span> values
(LINE).<br />
</li>
<li>
In addition to the theory-based method, computer-based methods can
also be used to compute the <em>p</em>-value and 95% confidence interval
for <span class="math inline"><span class="math inline">\(B_0\)</span></span> and <span class="math inline"><span class="math inline">\(B_1\)</span></span>.<br />
</li>
</ul>
</div>
<div id="summary-of-statistical-inference" class="section level3 hasAnchor" number="9.6.1">
<h3><span class="header-section-number">9.6.1</span> Summary of statistical inference<a href="9-inference-for-regression.html#summary-of-statistical-inference" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We’ve finished the last scenario from the “Scenarios of sampling for inference” table in Subsection <a href="5-sampling.html#sampling-conclusion-table">5.6</a>, which we re-display in Table <a href="9-inference-for-regression.html#tab:table-ch11">9.4</a>.</p>
<table class="table" style="font-size: 16px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:table-ch11">TABLE 9.4: </span>Scenarios of sampling for inference
</caption>
<thead>
<tr>
<th style="text-align:right;">
Scenario
</th>
<th style="text-align:left;">
Population parameter
</th>
<th style="text-align:left;">
Notation
</th>
<th style="text-align:left;">
Point estimate
</th>
<th style="text-align:left;">
Symbol(s)
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;width: 0.5in; ">
1
</td>
<td style="text-align:left;width: 1.5in; ">
Population proportion
</td>
<td style="text-align:left;width: 0.65in; ">
<span class="math inline">\(p\)</span>
</td>
<td style="text-align:left;width: 1.6in; ">
Sample proportion
</td>
<td style="text-align:left;width: 0.65in; ">
<span class="math inline">\(\widehat{p}\)</span>
</td>
</tr>
<tr>
<td style="text-align:right;width: 0.5in; ">
2
</td>
<td style="text-align:left;width: 1.5in; ">
Population mean
</td>
<td style="text-align:left;width: 0.65in; ">
<span class="math inline">\(\mu\)</span>
</td>
<td style="text-align:left;width: 1.6in; ">
Sample mean
</td>
<td style="text-align:left;width: 0.65in; ">
<span class="math inline">\(\overline{x}\)</span> or <span class="math inline">\(\widehat{\mu}\)</span>
</td>
</tr>
<tr>
<td style="text-align:right;width: 0.5in; ">
3
</td>
<td style="text-align:left;width: 1.5in; ">
Difference in population proportions
</td>
<td style="text-align:left;width: 0.65in; ">
<span class="math inline">\(p_1 - p_2\)</span>
</td>
<td style="text-align:left;width: 1.6in; ">
Difference in sample proportions
</td>
<td style="text-align:left;width: 0.65in; ">
<span class="math inline">\(\widehat{p}_1 - \widehat{p}_2\)</span>
</td>
</tr>
<tr>
<td style="text-align:right;width: 0.5in; ">
4
</td>
<td style="text-align:left;width: 1.5in; ">
Difference in population means
</td>
<td style="text-align:left;width: 0.65in; ">
<span class="math inline">\(\mu_1 - \mu_2\)</span>
</td>
<td style="text-align:left;width: 1.6in; ">
Difference in sample means
</td>
<td style="text-align:left;width: 0.65in; ">
<span class="math inline">\(\overline{x}_1 - \overline{x}_2\)</span>
</td>
</tr>
<tr>
<td style="text-align:right;width: 0.5in; ">
5
</td>
<td style="text-align:left;width: 1.5in; ">
Population regression slope
</td>
<td style="text-align:left;width: 0.65in; ">
<span class="math inline">\(\beta_1\)</span>
</td>
<td style="text-align:left;width: 1.6in; ">
Fitted regression slope
</td>
<td style="text-align:left;width: 0.65in; ">
<span class="math inline">\(b_1\)</span> or <span class="math inline">\(\widehat{\beta}_1\)</span>
</td>
</tr>
</tbody>
</table>
<p>Armed with the regression modeling techniques you learned in Chapter <a href="8-regression.html#regression">8</a>, your understanding of sampling for inference in Chapter <a href="5-sampling.html#sampling">5</a>, and the tools for statistical inference like confidence intervals and hypothesis tests in Chapters <a href="6-confidence-intervals.html#confidence-intervals">6</a> and <a href="7-hypothesis-testing.html#hypothesis-testing">7</a>, you’re now equipped to study the significance of relationships between variables in a wide array of data! Many of the ideas presented here can be extended into multiple regression, as we’ll see in Chapter <a href="10-multiple-regression.html#multiple-regression">10</a> and other more advanced modeling techniques.</p>
<!--
### Additional resources



An R script file of all R code used in this chapter is available [here](scripts/10-inference-for-regression.R).
-->
</div>
<div id="whats-to-come-8" class="section level3 hasAnchor" number="9.6.2">
<h3><span class="header-section-number">9.6.2</span> What’s to come<a href="9-inference-for-regression.html#whats-to-come-8" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In Chapter <a href="10-multiple-regression.html#multiple-regression">10</a>, we’ll study <em>multiple regression</em>, where our regression models can now have more than one explanatory variable! In particular, we’ll consider two scenarios: regression models with one numerical and one categorical explanatory variable and regression models with two categorical explanatory variables. This will allow you to construct more sophisticated and more powerful models, all in the hopes of better explaining your outcome variable <span class="math inline">\(y\)</span>.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="8-regression.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="10-multiple-regression.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/moderndive/moderndive_book/edit/master/09-inference-for-regression.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
