<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 8 Basic Regression | Modern Biological Data Analysis</title>
  <meta name="description" content="An open-source and fully-reproducible electronic textbook for teaching statistical inference using tidyverse data science tools." />
  <meta name="generator" content="bookdown 0.26 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 8 Basic Regression | Modern Biological Data Analysis" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://moderndive.com//images/logos/book_cover.png" />
  <meta property="og:description" content="An open-source and fully-reproducible electronic textbook for teaching statistical inference using tidyverse data science tools." />
  <meta name="github-repo" content="moderndive/ModernDive_book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 8 Basic Regression | Modern Biological Data Analysis" />
  <meta name="twitter:site" content="@ModernDive" />
  <meta name="twitter:description" content="An open-source and fully-reproducible electronic textbook for teaching statistical inference using tidyverse data science tools." />
  <meta name="twitter:image" content="https://moderndive.com//images/logos/book_cover.png" />

<meta name="author" content="Chester Ismay and Albert Y. Kim   Foreword by Kelly S. McConville   Adapted by William R. Morgan" />


<meta name="date" content="2022-08-16" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  <link rel="apple-touch-icon-precomposed" sizes="152x152" href="images/logos/favicons/apple-touch-icon.png" />
  <link rel="shortcut icon" href="images/logos/favicons/favicon.ico" type="image/x-icon" />
<link rel="prev" href="7-hypothesis-testing.html"/>
<link rel="next" href="9-inference-for-regression.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<link href="libs/dygraphs-1.1.1/dygraph.css" rel="stylesheet" />
<script src="libs/dygraphs-1.1.1/dygraph-combined.js"></script>
<script src="libs/dygraphs-1.1.1/shapes.js"></script>
<script src="libs/moment-2.8.4/moment.js"></script>
<script src="libs/moment-timezone-0.2.5/moment-timezone-with-data.js"></script>
<script src="libs/moment-fquarter-1.0.0/moment-fquarter.min.js"></script>
<script src="libs/dygraphs-binding-1.1.1.6/dygraphs.js"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-89938436-1', 'auto');
  ga('send', 'pageview');

</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>ModernDive for Life Scientists</a></li>
<li class="chapter" data-level="" data-path="foreword.html"><a href="foreword.html"><i class="fa fa-check"></i>Foreword</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#introduction-for-students"><i class="fa fa-check"></i>Introduction for students</a>
<ul>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#what-we-hope-you-will-learn-from-this-book"><i class="fa fa-check"></i>What we hope you will learn from this book</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#datascience-pipeline"><i class="fa fa-check"></i>Data/science pipeline</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#reproducible-research"><i class="fa fa-check"></i>Reproducible research</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#final-note-for-students"><i class="fa fa-check"></i>Final note for students</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#introduction-for-instructors"><i class="fa fa-check"></i>Introduction for instructors</a>
<ul>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#resources"><i class="fa fa-check"></i>Resources</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#why-did-we-write-this-book"><i class="fa fa-check"></i>Why did we write this book?</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#who-is-this-book-for"><i class="fa fa-check"></i>Who is this book for?</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#connect-and-contribute"><i class="fa fa-check"></i>Connect and contribute</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#acknowledgements"><i class="fa fa-check"></i>Acknowledgements</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#about-this-book"><i class="fa fa-check"></i>About this book</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="about-the-authors.html"><a href="about-the-authors.html"><i class="fa fa-check"></i>About the authors</a></li>
<li class="chapter" data-level="" data-path="about-the-adapting-author.html"><a href="about-the-adapting-author.html"><i class="fa fa-check"></i>About the adapting author</a></li>
<li class="chapter" data-level="1" data-path="1-getting-started.html"><a href="1-getting-started.html"><i class="fa fa-check"></i><b>1</b> Getting Started with Data in R</a>
<ul>
<li class="chapter" data-level="1.1" data-path="1-getting-started.html"><a href="1-getting-started.html#r-rstudio"><i class="fa fa-check"></i><b>1.1</b> What are R and RStudio?</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="1-getting-started.html"><a href="1-getting-started.html#installing"><i class="fa fa-check"></i><b>1.1.1</b> Installing R and RStudio</a></li>
<li class="chapter" data-level="1.1.2" data-path="1-getting-started.html"><a href="1-getting-started.html#using-r-via-rstudio"><i class="fa fa-check"></i><b>1.1.2</b> Using R via RStudio</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="1-getting-started.html"><a href="1-getting-started.html#code"><i class="fa fa-check"></i><b>1.2</b> How do I code in R?</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="1-getting-started.html"><a href="1-getting-started.html#programming-concepts"><i class="fa fa-check"></i><b>1.2.1</b> Basic programming concepts and terminology</a></li>
<li class="chapter" data-level="1.2.2" data-path="1-getting-started.html"><a href="1-getting-started.html#messages"><i class="fa fa-check"></i><b>1.2.2</b> Errors, warnings, and messages</a></li>
<li class="chapter" data-level="1.2.3" data-path="1-getting-started.html"><a href="1-getting-started.html#tips-code"><i class="fa fa-check"></i><b>1.2.3</b> Tips on learning to code</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="1-getting-started.html"><a href="1-getting-started.html#packages"><i class="fa fa-check"></i><b>1.3</b> What are R packages?</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="1-getting-started.html"><a href="1-getting-started.html#package-installation"><i class="fa fa-check"></i><b>1.3.1</b> Package installation</a></li>
<li class="chapter" data-level="1.3.2" data-path="1-getting-started.html"><a href="1-getting-started.html#package-loading"><i class="fa fa-check"></i><b>1.3.2</b> Package loading</a></li>
<li class="chapter" data-level="1.3.3" data-path="1-getting-started.html"><a href="1-getting-started.html#package-use"><i class="fa fa-check"></i><b>1.3.3</b> Package use</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="1-getting-started.html"><a href="1-getting-started.html#mammalsdb"><i class="fa fa-check"></i><b>1.4</b> Explore your first data sets</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="1-getting-started.html"><a href="1-getting-started.html#openintropackage"><i class="fa fa-check"></i><b>1.4.1</b> <code>openintro</code> package</a></li>
<li class="chapter" data-level="1.4.2" data-path="1-getting-started.html"><a href="1-getting-started.html#mammalsdataframe"><i class="fa fa-check"></i><b>1.4.2</b> <code>mammals</code> data frame</a></li>
<li class="chapter" data-level="1.4.3" data-path="1-getting-started.html"><a href="1-getting-started.html#exploredataframes"><i class="fa fa-check"></i><b>1.4.3</b> Exploring data frames</a></li>
<li class="chapter" data-level="1.4.4" data-path="1-getting-started.html"><a href="1-getting-started.html#identification-vs-measurement-variables"><i class="fa fa-check"></i><b>1.4.4</b> Identification and measurement variables</a></li>
<li class="chapter" data-level="1.4.5" data-path="1-getting-started.html"><a href="1-getting-started.html#help-files"><i class="fa fa-check"></i><b>1.4.5</b> Help files</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="1-getting-started.html"><a href="1-getting-started.html#csv"><i class="fa fa-check"></i><b>1.5</b> Importing data</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="1-getting-started.html"><a href="1-getting-started.html#using-the-console"><i class="fa fa-check"></i><b>1.5.1</b> Using the console</a></li>
<li class="chapter" data-level="1.5.2" data-path="1-getting-started.html"><a href="1-getting-started.html#using-rstudios-interface"><i class="fa fa-check"></i><b>1.5.2</b> Using RStudio’s interface</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="1-getting-started.html"><a href="1-getting-started.html#conclusion"><i class="fa fa-check"></i><b>1.6</b> Conclusion</a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="1-getting-started.html"><a href="1-getting-started.html#additional-resources"><i class="fa fa-check"></i><b>1.6.1</b> Additional resources</a></li>
<li class="chapter" data-level="1.6.2" data-path="1-getting-started.html"><a href="1-getting-started.html#whats-to-come"><i class="fa fa-check"></i><b>1.6.2</b> What’s to come?</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>I Data Science with tidyverse</b></span></li>
<li class="chapter" data-level="2" data-path="2-viz.html"><a href="2-viz.html"><i class="fa fa-check"></i><b>2</b> Data Visualization</a>
<ul>
<li class="chapter" data-level="" data-path="2-viz.html"><a href="2-viz.html#needed-packages"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="2.1" data-path="2-viz.html"><a href="2-viz.html#grammarofgraphics"><i class="fa fa-check"></i><b>2.1</b> The grammar of graphics</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="2-viz.html"><a href="2-viz.html#components-of-the-grammar"><i class="fa fa-check"></i><b>2.1.1</b> Components of the grammar</a></li>
<li class="chapter" data-level="2.1.2" data-path="2-viz.html"><a href="2-viz.html#gapminder"><i class="fa fa-check"></i><b>2.1.2</b> Gapminder data</a></li>
<li class="chapter" data-level="2.1.3" data-path="2-viz.html"><a href="2-viz.html#other-components"><i class="fa fa-check"></i><b>2.1.3</b> Other components</a></li>
<li class="chapter" data-level="2.1.4" data-path="2-viz.html"><a href="2-viz.html#ggplot2-package"><i class="fa fa-check"></i><b>2.1.4</b> ggplot2 package</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="2-viz.html"><a href="2-viz.html#FiveNG"><i class="fa fa-check"></i><b>2.2</b> Five named graphs - the 5NG</a></li>
<li class="chapter" data-level="2.3" data-path="2-viz.html"><a href="2-viz.html#scatterplots"><i class="fa fa-check"></i><b>2.3</b> 5NG#1: Scatterplots</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="2-viz.html"><a href="2-viz.html#geompoint"><i class="fa fa-check"></i><b>2.3.1</b> Scatterplots via <code>geom_point</code></a></li>
<li class="chapter" data-level="2.3.2" data-path="2-viz.html"><a href="2-viz.html#overplotting"><i class="fa fa-check"></i><b>2.3.2</b> Overplotting</a></li>
<li class="chapter" data-level="2.3.3" data-path="2-viz.html"><a href="2-viz.html#summary"><i class="fa fa-check"></i><b>2.3.3</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="2-viz.html"><a href="2-viz.html#linegraphs"><i class="fa fa-check"></i><b>2.4</b> 5NG#2: Linegraphs</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="2-viz.html"><a href="2-viz.html#geomline"><i class="fa fa-check"></i><b>2.4.1</b> Linegraphs via <code>geom_line</code></a></li>
<li class="chapter" data-level="2.4.2" data-path="2-viz.html"><a href="2-viz.html#summary-1"><i class="fa fa-check"></i><b>2.4.2</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="2-viz.html"><a href="2-viz.html#facets"><i class="fa fa-check"></i><b>2.5</b> Facets</a></li>
<li class="chapter" data-level="2.6" data-path="2-viz.html"><a href="2-viz.html#histograms"><i class="fa fa-check"></i><b>2.6</b> 5NG#3: Histograms</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="2-viz.html"><a href="2-viz.html#geomhistogram"><i class="fa fa-check"></i><b>2.6.1</b> Histograms via <code>geom_histogram</code></a></li>
<li class="chapter" data-level="2.6.2" data-path="2-viz.html"><a href="2-viz.html#adjustbins"><i class="fa fa-check"></i><b>2.6.2</b> Adjusting the bins</a></li>
<li class="chapter" data-level="2.6.3" data-path="2-viz.html"><a href="2-viz.html#summary-2"><i class="fa fa-check"></i><b>2.6.3</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="2-viz.html"><a href="2-viz.html#boxplots"><i class="fa fa-check"></i><b>2.7</b> 5NG#4: Boxplots</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="2-viz.html"><a href="2-viz.html#geomboxplot"><i class="fa fa-check"></i><b>2.7.1</b> Boxplots via <code>geom_boxplot</code></a></li>
<li class="chapter" data-level="2.7.2" data-path="2-viz.html"><a href="2-viz.html#summary-3"><i class="fa fa-check"></i><b>2.7.2</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="2-viz.html"><a href="2-viz.html#geombar"><i class="fa fa-check"></i><b>2.8</b> 5NG#5: Barplots</a>
<ul>
<li class="chapter" data-level="2.8.1" data-path="2-viz.html"><a href="2-viz.html#barplots-via-geom_bar-or-geom_col"><i class="fa fa-check"></i><b>2.8.1</b> Barplots via <code>geom_bar</code> or <code>geom_col</code></a></li>
<li class="chapter" data-level="2.8.2" data-path="2-viz.html"><a href="2-viz.html#two-categ-barplot"><i class="fa fa-check"></i><b>2.8.2</b> Two categorical variables</a></li>
<li class="chapter" data-level="2.8.3" data-path="2-viz.html"><a href="2-viz.html#summary-4"><i class="fa fa-check"></i><b>2.8.3</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="2-viz.html"><a href="2-viz.html#plots-to-avoid"><i class="fa fa-check"></i><b>2.9</b> Plots to avoid!</a>
<ul>
<li class="chapter" data-level="2.9.1" data-path="2-viz.html"><a href="2-viz.html#barplots-with-a-continuous-variable"><i class="fa fa-check"></i><b>2.9.1</b> Barplots with a continuous variable</a></li>
<li class="chapter" data-level="2.9.2" data-path="2-viz.html"><a href="2-viz.html#pie-charts"><i class="fa fa-check"></i><b>2.9.2</b> Pie charts</a></li>
</ul></li>
<li class="chapter" data-level="2.10" data-path="2-viz.html"><a href="2-viz.html#data-vis-conclusion"><i class="fa fa-check"></i><b>2.10</b> Conclusion</a>
<ul>
<li class="chapter" data-level="2.10.1" data-path="2-viz.html"><a href="2-viz.html#summary-table"><i class="fa fa-check"></i><b>2.10.1</b> Summary table</a></li>
<li class="chapter" data-level="2.10.2" data-path="2-viz.html"><a href="2-viz.html#function-argument-specification"><i class="fa fa-check"></i><b>2.10.2</b> Function argument specification</a></li>
<li class="chapter" data-level="2.10.3" data-path="2-viz.html"><a href="2-viz.html#additional-resources-1"><i class="fa fa-check"></i><b>2.10.3</b> Additional resources</a></li>
<li class="chapter" data-level="2.10.4" data-path="2-viz.html"><a href="2-viz.html#whats-to-come-3"><i class="fa fa-check"></i><b>2.10.4</b> What’s to come</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="3-wrangling.html"><a href="3-wrangling.html"><i class="fa fa-check"></i><b>3</b> Data Wrangling</a>
<ul>
<li class="chapter" data-level="" data-path="3-wrangling.html"><a href="3-wrangling.html#wrangling-packages"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="3.1" data-path="3-wrangling.html"><a href="3-wrangling.html#piping"><i class="fa fa-check"></i><b>3.1</b> The pipe operator: <code>%&gt;%</code></a></li>
<li class="chapter" data-level="3.2" data-path="3-wrangling.html"><a href="3-wrangling.html#filter"><i class="fa fa-check"></i><b>3.2</b> <code>filter</code> rows</a></li>
<li class="chapter" data-level="3.3" data-path="3-wrangling.html"><a href="3-wrangling.html#slice-rows"><i class="fa fa-check"></i><b>3.3</b> <code>slice</code> rows</a></li>
<li class="chapter" data-level="3.4" data-path="3-wrangling.html"><a href="3-wrangling.html#select"><i class="fa fa-check"></i><b>3.4</b> <code>select</code> variables</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="3-wrangling.html"><a href="3-wrangling.html#rename"><i class="fa fa-check"></i><b>3.4.1</b> <code>rename</code> variables</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="3-wrangling.html"><a href="3-wrangling.html#summarize"><i class="fa fa-check"></i><b>3.5</b> <code>summarize</code> variables</a></li>
<li class="chapter" data-level="3.6" data-path="3-wrangling.html"><a href="3-wrangling.html#groupby"><i class="fa fa-check"></i><b>3.6</b> <code>group_by</code> rows</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="3-wrangling.html"><a href="3-wrangling.html#grouping-by-more-than-one-variable"><i class="fa fa-check"></i><b>3.6.1</b> Grouping by more than one variable</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="3-wrangling.html"><a href="3-wrangling.html#mutate"><i class="fa fa-check"></i><b>3.7</b> <code>mutate</code> existing variables</a></li>
<li class="chapter" data-level="3.8" data-path="3-wrangling.html"><a href="3-wrangling.html#arrange"><i class="fa fa-check"></i><b>3.8</b> <code>arrange</code> and sort rows</a></li>
<li class="chapter" data-level="3.9" data-path="3-wrangling.html"><a href="3-wrangling.html#wrangling-conclusion"><i class="fa fa-check"></i><b>3.9</b> Conclusion</a>
<ul>
<li class="chapter" data-level="3.9.1" data-path="3-wrangling.html"><a href="3-wrangling.html#summary-table-1"><i class="fa fa-check"></i><b>3.9.1</b> Summary table</a></li>
<li class="chapter" data-level="3.9.2" data-path="3-wrangling.html"><a href="3-wrangling.html#additional-resources-2"><i class="fa fa-check"></i><b>3.9.2</b> Additional resources</a></li>
<li class="chapter" data-level="3.9.3" data-path="3-wrangling.html"><a href="3-wrangling.html#whats-to-come-1"><i class="fa fa-check"></i><b>3.9.3</b> What’s to come?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="4-tidy.html"><a href="4-tidy.html"><i class="fa fa-check"></i><b>4</b> “Tidy” Data</a>
<ul>
<li class="chapter" data-level="" data-path="4-tidy.html"><a href="4-tidy.html#tidy-packages"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="4.1" data-path="4-tidy.html"><a href="4-tidy.html#tidy-data-ex"><i class="fa fa-check"></i><b>4.1</b> “Tidy” data</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="4-tidy.html"><a href="4-tidy.html#tidy-definition"><i class="fa fa-check"></i><b>4.1.1</b> Definition of “tidy” data</a></li>
<li class="chapter" data-level="4.1.2" data-path="4-tidy.html"><a href="4-tidy.html#converting-to-tidy-data"><i class="fa fa-check"></i><b>4.1.2</b> Converting to “tidy” data</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="4-tidy.html"><a href="4-tidy.html#case-study-tidy"><i class="fa fa-check"></i><b>4.2</b> Case study: Weight loss data</a></li>
<li class="chapter" data-level="4.3" data-path="4-tidy.html"><a href="4-tidy.html#tidyverse-package"><i class="fa fa-check"></i><b>4.3</b> <code>tidyverse</code> package</a></li>
<li class="chapter" data-level="4.4" data-path="4-tidy.html"><a href="4-tidy.html#tidy-data-conclusion"><i class="fa fa-check"></i><b>4.4</b> Conclusion</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="4-tidy.html"><a href="4-tidy.html#additional-resources-3"><i class="fa fa-check"></i><b>4.4.1</b> Additional resources</a></li>
<li class="chapter" data-level="4.4.2" data-path="4-tidy.html"><a href="4-tidy.html#whats-to-come-2"><i class="fa fa-check"></i><b>4.4.2</b> What’s to come?</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Statistical Inference with infer</b></span></li>
<li class="chapter" data-level="5" data-path="5-sampling.html"><a href="5-sampling.html"><i class="fa fa-check"></i><b>5</b> Sampling</a>
<ul>
<li class="chapter" data-level="" data-path="5-sampling.html"><a href="5-sampling.html#sampling-packages"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="5.1" data-path="5-sampling.html"><a href="5-sampling.html#sampling-activity"><i class="fa fa-check"></i><b>5.1</b> Sampling bowl activity</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="5-sampling.html"><a href="5-sampling.html#what-proportion-of-this-bowls-balls-are-red"><i class="fa fa-check"></i><b>5.1.1</b> What proportion of this bowl’s balls are red?</a></li>
<li class="chapter" data-level="5.1.2" data-path="5-sampling.html"><a href="5-sampling.html#using-the-shovel-once"><i class="fa fa-check"></i><b>5.1.2</b> Using the shovel once</a></li>
<li class="chapter" data-level="5.1.3" data-path="5-sampling.html"><a href="5-sampling.html#student-shovels"><i class="fa fa-check"></i><b>5.1.3</b> Using the shovel 33 times</a></li>
<li class="chapter" data-level="5.1.4" data-path="5-sampling.html"><a href="5-sampling.html#sampling-what-did-we-just-do"><i class="fa fa-check"></i><b>5.1.4</b> What did we just do?</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="5-sampling.html"><a href="5-sampling.html#sampling-simulation"><i class="fa fa-check"></i><b>5.2</b> Virtual sampling</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="5-sampling.html"><a href="5-sampling.html#using-the-virtual-shovel-once"><i class="fa fa-check"></i><b>5.2.1</b> Using the virtual shovel once</a></li>
<li class="chapter" data-level="5.2.2" data-path="5-sampling.html"><a href="5-sampling.html#using-the-virtual-shovel-33-times"><i class="fa fa-check"></i><b>5.2.2</b> Using the virtual shovel 33 times</a></li>
<li class="chapter" data-level="5.2.3" data-path="5-sampling.html"><a href="5-sampling.html#shovel-1000-times"><i class="fa fa-check"></i><b>5.2.3</b> Using the virtual shovel 1000 times</a></li>
<li class="chapter" data-level="5.2.4" data-path="5-sampling.html"><a href="5-sampling.html#the-normal-distribution"><i class="fa fa-check"></i><b>5.2.4</b> The Normal Distribution</a></li>
<li class="chapter" data-level="5.2.5" data-path="5-sampling.html"><a href="5-sampling.html#different-shovels"><i class="fa fa-check"></i><b>5.2.5</b> Using different shovels</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="5-sampling.html"><a href="5-sampling.html#sampling-framework"><i class="fa fa-check"></i><b>5.3</b> Sampling framework</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="5-sampling.html"><a href="5-sampling.html#terminology-and-notation"><i class="fa fa-check"></i><b>5.3.1</b> Terminology and notation</a></li>
<li class="chapter" data-level="5.3.2" data-path="5-sampling.html"><a href="5-sampling.html#sampling-definitions"><i class="fa fa-check"></i><b>5.3.2</b> Statistical definitions</a></li>
<li class="chapter" data-level="5.3.3" data-path="5-sampling.html"><a href="5-sampling.html#moral-of-the-story"><i class="fa fa-check"></i><b>5.3.3</b> The moral of the story</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="5-sampling.html"><a href="5-sampling.html#sampling-case-study"><i class="fa fa-check"></i><b>5.4</b> Case study: Genetic crosses</a></li>
<li class="chapter" data-level="5.5" data-path="5-sampling.html"><a href="5-sampling.html#sampling-conclusion-central-limit-theorem"><i class="fa fa-check"></i><b>5.5</b> Central Limit Theorem</a></li>
<li class="chapter" data-level="5.6" data-path="5-sampling.html"><a href="5-sampling.html#sampling-conclusion-table"><i class="fa fa-check"></i><b>5.6</b> Sampling scenarios</a></li>
<li class="chapter" data-level="5.7" data-path="5-sampling.html"><a href="5-sampling.html#sampling-conclusion"><i class="fa fa-check"></i><b>5.7</b> Conclusion</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="5-sampling.html"><a href="5-sampling.html#whats-to-come-4"><i class="fa fa-check"></i><b>5.7.1</b> What’s to come?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html"><i class="fa fa-check"></i><b>6</b> Bootstrapping and Confidence Intervals</a>
<ul>
<li class="chapter" data-level="" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#CI-packages"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="6.1" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#resampling-tactile"><i class="fa fa-check"></i><b>6.1</b> Pennies activity</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#what-is-the-average-year-on-us-pennies-in-2019"><i class="fa fa-check"></i><b>6.1.1</b> What is the average year on US pennies in 2019?</a></li>
<li class="chapter" data-level="6.1.2" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#resampling-once"><i class="fa fa-check"></i><b>6.1.2</b> Resampling once</a></li>
<li class="chapter" data-level="6.1.3" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#student-resamples"><i class="fa fa-check"></i><b>6.1.3</b> Resampling 35 times</a></li>
<li class="chapter" data-level="6.1.4" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#ci-what-did-we-just-do"><i class="fa fa-check"></i><b>6.1.4</b> What did we just do?</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#resampling-simulation"><i class="fa fa-check"></i><b>6.2</b> Computer simulation of resampling</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#virtually-resampling-once"><i class="fa fa-check"></i><b>6.2.1</b> Virtually resampling once</a></li>
<li class="chapter" data-level="6.2.2" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#bootstrap-35-replicates"><i class="fa fa-check"></i><b>6.2.2</b> Virtually resampling 35 times</a></li>
<li class="chapter" data-level="6.2.3" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#bootstrap-1000-replicates"><i class="fa fa-check"></i><b>6.2.3</b> Virtually resampling 1000 times</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#ci-build-up"><i class="fa fa-check"></i><b>6.3</b> Understanding confidence intervals</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#percentile-method"><i class="fa fa-check"></i><b>6.3.1</b> Percentile method</a></li>
<li class="chapter" data-level="6.3.2" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#se-method"><i class="fa fa-check"></i><b>6.3.2</b> Standard error method</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#bootstrap-process"><i class="fa fa-check"></i><b>6.4</b> Constructing confidence intervals</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#original-workflow"><i class="fa fa-check"></i><b>6.4.1</b> Original workflow</a></li>
<li class="chapter" data-level="6.4.2" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#infer-workflow"><i class="fa fa-check"></i><b>6.4.2</b> <code>infer</code> package workflow</a></li>
<li class="chapter" data-level="6.4.3" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#percentile-method-infer"><i class="fa fa-check"></i><b>6.4.3</b> Percentile method with <code>infer</code></a></li>
<li class="chapter" data-level="6.4.4" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#infer-se"><i class="fa fa-check"></i><b>6.4.4</b> Standard error method with <code>infer</code></a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#one-prop-ci"><i class="fa fa-check"></i><b>6.5</b> Interpreting confidence intervals</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#ilyas-yohan"><i class="fa fa-check"></i><b>6.5.1</b> Did the net capture the fish?</a></li>
<li class="chapter" data-level="6.5.2" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#shorthand"><i class="fa fa-check"></i><b>6.5.2</b> Precise and shorthand interpretation</a></li>
<li class="chapter" data-level="6.5.3" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#ci-width"><i class="fa fa-check"></i><b>6.5.3</b> Width of confidence intervals</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#case-study-two-prop-ci"><i class="fa fa-check"></i><b>6.6</b> Case study: Is yawning contagious?</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#mythbusters-study-data"><i class="fa fa-check"></i><b>6.6.1</b> <em>Mythbusters</em> study data</a></li>
<li class="chapter" data-level="6.6.2" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#sampling-scenario"><i class="fa fa-check"></i><b>6.6.2</b> Sampling scenario</a></li>
<li class="chapter" data-level="6.6.3" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#ci-build"><i class="fa fa-check"></i><b>6.6.3</b> Constructing the confidence interval</a></li>
<li class="chapter" data-level="6.6.4" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#interpreting-the-confidence-interval"><i class="fa fa-check"></i><b>6.6.4</b> Interpreting the confidence interval</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#bootstrap-vs-sampling"><i class="fa fa-check"></i><b>6.7</b> Comparing bootstrap and sampling distributions</a>
<ul>
<li class="chapter" data-level="" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#sampling-distribution"><i class="fa fa-check"></i>Sampling distribution</a></li>
<li class="chapter" data-level="" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#bootstrap-distribution"><i class="fa fa-check"></i>Bootstrap distribution</a></li>
<li class="chapter" data-level="" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#comparison"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="6.8" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#theory-ci"><i class="fa fa-check"></i><b>6.8</b> Theory-based confidence intervals</a>
<ul>
<li class="chapter" data-level="" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#theory-based-method-for-computing-standard-errors"><i class="fa fa-check"></i>Theory-based method for computing standard errors</a></li>
<li class="chapter" data-level="" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#theory-based-method-for-constructing-confidence-intervals"><i class="fa fa-check"></i>Theory-based method for constructing confidence intervals</a></li>
<li class="chapter" data-level="" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#confidence-intervals-based-on-33-tactile-samples"><i class="fa fa-check"></i>Confidence intervals based on 33 tactile samples</a></li>
</ul></li>
<li class="chapter" data-level="6.9" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#ci-conclusion"><i class="fa fa-check"></i><b>6.9</b> Conclusion</a>
<ul>
<li class="chapter" data-level="6.9.1" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#additional-resources-4"><i class="fa fa-check"></i><b>6.9.1</b> Additional resources</a></li>
<li class="chapter" data-level="6.9.2" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#whats-to-come-5"><i class="fa fa-check"></i><b>6.9.2</b> What’s to come?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html"><i class="fa fa-check"></i><b>7</b> Hypothesis Testing</a>
<ul>
<li class="chapter" data-level="" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#nhst-packages"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="7.1" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#ht-activity"><i class="fa fa-check"></i><b>7.1</b> Clutch size and malaria resistance</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#is-there-a-tradeoff-between-reproduction-and-immune-defense"><i class="fa fa-check"></i><b>7.1.1</b> Is there a tradeoff between reproduction and immune defense?</a></li>
<li class="chapter" data-level="7.1.2" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#shuffling-once"><i class="fa fa-check"></i><b>7.1.2</b> Shuffling once</a></li>
<li class="chapter" data-level="7.1.3" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#shuffling-99-more-times"><i class="fa fa-check"></i><b>7.1.3</b> Shuffling 99 more times</a></li>
<li class="chapter" data-level="7.1.4" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#ht-what-did-we-just-do"><i class="fa fa-check"></i><b>7.1.4</b> What did we just do?</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#understanding-ht"><i class="fa fa-check"></i><b>7.2</b> Understanding hypothesis tests</a></li>
<li class="chapter" data-level="7.3" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#ht-infer"><i class="fa fa-check"></i><b>7.3</b> Conducting hypothesis tests</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#infer-workflow-ht"><i class="fa fa-check"></i><b>7.3.1</b> <code>infer</code> package workflow</a></li>
<li class="chapter" data-level="7.3.2" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#comparing-infer-workflows"><i class="fa fa-check"></i><b>7.3.2</b> Comparison with confidence intervals</a></li>
<li class="chapter" data-level="7.3.3" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#only-one-test"><i class="fa fa-check"></i><b>7.3.3</b> “There is only one test”</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#ht-interpretation"><i class="fa fa-check"></i><b>7.4</b> Interpreting hypothesis tests</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#trial"><i class="fa fa-check"></i><b>7.4.1</b> Two possible outcomes</a></li>
<li class="chapter" data-level="7.4.2" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#types-of-errors"><i class="fa fa-check"></i><b>7.4.2</b> Types of errors</a></li>
<li class="chapter" data-level="7.4.3" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#choosing-alpha"><i class="fa fa-check"></i><b>7.4.3</b> How do we choose alpha?</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#ht-case-study"><i class="fa fa-check"></i><b>7.5</b> Case study: Do living lizards have longer horns than dead lizards?</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#imdb-data"><i class="fa fa-check"></i><b>7.5.1</b> Horned lizards dataset</a></li>
<li class="chapter" data-level="7.5.2" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#sampling-scenario-1"><i class="fa fa-check"></i><b>7.5.2</b> Sampling scenario</a></li>
<li class="chapter" data-level="7.5.3" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#conducting-the-hypothesis-test"><i class="fa fa-check"></i><b>7.5.3</b> Conducting the hypothesis test</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#theory-hypo"><i class="fa fa-check"></i><b>7.6</b> Theory-based hypothesis tests</a>
<ul>
<li class="chapter" data-level="" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#two-sample-t-statistic"><i class="fa fa-check"></i>Two-sample t-statistic</a></li>
<li class="chapter" data-level="" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#null-distribution"><i class="fa fa-check"></i>Null distribution</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#problems-with-p-values"><i class="fa fa-check"></i><b>7.7</b> Problems with p-values</a></li>
<li class="chapter" data-level="7.8" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#nhst-conclusion"><i class="fa fa-check"></i><b>7.8</b> Conclusion</a>
<ul>
<li class="chapter" data-level="7.8.1" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#additional-resources-5"><i class="fa fa-check"></i><b>7.8.1</b> Additional resources</a></li>
<li class="chapter" data-level="7.8.2" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#whats-to-come-6"><i class="fa fa-check"></i><b>7.8.2</b> What’s to come</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Data Modeling with moderndive</b></span></li>
<li class="chapter" data-level="8" data-path="8-regression.html"><a href="8-regression.html"><i class="fa fa-check"></i><b>8</b> Basic Regression</a>
<ul>
<li class="chapter" data-level="" data-path="8-regression.html"><a href="8-regression.html#reg-modeling"><i class="fa fa-check"></i>Modeling for explanation or prediction</a></li>
<li class="chapter" data-level="" data-path="8-regression.html"><a href="8-regression.html#reg-packages"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="8.1" data-path="8-regression.html"><a href="8-regression.html#model1"><i class="fa fa-check"></i><b>8.1</b> One numerical explanatory variable</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="8-regression.html"><a href="8-regression.html#model1EDA"><i class="fa fa-check"></i><b>8.1.1</b> Exploratory data analysis</a></li>
<li class="chapter" data-level="8.1.2" data-path="8-regression.html"><a href="8-regression.html#model1table"><i class="fa fa-check"></i><b>8.1.2</b> Simple linear regression</a></li>
<li class="chapter" data-level="8.1.3" data-path="8-regression.html"><a href="8-regression.html#model1points"><i class="fa fa-check"></i><b>8.1.3</b> Observed/fitted values and residuals</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="8-regression.html"><a href="8-regression.html#model2"><i class="fa fa-check"></i><b>8.2</b> One categorical explanatory variable</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="8-regression.html"><a href="8-regression.html#model2EDA"><i class="fa fa-check"></i><b>8.2.1</b> Exploratory data analysis</a></li>
<li class="chapter" data-level="8.2.2" data-path="8-regression.html"><a href="8-regression.html#model2table"><i class="fa fa-check"></i><b>8.2.2</b> Linear regression</a></li>
<li class="chapter" data-level="8.2.3" data-path="8-regression.html"><a href="8-regression.html#model2points"><i class="fa fa-check"></i><b>8.2.3</b> Observed/fitted values and residuals</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="8-regression.html"><a href="8-regression.html#reg-related-topics"><i class="fa fa-check"></i><b>8.3</b> Related topics</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="8-regression.html"><a href="8-regression.html#correlation-is-not-causation"><i class="fa fa-check"></i><b>8.3.1</b> Correlation is not necessarily causation</a></li>
<li class="chapter" data-level="8.3.2" data-path="8-regression.html"><a href="8-regression.html#leastsquares"><i class="fa fa-check"></i><b>8.3.2</b> Best-fitting line</a></li>
<li class="chapter" data-level="8.3.3" data-path="8-regression.html"><a href="8-regression.html#underthehood"><i class="fa fa-check"></i><b>8.3.3</b> <code>get_regression_x()</code> functions</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="8-regression.html"><a href="8-regression.html#reg-conclusion"><i class="fa fa-check"></i><b>8.4</b> Conclusion</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="8-regression.html"><a href="8-regression.html#whats-to-come-7"><i class="fa fa-check"></i><b>8.4.1</b> What’s to come?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html"><i class="fa fa-check"></i><b>9</b> Inference for Regression</a>
<ul>
<li class="chapter" data-level="" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#inf-packages"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="9.1" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#regression-refresher"><i class="fa fa-check"></i><b>9.1</b> Regression refresher</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#lion-age-and-nose-coloration"><i class="fa fa-check"></i><b>9.1.1</b> Lion age and nose coloration</a></li>
<li class="chapter" data-level="9.1.2" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#sampling-scenario-2"><i class="fa fa-check"></i><b>9.1.2</b> Sampling scenario</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#regression-interp"><i class="fa fa-check"></i><b>9.2</b> Interpreting regression tables</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#regression-se"><i class="fa fa-check"></i><b>9.2.1</b> Standard error</a></li>
<li class="chapter" data-level="9.2.2" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#regression-test-statistic"><i class="fa fa-check"></i><b>9.2.2</b> Test statistic</a></li>
<li class="chapter" data-level="9.2.3" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#p-value"><i class="fa fa-check"></i><b>9.2.3</b> p-value</a></li>
<li class="chapter" data-level="9.2.4" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#confidence-interval"><i class="fa fa-check"></i><b>9.2.4</b> Confidence interval</a></li>
<li class="chapter" data-level="9.2.5" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#regression-table-computation"><i class="fa fa-check"></i><b>9.2.5</b> How does R compute the table?</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#regression-conditions"><i class="fa fa-check"></i><b>9.3</b> Conditions for inference for regression</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#residuals-refresher"><i class="fa fa-check"></i><b>9.3.1</b> Residuals refresher</a></li>
<li class="chapter" data-level="9.3.2" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#linearity-of-relationship"><i class="fa fa-check"></i><b>9.3.2</b> Linearity of relationship</a></li>
<li class="chapter" data-level="9.3.3" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#independence-of-residuals"><i class="fa fa-check"></i><b>9.3.3</b> Independence of residuals</a></li>
<li class="chapter" data-level="9.3.4" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#normality-of-residuals"><i class="fa fa-check"></i><b>9.3.4</b> Normality of residuals</a></li>
<li class="chapter" data-level="9.3.5" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#equality-of-variance"><i class="fa fa-check"></i><b>9.3.5</b> Equality of variance</a></li>
<li class="chapter" data-level="9.3.6" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#what-is-the-conclusion"><i class="fa fa-check"></i><b>9.3.6</b> What’s the conclusion?</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#infer-regression"><i class="fa fa-check"></i><b>9.4</b> Simulation-based inference for regression</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#confidence-interval-for-slope"><i class="fa fa-check"></i><b>9.4.1</b> Confidence interval for slope</a></li>
<li class="chapter" data-level="9.4.2" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#hypothesis-test-for-slope"><i class="fa fa-check"></i><b>9.4.2</b> Hypothesis test for slope</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#theory-regression"><i class="fa fa-check"></i><b>9.5</b> Theory-based inference for regression</a></li>
<li class="chapter" data-level="9.6" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#inference-conclusion"><i class="fa fa-check"></i><b>9.6</b> Conclusion</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#summary-of-statistical-inference"><i class="fa fa-check"></i><b>9.6.1</b> Summary of statistical inference</a></li>
<li class="chapter" data-level="9.6.2" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#whats-to-come-8"><i class="fa fa-check"></i><b>9.6.2</b> What’s to come</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="10-multiple-regression.html"><a href="10-multiple-regression.html"><i class="fa fa-check"></i><b>10</b> Multiple Regression</a>
<ul>
<li class="chapter" data-level="" data-path="10-multiple-regression.html"><a href="10-multiple-regression.html#mult-reg-packages"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="10.1" data-path="10-multiple-regression.html"><a href="10-multiple-regression.html#model4"><i class="fa fa-check"></i><b>10.1</b> One numerical and one categorical explanatory variable</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="10-multiple-regression.html"><a href="10-multiple-regression.html#model4EDA"><i class="fa fa-check"></i><b>10.1.1</b> Exploratory data analysis</a></li>
<li class="chapter" data-level="10.1.2" data-path="10-multiple-regression.html"><a href="10-multiple-regression.html#model4interactiontable"><i class="fa fa-check"></i><b>10.1.2</b> Interaction model</a></li>
<li class="chapter" data-level="10.1.3" data-path="10-multiple-regression.html"><a href="10-multiple-regression.html#model4table"><i class="fa fa-check"></i><b>10.1.3</b> Parallel slopes model</a></li>
<li class="chapter" data-level="10.1.4" data-path="10-multiple-regression.html"><a href="10-multiple-regression.html#model4points"><i class="fa fa-check"></i><b>10.1.4</b> Observed/fitted values and residuals</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="10-multiple-regression.html"><a href="10-multiple-regression.html#model3"><i class="fa fa-check"></i><b>10.2</b> Two categorical explanatory variables</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="10-multiple-regression.html"><a href="10-multiple-regression.html#model3EDA"><i class="fa fa-check"></i><b>10.2.1</b> Exploratory data analysis</a></li>
<li class="chapter" data-level="10.2.2" data-path="10-multiple-regression.html"><a href="10-multiple-regression.html#model3table"><i class="fa fa-check"></i><b>10.2.2</b> Regression lines</a></li>
<li class="chapter" data-level="10.2.3" data-path="10-multiple-regression.html"><a href="10-multiple-regression.html#model3points"><i class="fa fa-check"></i><b>10.2.3</b> Observed/fitted values and residuals</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="10-multiple-regression.html"><a href="10-multiple-regression.html#mult-reg-related-topics"><i class="fa fa-check"></i><b>10.3</b> Related topics</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="10-multiple-regression.html"><a href="10-multiple-regression.html#model-selection"><i class="fa fa-check"></i><b>10.3.1</b> Model selection using visualizations</a></li>
<li class="chapter" data-level="10.3.2" data-path="10-multiple-regression.html"><a href="10-multiple-regression.html#rsquared"><i class="fa fa-check"></i><b>10.3.2</b> Model selection using R-squared</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="10-multiple-regression.html"><a href="10-multiple-regression.html#mult-reg-conclusion"><i class="fa fa-check"></i><b>10.4</b> Conclusion</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="10-multiple-regression.html"><a href="10-multiple-regression.html#whats-to-come-9"><i class="fa fa-check"></i><b>10.4.1</b> What’s to come?</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>IV Conclusion</b></span></li>
<li class="chapter" data-level="11" data-path="11-thinking-with-data.html"><a href="11-thinking-with-data.html"><i class="fa fa-check"></i><b>11</b> Tell Your Story with Data</a>
<ul>
<li class="chapter" data-level="11.1" data-path="11-thinking-with-data.html"><a href="11-thinking-with-data.html#review"><i class="fa fa-check"></i><b>11.1</b> Review</a></li>
<li class="chapter" data-level="11.2" data-path="11-thinking-with-data.html"><a href="11-thinking-with-data.html#data-journalism"><i class="fa fa-check"></i><b>11.2</b> Case study: Effective data storytelling</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="11-thinking-with-data.html"><a href="11-thinking-with-data.html#us-births-in-1999"><i class="fa fa-check"></i><b>11.2.1</b> US Births in 1999</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="11-thinking-with-data.html"><a href="11-thinking-with-data.html#concluding-remarks"><i class="fa fa-check"></i>Concluding remarks</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="A-appendixA.html"><a href="A-appendixA.html"><i class="fa fa-check"></i><b>A</b> Statistical Background</a>
<ul>
<li class="chapter" data-level="A.1" data-path="A-appendixA.html"><a href="A-appendixA.html#appendix-stat-terms"><i class="fa fa-check"></i><b>A.1</b> Basic statistical terms</a>
<ul>
<li class="chapter" data-level="A.1.1" data-path="A-appendixA.html"><a href="A-appendixA.html#mean"><i class="fa fa-check"></i><b>A.1.1</b> Mean</a></li>
<li class="chapter" data-level="A.1.2" data-path="A-appendixA.html"><a href="A-appendixA.html#median"><i class="fa fa-check"></i><b>A.1.2</b> Median</a></li>
<li class="chapter" data-level="A.1.3" data-path="A-appendixA.html"><a href="A-appendixA.html#appendix-sd-variance"><i class="fa fa-check"></i><b>A.1.3</b> Standard deviation and variance</a></li>
<li class="chapter" data-level="A.1.4" data-path="A-appendixA.html"><a href="A-appendixA.html#five-number-summary"><i class="fa fa-check"></i><b>A.1.4</b> Five-number summary</a></li>
<li class="chapter" data-level="A.1.5" data-path="A-appendixA.html"><a href="A-appendixA.html#distribution"><i class="fa fa-check"></i><b>A.1.5</b> Distribution</a></li>
<li class="chapter" data-level="A.1.6" data-path="A-appendixA.html"><a href="A-appendixA.html#outliers"><i class="fa fa-check"></i><b>A.1.6</b> Outliers</a></li>
</ul></li>
<li class="chapter" data-level="A.2" data-path="A-appendixA.html"><a href="A-appendixA.html#appendix-normal-curve"><i class="fa fa-check"></i><b>A.2</b> Normal distribution</a></li>
<li class="chapter" data-level="A.3" data-path="A-appendixA.html"><a href="A-appendixA.html#appendix-log10-transformations"><i class="fa fa-check"></i><b>A.3</b> log10 transformations</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="B-appendixB.html"><a href="B-appendixB.html"><i class="fa fa-check"></i><b>B</b> Inference Examples</a>
<ul>
<li class="chapter" data-level="" data-path="B-appendixB.html"><a href="B-appendixB.html#needed-packages-1"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="B.1" data-path="B-appendixB.html"><a href="B-appendixB.html#inference-mind-map"><i class="fa fa-check"></i><b>B.1</b> Inference mind map</a></li>
<li class="chapter" data-level="B.2" data-path="B-appendixB.html"><a href="B-appendixB.html#one-mean"><i class="fa fa-check"></i><b>B.2</b> One mean</a>
<ul>
<li class="chapter" data-level="B.2.1" data-path="B-appendixB.html"><a href="B-appendixB.html#problem-statement"><i class="fa fa-check"></i><b>B.2.1</b> Problem statement</a></li>
<li class="chapter" data-level="B.2.2" data-path="B-appendixB.html"><a href="B-appendixB.html#competing-hypotheses"><i class="fa fa-check"></i><b>B.2.2</b> Competing hypotheses</a></li>
<li class="chapter" data-level="B.2.3" data-path="B-appendixB.html"><a href="B-appendixB.html#exploring-the-sample-data"><i class="fa fa-check"></i><b>B.2.3</b> Exploring the sample data</a></li>
<li class="chapter" data-level="B.2.4" data-path="B-appendixB.html"><a href="B-appendixB.html#non-traditional-methods"><i class="fa fa-check"></i><b>B.2.4</b> Non-traditional methods</a></li>
<li class="chapter" data-level="B.2.5" data-path="B-appendixB.html"><a href="B-appendixB.html#traditional-methods"><i class="fa fa-check"></i><b>B.2.5</b> Traditional methods</a></li>
<li class="chapter" data-level="B.2.6" data-path="B-appendixB.html"><a href="B-appendixB.html#comparing-results"><i class="fa fa-check"></i><b>B.2.6</b> Comparing results</a></li>
</ul></li>
<li class="chapter" data-level="B.3" data-path="B-appendixB.html"><a href="B-appendixB.html#one-proportion"><i class="fa fa-check"></i><b>B.3</b> One proportion</a>
<ul>
<li class="chapter" data-level="B.3.1" data-path="B-appendixB.html"><a href="B-appendixB.html#problem-statement-1"><i class="fa fa-check"></i><b>B.3.1</b> Problem statement</a></li>
<li class="chapter" data-level="B.3.2" data-path="B-appendixB.html"><a href="B-appendixB.html#competing-hypotheses-1"><i class="fa fa-check"></i><b>B.3.2</b> Competing hypotheses</a></li>
<li class="chapter" data-level="B.3.3" data-path="B-appendixB.html"><a href="B-appendixB.html#exploring-the-sample-data-1"><i class="fa fa-check"></i><b>B.3.3</b> Exploring the sample data</a></li>
<li class="chapter" data-level="B.3.4" data-path="B-appendixB.html"><a href="B-appendixB.html#non-traditional-methods-1"><i class="fa fa-check"></i><b>B.3.4</b> Non-traditional methods</a></li>
<li class="chapter" data-level="B.3.5" data-path="B-appendixB.html"><a href="B-appendixB.html#traditional-methods-1"><i class="fa fa-check"></i><b>B.3.5</b> Traditional methods</a></li>
<li class="chapter" data-level="B.3.6" data-path="B-appendixB.html"><a href="B-appendixB.html#comparing-results-1"><i class="fa fa-check"></i><b>B.3.6</b> Comparing results</a></li>
</ul></li>
<li class="chapter" data-level="B.4" data-path="B-appendixB.html"><a href="B-appendixB.html#two-proportions"><i class="fa fa-check"></i><b>B.4</b> Two proportions</a>
<ul>
<li class="chapter" data-level="B.4.1" data-path="B-appendixB.html"><a href="B-appendixB.html#problem-statement-2"><i class="fa fa-check"></i><b>B.4.1</b> Problem statement</a></li>
<li class="chapter" data-level="B.4.2" data-path="B-appendixB.html"><a href="B-appendixB.html#competing-hypotheses-2"><i class="fa fa-check"></i><b>B.4.2</b> Competing hypotheses</a></li>
<li class="chapter" data-level="B.4.3" data-path="B-appendixB.html"><a href="B-appendixB.html#exploring-the-sample-data-2"><i class="fa fa-check"></i><b>B.4.3</b> Exploring the sample data</a></li>
<li class="chapter" data-level="B.4.4" data-path="B-appendixB.html"><a href="B-appendixB.html#non-traditional-methods-2"><i class="fa fa-check"></i><b>B.4.4</b> Non-traditional methods</a></li>
<li class="chapter" data-level="B.4.5" data-path="B-appendixB.html"><a href="B-appendixB.html#traditional-methods-2"><i class="fa fa-check"></i><b>B.4.5</b> Traditional methods</a></li>
<li class="chapter" data-level="B.4.6" data-path="B-appendixB.html"><a href="B-appendixB.html#test-statistic-2"><i class="fa fa-check"></i><b>B.4.6</b> Test statistic</a></li>
<li class="chapter" data-level="B.4.7" data-path="B-appendixB.html"><a href="B-appendixB.html#state-conclusion-2"><i class="fa fa-check"></i><b>B.4.7</b> State conclusion</a></li>
<li class="chapter" data-level="B.4.8" data-path="B-appendixB.html"><a href="B-appendixB.html#comparing-results-2"><i class="fa fa-check"></i><b>B.4.8</b> Comparing results</a></li>
</ul></li>
<li class="chapter" data-level="B.5" data-path="B-appendixB.html"><a href="B-appendixB.html#two-means-independent-samples"><i class="fa fa-check"></i><b>B.5</b> Two means (independent samples)</a>
<ul>
<li class="chapter" data-level="B.5.1" data-path="B-appendixB.html"><a href="B-appendixB.html#problem-statement-3"><i class="fa fa-check"></i><b>B.5.1</b> Problem statement</a></li>
<li class="chapter" data-level="B.5.2" data-path="B-appendixB.html"><a href="B-appendixB.html#competing-hypotheses-3"><i class="fa fa-check"></i><b>B.5.2</b> Competing hypotheses</a></li>
<li class="chapter" data-level="B.5.3" data-path="B-appendixB.html"><a href="B-appendixB.html#exploring-the-sample-data-3"><i class="fa fa-check"></i><b>B.5.3</b> Exploring the sample data</a></li>
<li class="chapter" data-level="B.5.4" data-path="B-appendixB.html"><a href="B-appendixB.html#non-traditional-methods-3"><i class="fa fa-check"></i><b>B.5.4</b> Non-traditional methods</a></li>
<li class="chapter" data-level="B.5.5" data-path="B-appendixB.html"><a href="B-appendixB.html#traditional-methods-3"><i class="fa fa-check"></i><b>B.5.5</b> Traditional methods</a></li>
<li class="chapter" data-level="B.5.6" data-path="B-appendixB.html"><a href="B-appendixB.html#test-statistic-3"><i class="fa fa-check"></i><b>B.5.6</b> Test statistic</a></li>
<li class="chapter" data-level="B.5.7" data-path="B-appendixB.html"><a href="B-appendixB.html#compute-p-value-1"><i class="fa fa-check"></i><b>B.5.7</b> Compute <span class="math inline">\(p\)</span>-value</a></li>
<li class="chapter" data-level="B.5.8" data-path="B-appendixB.html"><a href="B-appendixB.html#state-conclusion-3"><i class="fa fa-check"></i><b>B.5.8</b> State conclusion</a></li>
<li class="chapter" data-level="B.5.9" data-path="B-appendixB.html"><a href="B-appendixB.html#comparing-results-3"><i class="fa fa-check"></i><b>B.5.9</b> Comparing results</a></li>
</ul></li>
<li class="chapter" data-level="B.6" data-path="B-appendixB.html"><a href="B-appendixB.html#two-means-paired-samples"><i class="fa fa-check"></i><b>B.6</b> Two means (paired samples)</a>
<ul>
<li class="chapter" data-level="" data-path="B-appendixB.html"><a href="B-appendixB.html#problem-statement-4"><i class="fa fa-check"></i>Problem statement</a></li>
<li class="chapter" data-level="B.6.1" data-path="B-appendixB.html"><a href="B-appendixB.html#competing-hypotheses-4"><i class="fa fa-check"></i><b>B.6.1</b> Competing hypotheses</a></li>
<li class="chapter" data-level="B.6.2" data-path="B-appendixB.html"><a href="B-appendixB.html#exploring-the-sample-data-4"><i class="fa fa-check"></i><b>B.6.2</b> Exploring the sample data</a></li>
<li class="chapter" data-level="B.6.3" data-path="B-appendixB.html"><a href="B-appendixB.html#non-traditional-methods-4"><i class="fa fa-check"></i><b>B.6.3</b> Non-traditional methods</a></li>
<li class="chapter" data-level="B.6.4" data-path="B-appendixB.html"><a href="B-appendixB.html#traditional-methods-4"><i class="fa fa-check"></i><b>B.6.4</b> Traditional methods</a></li>
<li class="chapter" data-level="B.6.5" data-path="B-appendixB.html"><a href="B-appendixB.html#comparing-results-4"><i class="fa fa-check"></i><b>B.6.5</b> Comparing results</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="C" data-path="C-appendixC.html"><a href="C-appendixC.html"><i class="fa fa-check"></i><b>C</b> Tips and Tricks</a>
<ul>
<li class="chapter" data-level="" data-path="C-appendixC.html"><a href="C-appendixC.html#needed-packages-2"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="C.1" data-path="C-appendixC.html"><a href="C-appendixC.html#data-wrangling"><i class="fa fa-check"></i><b>C.1</b> Data wrangling</a>
<ul>
<li class="chapter" data-level="C.1.1" data-path="C-appendixC.html"><a href="C-appendixC.html#appendix-missing-values"><i class="fa fa-check"></i><b>C.1.1</b> Dealing with missing values</a></li>
<li class="chapter" data-level="C.1.2" data-path="C-appendixC.html"><a href="C-appendixC.html#appendix-reordering-bars"><i class="fa fa-check"></i><b>C.1.2</b> Reordering bars in a barplot</a></li>
<li class="chapter" data-level="C.1.3" data-path="C-appendixC.html"><a href="C-appendixC.html#appendix-money-on-axis"><i class="fa fa-check"></i><b>C.1.3</b> Showing money on an axis</a></li>
<li class="chapter" data-level="C.1.4" data-path="C-appendixC.html"><a href="C-appendixC.html#appendix-changing-values"><i class="fa fa-check"></i><b>C.1.4</b> Changing values inside cells</a></li>
<li class="chapter" data-level="C.1.5" data-path="C-appendixC.html"><a href="C-appendixC.html#appendix-convert-numerical-categorical"><i class="fa fa-check"></i><b>C.1.5</b> Converting a numerical variable to a categorical one</a></li>
<li class="chapter" data-level="C.1.6" data-path="C-appendixC.html"><a href="C-appendixC.html#appendix-prop"><i class="fa fa-check"></i><b>C.1.6</b> Computing proportions</a></li>
<li class="chapter" data-level="C.1.7" data-path="C-appendixC.html"><a href="C-appendixC.html#appendix-commas"><i class="fa fa-check"></i><b>C.1.7</b> Dealing with %, commas, and $</a></li>
</ul></li>
<li class="chapter" data-level="C.2" data-path="C-appendixC.html"><a href="C-appendixC.html#interactive-graphics"><i class="fa fa-check"></i><b>C.2</b> Interactive graphics</a>
<ul>
<li class="chapter" data-level="C.2.1" data-path="C-appendixC.html"><a href="C-appendixC.html#interactive-linegraphs"><i class="fa fa-check"></i><b>C.2.1</b> Interactive linegraphs</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Modern Biological Data Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<html>
<img src='https://moderndive.com/wide_format.png' alt="ModernDive">
</html>
<div id="regression" class="section level1 hasAnchor" number="8">
<h1><span class="header-section-number">Chapter 8</span> Basic Regression<a href="8-regression.html#regression" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<!--
Now that we are equipped with data visualization skills from Chapter \@ref(viz), data wrangling skills from Chapter \@ref(wrangling), and an understanding of how to import data and the concept of a "tidy" data format from Chapter \@ref(tidy), let's now proceed with data modeling.
-->
<p>The fundamental premise of data modeling is to make explicit the relationship between an <em>response variable</em> <span class="math inline">\(y\)</span>, also called a dependent variable or outcome variable, and
* an <em>explanatory variable</em> <span class="math inline">\(x\)</span>, also called an independent variable, predictor variable, or covariate. Another way to state this is using mathematical terminology: we will model the outcome variable <span class="math inline">\(y\)</span> “as a function” of the explanatory/predictor variable <span class="math inline">\(x\)</span>. When we say “function” here, we are referring to a mathematical function (not functions in R like <code>ggplot()</code>).</p>
<p>While there exist many techniques for modeling, such as tree-based models and neural networks, in this book we’ll focus on one particular technique: <em>linear regression</em>. Linear regression is one of the most commonly-used and easy-to-understand approaches to modeling.</p>
<p>Linear regression involves a <em>numerical</em> outcome variable <span class="math inline">\(y\)</span> and explanatory variables <span class="math inline">\(x\)</span> that are either <em>numerical</em> or <em>categorical</em>. Furthermore, the relationship between <span class="math inline">\(y\)</span> and <span class="math inline">\(x\)</span> is assumed to be linear, or in other words, a line. However, we’ll see that what constitutes a “line” will vary depending on the nature of your explanatory variables <span class="math inline">\(x\)</span>.</p>
<p>In Chapter <a href="8-regression.html#regression">8</a> on basic regression, we’ll only consider models with a single explanatory variable <span class="math inline">\(x\)</span>. In Section <a href="8-regression.html#model1">8.1</a>, the explanatory variable will be numerical. This scenario is known as <em>simple linear regression</em>. In Section <a href="8-regression.html#model2">8.2</a>, the explanatory variable will be categorical.</p>
<p>In Chapter <a href="9-inference-for-regression.html#inference-for-regression">9</a> on inference for regression, we’ll revisit our regression models and analyze the results using the tools for <em>statistical inference</em> developed in Chapters <a href="5-sampling.html#sampling">5</a>, <a href="6-confidence-intervals.html#confidence-intervals">6</a>, and <a href="7-hypothesis-testing.html#hypothesis-testing">7</a> on sampling, bootstrapping and confidence intervals, and hypothesis testing and <span class="math inline">\(p\)</span>-values, respectively.</p>
<p>In Chapter <a href="10-multiple-regression.html#multiple-regression">10</a> on multiple regression, we’ll extend the ideas behind basic regression and consider models with two explanatory variables <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span>. In Section <a href="10-multiple-regression.html#model4">10.1</a>, we’ll have one numerical and one categorical variable. In Section <a href="10-multiple-regression.html#model3">10.2</a>, we’ll have two categorical explanatory variables. In particular, we’ll consider two such models: <em>interaction</em> and <em>parallel slopes</em> models.</p>
<div id="reg-modeling" class="section level3 unnumbered hasAnchor">
<h3>Modeling for explanation or prediction<a href="8-regression.html#reg-modeling" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Why do we have two different labels, explanatory and predictor, for the variable <span class="math inline">\(x\)</span>? That’s because even though the two terms are often used interchangeably, roughly speaking data modeling serves one of two purposes:</p>
<ol style="list-style-type: decimal">
<li><strong>Modeling for explanation</strong>: When you want to explicitly describe and quantify the relationship between the outcome variable <span class="math inline">\(y\)</span> and a set of explanatory variables <span class="math inline">\(x\)</span>, determine the significance of any relationships, have measures summarizing these relationships, and possibly identify any <em>causal</em> relationships between the variables.</li>
<li><strong>Modeling for prediction</strong>: When you want to predict an outcome variable <span class="math inline">\(y\)</span> based on the information contained in a set of predictor variables <span class="math inline">\(x\)</span>. Unlike modeling for explanation, however, you don’t care so much about understanding how all the variables relate and interact with one another, but rather only whether you can make good predictions about <span class="math inline">\(y\)</span> using the information in <span class="math inline">\(x\)</span>.</li>
</ol>
<p>For example, say you are interested in an outcome variable <span class="math inline">\(y\)</span> of whether patients develop lung cancer and information <span class="math inline">\(x\)</span> on their risk factors, such as smoking habits, age, and socioeconomic status. If we are modeling for explanation, we would be interested in both describing and quantifying the effects of the different risk factors. One reason could be that you want to design an intervention to reduce lung cancer incidence in a population, such as targeting smokers of a specific age group with advertising for smoking cessation programs. If we are modeling for prediction, however, we wouldn’t care so much about understanding how all the individual risk factors contribute to lung cancer, but rather only whether we can make good predictions of which people will contract lung cancer.</p>
<p>We’ll generally focus on modeling for explanation and hence refer to <span class="math inline">\(x\)</span> as <em>explanatory variables</em>. If you are interested in learning about modeling for prediction, we suggest you check out books and courses on the field of <em>machine learning</em> such as <a href="http://www-bcf.usc.edu/~gareth/ISL/"><em>An Introduction to Statistical Learning with Applications in R (ISLR)</em></a> <span class="citation">(<a href="#ref-islr2017" role="doc-biblioref">James et al. 2017</a>)</span>.</p>
<div class="review">
<p>
<strong><em>Chapter Learning Objectives</em></strong>
</p>
<p>
<em>At the end of this chapter, you should be able to…</em><br />
• Calculate the correlation coefficient to estimate the strength of
association between two variables.<br />
• Interpret a regression table to estimate the intercept and slope of a
simple regression line.<br />
• Compute the fitted values and residuals for observed values.<br />
• Interpret a regression table to estimate the baseline and offset
values of linear regression with a categorical explanatory
variable.<br />
• Explain how correlation can occur without causation.<br />
</p>
</div>
</div>
<div id="reg-packages" class="section level3 unnumbered hasAnchor">
<h3>Needed packages<a href="8-regression.html#reg-packages" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s now load all the packages needed for this chapter (this assumes you’ve already installed them). In this chapter, we introduce the <code>moderndive</code> package of datasets and functions for tidyverse-friendly introductory linear regression.</p>
<p>If needed, read Section <a href="1-getting-started.html#packages">1.3</a> for information on how to install and load R packages.</p>
<div class="sourceCode" id="cb345"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb345-1"><a href="8-regression.html#cb345-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb345-2"><a href="8-regression.html#cb345-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(moderndive)</span>
<span id="cb345-3"><a href="8-regression.html#cb345-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(skimr)</span>
<span id="cb345-4"><a href="8-regression.html#cb345-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(abd)</span>
<span id="cb345-5"><a href="8-regression.html#cb345-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gapminder)</span></code></pre></div>
<p>Let’s now begin with basic regression, which refers to linear regression models with a single explanatory variable <span class="math inline">\(x\)</span>. We’ll also discuss important statistical concepts like the <em>correlation coefficient</em>, that “correlation isn’t necessarily causation,” and what it means for a line to be “best-fitting.”</p>
</div>
<div id="model1" class="section level2 hasAnchor" number="8.1">
<h2><span class="header-section-number">8.1</span> One numerical explanatory variable<a href="8-regression.html#model1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Determining the age of lions living in the wild can be difficult to estimate. One hypothesis is that the amount of black pigment in the nose increases with age and that therefore the proportion of black in the nose can be used to estimate a lion’s age. Here we’ll look at the <code>LionNoses</code> data set in the <code>abd</code> package. More information, including a reference to the original study, can be found by typing <code>?LionNoses</code> in the console to view its help file.</p>
<p>Researchers at the University of Minnesota tried to answer the following research question: can the age of male lions be used to explain the proportion of black in the nose or is there no relation? To this end, they used age and nose coloration data from 32 lions. We’ll answer these questions by modeling the relationship between proportion black and age using <em>simple linear regression</em> where we have:</p>
<ol style="list-style-type: decimal">
<li>A numerical outcome variable <span class="math inline">\(y\)</span> (the relative nose coloration) and</li>
<li>A single numerical explanatory variable <span class="math inline">\(x\)</span> (the lion’s age).</li>
</ol>
<div id="model1EDA" class="section level3 hasAnchor" number="8.1.1">
<h3><span class="header-section-number">8.1.1</span> Exploratory data analysis<a href="8-regression.html#model1EDA" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The data on the 32 male lions can be found in the <code>LionNoses</code> data frame included in the <code>abd</code> package.</p>
<div class="sourceCode" id="cb346"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb346-1"><a href="8-regression.html#cb346-1" aria-hidden="true" tabindex="-1"></a>LionNoses</span></code></pre></div>
<pre><code>    age proportion.black
1   1.1             0.21
2   1.5             0.14
3   1.9             0.11
4   2.2             0.13
5   2.6             0.12
6   3.2             0.13
7   3.2             0.12
8   2.9             0.18
9   2.4             0.23
10  2.1             0.22
11  1.9             0.20
12  1.9             0.17
13  1.9             0.15
14  1.9             0.27
15  2.8             0.26
16  3.6             0.21
17  4.3             0.30
18  3.8             0.42
19  4.2             0.43
20  5.4             0.59
21  5.8             0.60
22  6.0             0.72
23  3.4             0.29
24  4.0             0.10
25  7.3             0.48
26  7.3             0.44
27  7.8             0.34
28  7.1             0.37
29  7.1             0.34
30 13.1             0.74
31  8.8             0.79
32  5.4             0.51</code></pre>
<p>Recall that a crucial step before doing any kind of analysis or modeling is performing an <em>exploratory data analysis</em>, or EDA for short. EDA gives you a sense of the distributions of the individual variables in your data, whether any potential relationships exist between variables, whether there are outliers and/or missing values, and (most importantly) how to build your model. Here are three common steps in an EDA:</p>
<ol style="list-style-type: decimal">
<li>Most crucially, looking at the raw data values.</li>
<li>Computing summary statistics, such as means, medians, and interquartile ranges.</li>
<li>Creating data visualizations.</li>
</ol>
<p>Let’s perform the first common step in an exploratory data analysis: looking at the raw data values. Because this step seems so trivial, unfortunately many data analysts ignore it. However, getting an early sense of what your raw data looks like can often prevent many larger issues down the road.</p>
<p>You can do this by using RStudio’s spreadsheet viewer or by using the <code>glimpse()</code> function as introduced in Subsection <a href="1-getting-started.html#exploredataframes">1.4.3</a> on exploring data frames:</p>
<div class="sourceCode" id="cb348"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb348-1"><a href="8-regression.html#cb348-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(LionNoses)</span></code></pre></div>
<pre><code>Rows: 32
Columns: 2
$ age              &lt;dbl&gt; 1.1, 1.5, 1.9, 2.2, 2.6, 3.2, 3.2, 2.9, 2.4, 2.1, 1.9, 1.9, 1.9, 1.9, 2.8…
$ proportion.black &lt;dbl&gt; 0.21, 0.14, 0.11, 0.13, 0.12, 0.13, 0.12, 0.18, 0.23, 0.22, 0.20, 0.17, 0…</code></pre>
<p>Let’s fully describe the variables in <code>LionNoses</code>:</p>
<ol style="list-style-type: decimal">
<li><code>proportion.black</code>: A numerical variable of the relative coloration of the nose. This is the outcome variable <span class="math inline">\(y\)</span> of interest.</li>
<li><code>age</code>: A numerical variable of the male lion’s age. This will be the explanatory variable <span class="math inline">\(x\)</span>.</li>
</ol>
<p>An alternative way to look at the raw data values is by choosing a random sample of the rows in <code>LionNoses</code> by piping it into the <code>sample_n()</code> function from the <code>dplyr</code> package. Here we set the <code>size</code> argument to be <code>5</code>, indicating that we want a random sample of 5 rows. We display the results in Table <a href="8-regression.html#tab:five-random-courses">8.1</a>. Note that due to the random nature of the sampling, you will likely end up with a different subset of 5 rows.</p>
<div class="sourceCode" id="cb350"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb350-1"><a href="8-regression.html#cb350-1" aria-hidden="true" tabindex="-1"></a>LionNoses <span class="sc">%&gt;%</span></span>
<span id="cb350-2"><a href="8-regression.html#cb350-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sample_n</span>(<span class="at">size =</span> <span class="dv">5</span>)</span></code></pre></div>
<table class="table" style="font-size: 16px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:five-random-courses">TABLE 8.1: </span>A random sample of 5 out of the 32 lions
</caption>
<thead>
<tr>
<th style="text-align:right;">
age
</th>
<th style="text-align:right;">
proportion.black
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
2.6
</td>
<td style="text-align:right;">
0.12
</td>
</tr>
<tr>
<td style="text-align:right;">
1.1
</td>
<td style="text-align:right;">
0.21
</td>
</tr>
<tr>
<td style="text-align:right;">
1.9
</td>
<td style="text-align:right;">
0.15
</td>
</tr>
<tr>
<td style="text-align:right;">
7.1
</td>
<td style="text-align:right;">
0.37
</td>
</tr>
<tr>
<td style="text-align:right;">
3.8
</td>
<td style="text-align:right;">
0.42
</td>
</tr>
</tbody>
</table>
<p>Now that we’ve looked at the raw values in our <code>LionNoses</code> data frame and got a preliminary sense of the data, let’s move on to the next common step in an exploratory data analysis: computing summary statistics. Let’s start by computing the mean and median of our numerical outcome variable denoted as <code>proportion.black</code> and our numerical explanatory variable <code>age</code>. We’ll do this by using the <code>summarize()</code> function from <code>dplyr</code> along with the <code>mean()</code> and <code>median()</code> summary functions we saw in Section <a href="3-wrangling.html#summarize">3.5</a>.</p>
<div class="sourceCode" id="cb351"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb351-1"><a href="8-regression.html#cb351-1" aria-hidden="true" tabindex="-1"></a>LionNoses <span class="sc">%&gt;%</span></span>
<span id="cb351-2"><a href="8-regression.html#cb351-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_age =</span> <span class="fu">mean</span>(age), <span class="at">mean_proportion.black =</span> <span class="fu">mean</span>(proportion.black),</span>
<span id="cb351-3"><a href="8-regression.html#cb351-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">median_age =</span> <span class="fu">median</span>(age), <span class="at">median_proportion.black =</span> <span class="fu">median</span>(proportion.black))</span></code></pre></div>
<pre><code>  mean_age mean_proportion.black median_age median_proportion.black
1     4.31                 0.322        3.5                   0.265</code></pre>
<!-- Move skim section to Chap. 3-->
<p>However, what if we want other summary statistics as well, such as the standard deviation (a measure of spread), the minimum and maximum values, and various percentiles?</p>
<p>Typing out all these summary statistic functions in <code>summarize()</code> would be long and tedious. Instead, let’s use the convenient <code>skim()</code> function from the <code>skimr</code> package that you saw earlier in Section <a href="3-wrangling.html#summarize">3.5</a>. This function takes in a data frame, “skims” it, and returns commonly used summary statistics. Let’s take the <code>LionNoses</code> data frame, with the outcome and explanatory variables <code>proportion.black</code> and <code>age</code>, and pipe them into the <code>skim()</code> function:</p>
<div class="sourceCode" id="cb353"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb353-1"><a href="8-regression.html#cb353-1" aria-hidden="true" tabindex="-1"></a>LionNoses <span class="sc">%&gt;%</span> <span class="fu">skim</span>()</span></code></pre></div>
<!--
TODO: 
Update skimr::skim() output to match v2.0.1

Skipped: Couldn't figure out how to use skim_with(ts = sfl(line_graph = NULL))
at https://cran.r-project.org/web/packages/skimr/vignettes/skimr.html

Used remotes::install_version("skimr", version = "1.0.6") to use that version
instead.

(For formatting purposes in this book, the inline histogram that is usually printed with `skim()` has been removed. This can be done by using `skim_with(numeric = list(hist = NULL))` prior to using the `skim()` function for version 1.0.6 of `skimr`.)
-->
<p>For the numerical variables <code>age</code> and <code>proportion.black</code> it returns:</p>
<ul>
<li><code>n_missing</code>: the number of missing values</li>
<li><code>complete_rate</code>: the proportion of complete values</li>
<li><code>mean</code>: the average</li>
<li><code>sd</code>: the standard deviation</li>
<li><code>p0</code>: the 0th percentile: the value at which 0% of observations are smaller than it (the <em>minimum</em> value)</li>
<li><code>p25</code>: the 25th percentile: the value at which 25% of observations are smaller than it (the <em>1st quartile</em>)</li>
<li><code>p50</code>: the 50th percentile: the value at which 50% of observations are smaller than it (the <em>2nd</em> quartile and more commonly called the <em>median</em>)</li>
<li><code>p75</code>: the 75th percentile: the value at which 75% of observations are smaller than it (the <em>3rd quartile</em>)</li>
<li><code>p100</code>: the 100th percentile: the value at which 100% of observations are smaller than it (the <em>maximum</em> value)</li>
</ul>
<p>Looking at this output, we can see how the values of both variables distribute. For example, the mean nose coloration was 0.322 black, whereas the mean “age” was 4.31 years. Furthermore, the middle 50% of nose coloration was between 0.165 and 0.433 (the first and third quartiles), whereas the middle 50% of age falls within 2.18 to 5.85 years.</p>
<p>####Correlation coefficient</p>
<p>The <code>skim()</code> function only returns what are known as <em>univariate</em> summary statistics: functions that take a single variable and return some numerical summary of that variable. However, there also exist <em>bivariate</em> summary statistics: functions that take in two variables and return some summary of those two variables. In particular, when the two variables are numerical, we can compute the <em>correlation coefficient</em>. Generally speaking, <em>coefficients</em> are quantitative expressions of a specific phenomenon. A <em>correlation coefficient</em> is a quantitative expression of the <em>strength of the linear relationship between two numerical variables</em>. Its value ranges between -1 and 1 where:</p>
<ul>
<li>-1 indicates a perfect <em>negative relationship</em>: As one variable increases, the value of the other variable tends to go down, following a straight line.</li>
<li>0 indicates no relationship: The values of both variables go up/down independently of each other.</li>
<li>+1 indicates a perfect <em>positive relationship</em>: As the value of one variable goes up, the value of the other variable tends to go up as well in a linear fashion.</li>
</ul>
<p>Figure <a href="8-regression.html#fig:correlation1">8.1</a> gives examples of 9 different correlation coefficient values for hypothetical numerical variables <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>. For example, observe in the top right plot that for a correlation coefficient of -0.75 there is a negative linear relationship between <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>, but it is not as strong as the negative linear relationship between <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> when the correlation coefficient is -0.9 or -1.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:correlation1"></span>
<img src="ModernDive_files/figure-html/correlation1-1.png" alt="Nine different correlation coefficients." width="\textwidth" />
<p class="caption">
FIGURE 8.1: Nine different correlation coefficients.
</p>
</div>
<p>The correlation coefficient can be computed using the <code>get_correlation()</code> function in the <code>moderndive</code> package. In this case, the inputs to the function are the two numerical variables for which we want to calculate the correlation coefficient.</p>
<p>We put the name of the outcome variable on the left-hand side of the <code>~</code> “tilde” sign, while putting the name of the explanatory variable on the right-hand side. This is known as R’s <em>formula notation</em>. We will use this same “formula” syntax with regression later in this chapter.</p>
<div class="sourceCode" id="cb354"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb354-1"><a href="8-regression.html#cb354-1" aria-hidden="true" tabindex="-1"></a>LionNoses <span class="sc">%&gt;%</span> </span>
<span id="cb354-2"><a href="8-regression.html#cb354-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_correlation</span>(<span class="at">formula =</span> proportion.black <span class="sc">~</span> age)</span></code></pre></div>
<pre><code>   cor
1 0.79</code></pre>
<p>An alternative way to compute correlation is to use the <code>cor()</code> summary function within a <code>summarize()</code> command:</p>
<div class="sourceCode" id="cb356"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb356-1"><a href="8-regression.html#cb356-1" aria-hidden="true" tabindex="-1"></a>LionNoses <span class="sc">%&gt;%</span> </span>
<span id="cb356-2"><a href="8-regression.html#cb356-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">correlation =</span> <span class="fu">cor</span>(proportion.black, age))</span></code></pre></div>
<p>In our case, the correlation coefficient of 0.79 indicates that the relationship between proportion black and age is “clearly positive.” There is a certain amount of subjectivity in interpreting correlation coefficients, especially those that aren’t close to the extreme values of -1, 0, and 1. To develop your intuition about correlation coefficients, play the “Guess the Correlation” 1980’s style video game called “Guess the Correlation”, at <a href="http://guessthecorrelation.com/" class="uri">http://guessthecorrelation.com/</a>.</p>

<div class="figure" style="text-align: center"><span style="display:block;" id="fig:guess-the-correlation"></span>
<img src="images/copyright/guess_the_correlation.png" alt="Preview of “Guess the Correlation” game." width="70%" />
<p class="caption">
FIGURE 8.2: Preview of “Guess the Correlation” game.
</p>
</div>
<p>Let’s now perform the last of the steps in an exploratory data analysis: creating data visualizations. Since both the <code>proportion.black</code> and <code>age</code> variables are numerical, a scatterplot is an appropriate graph to visualize this data. Let’s do this using <code>geom_point()</code> and display the result in Figure <a href="8-regression.html#fig:numxplot1">8.3</a>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:numxplot1"></span>
<img src="ModernDive_files/figure-html/numxplot1-1.png" alt="Lion age and nose coloration." width="\textwidth" />
<p class="caption">
FIGURE 8.3: Lion age and nose coloration.
</p>
</div>
<p>Observe that most ages lie between 1 and 5 years, while most nose coloration proportions lie between 0.1 and 0.3 black. Furthermore, while opinions may vary, it is our opinion that the relationship between proportion black and age is “clearly positive.” This is consistent with our earlier computed correlation coefficient of 0.79.</p>
<p>Let’s build on the scatterplot in Figure <a href="8-regression.html#fig:numxplot1">8.3</a> by adding a “best-fitting” line: of all possible lines we can draw on this scatterplot, it is the line that “best” fits through the cloud of points. We do this by adding a new <code>geom_smooth(method = "lm", se = FALSE)</code> layer to the <code>ggplot()</code> code that created the scatterplot in Figure <a href="8-regression.html#fig:numxplot1">8.3</a>. The <code>method = "lm"</code> argument sets the line to be a “<code>l</code>inear <code>m</code>odel.” The <code>se = FALSE</code> argument suppresses <em>standard error</em> uncertainty bars. (We defined the concept of <em>standard error</em> earlier in Subsection <a href="5-sampling.html#sampling-definitions">5.3.2</a>.)</p>
<div class="sourceCode" id="cb357"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb357-1"><a href="8-regression.html#cb357-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(LionNoses, <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> proportion.black)) <span class="sc">+</span></span>
<span id="cb357-2"><a href="8-regression.html#cb357-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb357-3"><a href="8-regression.html#cb357-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Age (years)&quot;</span>, </span>
<span id="cb357-4"><a href="8-regression.html#cb357-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Proportion of black nose&quot;</span>,</span>
<span id="cb357-5"><a href="8-regression.html#cb357-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;Scatterplot of relationship of relative coloration and age of male lions.&quot;</span>) <span class="sc">+</span>  </span>
<span id="cb357-6"><a href="8-regression.html#cb357-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:numxplot3"></span>
<img src="ModernDive_files/figure-html/numxplot3-1.png" alt="Regression line." width="\textwidth" />
<p class="caption">
FIGURE 8.4: Regression line.
</p>
</div>
<p>The line in the resulting Figure <a href="8-regression.html#fig:numxplot3">8.4</a> is called a “regression line.” The regression line is a visual summary of the relationship between two numerical variables, in our case the outcome variable <code>proportion.black</code> and the explanatory variable <code>age</code>. The positive slope of the blue line is consistent with our earlier observed correlation coefficient of 0.79 suggesting that there is a positive relationship between these two variables: as lions have higher ages, they also have noses with a higher proportion of black. We’ll see later, however, that while the correlation coefficient and the slope of a regression line always have the same sign (positive or negative), they typically do not have the same value.</p>
<p>Furthermore, a regression line is “best-fitting” in that it minimizes some mathematical criteria. We present these mathematical criteria in Subsection <a href="8-regression.html#leastsquares">8.3.2</a>, but we suggest you read this subsection only after first reading the rest of this section on regression with one numerical explanatory variable.</p>
<div class="learncheck">
<p>
<strong><em>Learning check</em></strong>
</p>
</div>
<p><strong>(LC8.1)</strong> Conduct a new exploratory data analysis with the <code>ProgesteroneExercise</code> data set in the <code>abd</code> package. Remember, this involves three things:</p>
<ol style="list-style-type: lower-alpha">
<li>Looking at the raw data values.</li>
<li>Computing summary statistics.</li>
<li>Creating data visualizations.</li>
</ol>
<p>The outcome variable <span class="math inline">\(y\)</span> is <code>ventilation</code> rate and the explanatory variable <span class="math inline">\(x\)</span> is <code>progesterone</code> levels. What can you say about the relationship between progesterone levels and ventilation rate based on this exploration?</p>
<div class="learncheck">

</div>
</div>
<div id="model1table" class="section level3 hasAnchor" number="8.1.2">
<h3><span class="header-section-number">8.1.2</span> Simple linear regression<a href="8-regression.html#model1table" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You may recall from secondary/high school algebra that the equation of a line is <span class="math inline">\(y = a + b\cdot x\)</span>. (Note that the <span class="math inline">\(\cdot\)</span> symbol is equivalent to the <span class="math inline">\(\times\)</span> “multiply by” mathematical symbol. We’ll use the <span class="math inline">\(\cdot\)</span> symbol in the rest of this book as it is more succinct.) It is defined by two coefficients <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span>. The intercept coefficient <span class="math inline">\(a\)</span> is the value of <span class="math inline">\(y\)</span> when <span class="math inline">\(x = 0\)</span>. The slope coefficient <span class="math inline">\(b\)</span> for <span class="math inline">\(x\)</span> is the increase in <span class="math inline">\(y\)</span> for every increase of one in <span class="math inline">\(x\)</span>. This is also called the “rise over run.”</p>
<p>However, when defining a regression line like the regression line in Figure <a href="8-regression.html#fig:numxplot3">8.4</a>, we use slightly different notation: the equation of the regression line is <span class="math inline">\(\widehat{y} = b_0 + b_1 \cdot x\)</span> . The intercept coefficient is <span class="math inline">\(b_0\)</span>, so <span class="math inline">\(b_0\)</span> is the value of <span class="math inline">\(\widehat{y}\)</span> when <span class="math inline">\(x = 0\)</span>. The slope coefficient for <span class="math inline">\(x\)</span> is <span class="math inline">\(b_1\)</span>, i.e., the increase in <span class="math inline">\(\widehat{y}\)</span> for every increase of one in <span class="math inline">\(x\)</span>. Why do we put a “hat” on top of the <span class="math inline">\(y\)</span>? It’s a form of notation commonly used in regression to indicate that we have a “fitted value,” or the value of <span class="math inline">\(y\)</span> on the regression line for a given <span class="math inline">\(x\)</span> value. We’ll discuss this more in the upcoming Subsection <a href="8-regression.html#model1points">8.1.3</a>.</p>
<p>We know that the regression line in Figure <a href="8-regression.html#fig:numxplot3">8.4</a> has a positive slope <span class="math inline">\(b_1\)</span> corresponding to our explanatory <span class="math inline">\(x\)</span> variable <code>age</code>. Why? Because as lions tend to have higher <code>age</code>s, so also do they tend to have higher <code>proportion.black</code> noses. However, what is the numerical value of the slope <span class="math inline">\(b_1\)</span>? What about the intercept <span class="math inline">\(b_0\)</span>? Let’s not compute these two values by hand, but rather let’s use a computer!</p>
<p>We can obtain the values of the intercept <span class="math inline">\(b_0\)</span> and the slope for <code>age</code> <span class="math inline">\(b_1\)</span> by outputting a <em>linear regression table</em>. This is done in two steps:</p>
<ol style="list-style-type: decimal">
<li>We first “fit” the linear regression model using the <code>lm()</code> function and save it in <code>lion_model</code>.</li>
<li>We get the regression table by applying the <code>get_regression_table()</code> function from the <code>moderndive</code> package to <code>lion_model</code>.</li>
</ol>
<div class="sourceCode" id="cb358"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb358-1"><a href="8-regression.html#cb358-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit regression model:</span></span>
<span id="cb358-2"><a href="8-regression.html#cb358-2" aria-hidden="true" tabindex="-1"></a>lion_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(proportion.black <span class="sc">~</span> age, <span class="at">data =</span> LionNoses)</span>
<span id="cb358-3"><a href="8-regression.html#cb358-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Get regression table:</span></span>
<span id="cb358-4"><a href="8-regression.html#cb358-4" aria-hidden="true" tabindex="-1"></a><span class="fu">get_regression_table</span>(lion_model)</span></code></pre></div>
<table class="table" style="font-size: 16px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:regtable">TABLE 8.2: </span>Linear regression table
</caption>
<thead>
<tr>
<th style="text-align:left;">
term
</th>
<th style="text-align:right;">
estimate
</th>
<th style="text-align:right;">
std_error
</th>
<th style="text-align:right;">
statistic
</th>
<th style="text-align:right;">
p_value
</th>
<th style="text-align:right;">
lower_ci
</th>
<th style="text-align:right;">
upper_ci
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
intercept
</td>
<td style="text-align:right;">
0.070
</td>
<td style="text-align:right;">
0.042
</td>
<td style="text-align:right;">
1.66
</td>
<td style="text-align:right;">
0.107
</td>
<td style="text-align:right;">
-0.016
</td>
<td style="text-align:right;">
0.155
</td>
</tr>
<tr>
<td style="text-align:left;">
age
</td>
<td style="text-align:right;">
0.059
</td>
<td style="text-align:right;">
0.008
</td>
<td style="text-align:right;">
7.05
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.042
</td>
<td style="text-align:right;">
0.076
</td>
</tr>
</tbody>
</table>
<p>Let’s first focus on interpreting the regression table output in Table <a href="8-regression.html#tab:regtable">8.2</a>, and then we’ll later revisit the code that produced it. In the <code>estimate</code> column of Table <a href="8-regression.html#tab:regtable">8.2</a> are the intercept <span class="math inline">\(b_0\)</span> = 0.07 and the slope <span class="math inline">\(b_1\)</span> = 0.059 for <code>age</code>. Thus the equation of the regression line in Figure <a href="8-regression.html#fig:numxplot3">8.4</a> follows:</p>
<p><span class="math display">\[
\begin{aligned}
\widehat{y} &amp;= b_0 + b_1 \cdot x\\
\widehat{\text{proportion.black}} &amp;= b_0 + b_{\text{age}} \cdot\text{age}\\
&amp;= 0.07 + 0.059\cdot\text{age}
\end{aligned}
\]</span></p>
<p>The intercept <span class="math inline">\(b_0\)</span> = 0.07 is the average proportion of black <span class="math inline">\(\widehat{y}\)</span> = <span class="math inline">\(\widehat{\text{proportion.black}}\)</span> for those lions that had an <code>age</code> of 0. Or in graphical terms, it’s where the line intersects the <span class="math inline">\(y\)</span> axis when <span class="math inline">\(x\)</span> = 0. Note, however, that while the intercept of the regression line has a mathematical interpretation, it has no <em>practical</em> interpretation here, since observing an <code>age</code> of 0 is unlikely. Furthermore, looking at the scatterplot with the regression line in Figure <a href="8-regression.html#fig:numxplot3">8.4</a>, no lions had an <code>age</code> near 0.</p>
<p>Of greater interest is the slope <span class="math inline">\(b_1\)</span> = <span class="math inline">\(b_{\text{age}}\)</span> for <code>age</code> of 0.059, as this summarizes the relationship between <code>proportion.black</code> and <code>age</code> variables. Note that the sign is positive, suggesting a positive relationship between these two variables, meaning lions with higher black proportions of the nose also tend to have higher ages. Recall from earlier that the correlation coefficient is 0.79. They both have the same positive sign, but have a different value. Recall further that the correlation’s interpretation is the “strength of linear association”. The slope’s interpretation is a little different:</p>
<blockquote>
<p>For every increase of 1 unit in <code>age</code>, there is an <em>associated</em> increase of, <em>on average</em>, 0.059 units of <code>proportion.black</code>.</p>
</blockquote>
<p>We only state that there is an <em>associated</em> increase and not necessarily a <em>causal</em> increase. For example, perhaps it’s not that higher “age” directly cause higher proportions of black per se. Instead, the following could hold true: lions with blacker noses are more likely to survive and hence have higher ages. In other words, just because two variables are strongly associated, it doesn’t necessarily mean that one causes the other. This is summed up in the often quoted phrase, “correlation is not necessarily causation.” We discuss this idea further in Subsection <a href="8-regression.html#correlation-is-not-causation">8.3.1</a>.</p>
<p>Furthermore, we say that this associated increase is <em>on average</em> 0.059 years of <code>age</code>, because you might have two lions whose <code>age</code> scores differ by 1 unit, but their difference in proportion black won’t necessarily be exactly 0.059. What the slope of 0.059 is saying is that across all possible lions, the <em>average</em> difference in proportion black between two lions whose <code>age</code> differ by one is 0.059.</p>
<p>Now that we’ve learned how to compute the equation for the regression line in Figure <a href="8-regression.html#fig:numxplot3">8.4</a> using the values in the <code>estimate</code> column of Table <a href="8-regression.html#tab:regtable">8.2</a>, and how to interpret the resulting intercept and slope, let’s revisit the code that generated this table:</p>
<div class="sourceCode" id="cb359"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb359-1"><a href="8-regression.html#cb359-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit regression model:</span></span>
<span id="cb359-2"><a href="8-regression.html#cb359-2" aria-hidden="true" tabindex="-1"></a>lion_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(proportion.black <span class="sc">~</span> age, <span class="at">data =</span> LionNoses)</span>
<span id="cb359-3"><a href="8-regression.html#cb359-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Get regression table:</span></span>
<span id="cb359-4"><a href="8-regression.html#cb359-4" aria-hidden="true" tabindex="-1"></a><span class="fu">get_regression_table</span>(lion_model)</span></code></pre></div>
<p>First, we “fit” the linear regression model to the <code>data</code> using the <code>lm()</code> function and save this as <code>lion_model</code>. When we say “fit”, we mean “find the best fitting line to this data.” <code>lm()</code> stands for “linear model” and is used as follows: <code>lm(y ~ x, data = data_frame_name)</code> where:</p>
<ul>
<li><code>y</code> is the outcome variable, followed by a tilde <code>~</code>. In our case, <code>y</code> is set to <code>proportion.black</code>.</li>
<li><code>x</code> is the explanatory variable. In our case, <code>x</code> is set to <code>age</code>.</li>
<li>The combination of <code>y ~ x</code> is called a <em>model formula</em>. (Note the order of <code>y</code> and <code>x</code>.) In our case, the model formula is <code>proportion.black ~ age</code>. We saw such model formulas earlier when we computed the correlation coefficient using the <code>get_correlation()</code> function in Subsection <a href="8-regression.html#model1EDA">8.1.1</a>.</li>
<li><code>data_frame_name</code> is the name of the data frame that contains the variables <code>y</code> and <code>x</code>. In our case, <code>data_frame_name</code> is the <code>LionNoses</code> data frame.</li>
</ul>
<p>Second, we take the saved model in <code>lion_model</code> and apply the <code>get_regression_table()</code> function from the <code>moderndive</code> package to it to obtain the regression table in Table <a href="8-regression.html#tab:regtable">8.2</a>. This function is an example of what’s known in computer programming as a <em>wrapper function</em>. They take other pre-existing functions and “wrap” them into a single function that hides its inner workings. This concept is illustrated in Figure <a href="8-regression.html#fig:moderndive-figure-wrapper">8.5</a>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:moderndive-figure-wrapper"></span>
<img src="images/shutterstock/wrapper_function.png" alt="The concept of a wrapper function." width="60%" height="60%" />
<p class="caption">
FIGURE 8.5: The concept of a wrapper function.
</p>
</div>
<p>So all you need to worry about is what the inputs look like and what the outputs look like; you leave all the other details “under the hood of the car.” In our regression modeling example, the <code>get_regression_table()</code> function takes a saved <code>lm()</code> linear regression model as input and returns a data frame of the regression table as output. If you’re interested in learning more about the <code>get_regression_table()</code> function’s inner workings, check out Subsection <a href="8-regression.html#underthehood">8.3.3</a>.</p>
<!-- Merge Ch. 10 elements here? -->
<p>Lastly, the remaining five columns in Table <a href="8-regression.html#tab:regtable">8.2</a> are: <code>std_error</code>, <code>statistic</code>, <code>p_value</code>, <code>lower_ci</code> and <code>upper_ci</code> are the <em>standard error</em>, <em>test statistic</em>, <em>p-value</em>, <em>lower 95% confidence interval bound</em>, and <em>upper 95% confidence interval bound</em>. As you know, they tell us about both the <em>statistical significance</em> and <em>practical significance</em> of our results, that is, the “meaningfulness” of our results from a statistical perspective. Let’s put aside these ideas for now and revisit them in Chapter <a href="9-inference-for-regression.html#inference-for-regression">9</a> on (statistical) inference for regression.</p>
<div class="learncheck">
<p>
<strong><em>Learning check</em></strong>
</p>
</div>
<p><strong>(LC8.2)</strong> Fit a new simple linear regression using <code>lm(ventilation ~ progesterone, data = ProgesteroneExercise)</code>. Get information about the “best-fitting” line from the regression table by applying the <code>get_regression_table()</code> function. How do the regression results match up with the results from your earlier exploratory data analysis of this dataset?</p>
<div class="learncheck">

</div>
</div>
<div id="model1points" class="section level3 hasAnchor" number="8.1.3">
<h3><span class="header-section-number">8.1.3</span> Observed/fitted values and residuals<a href="8-regression.html#model1points" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We just saw how to get the value of the intercept and the slope of a regression line from the <code>estimate</code> column of a regression table generated by the <code>get_regression_table()</code> function. Now instead say we want information on individual observations. For example, let’s focus on the 21st of the 32 courses in the <code>LionNoses</code> data frame in Table <a href="8-regression.html#tab:lion-21">8.3</a>:</p>
<table class="table" style="font-size: 16px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:lion-21">TABLE 8.3: </span>Data for the 21st lion out of 32
</caption>
<thead>
<tr>
<th style="text-align:right;">
age
</th>
<th style="text-align:right;">
proportion.black
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
5.8
</td>
<td style="text-align:right;">
0.6
</td>
</tr>
</tbody>
</table>
<p>What is the value <span class="math inline">\(\widehat{y}\)</span> on the regression line corresponding to this lion’s <code>age</code> of 5.8 years? In Figure <a href="8-regression.html#fig:numxplot4">8.6</a> we mark three values corresponding to the 21st lion and give their statistical names:</p>
<ul>
<li>Circle: The <em>observed value</em> <span class="math inline">\(y\)</span> = 0.6 is this lion’s actual proportion of the nose that was black.</li>
<li>Square: The <em>fitted value</em> <span class="math inline">\(\widehat{y}\)</span> is the value on the regression line for <span class="math inline">\(x\)</span> = <code>age</code> = 5.8. This value is computed using the intercept and slope in the previous regression table:</li>
</ul>
<p><span class="math display">\[\widehat{y} = b_0 + b_1 \cdot x = 0.07 + 0.059 \cdot 5.8 = 0.41\]</span></p>
<ul>
<li>Arrow: The length of this arrow is the <em>residual</em> and is computed by subtracting the fitted value <span class="math inline">\(\widehat{y}\)</span> from the observed value <span class="math inline">\(y\)</span>. The residual can be thought of as a model’s error or “lack of fit” for a particular observation. In the case of this lion, it is <span class="math inline">\(y - \widehat{y}\)</span> = 0.6 - 0.41 = 0.19.</li>
</ul>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:numxplot4"></span>
<img src="ModernDive_files/figure-html/numxplot4-1.png" alt="Example of observed value, fitted value, and residual." width="\textwidth" />
<p class="caption">
FIGURE 8.6: Example of observed value, fitted value, and residual.
</p>
</div>
<p>Now say we want to compute both the fitted value <span class="math inline">\(\widehat{y} = b_0 + b_1 \cdot x\)</span> and the residual <span class="math inline">\(y - \widehat{y}\)</span> for <em>all</em> 32 lions in the study. Recall that each lion corresponds to one of the 32 rows in the <code>LionNoses</code> data frame and also one of the 32 points in the regression plot in Figure <a href="8-regression.html#fig:numxplot4">8.6</a>.</p>
<p>We could repeat the previous calculations we performed by hand 32 times, but that would be tedious and time consuming. Instead, let’s do this using a computer with the <code>get_regression_points()</code> function. Just like the <code>get_regression_table()</code> function, the <code>get_regression_points()</code> function is a “wrapper” function. However, this function returns a different output. Let’s apply the <code>get_regression_points()</code> function to <code>lion_model</code>, which is where we saved our <code>lm()</code> model in the previous section. In Table <a href="8-regression.html#tab:regression-points-1">8.4</a> we present the results of only the 21st through 24th courses for brevity’s sake.</p>
<div class="sourceCode" id="cb360"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb360-1"><a href="8-regression.html#cb360-1" aria-hidden="true" tabindex="-1"></a>regression_points <span class="ot">&lt;-</span> <span class="fu">get_regression_points</span>(lion_model)</span>
<span id="cb360-2"><a href="8-regression.html#cb360-2" aria-hidden="true" tabindex="-1"></a>regression_points</span></code></pre></div>
<table>
<caption>
<span id="tab:regression-points-1">TABLE 8.4: </span>Regression points (for only the 21st through 24th lions)
</caption>
<thead>
<tr>
<th style="text-align:right;">
ID
</th>
<th style="text-align:right;">
proportion.black
</th>
<th style="text-align:right;">
age
</th>
<th style="text-align:right;">
proportion.black_hat
</th>
<th style="text-align:right;">
residual
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
0.60
</td>
<td style="text-align:right;">
5.8
</td>
<td style="text-align:right;">
0.410
</td>
<td style="text-align:right;">
0.190
</td>
</tr>
<tr>
<td style="text-align:right;">
22
</td>
<td style="text-align:right;">
0.72
</td>
<td style="text-align:right;">
6.0
</td>
<td style="text-align:right;">
0.421
</td>
<td style="text-align:right;">
0.299
</td>
</tr>
<tr>
<td style="text-align:right;">
23
</td>
<td style="text-align:right;">
0.29
</td>
<td style="text-align:right;">
3.4
</td>
<td style="text-align:right;">
0.269
</td>
<td style="text-align:right;">
0.021
</td>
</tr>
<tr>
<td style="text-align:right;">
24
</td>
<td style="text-align:right;">
0.10
</td>
<td style="text-align:right;">
4.0
</td>
<td style="text-align:right;">
0.304
</td>
<td style="text-align:right;">
-0.204
</td>
</tr>
</tbody>
</table>
<p>Let’s inspect the individual columns and match them with the elements of Figure <a href="8-regression.html#fig:numxplot4">8.6</a>:</p>
<ul>
<li>The <code>proportion.black</code> column represents the observed outcome variable <span class="math inline">\(y\)</span>. This is the y-position of the 32 black points.</li>
<li>The <code>age</code> column represents the values of the explanatory variable <span class="math inline">\(x\)</span>. This is the x-position of the 32 black points.</li>
<li>The <code>proportion.black_hat</code> column represents the fitted values <span class="math inline">\(\widehat{y}\)</span>. This is the corresponding value on the regression line for the 32 <span class="math inline">\(x\)</span> values.</li>
<li>The <code>residual</code> column represents the residuals <span class="math inline">\(y - \widehat{y}\)</span>. This is the 32 vertical distances between the 32 black points and the regression line.</li>
</ul>
<p>Just as we did for the 21st lion in the <code>LionNoses</code> dataset (in the first row of the table), let’s repeat the calculations for the lion of the 24th lion (in the fourth row of Table <a href="8-regression.html#tab:regression-points-1">8.4</a>):</p>
<ul>
<li><code>proportion.black</code> = 0.1 is the observed <code>proportion.black</code> <span class="math inline">\(y\)</span> for this lion.</li>
<li><code>age</code> = 4.00 is the value of the explanatory variable <code>age</code> <span class="math inline">\(x\)</span> for this lion.</li>
<li><code>proportion.black_hat</code> = 0.304 = 0.07 + 0.059 <span class="math inline">\(\cdot\)</span> 4.00 is the fitted value <span class="math inline">\(\widehat{y}\)</span> on the regression line for this lion.</li>
<li><code>residual</code> = -0.204 = 0.1 - 0.304 is the value of the residual for this lion. In other words, the model’s fitted value was off by -0.204 for this lion.</li>
</ul>
<p>At this point, you can skip ahead if you like to Subsection <a href="8-regression.html#leastsquares">8.3.2</a> to learn about the processes behind what makes “best-fitting” regression lines. As a primer, a “best-fitting” line refers to the line that minimizes the <em>sum of squared residuals</em> out of all possible lines we can draw through the points. In Section <a href="8-regression.html#model2">8.2</a>, we’ll discuss another common scenario of having a categorical explanatory variable and a numerical outcome variable.</p>
<div class="learncheck">
<p>
<strong><em>Learning check</em></strong>
</p>
</div>
<p><strong>(LC8.3)</strong> Generate a data frame of the residuals of the model <code>lm(ventilation ~ progesterone, data = ProgesteroneExercise)</code>.</p>
<div class="learncheck">

</div>
</div>
</div>
<div id="model2" class="section level2 hasAnchor" number="8.2">
<h2><span class="header-section-number">8.2</span> One categorical explanatory variable<a href="8-regression.html#model2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>It’s an unfortunate truth that life expectancy is not the same across all countries in the world. International development agencies are interested in studying these differences in life expectancy in the hopes of identifying where governments should allocate resources to address this problem. In this section, we’ll explore differences in life expectancy in two ways:</p>
<ol style="list-style-type: decimal">
<li>Differences between continents: Are there significant differences in average life expectancy between the five populated continents of the world: Africa, the Americas, Asia, Europe, and Oceania?</li>
<li>Differences within continents: How does life expectancy vary within the world’s five continents? For example, is the spread of life expectancy among the countries of Africa larger than the spread of life expectancy among the countries of Asia?</li>
</ol>
<p>To answer such questions, we’ll use the <code>gapminder</code> data frame included in the <code>gapminder</code> package. This dataset has international development statistics such as life expectancy, GDP per capita, and population for 142 countries for 5-year intervals between 1952 and 2007. Recall we visualized some of this data in Figure <a href="2-viz.html#fig:gapminder">2.1</a> in Subsection <a href="2-viz.html#gapminder">2.1.2</a> on the grammar of graphics.</p>
<p>We’ll use this data for basic regression again, but now using an explanatory variable <span class="math inline">\(x\)</span> that is categorical, as opposed to the numerical explanatory variable model we used in the previous Section <a href="8-regression.html#model1">8.1</a>.</p>
<ol style="list-style-type: decimal">
<li>A numerical outcome variable <span class="math inline">\(y\)</span> (a country’s life expectancy) and</li>
<li>A single categorical explanatory variable <span class="math inline">\(x\)</span> (the continent that the country is a part of).</li>
</ol>
<p>When the explanatory variable <span class="math inline">\(x\)</span> is categorical, the concept of a “best-fitting” regression line is a little different than the one we saw previously in Section <a href="8-regression.html#model1">8.1</a> where the explanatory variable <span class="math inline">\(x\)</span> was numerical. We’ll study these differences shortly in Subsection <a href="8-regression.html#model2table">8.2.2</a>, but first we conduct an exploratory data analysis.</p>
<div id="model2EDA" class="section level3 hasAnchor" number="8.2.1">
<h3><span class="header-section-number">8.2.1</span> Exploratory data analysis<a href="8-regression.html#model2EDA" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The data on the 142 countries can be found in the <code>gapminder</code> data frame included in the <code>gapminder</code> package. However, to keep things simple, let’s <code>filter()</code> for only those observations/rows corresponding to the year 2007. Additionally, let’s <code>select()</code> only the subset of the variables we’ll consider in this chapter. We’ll save this data in a new data frame called <code>gapminder2007</code>:</p>
<div class="sourceCode" id="cb361"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb361-1"><a href="8-regression.html#cb361-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gapminder)</span>
<span id="cb361-2"><a href="8-regression.html#cb361-2" aria-hidden="true" tabindex="-1"></a>gapminder2007 <span class="ot">&lt;-</span> gapminder <span class="sc">%&gt;%</span></span>
<span id="cb361-3"><a href="8-regression.html#cb361-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2007</span>) <span class="sc">%&gt;%</span></span>
<span id="cb361-4"><a href="8-regression.html#cb361-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(country, lifeExp, continent, gdpPercap)</span></code></pre></div>
<p>Let’s perform the first common step in an exploratory data analysis: looking at the raw data values. You can do this by using RStudio’s spreadsheet viewer or by using the <code>glimpse()</code> command as introduced in Subsection <a href="1-getting-started.html#exploredataframes">1.4.3</a> on exploring data frames:</p>
<div class="sourceCode" id="cb362"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb362-1"><a href="8-regression.html#cb362-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(gapminder2007)</span></code></pre></div>
<pre><code>Rows: 142
Columns: 4
$ country   &lt;fct&gt; &quot;Afghanistan&quot;, &quot;Albania&quot;, &quot;Algeria&quot;, &quot;Angola&quot;, &quot;Argentina&quot;, &quot;Australia&quot;, &quot;Austri…
$ lifeExp   &lt;dbl&gt; 43.8, 76.4, 72.3, 42.7, 75.3, 81.2, 79.8, 75.6, 64.1, 79.4, 56.7, 65.6, 74.9, 50…
$ continent &lt;fct&gt; Asia, Europe, Africa, Africa, Americas, Oceania, Europe, Asia, Asia, Europe, Afr…
$ gdpPercap &lt;dbl&gt; 975, 5937, 6223, 4797, 12779, 34435, 36126, 29796, 1391, 33693, 1441, 3822, 7446…</code></pre>
<p>Observe that <code>Observations: 142</code> indicates that there are 142 rows/observations in <code>gapminder2007</code>, where each row corresponds to one country. In other words, the <em>observational unit</em> is an individual country. Furthermore, observe that the variable <code>continent</code> is of type <code>&lt;fct&gt;</code>, which stands for <em>factor</em>, which is R’s way of encoding categorical variables.</p>
<p>A full description of all the variables included in <code>gapminder</code> can be found by reading the associated help file (run <code>?gapminder</code> in the console). However, let’s fully describe only the 4 variables we selected in <code>gapminder2007</code>:</p>
<ol style="list-style-type: decimal">
<li><code>country</code>: An identification variable of type character/text used to distinguish the 142 countries in the dataset.</li>
<li><code>lifeExp</code>: A numerical variable of that country’s life expectancy at birth. This is the outcome variable <span class="math inline">\(y\)</span> of interest.</li>
<li><code>continent</code>: A categorical variable with five levels. Here “levels” correspond to the possible categories: Africa, Asia, Americas, Europe, and Oceania. This is the explanatory variable <span class="math inline">\(x\)</span> of interest.</li>
<li><code>gdpPercap</code>: A numerical variable of that country’s GDP per capita in US inflation-adjusted dollars that we’ll use as another outcome variable <span class="math inline">\(y\)</span> in the <em>Learning check</em> at the end of this subsection.</li>
</ol>
<p>Let’s look at a random sample of five out of the 142 countries in Table <a href="8-regression.html#tab:model2-data-preview">8.5</a>.</p>
<div class="sourceCode" id="cb364"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb364-1"><a href="8-regression.html#cb364-1" aria-hidden="true" tabindex="-1"></a>gapminder2007 <span class="sc">%&gt;%</span> <span class="fu">sample_n</span>(<span class="at">size =</span> <span class="dv">5</span>)</span></code></pre></div>
<table class="table" style="font-size: 16px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:model2-data-preview">TABLE 8.5: </span>Random sample of 5 out of 142 countries
</caption>
<thead>
<tr>
<th style="text-align:left;">
country
</th>
<th style="text-align:right;">
lifeExp
</th>
<th style="text-align:left;">
continent
</th>
<th style="text-align:right;">
gdpPercap
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Togo
</td>
<td style="text-align:right;">
58.4
</td>
<td style="text-align:left;">
Africa
</td>
<td style="text-align:right;">
883
</td>
</tr>
<tr>
<td style="text-align:left;">
Sao Tome and Principe
</td>
<td style="text-align:right;">
65.5
</td>
<td style="text-align:left;">
Africa
</td>
<td style="text-align:right;">
1598
</td>
</tr>
<tr>
<td style="text-align:left;">
Congo, Dem. Rep. 
</td>
<td style="text-align:right;">
46.5
</td>
<td style="text-align:left;">
Africa
</td>
<td style="text-align:right;">
278
</td>
</tr>
<tr>
<td style="text-align:left;">
Lesotho
</td>
<td style="text-align:right;">
42.6
</td>
<td style="text-align:left;">
Africa
</td>
<td style="text-align:right;">
1569
</td>
</tr>
<tr>
<td style="text-align:left;">
Bulgaria
</td>
<td style="text-align:right;">
73.0
</td>
<td style="text-align:left;">
Europe
</td>
<td style="text-align:right;">
10681
</td>
</tr>
</tbody>
</table>
<p>Note that random sampling will likely produce a different subset of 5 rows for you than what’s shown. Now that we’ve looked at the raw values in our <code>gapminder2007</code> data frame and got a sense of the data, let’s move on to computing summary statistics. Let’s once again apply the <code>skim()</code> function from the <code>skimr</code> package. Recall from our previous EDA that this function takes in a data frame, “skims” it, and returns commonly used summary statistics. Let’s take our <code>gapminder2007</code> data frame, <code>select()</code> only the outcome and explanatory variables <code>lifeExp</code> and <code>continent</code>, and pipe them into the <code>skim()</code> function:</p>
<div class="sourceCode" id="cb365"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb365-1"><a href="8-regression.html#cb365-1" aria-hidden="true" tabindex="-1"></a>gapminder2007 <span class="sc">%&gt;%</span></span>
<span id="cb365-2"><a href="8-regression.html#cb365-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(lifeExp, continent) <span class="sc">%&gt;%</span></span>
<span id="cb365-3"><a href="8-regression.html#cb365-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">skim</span>()</span></code></pre></div>
<pre><code>Skim summary statistics
 n obs: 142 
 n variables: 2 

── Variable type:factor
  variable missing complete   n n_unique                         top_counts ordered
 continent       0      142 142        5 Afr: 52, Asi: 33, Eur: 30, Ame: 25   FALSE

── Variable type:numeric
 variable missing complete   n  mean    sd    p0   p25   p50   p75 p100
  lifeExp       0      142 142 67.01 12.07 39.61 57.16 71.94 76.41 82.6</code></pre>
<p>The <code>skim()</code> output now reports summaries for categorical variables (<code>Variable type:factor</code>) separately from the numerical variables (<code>Variable type:numeric</code>). For the categorical variable <code>continent</code>, it reports:</p>
<ul>
<li><code>missing</code>, <code>complete</code>, and <code>n</code>, which are the number of missing, complete, and total number of values as before, respectively.</li>
<li><code>n_unique</code>: The number of unique levels to this variable, corresponding to Africa, Asia, Americas, Europe, and Oceania. This refers to how many countries are in the data for each continent.</li>
<li><code>top_counts</code>: In this case, the top four counts: <code>Africa</code> has 52 countries, <code>Asia</code> has 33, <code>Europe</code> has 30, and <code>Americas</code> has 25. Not displayed is <code>Oceania</code> with 2 countries.</li>
<li><code>ordered</code>: This tells us whether the categorical variable is “ordinal”: whether there is an encoded hierarchy (like low, medium, high). In this case, <code>continent</code> is not ordered.</li>
</ul>
<p>Turning our attention to the summary statistics of the numerical variable <code>lifeExp</code>, we observe that the global median life expectancy in 2007 was 71.94. Thus, half of the world’s countries (71 countries) had a life expectancy less than 71.94. The mean life expectancy of 67.01 is lower, however. Why is the mean life expectancy lower than the median?</p>
<p>We can answer this question by performing the last of the three common steps in an exploratory data analysis: creating data visualizations. Let’s visualize the distribution of our outcome variable <span class="math inline">\(y\)</span> = <code>lifeExp</code> in Figure <a href="8-regression.html#fig:lifeExp2007hist">8.7</a>.</p>
<div class="sourceCode" id="cb367"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb367-1"><a href="8-regression.html#cb367-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(gapminder2007, <span class="fu">aes</span>(<span class="at">x =</span> lifeExp)) <span class="sc">+</span></span>
<span id="cb367-2"><a href="8-regression.html#cb367-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">5</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb367-3"><a href="8-regression.html#cb367-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Life expectancy&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Number of countries&quot;</span>,</span>
<span id="cb367-4"><a href="8-regression.html#cb367-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;Histogram of distribution of worldwide life expectancies&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:lifeExp2007hist"></span>
<img src="ModernDive_files/figure-html/lifeExp2007hist-1.png" alt="Histogram of life expectancy in 2007." width="\textwidth" />
<p class="caption">
FIGURE 8.7: Histogram of life expectancy in 2007.
</p>
</div>
<p>We see that this data is <em>left-skewed</em>, also known as <em>negatively</em> skewed: there are a few countries with low life expectancy that are bringing down the mean life expectancy. However, the median is less sensitive to the effects of such outliers; hence, the median is greater than the mean in this case.</p>
<p>Remember, however, that we want to compare life expectancies both between continents and within continents. In other words, our visualizations need to incorporate some notion of the variable <code>continent</code>. We can do this easily with a faceted histogram. Recall from Section <a href="2-viz.html#facets">2.5</a> that facets allow us to split a visualization by the different values of another variable. We display the resulting visualization in Figure <a href="8-regression.html#fig:catxplot0b">8.8</a> by adding a <code>facet_wrap(~ continent, nrow = 2)</code> layer.</p>
<div class="sourceCode" id="cb368"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb368-1"><a href="8-regression.html#cb368-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(gapminder2007, <span class="fu">aes</span>(<span class="at">x =</span> lifeExp)) <span class="sc">+</span></span>
<span id="cb368-2"><a href="8-regression.html#cb368-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">5</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb368-3"><a href="8-regression.html#cb368-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Life expectancy&quot;</span>, </span>
<span id="cb368-4"><a href="8-regression.html#cb368-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Number of countries&quot;</span>,</span>
<span id="cb368-5"><a href="8-regression.html#cb368-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;Histogram of distribution of worldwide life expectancies&quot;</span>) <span class="sc">+</span></span>
<span id="cb368-6"><a href="8-regression.html#cb368-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> continent, <span class="at">nrow =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:catxplot0b"></span>
<img src="ModernDive_files/figure-html/catxplot0b-1.png" alt="Life expectancy in 2007." width="\textwidth" />
<p class="caption">
FIGURE 8.8: Life expectancy in 2007.
</p>
</div>
<p>Observe that unfortunately the distribution of African life expectancies is much lower than the other continents, while in Europe life expectancies tend to be higher and furthermore do not vary as much. On the other hand, both Asia and Africa have the most variation in life expectancies. There is the least variation in Oceania, but keep in mind that there are only two countries in Oceania: Australia and New Zealand.</p>
<p>Recall that an alternative method to visualize the distribution of a numerical variable split by a categorical variable is by using a side-by-side boxplot. We map the categorical variable <code>continent</code> to the <span class="math inline">\(x\)</span>-axis and the different life expectancies within each continent on the <span class="math inline">\(y\)</span>-axis in Figure <a href="8-regression.html#fig:catxplot1">8.9</a>.</p>
<div class="sourceCode" id="cb369"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb369-1"><a href="8-regression.html#cb369-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(gapminder2007, <span class="fu">aes</span>(<span class="at">x =</span> continent, <span class="at">y =</span> lifeExp)) <span class="sc">+</span></span>
<span id="cb369-2"><a href="8-regression.html#cb369-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb369-3"><a href="8-regression.html#cb369-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Continent&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Life expectancy&quot;</span>,</span>
<span id="cb369-4"><a href="8-regression.html#cb369-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;Life expectancy by continent&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:catxplot1"></span>
<img src="ModernDive_files/figure-html/catxplot1-1.png" alt="Life expectancy in 2007." width="\textwidth" />
<p class="caption">
FIGURE 8.9: Life expectancy in 2007.
</p>
</div>
<p>Some people prefer comparing the distributions of a numerical variable between different levels of a categorical variable using a boxplot instead of a faceted histogram. This is because we can make quick comparisons between the categorical variable’s levels with imaginary horizontal lines. For example, observe in Figure <a href="8-regression.html#fig:catxplot1">8.9</a> that we can quickly convince ourselves that Oceania has the highest median life expectancies by drawing an imaginary horizontal line at <span class="math inline">\(y\)</span> = 80. Furthermore, as we observed in the faceted histogram in Figure <a href="8-regression.html#fig:catxplot0b">8.8</a>, Africa and Asia have the largest variation in life expectancy as evidenced by their large interquartile ranges (the heights of the boxes).</p>
<p>It’s important to remember, however, that the solid lines in the middle of the boxes correspond to the medians (the middle value) rather than the mean (the average). So, for example, if you look at Asia, the solid line denotes the median life expectancy of around 72 years. This tells us that half of all countries in Asia have a life expectancy below 72 years, whereas half have a life expectancy above 72 years.</p>
<p>Let’s compute the median and mean life expectancy for each continent with a little more data wrangling and display the results in Table <a href="8-regression.html#tab:catxplot0">8.6</a>.</p>
<div class="sourceCode" id="cb370"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb370-1"><a href="8-regression.html#cb370-1" aria-hidden="true" tabindex="-1"></a>lifeExp_by_continent <span class="ot">&lt;-</span> gapminder2007 <span class="sc">%&gt;%</span></span>
<span id="cb370-2"><a href="8-regression.html#cb370-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(continent) <span class="sc">%&gt;%</span></span>
<span id="cb370-3"><a href="8-regression.html#cb370-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">median =</span> <span class="fu">median</span>(lifeExp), </span>
<span id="cb370-4"><a href="8-regression.html#cb370-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean =</span> <span class="fu">mean</span>(lifeExp))</span></code></pre></div>
<table>
<caption>
<span id="tab:catxplot0">TABLE 8.6: </span>Life expectancy by continent
</caption>
<thead>
<tr>
<th style="text-align:left;">
continent
</th>
<th style="text-align:right;">
median
</th>
<th style="text-align:right;">
mean
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Africa
</td>
<td style="text-align:right;">
52.9
</td>
<td style="text-align:right;">
54.8
</td>
</tr>
<tr>
<td style="text-align:left;">
Americas
</td>
<td style="text-align:right;">
72.9
</td>
<td style="text-align:right;">
73.6
</td>
</tr>
<tr>
<td style="text-align:left;">
Asia
</td>
<td style="text-align:right;">
72.4
</td>
<td style="text-align:right;">
70.7
</td>
</tr>
<tr>
<td style="text-align:left;">
Europe
</td>
<td style="text-align:right;">
78.6
</td>
<td style="text-align:right;">
77.6
</td>
</tr>
<tr>
<td style="text-align:left;">
Oceania
</td>
<td style="text-align:right;">
80.7
</td>
<td style="text-align:right;">
80.7
</td>
</tr>
</tbody>
</table>
<p>Observe the order of the second column <code>median</code> life expectancy: Africa is lowest, the Americas and Asia are next with similar medians, then Europe, then Oceania. This ordering corresponds to the ordering of the solid black lines inside the boxes in our side-by-side boxplot in Figure <a href="8-regression.html#fig:catxplot1">8.9</a>.</p>
<p>Let’s now turn our attention to the values in the third column <code>mean</code>. Using Africa’s mean life expectancy of 54.8 as a <em>baseline for comparison</em>, let’s start making comparisons to the mean life expectancies of the other four continents and put these values in Table <a href="8-regression.html#tab:continent-mean-life-expectancies">8.7</a>, which we’ll revisit later on in this section.</p>
<ol style="list-style-type: decimal">
<li>For the Americas, it is 73.6 - 54.8 = 18.8 years higher.</li>
<li>For Asia, it is 70.7 - 54.8 = 15.9 years higher.</li>
<li>For Europe, it is 77.6 - 54.8 = 22.8 years higher.</li>
<li>For Oceania, it is 80.7 - 54.8 = 25.9 years higher.</li>
</ol>
<table class="table" style="font-size: 16px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:continent-mean-life-expectancies">TABLE 8.7: </span>Mean life expectancy by continent and relative differences from mean for Africa
</caption>
<thead>
<tr>
<th style="text-align:left;">
continent
</th>
<th style="text-align:right;">
mean
</th>
<th style="text-align:right;">
Difference versus Africa
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Africa
</td>
<td style="text-align:right;">
54.8
</td>
<td style="text-align:right;">
0.0
</td>
</tr>
<tr>
<td style="text-align:left;">
Americas
</td>
<td style="text-align:right;">
73.6
</td>
<td style="text-align:right;">
18.8
</td>
</tr>
<tr>
<td style="text-align:left;">
Asia
</td>
<td style="text-align:right;">
70.7
</td>
<td style="text-align:right;">
15.9
</td>
</tr>
<tr>
<td style="text-align:left;">
Europe
</td>
<td style="text-align:right;">
77.6
</td>
<td style="text-align:right;">
22.8
</td>
</tr>
<tr>
<td style="text-align:left;">
Oceania
</td>
<td style="text-align:right;">
80.7
</td>
<td style="text-align:right;">
25.9
</td>
</tr>
</tbody>
</table>
<div class="learncheck">
<p>
<strong><em>Learning check</em></strong>
</p>
</div>
<p><strong>(LC8.4)</strong> Conduct a new exploratory data analysis with the same explanatory variable <span class="math inline">\(x\)</span> being <code>continent</code> but with <code>gdpPercap</code> as the new outcome variable <span class="math inline">\(y\)</span>. What can you say about the differences in GDP per capita between continents based on this exploration?</p>
<div class="learncheck">

</div>
</div>
<div id="model2table" class="section level3 hasAnchor" number="8.2.2">
<h3><span class="header-section-number">8.2.2</span> Linear regression<a href="8-regression.html#model2table" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In Subsection <a href="8-regression.html#model1table">8.1.2</a> we introduced simple linear regression, which involves modeling the relationship between a numerical outcome variable <span class="math inline">\(y\)</span> and a numerical explanatory variable <span class="math inline">\(x\)</span>. In our life expectancy example, we now instead have a categorical explanatory variable <code>continent</code>. Our model will not yield a “best-fitting” regression line like in Figure <a href="8-regression.html#fig:numxplot3">8.4</a>, but rather <em>offsets</em> relative to a baseline for comparison.</p>
<p>As we did in Subsection <a href="8-regression.html#model1table">8.1.2</a> when studying the relationship between black proportion of life noses and age, let’s output the regression table for this model. Recall that this is done in two steps:</p>
<ol style="list-style-type: decimal">
<li>We first “fit” the linear regression model using the <code>lm(y ~ x, data)</code> function and save it in <code>lifeExp_model</code>.</li>
<li>We get the regression table by applying the <code>get_regression_table()</code> function from the <code>moderndive</code> package to <code>lifeExp_model</code>.</li>
</ol>
<div class="sourceCode" id="cb371"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb371-1"><a href="8-regression.html#cb371-1" aria-hidden="true" tabindex="-1"></a>lifeExp_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(lifeExp <span class="sc">~</span> continent, <span class="at">data =</span> gapminder2007)</span>
<span id="cb371-2"><a href="8-regression.html#cb371-2" aria-hidden="true" tabindex="-1"></a><span class="fu">get_regression_table</span>(lifeExp_model)</span></code></pre></div>
<table class="table" style="font-size: 16px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:catxplot4b">TABLE 8.8: </span>Linear regression table
</caption>
<thead>
<tr>
<th style="text-align:left;">
term
</th>
<th style="text-align:right;">
estimate
</th>
<th style="text-align:right;">
std_error
</th>
<th style="text-align:right;">
statistic
</th>
<th style="text-align:right;">
p_value
</th>
<th style="text-align:right;">
lower_ci
</th>
<th style="text-align:right;">
upper_ci
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
intercept
</td>
<td style="text-align:right;">
54.8
</td>
<td style="text-align:right;">
1.02
</td>
<td style="text-align:right;">
53.45
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
52.8
</td>
<td style="text-align:right;">
56.8
</td>
</tr>
<tr>
<td style="text-align:left;">
continent: Americas
</td>
<td style="text-align:right;">
18.8
</td>
<td style="text-align:right;">
1.80
</td>
<td style="text-align:right;">
10.45
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
15.2
</td>
<td style="text-align:right;">
22.4
</td>
</tr>
<tr>
<td style="text-align:left;">
continent: Asia
</td>
<td style="text-align:right;">
15.9
</td>
<td style="text-align:right;">
1.65
</td>
<td style="text-align:right;">
9.68
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
12.7
</td>
<td style="text-align:right;">
19.2
</td>
</tr>
<tr>
<td style="text-align:left;">
continent: Europe
</td>
<td style="text-align:right;">
22.8
</td>
<td style="text-align:right;">
1.70
</td>
<td style="text-align:right;">
13.47
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
19.5
</td>
<td style="text-align:right;">
26.2
</td>
</tr>
<tr>
<td style="text-align:left;">
continent: Oceania
</td>
<td style="text-align:right;">
25.9
</td>
<td style="text-align:right;">
5.33
</td>
<td style="text-align:right;">
4.86
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
15.4
</td>
<td style="text-align:right;">
36.5
</td>
</tr>
</tbody>
</table>
<p>Let’s once again focus on the values in the <code>term</code> and <code>estimate</code> columns of Table <a href="8-regression.html#tab:catxplot4b">8.8</a>. Why are there now 5 rows? Let’s break them down one-by-one:</p>
<ol style="list-style-type: decimal">
<li><code>intercept</code> corresponds to the mean life expectancy of countries in Africa of 54.8 years.</li>
<li><code>continentAmericas</code> corresponds to countries in the Americas and the value +18.8 is the same difference in mean life expectancy relative to Africa we displayed in Table <a href="8-regression.html#tab:continent-mean-life-expectancies">8.7</a>. In other words, the mean life expectancy of countries in the Americas is <span class="math inline">\(54.8 + 18.8 = 73.6\)</span>.</li>
<li><code>continentAsia</code> corresponds to countries in Asia and the value +15.9 is the same difference in mean life expectancy relative to Africa we displayed in Table <a href="8-regression.html#tab:continent-mean-life-expectancies">8.7</a>. In other words, the mean life expectancy of countries in Asia is <span class="math inline">\(54.8 + 15.9 = 70.7\)</span>.</li>
<li><code>continentEurope</code> corresponds to countries in Europe and the value +22.8 is the same difference in mean life expectancy relative to Africa we displayed in Table <a href="8-regression.html#tab:continent-mean-life-expectancies">8.7</a>. In other words, the mean life expectancy of countries in Europe is <span class="math inline">\(54.8 + 22.8 = 77.6\)</span>.</li>
<li><code>continentOceania</code> corresponds to countries in Oceania and the value +25.9 is the same difference in mean life expectancy relative to Africa we displayed in Table <a href="8-regression.html#tab:continent-mean-life-expectancies">8.7</a>. In other words, the mean life expectancy of countries in Oceania is <span class="math inline">\(54.8 + 25.9 = 80.7\)</span>.</li>
</ol>
<p>To summarize, the 5 values in the <code>estimate</code> column in Table <a href="8-regression.html#tab:catxplot4b">8.8</a> correspond to the “baseline for comparison” continent Africa (the intercept) as well as four “offsets” from this baseline for the remaining 4 continents: the Americas, Asia, Europe, and Oceania.</p>
<p>You might be asking at this point why was Africa chosen as the “baseline for comparison” group. This is the case for no other reason than it comes first alphabetically of the five continents; by default R arranges factors/categorical variables in alphanumeric order. You can change this baseline group to be another continent if you manipulate the variable <code>continent</code>’s factor “levels” using the <code>forcats</code> package. See <a href="https://r4ds.had.co.nz/factors.html">Chapter 15</a> of <em>R for Data Science</em> <span class="citation">(<a href="#ref-rds2016" role="doc-biblioref">Grolemund and Wickham 2017</a>)</span> for examples.</p>
<p>Let’s now write the equation for our fitted values <span class="math inline">\(\widehat{y} = \widehat{\text{life exp}}\)</span>.</p>
<!--
Note: Even though markdown preview of the following LaTeX looks garbled, it
comes out correct in the HTML output.
-->
<p><span class="math display">\[
\begin{aligned}
\widehat{y} = \widehat{\text{life exp}} &amp;= b_0 + b_{\text{Amer}}\cdot\mathbb{1}_{\text{Amer}}(x) + b_{\text{Asia}}\cdot\mathbb{1}_{\text{Asia}}(x) + \\
&amp; \qquad b_{\text{Euro}}\cdot\mathbb{1}_{\text{Euro}}(x) + b_{\text{Ocean}}\cdot\mathbb{1}_{\text{Ocean}}(x)\\
&amp;= 54.8 + 18.8\cdot\mathbb{1}_{\text{Amer}}(x) + 15.9\cdot\mathbb{1}_{\text{Asia}}(x) + \\
&amp; \qquad 22.8\cdot\mathbb{1}_{\text{Euro}}(x) + 25.9\cdot\mathbb{1}_{\text{Ocean}}(x)
\end{aligned}
\]</span></p>
<p>Whoa! That looks daunting! Don’t fret, however, as once you understand what all the elements mean, things simplify greatly. First, <span class="math inline">\(\mathbb{1}_{A}(x)\)</span> is what’s known in mathematics as an “indicator function.” It returns only one of two possible values, 0 and 1, where</p>
<p><span class="math display">\[
\mathbb{1}_{A}(x) = \left\{
\begin{array}{ll}
1 &amp; \text{if } x \text{ is in } A \\
0 &amp; \text{if } \text{otherwise} \end{array}
\right.
\]</span></p>
<p>In a statistical modeling context, this is also known as a <em>dummy variable</em>. In our case, let’s consider the first such indicator variable <span class="math inline">\(\mathbb{1}_{\text{Amer}}(x)\)</span>. This indicator function returns 1 if a country is in the Americas, 0 otherwise:</p>
<p><span class="math display">\[
\mathbb{1}_{\text{Amer}}(x) = \left\{
\begin{array}{ll}
1 &amp; \text{if } \text{country } x \text{ is in the Americas} \\
0 &amp; \text{otherwise}\end{array}
\right.
\]</span></p>
<p>Second, <span class="math inline">\(b_0\)</span> corresponds to the intercept as before; in this case, it’s the mean life expectancy of all countries in Africa. Third, the <span class="math inline">\(b_{\text{Amer}}\)</span>, <span class="math inline">\(b_{\text{Asia}}\)</span>, <span class="math inline">\(b_{\text{Euro}}\)</span>, and <span class="math inline">\(b_{\text{Ocean}}\)</span> represent the 4 “offsets relative to the baseline for comparison” in the regression table output in Table <a href="8-regression.html#tab:catxplot4b">8.8</a>: <code>continentAmericas</code>, <code>continentAsia</code>, <code>continentEurope</code>, and <code>continentOceania</code>.</p>
<p>Let’s put this all together and compute the fitted value <span class="math inline">\(\widehat{y} = \widehat{\text{life exp}}\)</span> for a country in Africa. Since the country is in Africa, all four indicator functions <span class="math inline">\(\mathbb{1}_{\text{Amer}}(x)\)</span>, <span class="math inline">\(\mathbb{1}_{\text{Asia}}(x)\)</span>, <span class="math inline">\(\mathbb{1}_{\text{Euro}}(x)\)</span>, and <span class="math inline">\(\mathbb{1}_{\text{Ocean}}(x)\)</span> will equal 0, and thus:</p>
<p><span class="math display">\[
\begin{aligned}
\widehat{\text{life exp}} &amp;= b_0 + b_{\text{Amer}}\cdot\mathbb{1}_{\text{Amer}}(x) + b_{\text{Asia}}\cdot\mathbb{1}_{\text{Asia}}(x)
+ \\
&amp; \qquad b_{\text{Euro}}\cdot\mathbb{1}_{\text{Euro}}(x) + b_{\text{Ocean}}\cdot\mathbb{1}_{\text{Ocean}}(x)\\
&amp;= 54.8 + 18.8\cdot\mathbb{1}_{\text{Amer}}(x) + 15.9\cdot\mathbb{1}_{\text{Asia}}(x)
+ \\
&amp; \qquad 22.8\cdot\mathbb{1}_{\text{Euro}}(x) + 25.9\cdot\mathbb{1}_{\text{Ocean}}(x)\\
&amp;= 54.8 + 18.8\cdot 0 + 15.9\cdot 0 + 22.8\cdot 0 + 25.9\cdot 0\\
&amp;= 54.8
\end{aligned}
\]</span></p>
<p>In other words, all that’s left is the intercept <span class="math inline">\(b_0\)</span>, corresponding to the average life expectancy of African countries of 54.8 years. Next, say we are considering a country in the Americas. In this case, only the indicator function <span class="math inline">\(\mathbb{1}_{\text{Amer}}(x)\)</span> for the Americas will equal 1, while all the others will equal 0, and thus:</p>
<p><span class="math display">\[
\begin{aligned}
\widehat{\text{life exp}} &amp;= 54.8 + 18.8\cdot\mathbb{1}_{\text{Amer}}(x) + 15.9\cdot\mathbb{1}_{\text{Asia}}(x)
+ 22.8\cdot\mathbb{1}_{\text{Euro}}(x) + \\
&amp; \qquad 25.9\cdot\mathbb{1}_{\text{Ocean}}(x)\\
&amp;= 54.8 + 18.8\cdot 1 + 15.9\cdot 0 + 22.8\cdot 0 + 25.9\cdot 0\\
&amp;= 54.8 + 18.8 \\
&amp; = 73.6
\end{aligned}
\]</span></p>
<p>which is the mean life expectancy for countries in the Americas of 73.6 years in Table <a href="8-regression.html#tab:continent-mean-life-expectancies">8.7</a>. Note the “offset from the baseline for comparison” is +18.8 years.</p>
<p>Let’s do one more. Say we are considering a country in Asia. In this case, only the indicator function <span class="math inline">\(\mathbb{1}_{\text{Asia}}(x)\)</span> for Asia will equal 1, while all the others will equal 0, and thus:</p>
<p><span class="math display">\[
\begin{aligned}
\widehat{\text{life exp}} &amp;= 54.8 + 18.8\cdot\mathbb{1}_{\text{Amer}}(x) + 15.9\cdot\mathbb{1}_{\text{Asia}}(x)
+ 22.8\cdot\mathbb{1}_{\text{Euro}}(x) + \\
&amp; \qquad 25.9\cdot\mathbb{1}_{\text{Ocean}}(x)\\
&amp;= 54.8 + 18.8\cdot 0 + 15.9\cdot 1 + 22.8\cdot 0 + 25.9\cdot 0\\
&amp;= 54.8 + 15.9 \\
&amp; = 70.7
\end{aligned}
\]</span></p>
<p>which is the mean life expectancy for Asian countries of 70.7 years in Table <a href="8-regression.html#tab:continent-mean-life-expectancies">8.7</a>. The “offset from the baseline for comparison” here is +15.9 years.</p>
<p>Let’s generalize this idea a bit. If we fit a linear regression model using a categorical explanatory variable <span class="math inline">\(x\)</span> that has <span class="math inline">\(k\)</span> possible categories, the regression table will return an intercept and <span class="math inline">\(k - 1\)</span> “offsets.” In our case, since there are <span class="math inline">\(k = 5\)</span> continents, the regression model returns an intercept corresponding to the baseline for comparison group of Africa and <span class="math inline">\(k - 1 = 4\)</span> offsets corresponding to the Americas, Asia, Europe, and Oceania.</p>
<p>Understanding a regression table output when you’re using a categorical explanatory variable is a topic those new to regression often struggle with. The only real remedy for these struggles is practice, practice, practice. However, once you equip yourselves with an understanding of how to create regression models using categorical explanatory variables, you’ll be able to incorporate many new variables into your models, given the large amount of the world’s data that is categorical. If you feel like you’re still struggling at this point, however, we suggest you closely compare Tables <a href="8-regression.html#tab:continent-mean-life-expectancies">8.7</a> and <a href="8-regression.html#tab:catxplot4b">8.8</a> and note how you can compute all the values from one table using the values in the other.</p>
<div class="learncheck">
<p>
<strong><em>Learning check</em></strong>
</p>
</div>
<p><strong>(LC8.5)</strong> Fit a new linear regression using <code>lm(gdpPercap ~ continent, data = gapminder2007)</code> where <code>gdpPercap</code> is the new outcome variable <span class="math inline">\(y\)</span>. Get information about the “best-fitting” line from the regression table by applying the <code>get_regression_table()</code> function. How do the regression results match up with the results from your previous exploratory data analysis?</p>
<div class="learncheck">

</div>
</div>
<div id="model2points" class="section level3 hasAnchor" number="8.2.3">
<h3><span class="header-section-number">8.2.3</span> Observed/fitted values and residuals<a href="8-regression.html#model2points" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Recall in Subsection <a href="8-regression.html#model1points">8.1.3</a>, we defined the following three concepts:</p>
<ol style="list-style-type: decimal">
<li>Observed values <span class="math inline">\(y\)</span>, or the observed value of the outcome variable </li>
<li>Fitted values <span class="math inline">\(\widehat{y}\)</span>, or the value on the regression line for a given <span class="math inline">\(x\)</span> value</li>
<li>Residuals <span class="math inline">\(y - \widehat{y}\)</span>, or the error between the observed value and the fitted value</li>
</ol>
<p>We obtained these values and other values using the <code>get_regression_points()</code> function from the <code>moderndive</code> package. This time, however, let’s add an argument setting <code>ID = "country"</code>: this is telling the function to use the variable <code>country</code> in <code>gapminder2007</code> as an <em>identification variable</em> in the output. This will help contextualize our analysis by matching values to countries.</p>
<div class="sourceCode" id="cb372"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb372-1"><a href="8-regression.html#cb372-1" aria-hidden="true" tabindex="-1"></a>regression_points <span class="ot">&lt;-</span> <span class="fu">get_regression_points</span>(lifeExp_model, <span class="at">ID =</span> <span class="st">&quot;country&quot;</span>)</span>
<span id="cb372-2"><a href="8-regression.html#cb372-2" aria-hidden="true" tabindex="-1"></a>regression_points</span></code></pre></div>
<table class="table" style="font-size: 16px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:model2-residuals">TABLE 8.9: </span>Regression points (First 10 out of 142 countries)
</caption>
<thead>
<tr>
<th style="text-align:left;">
country
</th>
<th style="text-align:right;">
lifeExp
</th>
<th style="text-align:left;">
continent
</th>
<th style="text-align:right;">
lifeExp_hat
</th>
<th style="text-align:right;">
residual
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Afghanistan
</td>
<td style="text-align:right;">
43.8
</td>
<td style="text-align:left;">
Asia
</td>
<td style="text-align:right;">
70.7
</td>
<td style="text-align:right;">
-26.900
</td>
</tr>
<tr>
<td style="text-align:left;">
Albania
</td>
<td style="text-align:right;">
76.4
</td>
<td style="text-align:left;">
Europe
</td>
<td style="text-align:right;">
77.6
</td>
<td style="text-align:right;">
-1.226
</td>
</tr>
<tr>
<td style="text-align:left;">
Algeria
</td>
<td style="text-align:right;">
72.3
</td>
<td style="text-align:left;">
Africa
</td>
<td style="text-align:right;">
54.8
</td>
<td style="text-align:right;">
17.495
</td>
</tr>
<tr>
<td style="text-align:left;">
Angola
</td>
<td style="text-align:right;">
42.7
</td>
<td style="text-align:left;">
Africa
</td>
<td style="text-align:right;">
54.8
</td>
<td style="text-align:right;">
-12.075
</td>
</tr>
<tr>
<td style="text-align:left;">
Argentina
</td>
<td style="text-align:right;">
75.3
</td>
<td style="text-align:left;">
Americas
</td>
<td style="text-align:right;">
73.6
</td>
<td style="text-align:right;">
1.712
</td>
</tr>
<tr>
<td style="text-align:left;">
Australia
</td>
<td style="text-align:right;">
81.2
</td>
<td style="text-align:left;">
Oceania
</td>
<td style="text-align:right;">
80.7
</td>
<td style="text-align:right;">
0.516
</td>
</tr>
<tr>
<td style="text-align:left;">
Austria
</td>
<td style="text-align:right;">
79.8
</td>
<td style="text-align:left;">
Europe
</td>
<td style="text-align:right;">
77.6
</td>
<td style="text-align:right;">
2.180
</td>
</tr>
<tr>
<td style="text-align:left;">
Bahrain
</td>
<td style="text-align:right;">
75.6
</td>
<td style="text-align:left;">
Asia
</td>
<td style="text-align:right;">
70.7
</td>
<td style="text-align:right;">
4.907
</td>
</tr>
<tr>
<td style="text-align:left;">
Bangladesh
</td>
<td style="text-align:right;">
64.1
</td>
<td style="text-align:left;">
Asia
</td>
<td style="text-align:right;">
70.7
</td>
<td style="text-align:right;">
-6.666
</td>
</tr>
<tr>
<td style="text-align:left;">
Belgium
</td>
<td style="text-align:right;">
79.4
</td>
<td style="text-align:left;">
Europe
</td>
<td style="text-align:right;">
77.6
</td>
<td style="text-align:right;">
1.792
</td>
</tr>
</tbody>
</table>
<p>Observe in Table <a href="8-regression.html#tab:model2-residuals">8.9</a> that <code>lifeExp_hat</code> contains the fitted values <span class="math inline">\(\widehat{y}\)</span> = <span class="math inline">\(\widehat{\text{lifeExp}}\)</span>. If you look closely, there are only 5 possible values for <code>lifeExp_hat</code>. These correspond to the five mean life expectancies for the 5 continents that we displayed in Table <a href="8-regression.html#tab:continent-mean-life-expectancies">8.7</a> and computed using the values in the <code>estimate</code> column of the regression table in Table <a href="8-regression.html#tab:catxplot4b">8.8</a>.</p>
<p>The <code>residual</code> column is simply <span class="math inline">\(y - \widehat{y}\)</span> = <code>lifeExp - lifeExp_hat</code>. These values can be interpreted as the deviation of a country’s life expectancy from its continent’s average life expectancy. For example, look at the first row of Table <a href="8-regression.html#tab:model2-residuals">8.9</a> corresponding to Afghanistan. The residual of <span class="math inline">\(y - \widehat{y} = 43.8 - 70.7 = -26.9\)</span> is telling us that Afghanistan’s life expectancy is a whopping 26.9 years lower than the mean life expectancy of all Asian countries. This can in part be explained by the many years of war that country has suffered.</p>
<div class="learncheck">
<p>
<strong><em>Learning check</em></strong>
</p>
</div>
<p><strong>(LC8.6)</strong> Using either the sorting functionality of RStudio’s spreadsheet viewer or using the data wrangling tools you learned in Chapter <a href="3-wrangling.html#wrangling">3</a>, identify the five countries with the five smallest (most negative) residuals? What do these negative residuals say about their life expectancy relative to their continents’ life expectancy?</p>
<p><strong>(LC8.7)</strong> Repeat this process, but identify the five countries with the five largest (most positive) residuals. What do these positive residuals say about their life expectancy relative to their continents’ life expectancy?</p>
<div class="learncheck">

</div>
</div>
</div>
<div id="reg-related-topics" class="section level2 hasAnchor" number="8.3">
<h2><span class="header-section-number">8.3</span> Related topics<a href="8-regression.html#reg-related-topics" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="correlation-is-not-causation" class="section level3 hasAnchor" number="8.3.1">
<h3><span class="header-section-number">8.3.1</span> Correlation is not necessarily causation<a href="8-regression.html#correlation-is-not-causation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Throughout this chapter we’ve been cautious when interpreting regression slope coefficients. We always discussed the “associated” effect of an explanatory variable <span class="math inline">\(x\)</span> on an outcome variable <span class="math inline">\(y\)</span>. For example, our statement from Subsection <a href="8-regression.html#model1table">8.1.2</a> that “for every increase of 1 unit in <code>age</code>, there is an <em>associated</em> increase of on average 0.059 units of <code>proportion.black</code>.” We include the term “associated” to be extra careful not to suggest we are making a <em>causal</em> statement. So while lion<code>age</code> is positively correlated with <code>proportion.black</code>, we can’t necessarily make any statements about age’s direct causal effect on black proportion without more information on how this study was conducted. Here is another example: a not-so-great medical doctor goes through medical records and finds that patients who slept with their shoes on tended to wake up more with headaches. So this doctor declares, “Sleeping with shoes on causes headaches!”</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:moderndive-figure-causal-graph-2"></span>
<img src="images/shutterstock/shoes_headache.png" alt="Does sleeping with shoes on cause headaches?" width="60%" height="60%" />
<p class="caption">
FIGURE 8.10: Does sleeping with shoes on cause headaches?
</p>
</div>
<p>However, there is a good chance that if someone is sleeping with their shoes on, it’s potentially because they are intoxicated from alcohol. Furthermore, higher levels of drinking leads to more hangovers, and hence more headaches. The amount of alcohol consumption here is what’s known as a <em>confounding/lurking</em> variable. It “lurks” behind the scenes, confounding the causal relationship (if any) of “sleeping with shoes on” with “waking up with a headache.” We can summarize this in Figure <a href="8-regression.html#fig:moderndive-figure-causal-graph">8.11</a> with a <em>causal graph</em> where:</p>
<ul>
<li>Y is a <em>response</em> variable; here it is “waking up with a headache.” </li>
<li>X is a <em>treatment</em> variable whose causal effect we are interested in; here it is “sleeping with shoes on.”</li>
</ul>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:moderndive-figure-causal-graph"></span>
<img src="images/flowcharts/flowchart/flowchart.009-cropped.png" alt="Causal graph." width="50%" />
<p class="caption">
FIGURE 8.11: Causal graph.
</p>
</div>
<p>To study the relationship between Y and X, we could use a regression model where the outcome variable is set to Y and the explanatory variable is set to be X, as you’ve been doing throughout this chapter. However, Figure <a href="8-regression.html#fig:moderndive-figure-causal-graph">8.11</a> also includes a third variable with arrows pointing at both X and Y:</p>
<ul>
<li>Z is a <em>confounding</em> variable that affects both X and Y, thereby “confounding” their relationship. Here the confounding variable is alcohol.</li>
</ul>
<p>Alcohol will cause people to be both more likely to sleep with their shoes on as well as be more likely to wake up with a headache. Thus any regression model of the relationship between X and Y should also use Z as an explanatory variable. In other words, our doctor needs to take into account who had been drinking the night before. In the next chapter, we’ll start covering multiple regression models that allow us to incorporate more than one variable in our regression models.</p>
<p>Establishing causation is a tricky problem and frequently takes either carefully designed experiments or methods to control for the effects of confounding variables. Both these approaches attempt, as best they can, either to take all possible confounding variables into account or negate their impact. This allows researchers to focus only on the relationship of interest: the relationship between the outcome variable Y and the treatment variable X.</p>
<p>As you read news stories, be careful not to fall into the trap of thinking that correlation necessarily implies causation. Check out the <a href="http://www.tylervigen.com/spurious-correlations">Spurious Correlations</a> website for some rather comical examples of variables that are correlated, but are definitely not causally related.</p>
</div>
<div id="leastsquares" class="section level3 hasAnchor" number="8.3.2">
<h3><span class="header-section-number">8.3.2</span> Best-fitting line<a href="8-regression.html#leastsquares" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Regression lines are also known as “best-fitting” lines. But what do we mean by “best”? Let’s unpack the criteria that is used in regression to determine “best.” Recall Figure <a href="8-regression.html#fig:numxplot4">8.6</a>, where for an lion with an age of <span class="math inline">\(x = 5.8\)</span> years we mark the <em>observed value</em> <span class="math inline">\(y\)</span> with a circle, the <em>fitted value</em> <span class="math inline">\(\widehat{y}\)</span> with a square, and the <em>residual</em> <span class="math inline">\(y - \widehat{y}\)</span> with an arrow. We re-display Figure <a href="8-regression.html#fig:numxplot4">8.6</a> in the top-left plot of Figure <a href="8-regression.html#fig:best-fitting-line">8.12</a> in addition to three more arbitrarily chosen course lions:</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:best-fitting-line"></span>
<img src="ModernDive_files/figure-html/best-fitting-line-1.png" alt="Example of observed value, fitted value, and residual." width="\textwidth" />
<p class="caption">
FIGURE 8.12: Example of observed value, fitted value, and residual.
</p>
</div>
<p>The three other plots refer to:</p>
<ol style="list-style-type: decimal">
<li>A lion with an age of <span class="math inline">\(x\)</span> = 1.9 years and black proportion of <span class="math inline">\(y\)</span> = 0.27. The residual in this case is <span class="math inline">\(0.27 - 0.181 = 0.089\)</span>, which we mark with a new blue arrow in the top-right plot.</li>
<li>A lion with an age of <span class="math inline">\(x = 2.9\)</span> years and black proportion of <span class="math inline">\(y = 0.18\)</span>. The residual in this case is <span class="math inline">\(0.18 - 0.24 = -0.06\)</span>, which we mark with a new blue arrow in the bottom-left plot.</li>
<li>A lion with an age of <span class="math inline">\(x = 1.5\)</span> years and black proportion of <span class="math inline">\(y = 0.0.14\)</span>. The residual in this case is <span class="math inline">\(0.14 - 0.158 = -0.018\)</span>, which we mark with a new blue arrow in the bottom-right plot.</li>
</ol>
<p>Now say we repeated this process of computing residuals for all 32 courses’ lions, then we squared all the residuals, and then we summed them. We call this quantity the <em>sum of squared residuals</em>; it is a measure of the <em>lack of fit</em> of a model. Larger values of the sum of squared residuals indicate a bigger lack of fit. This corresponds to a worse fitting model.</p>
<p>If the regression line fits all the points perfectly, then the sum of squared residuals is 0. This is because if the regression line fits all the points perfectly, then the fitted value <span class="math inline">\(\widehat{y}\)</span> equals the observed value <span class="math inline">\(y\)</span> in all cases, and hence the residual <span class="math inline">\(y-\widehat{y}\)</span> = 0 in all cases, and the sum of even a large number of 0’s is still 0.</p>
<p>Furthermore, of all possible lines we can draw through the cloud of 32 points, the regression line minimizes this value. In other words, the regression and its corresponding fitted values <span class="math inline">\(\widehat{y}\)</span> minimizes the sum of the squared residuals:</p>
<p><span class="math display">\[
\sum_{i=1}^{n}(y_i - \widehat{y}_i)^2
\]</span></p>
<p>Let’s use our data wrangling tools from Chapter <a href="3-wrangling.html#wrangling">3</a> to compute the sum of squared residuals exactly:</p>
<div class="sourceCode" id="cb373"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb373-1"><a href="8-regression.html#cb373-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit regression model:</span></span>
<span id="cb373-2"><a href="8-regression.html#cb373-2" aria-hidden="true" tabindex="-1"></a>lion_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(proportion.black <span class="sc">~</span> age, </span>
<span id="cb373-3"><a href="8-regression.html#cb373-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> LionNoses)</span>
<span id="cb373-4"><a href="8-regression.html#cb373-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb373-5"><a href="8-regression.html#cb373-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Get regression points:</span></span>
<span id="cb373-6"><a href="8-regression.html#cb373-6" aria-hidden="true" tabindex="-1"></a>regression_points <span class="ot">&lt;-</span> <span class="fu">get_regression_points</span>(lion_model)</span>
<span id="cb373-7"><a href="8-regression.html#cb373-7" aria-hidden="true" tabindex="-1"></a>regression_points</span></code></pre></div>
<pre><code># A tibble: 32 × 5
      ID proportion.black   age proportion.black_hat residual
   &lt;int&gt;            &lt;dbl&gt; &lt;dbl&gt;                &lt;dbl&gt;    &lt;dbl&gt;
 1     1             0.21   1.1                0.134    0.076
 2     2             0.14   1.5                0.158   -0.018
 3     3             0.11   1.9                0.181   -0.071
 4     4             0.13   2.2                0.199   -0.069
 5     5             0.12   2.6                0.222   -0.102
 6     6             0.13   3.2                0.257   -0.127
 7     7             0.12   3.2                0.257   -0.137
 8     8             0.18   2.9                0.24    -0.06 
 9     9             0.23   2.4                0.21     0.02 
10    10             0.22   2.1                0.193    0.027
# … with 22 more rows</code></pre>
<div class="sourceCode" id="cb375"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb375-1"><a href="8-regression.html#cb375-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute sum of squared residuals</span></span>
<span id="cb375-2"><a href="8-regression.html#cb375-2" aria-hidden="true" tabindex="-1"></a>regression_points <span class="sc">%&gt;%</span></span>
<span id="cb375-3"><a href="8-regression.html#cb375-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">squared_residuals =</span> residual<span class="sc">^</span><span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb375-4"><a href="8-regression.html#cb375-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">sum_of_squared_residuals =</span> <span class="fu">sum</span>(squared_residuals))</span></code></pre></div>
<pre><code># A tibble: 1 × 1
  sum_of_squared_residuals
                     &lt;dbl&gt;
1                 0.460141</code></pre>
<p>Any other straight line drawn in the figure would yield a sum of squared residuals greater than 132. This is a mathematically guaranteed fact that you can prove using calculus and linear algebra. That’s why alternative names for the linear regression line are the <em>best-fitting line</em> and the <em>least-squares line</em>. Why do we square the residuals (i.e., the arrow lengths)? So that both positive and negative deviations of the same amount are treated equally.</p>
<div class="learncheck">
<p>
<strong><em>Learning check</em></strong>
</p>
</div>
<p><strong>(LC8.8)</strong> Note in Figure <a href="8-regression.html#fig:three-lines">8.13</a> there are 3 points marked with dots and:</p>
<ul>
<li>The “best” fitting solid regression line in blue</li>
<li>An arbitrarily chosen dotted red line</li>
<li>Another arbitrarily chosen dashed green line</li>
</ul>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:three-lines"></span>
<img src="ModernDive_files/figure-html/three-lines-1.png" alt="Regression line and two others." width="85%" />
<p class="caption">
FIGURE 8.13: Regression line and two others.
</p>
</div>
<p>Compute the sum of squared residuals by hand for each line and show that of these three lines, the regression line in blue has the smallest value.</p>
<div class="learncheck">

</div>
</div>
<div id="underthehood" class="section level3 hasAnchor" number="8.3.3">
<h3><span class="header-section-number">8.3.3</span> <code>get_regression_x()</code> functions<a href="8-regression.html#underthehood" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Recall in this chapter we introduced two functions from the <code>moderndive</code> package:</p>
<ol style="list-style-type: decimal">
<li><code>get_regression_table()</code> that returns a regression table in Subsection <a href="8-regression.html#model1table">8.1.2</a> and</li>
<li><code>get_regression_points()</code> that returns point-by-point information from a regression model in Subsection <a href="8-regression.html#model1points">8.1.3</a>.</li>
</ol>
<p>What is going on behind the scenes with the <code>get_regression_table()</code> and <code>get_regression_points()</code> functions? We mentioned in Subsection <a href="8-regression.html#model1table">8.1.2</a> that these were examples of <em>wrapper functions</em>. Such functions take other pre-existing functions and “wrap” them into single functions that hide the user from their inner workings. This way all the user needs to worry about is what the inputs look like and what the outputs look like. In this subsection, we’ll “get under the hood” of these functions and see how the “engine” of these wrapper functions works.</p>
<p>Recall our two-step process to generate a regression table from Subsection <a href="8-regression.html#model1table">8.1.2</a>:</p>
<div class="sourceCode" id="cb377"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb377-1"><a href="8-regression.html#cb377-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit regression model:</span></span>
<span id="cb377-2"><a href="8-regression.html#cb377-2" aria-hidden="true" tabindex="-1"></a>lion_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> proportion.black <span class="sc">~</span> age, <span class="at">data =</span> LionNoses)</span>
<span id="cb377-3"><a href="8-regression.html#cb377-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Get regression table:</span></span>
<span id="cb377-4"><a href="8-regression.html#cb377-4" aria-hidden="true" tabindex="-1"></a><span class="fu">get_regression_table</span>(lion_model)</span></code></pre></div>
<table class="table" style="font-size: 16px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:recall-table">TABLE 8.10: </span>Regression table
</caption>
<thead>
<tr>
<th style="text-align:left;">
term
</th>
<th style="text-align:right;">
estimate
</th>
<th style="text-align:right;">
std_error
</th>
<th style="text-align:right;">
statistic
</th>
<th style="text-align:right;">
p_value
</th>
<th style="text-align:right;">
lower_ci
</th>
<th style="text-align:right;">
upper_ci
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
intercept
</td>
<td style="text-align:right;">
0.070
</td>
<td style="text-align:right;">
0.042
</td>
<td style="text-align:right;">
1.66
</td>
<td style="text-align:right;">
0.107
</td>
<td style="text-align:right;">
-0.016
</td>
<td style="text-align:right;">
0.155
</td>
</tr>
<tr>
<td style="text-align:left;">
age
</td>
<td style="text-align:right;">
0.059
</td>
<td style="text-align:right;">
0.008
</td>
<td style="text-align:right;">
7.05
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.042
</td>
<td style="text-align:right;">
0.076
</td>
</tr>
</tbody>
</table>
<p>The <code>get_regression_table()</code> wrapper function takes two pre-existing functions in other R packages:</p>
<ul>
<li><code>tidy()</code> from the <a href="https://broom.tidyverse.org/"><code>broom</code> package</a> <span class="citation">(<a href="#ref-R-broom" role="doc-biblioref">Robinson, Hayes, and Couch 2022</a>)</span> and</li>
<li><code>clean_names()</code> from the <a href="https://github.com/sfirke/janitor"><code>janitor</code> package</a> <span class="citation">(<a href="#ref-R-janitor" role="doc-biblioref">Firke 2021</a>)</span></li>
</ul>
<p>and “wraps” them into a single function that takes in a saved <code>lm()</code> linear model, here <code>lion_model</code>, and returns a regression table saved as a “tidy” data frame. Here is how we used the <code>tidy()</code> and <code>clean_names()</code> functions to produce Table <a href="8-regression.html#tab:regtable-broom">8.11</a>:</p>
<div class="sourceCode" id="cb378"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb378-1"><a href="8-regression.html#cb378-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb378-2"><a href="8-regression.html#cb378-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span>
<span id="cb378-3"><a href="8-regression.html#cb378-3" aria-hidden="true" tabindex="-1"></a>lion_model <span class="sc">%&gt;%</span></span>
<span id="cb378-4"><a href="8-regression.html#cb378-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>(<span class="at">conf.int =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb378-5"><a href="8-regression.html#cb378-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric, round, <span class="at">digits =</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb378-6"><a href="8-regression.html#cb378-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">%&gt;%</span></span>
<span id="cb378-7"><a href="8-regression.html#cb378-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">lower_ci =</span> conf_low, <span class="at">upper_ci =</span> conf_high)</span></code></pre></div>
<table class="table" style="font-size: 16px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:regtable-broom">TABLE 8.11: </span>Regression table using tidy() from broom package
</caption>
<thead>
<tr>
<th style="text-align:left;">
term
</th>
<th style="text-align:right;">
estimate
</th>
<th style="text-align:right;">
std_error
</th>
<th style="text-align:right;">
statistic
</th>
<th style="text-align:right;">
p_value
</th>
<th style="text-align:right;">
lower_ci
</th>
<th style="text-align:right;">
upper_ci
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:right;">
0.070
</td>
<td style="text-align:right;">
0.042
</td>
<td style="text-align:right;">
1.66
</td>
<td style="text-align:right;">
0.107
</td>
<td style="text-align:right;">
-0.016
</td>
<td style="text-align:right;">
0.155
</td>
</tr>
<tr>
<td style="text-align:left;">
age
</td>
<td style="text-align:right;">
0.059
</td>
<td style="text-align:right;">
0.008
</td>
<td style="text-align:right;">
7.05
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.042
</td>
<td style="text-align:right;">
0.076
</td>
</tr>
</tbody>
</table>
<p>Yikes! That’s a lot of code! So, in order to simplify your lives, we made the editorial decision to “wrap” all the code into <code>get_regression_table()</code>, freeing you from the need to understand the inner workings of the function. Note that the <code>mutate_if()</code> function is from the <code>dplyr</code> package and applies the <code>round()</code> function to three significant digits precision only to those variables that are numerical.</p>
<p>Similarly, the <code>get_regression_points()</code> function is another wrapper function, but this time returning information about the individual points involved in a regression model like the fitted values, observed values, and the residuals. <code>get_regression_points()</code> uses the <code>augment()</code> function in the <a href="https://broom.tidyverse.org/"><code>broom</code> package</a> instead of the <code>tidy()</code> function as with <code>get_regression_table()</code> to produce the data shown in Table <a href="8-regression.html#tab:regpoints-augment">8.12</a>:</p>
<div class="sourceCode" id="cb379"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb379-1"><a href="8-regression.html#cb379-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb379-2"><a href="8-regression.html#cb379-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span>
<span id="cb379-3"><a href="8-regression.html#cb379-3" aria-hidden="true" tabindex="-1"></a>lion_model <span class="sc">%&gt;%</span></span>
<span id="cb379-4"><a href="8-regression.html#cb379-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">augment</span>() <span class="sc">%&gt;%</span></span>
<span id="cb379-5"><a href="8-regression.html#cb379-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric, round, <span class="at">digits =</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb379-6"><a href="8-regression.html#cb379-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">%&gt;%</span></span>
<span id="cb379-7"><a href="8-regression.html#cb379-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(<span class="st">&quot;std_resid&quot;</span>, <span class="st">&quot;hat&quot;</span>, <span class="st">&quot;sigma&quot;</span>, <span class="st">&quot;cooksd&quot;</span>, <span class="st">&quot;std_resid&quot;</span>))</span></code></pre></div>
<table class="table" style="font-size: 16px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:regpoints-augment">TABLE 8.12: </span>Regression points using augment() from broom package
</caption>
<thead>
<tr>
<th style="text-align:right;">
proportion_black
</th>
<th style="text-align:right;">
age
</th>
<th style="text-align:right;">
fitted
</th>
<th style="text-align:right;">
resid
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.21
</td>
<td style="text-align:right;">
1.1
</td>
<td style="text-align:right;">
0.134
</td>
<td style="text-align:right;">
0.076
</td>
</tr>
<tr>
<td style="text-align:right;">
0.14
</td>
<td style="text-align:right;">
1.5
</td>
<td style="text-align:right;">
0.158
</td>
<td style="text-align:right;">
-0.018
</td>
</tr>
<tr>
<td style="text-align:right;">
0.11
</td>
<td style="text-align:right;">
1.9
</td>
<td style="text-align:right;">
0.181
</td>
<td style="text-align:right;">
-0.071
</td>
</tr>
<tr>
<td style="text-align:right;">
0.13
</td>
<td style="text-align:right;">
2.2
</td>
<td style="text-align:right;">
0.199
</td>
<td style="text-align:right;">
-0.069
</td>
</tr>
<tr>
<td style="text-align:right;">
0.12
</td>
<td style="text-align:right;">
2.6
</td>
<td style="text-align:right;">
0.222
</td>
<td style="text-align:right;">
-0.102
</td>
</tr>
<tr>
<td style="text-align:right;">
0.13
</td>
<td style="text-align:right;">
3.2
</td>
<td style="text-align:right;">
0.257
</td>
<td style="text-align:right;">
-0.127
</td>
</tr>
<tr>
<td style="text-align:right;">
0.12
</td>
<td style="text-align:right;">
3.2
</td>
<td style="text-align:right;">
0.257
</td>
<td style="text-align:right;">
-0.137
</td>
</tr>
<tr>
<td style="text-align:right;">
0.18
</td>
<td style="text-align:right;">
2.9
</td>
<td style="text-align:right;">
0.240
</td>
<td style="text-align:right;">
-0.060
</td>
</tr>
<tr>
<td style="text-align:right;">
0.23
</td>
<td style="text-align:right;">
2.4
</td>
<td style="text-align:right;">
0.210
</td>
<td style="text-align:right;">
0.020
</td>
</tr>
<tr>
<td style="text-align:right;">
0.22
</td>
<td style="text-align:right;">
2.1
</td>
<td style="text-align:right;">
0.193
</td>
<td style="text-align:right;">
0.027
</td>
</tr>
</tbody>
</table>
<p>In this case, it outputs only the variables of interest to students learning regression: the outcome variable <span class="math inline">\(y\)</span> (<code>proportion.black</code>), all explanatory/predictor variables (<code>age</code>), all resulting <code>fitted</code> values <span class="math inline">\(\hat{y}\)</span> used by applying the equation of the regression line to <code>age</code>, and the <code>resid</code>ual <span class="math inline">\(y - \hat{y}\)</span>.</p>
<p>If you’re even more curious about how these and other wrapper functions work, take a look at the source code for these functions on <a href="https://github.com/moderndive/moderndive/blob/master/R/regression_functions.R">GitHub</a>.</p>
</div>
</div>
<div id="reg-conclusion" class="section level2 hasAnchor" number="8.4">
<h2><span class="header-section-number">8.4</span> Conclusion<a href="8-regression.html#reg-conclusion" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="review">
<p>
<strong><em>Chapter Learning Summary</em></strong>
</p>
<ul>
<li>
Data modeling examines the relationship between an outcome/response
variable and one or more explanatory/predictor variables.<br />
</li>
<li>
Linear regression assumes a linear relationship between a numerical
outcome variable and explanatory variables.<br />
</li>
<li>
Simple linear regression assumes a linear relationship between a
numerical outcome variable and a single <em>numerical</em> explanatory
variable.<br />
</li>
<li>
The correlation coefficient quantifies the strength of the linear
relationship between two numerical variables.<br />
</li>
<li>
The regression, or best-fitting, line minimizes the distance between
the line and the observed values and can be modeled with the
mathematical equation <span class="math inline"><span class="math inline">\(\hat{y} = b_0 + b_1 \cdot x\)</span></span>.<br />
</li>
<li>
The fitted value, <span class="math inline"><span class="math inline">\(\hat{y}\)</span></span>, is
the value of <span class="math inline"><span class="math inline">\(y\)</span></span> on the regression
line for a given value of <span class="math inline"><span class="math inline">\(x\)</span></span>.<br />
</li>
<li>
The residual is the difference between the fitted value <span class="math inline"><span class="math inline">\(\hat{y}\)</span></span> and the observed value <span class="math inline"><span class="math inline">\(y\)</span></span>.<br />
</li>
<li>
Basic linear regression can be extended to model the relationship
between a numerical outcome variable and a <em>categorical</em>
explanatory variable.<br />
</li>
<li>
Linear regression with a categorical explanatory variable uses
indicator functions (or dummy variables) that return a value of 1, if
the explanatory variable is true, or 0, if not.<br />
</li>
<li>
With a categorical explanatory variable, the intercept is the fitted
value of the baseline comparison group and the slope is the offset of
another group from the intercept.<br />
</li>
<li>
When two variables are correlated, it doesn’t necessarily mean that
one causes the other.<br />
</li>
<li>
The regression, or best-fitting, line is the line that minimizes the
sum of squared residuals.<br />
</li>
<li>
A wrapper function chains together other functions to seamlessly
perform a desired function.<br />
</li>
</ul>
</div>
<!--
### Additional resources {#additional-resources-basic-regression}



An R script file of all R code used in this chapter is available [here](scripts/05-regression.R).
-->
<div id="whats-to-come-7" class="section level3 hasAnchor" number="8.4.1">
<h3><span class="header-section-number">8.4.1</span> What’s to come?<a href="8-regression.html#whats-to-come-7" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In this chapter, you’ve studied the term <em>basic regression</em>, where you fit models that only have one explanatory variable. So far, we’ve only studied the <code>estimate</code> column of all our regression tables. Chapter <a href="9-inference-for-regression.html#inference-for-regression">9</a> focuses on the remaining columns: the standard error (<code>std_error</code>), the test <code>statistic</code>, the <code>p_value</code>, and the lower and upper bounds of confidence intervals (<code>lower_ci</code> and <code>upper_ci</code>). Furthermore, we’ll revisit the concept of residuals <span class="math inline">\(y - \widehat{y}\)</span> and discuss their importance when interpreting the results of a regression model. We’ll perform what is known as a <em>residual analysis</em> of the <code>residual</code> variable of all <code>get_regression_points()</code> outputs. Residual analyses allow you to verify what are known as the <em>conditions for inference for regression</em>.</p>

</div>
</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-R-janitor" class="csl-entry">
Firke, Sam. 2021. <em>Janitor: Simple Tools for Examining and Cleaning Dirty Data</em>. <a href="https://github.com/sfirke/janitor">https://github.com/sfirke/janitor</a>.
</div>
<div id="ref-rds2016" class="csl-entry">
Grolemund, Garrett, and Hadley Wickham. 2017. <em>R for Data Science</em>. First. Sebastopol, CA: O’Reilly Media. <a href="https://r4ds.had.co.nz/">https://r4ds.had.co.nz/</a>.
</div>
<div id="ref-islr2017" class="csl-entry">
James, Gareth, Daniela Witten, Trevor Hastie, and Robert Tibshirani. 2017. <em>An Introduction to Statistical Learning: With Applications in r</em>. First. New York, NY: Springer.
</div>
<div id="ref-R-broom" class="csl-entry">
Robinson, David, Alex Hayes, and Simon Couch. 2022. <em>Broom: Convert Statistical Objects into Tidy Tibbles</em>. <a href="https://CRAN.R-project.org/package=broom">https://CRAN.R-project.org/package=broom</a>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="7-hypothesis-testing.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="9-inference-for-regression.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/moderndive/moderndive_book/edit/master/08-regression.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
