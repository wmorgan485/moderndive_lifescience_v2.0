<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 10 Multiple Regression | Modern Biological Data Analysis</title>
  <meta name="description" content="An open-source and fully-reproducible electronic textbook for teaching statistical inference using tidyverse data science tools." />
  <meta name="generator" content="bookdown 0.36 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 10 Multiple Regression | Modern Biological Data Analysis" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://moderndive.com//images/logos/book_cover.png" />
  <meta property="og:description" content="An open-source and fully-reproducible electronic textbook for teaching statistical inference using tidyverse data science tools." />
  <meta name="github-repo" content="moderndive/ModernDive_book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 10 Multiple Regression | Modern Biological Data Analysis" />
  <meta name="twitter:site" content="@ModernDive" />
  <meta name="twitter:description" content="An open-source and fully-reproducible electronic textbook for teaching statistical inference using tidyverse data science tools." />
  <meta name="twitter:image" content="https://moderndive.com//images/logos/book_cover.png" />

<meta name="author" content="Chester Ismay and Albert Y. Kim   Foreword by Kelly S. McConville   Adapted by William R. Morgan" />


<meta name="date" content="2023-10-31" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  <link rel="apple-touch-icon-precomposed" sizes="152x152" href="images/logos/favicons/apple-touch-icon.png" />
  <link rel="shortcut icon" href="images/logos/favicons/favicon.ico" type="image/x-icon" />
<link rel="prev" href="9-inference-for-regression.html"/>
<link rel="next" href="11-thinking-with-data.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<link href="libs/dygraphs-1.1.1/dygraph.css" rel="stylesheet" />
<script src="libs/dygraphs-1.1.1/dygraph-combined.js"></script>
<script src="libs/dygraphs-1.1.1/shapes.js"></script>
<script src="libs/moment-2.8.4/moment.js"></script>
<script src="libs/moment-timezone-0.2.5/moment-timezone-with-data.js"></script>
<script src="libs/moment-fquarter-1.0.0/moment-fquarter.min.js"></script>
<script src="libs/dygraphs-binding-1.1.1.6/dygraphs.js"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-89938436-1', 'auto');
  ga('send', 'pageview');

</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>ModernDive for Life Scientists</a></li>
<li class="chapter" data-level="" data-path="foreword.html"><a href="foreword.html"><i class="fa fa-check"></i>Foreword</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#introduction-for-students"><i class="fa fa-check"></i>Introduction for students</a>
<ul>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#what-we-hope-you-will-learn-from-this-book"><i class="fa fa-check"></i>What we hope you will learn from this book</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#datascience-pipeline"><i class="fa fa-check"></i>Data/science pipeline</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#reproducible-research"><i class="fa fa-check"></i>Reproducible research</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#final-note-for-students"><i class="fa fa-check"></i>Final note for students</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#introduction-for-instructors"><i class="fa fa-check"></i>Introduction for instructors</a>
<ul>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#resources"><i class="fa fa-check"></i>Resources</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#why-did-we-write-this-book"><i class="fa fa-check"></i>Why did we write this book?</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#who-is-this-book-for"><i class="fa fa-check"></i>Who is this book for?</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#connect-and-contribute"><i class="fa fa-check"></i>Connect and contribute</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#acknowledgements"><i class="fa fa-check"></i>Acknowledgements</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#about-this-book"><i class="fa fa-check"></i>About this book</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="about-the-authors.html"><a href="about-the-authors.html"><i class="fa fa-check"></i>About the authors</a></li>
<li class="chapter" data-level="" data-path="about-the-adapting-author.html"><a href="about-the-adapting-author.html"><i class="fa fa-check"></i>About the adapting author</a></li>
<li class="chapter" data-level="1" data-path="1-getting-started.html"><a href="1-getting-started.html"><i class="fa fa-check"></i><b>1</b> Getting Started with Data in R</a>
<ul>
<li class="chapter" data-level="1.1" data-path="1-getting-started.html"><a href="1-getting-started.html#r-rstudio"><i class="fa fa-check"></i><b>1.1</b> What are R and RStudio?</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="1-getting-started.html"><a href="1-getting-started.html#installing"><i class="fa fa-check"></i><b>1.1.1</b> Installing R and RStudio</a></li>
<li class="chapter" data-level="1.1.2" data-path="1-getting-started.html"><a href="1-getting-started.html#using-r-via-rstudio"><i class="fa fa-check"></i><b>1.1.2</b> Using R via RStudio</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="1-getting-started.html"><a href="1-getting-started.html#code"><i class="fa fa-check"></i><b>1.2</b> How do I code in R?</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="1-getting-started.html"><a href="1-getting-started.html#programming-concepts"><i class="fa fa-check"></i><b>1.2.1</b> Basic programming concepts and terminology</a></li>
<li class="chapter" data-level="1.2.2" data-path="1-getting-started.html"><a href="1-getting-started.html#messages"><i class="fa fa-check"></i><b>1.2.2</b> Errors, warnings, and messages</a></li>
<li class="chapter" data-level="1.2.3" data-path="1-getting-started.html"><a href="1-getting-started.html#tips-code"><i class="fa fa-check"></i><b>1.2.3</b> Tips on learning to code</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="1-getting-started.html"><a href="1-getting-started.html#packages"><i class="fa fa-check"></i><b>1.3</b> What are R packages?</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="1-getting-started.html"><a href="1-getting-started.html#package-installation"><i class="fa fa-check"></i><b>1.3.1</b> Package installation</a></li>
<li class="chapter" data-level="1.3.2" data-path="1-getting-started.html"><a href="1-getting-started.html#package-loading"><i class="fa fa-check"></i><b>1.3.2</b> Package loading</a></li>
<li class="chapter" data-level="1.3.3" data-path="1-getting-started.html"><a href="1-getting-started.html#package-use"><i class="fa fa-check"></i><b>1.3.3</b> Package use</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="1-getting-started.html"><a href="1-getting-started.html#mammalsdb"><i class="fa fa-check"></i><b>1.4</b> Explore your first data sets</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="1-getting-started.html"><a href="1-getting-started.html#openintropackage"><i class="fa fa-check"></i><b>1.4.1</b> <code>openintro</code> package</a></li>
<li class="chapter" data-level="1.4.2" data-path="1-getting-started.html"><a href="1-getting-started.html#mammalsdataframe"><i class="fa fa-check"></i><b>1.4.2</b> <code>mammals</code> data frame</a></li>
<li class="chapter" data-level="1.4.3" data-path="1-getting-started.html"><a href="1-getting-started.html#exploredataframes"><i class="fa fa-check"></i><b>1.4.3</b> Exploring data frames</a></li>
<li class="chapter" data-level="1.4.4" data-path="1-getting-started.html"><a href="1-getting-started.html#identification-vs-measurement-variables"><i class="fa fa-check"></i><b>1.4.4</b> Identification and measurement variables</a></li>
<li class="chapter" data-level="1.4.5" data-path="1-getting-started.html"><a href="1-getting-started.html#help-files"><i class="fa fa-check"></i><b>1.4.5</b> Help files</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="1-getting-started.html"><a href="1-getting-started.html#csv"><i class="fa fa-check"></i><b>1.5</b> Importing data</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="1-getting-started.html"><a href="1-getting-started.html#using-the-console"><i class="fa fa-check"></i><b>1.5.1</b> Using the console</a></li>
<li class="chapter" data-level="1.5.2" data-path="1-getting-started.html"><a href="1-getting-started.html#using-rstudios-interface"><i class="fa fa-check"></i><b>1.5.2</b> Using RStudio’s interface</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="1-getting-started.html"><a href="1-getting-started.html#conclusion"><i class="fa fa-check"></i><b>1.6</b> Conclusion</a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="1-getting-started.html"><a href="1-getting-started.html#additional-resources"><i class="fa fa-check"></i><b>1.6.1</b> Additional resources</a></li>
<li class="chapter" data-level="1.6.2" data-path="1-getting-started.html"><a href="1-getting-started.html#whats-to-come"><i class="fa fa-check"></i><b>1.6.2</b> What’s to come?</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>I Data Science with tidyverse</b></span></li>
<li class="chapter" data-level="2" data-path="2-viz.html"><a href="2-viz.html"><i class="fa fa-check"></i><b>2</b> Data Visualization</a>
<ul>
<li class="chapter" data-level="" data-path="2-viz.html"><a href="2-viz.html#needed-packages"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="2.1" data-path="2-viz.html"><a href="2-viz.html#grammarofgraphics"><i class="fa fa-check"></i><b>2.1</b> The grammar of graphics</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="2-viz.html"><a href="2-viz.html#components-of-the-grammar"><i class="fa fa-check"></i><b>2.1.1</b> Components of the grammar</a></li>
<li class="chapter" data-level="2.1.2" data-path="2-viz.html"><a href="2-viz.html#gapminder"><i class="fa fa-check"></i><b>2.1.2</b> Gapminder data</a></li>
<li class="chapter" data-level="2.1.3" data-path="2-viz.html"><a href="2-viz.html#other-components"><i class="fa fa-check"></i><b>2.1.3</b> Other components</a></li>
<li class="chapter" data-level="2.1.4" data-path="2-viz.html"><a href="2-viz.html#ggplot2-package"><i class="fa fa-check"></i><b>2.1.4</b> ggplot2 package</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="2-viz.html"><a href="2-viz.html#FiveNG"><i class="fa fa-check"></i><b>2.2</b> Five named graphs - the 5NG</a></li>
<li class="chapter" data-level="2.3" data-path="2-viz.html"><a href="2-viz.html#scatterplots"><i class="fa fa-check"></i><b>2.3</b> 5NG#1: Scatterplots</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="2-viz.html"><a href="2-viz.html#geompoint"><i class="fa fa-check"></i><b>2.3.1</b> Scatterplots via <code>geom_point</code></a></li>
<li class="chapter" data-level="2.3.2" data-path="2-viz.html"><a href="2-viz.html#overplotting"><i class="fa fa-check"></i><b>2.3.2</b> Overplotting</a></li>
<li class="chapter" data-level="2.3.3" data-path="2-viz.html"><a href="2-viz.html#summary"><i class="fa fa-check"></i><b>2.3.3</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="2-viz.html"><a href="2-viz.html#linegraphs"><i class="fa fa-check"></i><b>2.4</b> 5NG#2: Linegraphs</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="2-viz.html"><a href="2-viz.html#geomline"><i class="fa fa-check"></i><b>2.4.1</b> Linegraphs via <code>geom_line</code></a></li>
<li class="chapter" data-level="2.4.2" data-path="2-viz.html"><a href="2-viz.html#summary-1"><i class="fa fa-check"></i><b>2.4.2</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="2-viz.html"><a href="2-viz.html#histograms"><i class="fa fa-check"></i><b>2.5</b> 5NG#3: Histograms</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="2-viz.html"><a href="2-viz.html#geomhistogram"><i class="fa fa-check"></i><b>2.5.1</b> Histograms via <code>geom_histogram</code></a></li>
<li class="chapter" data-level="2.5.2" data-path="2-viz.html"><a href="2-viz.html#adjustbins"><i class="fa fa-check"></i><b>2.5.2</b> Adjusting the bins</a></li>
<li class="chapter" data-level="2.5.3" data-path="2-viz.html"><a href="2-viz.html#summary-2"><i class="fa fa-check"></i><b>2.5.3</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="2-viz.html"><a href="2-viz.html#facets"><i class="fa fa-check"></i><b>2.6</b> Facets</a></li>
<li class="chapter" data-level="2.7" data-path="2-viz.html"><a href="2-viz.html#boxplots"><i class="fa fa-check"></i><b>2.7</b> 5NG#4: Boxplots</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="2-viz.html"><a href="2-viz.html#geomboxplot"><i class="fa fa-check"></i><b>2.7.1</b> Boxplots via <code>geom_boxplot</code></a></li>
<li class="chapter" data-level="2.7.2" data-path="2-viz.html"><a href="2-viz.html#summary-3"><i class="fa fa-check"></i><b>2.7.2</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="2-viz.html"><a href="2-viz.html#geombar"><i class="fa fa-check"></i><b>2.8</b> 5NG#5: Barplots</a>
<ul>
<li class="chapter" data-level="2.8.1" data-path="2-viz.html"><a href="2-viz.html#barplots-via-geom_bar-or-geom_col"><i class="fa fa-check"></i><b>2.8.1</b> Barplots via <code>geom_bar</code> or <code>geom_col</code></a></li>
<li class="chapter" data-level="2.8.2" data-path="2-viz.html"><a href="2-viz.html#two-categ-barplot"><i class="fa fa-check"></i><b>2.8.2</b> Two categorical variables</a></li>
<li class="chapter" data-level="2.8.3" data-path="2-viz.html"><a href="2-viz.html#summary-4"><i class="fa fa-check"></i><b>2.8.3</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="2-viz.html"><a href="2-viz.html#plots-to-avoid"><i class="fa fa-check"></i><b>2.9</b> Plots to avoid!</a>
<ul>
<li class="chapter" data-level="2.9.1" data-path="2-viz.html"><a href="2-viz.html#barplots-with-a-continuous-variable"><i class="fa fa-check"></i><b>2.9.1</b> Barplots with a continuous variable</a></li>
<li class="chapter" data-level="2.9.2" data-path="2-viz.html"><a href="2-viz.html#pie-charts"><i class="fa fa-check"></i><b>2.9.2</b> Pie charts</a></li>
</ul></li>
<li class="chapter" data-level="2.10" data-path="2-viz.html"><a href="2-viz.html#data-vis-conclusion"><i class="fa fa-check"></i><b>2.10</b> Conclusion</a>
<ul>
<li class="chapter" data-level="2.10.1" data-path="2-viz.html"><a href="2-viz.html#summary-table"><i class="fa fa-check"></i><b>2.10.1</b> Summary table</a></li>
<li class="chapter" data-level="2.10.2" data-path="2-viz.html"><a href="2-viz.html#function-argument-specification"><i class="fa fa-check"></i><b>2.10.2</b> Function argument specification</a></li>
<li class="chapter" data-level="2.10.3" data-path="2-viz.html"><a href="2-viz.html#additional-resources-1"><i class="fa fa-check"></i><b>2.10.3</b> Additional resources</a></li>
<li class="chapter" data-level="2.10.4" data-path="2-viz.html"><a href="2-viz.html#whats-to-come-3"><i class="fa fa-check"></i><b>2.10.4</b> What’s to come</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="3-wrangling.html"><a href="3-wrangling.html"><i class="fa fa-check"></i><b>3</b> Data Wrangling</a>
<ul>
<li class="chapter" data-level="" data-path="3-wrangling.html"><a href="3-wrangling.html#wrangling-packages"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="3.1" data-path="3-wrangling.html"><a href="3-wrangling.html#piping"><i class="fa fa-check"></i><b>3.1</b> The pipe operator: <code>%&gt;%</code></a></li>
<li class="chapter" data-level="3.2" data-path="3-wrangling.html"><a href="3-wrangling.html#filter"><i class="fa fa-check"></i><b>3.2</b> <code>filter</code> rows</a></li>
<li class="chapter" data-level="3.3" data-path="3-wrangling.html"><a href="3-wrangling.html#slice-rows"><i class="fa fa-check"></i><b>3.3</b> <code>slice</code> rows</a></li>
<li class="chapter" data-level="3.4" data-path="3-wrangling.html"><a href="3-wrangling.html#select"><i class="fa fa-check"></i><b>3.4</b> <code>select</code> variables</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="3-wrangling.html"><a href="3-wrangling.html#rename"><i class="fa fa-check"></i><b>3.4.1</b> <code>rename</code> variables</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="3-wrangling.html"><a href="3-wrangling.html#summarize"><i class="fa fa-check"></i><b>3.5</b> <code>summarize</code> variables</a></li>
<li class="chapter" data-level="3.6" data-path="3-wrangling.html"><a href="3-wrangling.html#groupby"><i class="fa fa-check"></i><b>3.6</b> <code>group_by</code> rows</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="3-wrangling.html"><a href="3-wrangling.html#grouping-by-more-than-one-variable"><i class="fa fa-check"></i><b>3.6.1</b> Grouping by more than one variable</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="3-wrangling.html"><a href="3-wrangling.html#mutate"><i class="fa fa-check"></i><b>3.7</b> <code>mutate</code> existing variables</a></li>
<li class="chapter" data-level="3.8" data-path="3-wrangling.html"><a href="3-wrangling.html#arrange"><i class="fa fa-check"></i><b>3.8</b> <code>arrange</code> and sort rows</a></li>
<li class="chapter" data-level="3.9" data-path="3-wrangling.html"><a href="3-wrangling.html#wrangling-conclusion"><i class="fa fa-check"></i><b>3.9</b> Conclusion</a>
<ul>
<li class="chapter" data-level="3.9.1" data-path="3-wrangling.html"><a href="3-wrangling.html#summary-table-1"><i class="fa fa-check"></i><b>3.9.1</b> Summary table</a></li>
<li class="chapter" data-level="3.9.2" data-path="3-wrangling.html"><a href="3-wrangling.html#additional-resources-2"><i class="fa fa-check"></i><b>3.9.2</b> Additional resources</a></li>
<li class="chapter" data-level="3.9.3" data-path="3-wrangling.html"><a href="3-wrangling.html#whats-to-come-1"><i class="fa fa-check"></i><b>3.9.3</b> What’s to come?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="4-tidy.html"><a href="4-tidy.html"><i class="fa fa-check"></i><b>4</b> “Tidy” Data</a>
<ul>
<li class="chapter" data-level="" data-path="4-tidy.html"><a href="4-tidy.html#tidy-packages"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="4.1" data-path="4-tidy.html"><a href="4-tidy.html#tidy-data-ex"><i class="fa fa-check"></i><b>4.1</b> “Tidy” data</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="4-tidy.html"><a href="4-tidy.html#tidy-definition"><i class="fa fa-check"></i><b>4.1.1</b> Definition of “tidy” data</a></li>
<li class="chapter" data-level="4.1.2" data-path="4-tidy.html"><a href="4-tidy.html#converting-to-tidy-data"><i class="fa fa-check"></i><b>4.1.2</b> Converting to “tidy” data</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="4-tidy.html"><a href="4-tidy.html#case-study-tidy"><i class="fa fa-check"></i><b>4.2</b> Case study: Weight loss data</a></li>
<li class="chapter" data-level="4.3" data-path="4-tidy.html"><a href="4-tidy.html#tidyverse-package"><i class="fa fa-check"></i><b>4.3</b> <code>tidyverse</code> package</a></li>
<li class="chapter" data-level="4.4" data-path="4-tidy.html"><a href="4-tidy.html#tidy-data-conclusion"><i class="fa fa-check"></i><b>4.4</b> Conclusion</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="4-tidy.html"><a href="4-tidy.html#additional-resources-3"><i class="fa fa-check"></i><b>4.4.1</b> Additional resources</a></li>
<li class="chapter" data-level="4.4.2" data-path="4-tidy.html"><a href="4-tidy.html#whats-to-come-2"><i class="fa fa-check"></i><b>4.4.2</b> What’s to come?</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Statistical Inference with infer</b></span></li>
<li class="chapter" data-level="5" data-path="5-sampling.html"><a href="5-sampling.html"><i class="fa fa-check"></i><b>5</b> Sampling</a>
<ul>
<li class="chapter" data-level="" data-path="5-sampling.html"><a href="5-sampling.html#sampling-packages"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="5.1" data-path="5-sampling.html"><a href="5-sampling.html#sampling-activity"><i class="fa fa-check"></i><b>5.1</b> Sampling bowl activity</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="5-sampling.html"><a href="5-sampling.html#what-proportion-of-this-bowls-balls-are-red"><i class="fa fa-check"></i><b>5.1.1</b> What proportion of this bowl’s balls are red?</a></li>
<li class="chapter" data-level="5.1.2" data-path="5-sampling.html"><a href="5-sampling.html#using-the-shovel-once"><i class="fa fa-check"></i><b>5.1.2</b> Using the shovel once</a></li>
<li class="chapter" data-level="5.1.3" data-path="5-sampling.html"><a href="5-sampling.html#student-shovels"><i class="fa fa-check"></i><b>5.1.3</b> Using the shovel 33 times</a></li>
<li class="chapter" data-level="5.1.4" data-path="5-sampling.html"><a href="5-sampling.html#sampling-what-did-we-just-do"><i class="fa fa-check"></i><b>5.1.4</b> What did we just do?</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="5-sampling.html"><a href="5-sampling.html#sampling-simulation"><i class="fa fa-check"></i><b>5.2</b> Virtual sampling</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="5-sampling.html"><a href="5-sampling.html#using-the-virtual-shovel-once"><i class="fa fa-check"></i><b>5.2.1</b> Using the virtual shovel once</a></li>
<li class="chapter" data-level="5.2.2" data-path="5-sampling.html"><a href="5-sampling.html#using-the-virtual-shovel-33-times"><i class="fa fa-check"></i><b>5.2.2</b> Using the virtual shovel 33 times</a></li>
<li class="chapter" data-level="5.2.3" data-path="5-sampling.html"><a href="5-sampling.html#shovel-1000-times"><i class="fa fa-check"></i><b>5.2.3</b> Using the virtual shovel 1000 times</a></li>
<li class="chapter" data-level="5.2.4" data-path="5-sampling.html"><a href="5-sampling.html#the-normal-distribution"><i class="fa fa-check"></i><b>5.2.4</b> The Normal Distribution</a></li>
<li class="chapter" data-level="5.2.5" data-path="5-sampling.html"><a href="5-sampling.html#different-shovels"><i class="fa fa-check"></i><b>5.2.5</b> Using different shovels</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="5-sampling.html"><a href="5-sampling.html#sampling-framework"><i class="fa fa-check"></i><b>5.3</b> Sampling framework</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="5-sampling.html"><a href="5-sampling.html#terminology-and-notation"><i class="fa fa-check"></i><b>5.3.1</b> Terminology and notation</a></li>
<li class="chapter" data-level="5.3.2" data-path="5-sampling.html"><a href="5-sampling.html#sampling-definitions"><i class="fa fa-check"></i><b>5.3.2</b> Statistical definitions</a></li>
<li class="chapter" data-level="5.3.3" data-path="5-sampling.html"><a href="5-sampling.html#moral-of-the-story"><i class="fa fa-check"></i><b>5.3.3</b> The moral of the story</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="5-sampling.html"><a href="5-sampling.html#sampling-case-study"><i class="fa fa-check"></i><b>5.4</b> Case study: Genetic crosses</a></li>
<li class="chapter" data-level="5.5" data-path="5-sampling.html"><a href="5-sampling.html#sampling-conclusion-central-limit-theorem"><i class="fa fa-check"></i><b>5.5</b> Central Limit Theorem</a></li>
<li class="chapter" data-level="5.6" data-path="5-sampling.html"><a href="5-sampling.html#sampling-conclusion-table"><i class="fa fa-check"></i><b>5.6</b> Sampling scenarios</a></li>
<li class="chapter" data-level="5.7" data-path="5-sampling.html"><a href="5-sampling.html#sampling-conclusion"><i class="fa fa-check"></i><b>5.7</b> Conclusion</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="5-sampling.html"><a href="5-sampling.html#whats-to-come-4"><i class="fa fa-check"></i><b>5.7.1</b> What’s to come?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html"><i class="fa fa-check"></i><b>6</b> Bootstrapping and Confidence Intervals</a>
<ul>
<li class="chapter" data-level="" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#CI-packages"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="6.1" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#resampling-tactile"><i class="fa fa-check"></i><b>6.1</b> Pennies activity</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#what-is-the-average-year-on-us-pennies-in-2019"><i class="fa fa-check"></i><b>6.1.1</b> What is the average year on US pennies in 2019?</a></li>
<li class="chapter" data-level="6.1.2" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#resampling-once"><i class="fa fa-check"></i><b>6.1.2</b> Resampling once</a></li>
<li class="chapter" data-level="6.1.3" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#student-resamples"><i class="fa fa-check"></i><b>6.1.3</b> Resampling 35 times</a></li>
<li class="chapter" data-level="6.1.4" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#ci-what-did-we-just-do"><i class="fa fa-check"></i><b>6.1.4</b> What did we just do?</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#resampling-simulation"><i class="fa fa-check"></i><b>6.2</b> Computer simulation of resampling</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#virtually-resampling-once"><i class="fa fa-check"></i><b>6.2.1</b> Virtually resampling once</a></li>
<li class="chapter" data-level="6.2.2" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#bootstrap-35-replicates"><i class="fa fa-check"></i><b>6.2.2</b> Virtually resampling 35 times</a></li>
<li class="chapter" data-level="6.2.3" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#bootstrap-1000-replicates"><i class="fa fa-check"></i><b>6.2.3</b> Virtually resampling 1000 times</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#ci-build-up"><i class="fa fa-check"></i><b>6.3</b> Understanding confidence intervals</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#percentile-method"><i class="fa fa-check"></i><b>6.3.1</b> Percentile method</a></li>
<li class="chapter" data-level="6.3.2" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#se-method"><i class="fa fa-check"></i><b>6.3.2</b> Standard error method</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#bootstrap-process"><i class="fa fa-check"></i><b>6.4</b> Constructing confidence intervals</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#original-workflow"><i class="fa fa-check"></i><b>6.4.1</b> Original workflow</a></li>
<li class="chapter" data-level="6.4.2" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#infer-workflow"><i class="fa fa-check"></i><b>6.4.2</b> <code>infer</code> package workflow</a></li>
<li class="chapter" data-level="6.4.3" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#percentile-method-infer"><i class="fa fa-check"></i><b>6.4.3</b> Percentile method with <code>infer</code></a></li>
<li class="chapter" data-level="6.4.4" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#infer-se"><i class="fa fa-check"></i><b>6.4.4</b> Standard error method with <code>infer</code></a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#one-prop-ci"><i class="fa fa-check"></i><b>6.5</b> Interpreting confidence intervals</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#ilyas-yohan"><i class="fa fa-check"></i><b>6.5.1</b> Did the net capture the fish?</a></li>
<li class="chapter" data-level="6.5.2" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#shorthand"><i class="fa fa-check"></i><b>6.5.2</b> Precise and shorthand interpretation</a></li>
<li class="chapter" data-level="6.5.3" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#ci-width"><i class="fa fa-check"></i><b>6.5.3</b> Width of confidence intervals</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#case-study-two-prop-ci"><i class="fa fa-check"></i><b>6.6</b> Case study: Is yawning contagious?</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#mythbusters-study-data"><i class="fa fa-check"></i><b>6.6.1</b> <em>Mythbusters</em> study data</a></li>
<li class="chapter" data-level="6.6.2" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#sampling-scenario"><i class="fa fa-check"></i><b>6.6.2</b> Sampling scenario</a></li>
<li class="chapter" data-level="6.6.3" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#ci-build"><i class="fa fa-check"></i><b>6.6.3</b> Constructing the confidence interval</a></li>
<li class="chapter" data-level="6.6.4" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#interpreting-the-confidence-interval"><i class="fa fa-check"></i><b>6.6.4</b> Interpreting the confidence interval</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#bootstrap-vs-sampling"><i class="fa fa-check"></i><b>6.7</b> Comparing bootstrap and sampling distributions</a>
<ul>
<li class="chapter" data-level="" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#sampling-distribution"><i class="fa fa-check"></i>Sampling distribution</a></li>
<li class="chapter" data-level="" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#bootstrap-distribution"><i class="fa fa-check"></i>Bootstrap distribution</a></li>
<li class="chapter" data-level="" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#comparison"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="6.8" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#theory-ci"><i class="fa fa-check"></i><b>6.8</b> Theory-based confidence intervals</a>
<ul>
<li class="chapter" data-level="" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#theory-based-method-for-computing-standard-errors"><i class="fa fa-check"></i>Theory-based method for computing standard errors</a></li>
<li class="chapter" data-level="" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#theory-based-method-for-constructing-confidence-intervals"><i class="fa fa-check"></i>Theory-based method for constructing confidence intervals</a></li>
<li class="chapter" data-level="" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#confidence-intervals-based-on-33-tactile-samples"><i class="fa fa-check"></i>Confidence intervals based on 33 tactile samples</a></li>
</ul></li>
<li class="chapter" data-level="6.9" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#ci-conclusion"><i class="fa fa-check"></i><b>6.9</b> Conclusion</a>
<ul>
<li class="chapter" data-level="6.9.1" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#additional-resources-4"><i class="fa fa-check"></i><b>6.9.1</b> Additional resources</a></li>
<li class="chapter" data-level="6.9.2" data-path="6-confidence-intervals.html"><a href="6-confidence-intervals.html#whats-to-come-5"><i class="fa fa-check"></i><b>6.9.2</b> What’s to come?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html"><i class="fa fa-check"></i><b>7</b> Hypothesis Testing</a>
<ul>
<li class="chapter" data-level="" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#nhst-packages"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="7.1" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#ht-activity"><i class="fa fa-check"></i><b>7.1</b> Clutch size and malaria resistance</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#is-there-a-tradeoff-between-reproduction-and-immune-defense"><i class="fa fa-check"></i><b>7.1.1</b> Is there a tradeoff between reproduction and immune defense?</a></li>
<li class="chapter" data-level="7.1.2" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#shuffling-once"><i class="fa fa-check"></i><b>7.1.2</b> Shuffling once</a></li>
<li class="chapter" data-level="7.1.3" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#shuffling-99-more-times"><i class="fa fa-check"></i><b>7.1.3</b> Shuffling 99 more times</a></li>
<li class="chapter" data-level="7.1.4" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#ht-what-did-we-just-do"><i class="fa fa-check"></i><b>7.1.4</b> What did we just do?</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#understanding-ht"><i class="fa fa-check"></i><b>7.2</b> Understanding hypothesis tests</a></li>
<li class="chapter" data-level="7.3" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#ht-infer"><i class="fa fa-check"></i><b>7.3</b> Conducting hypothesis tests</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#infer-workflow-ht"><i class="fa fa-check"></i><b>7.3.1</b> <code>infer</code> package workflow</a></li>
<li class="chapter" data-level="7.3.2" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#comparing-infer-workflows"><i class="fa fa-check"></i><b>7.3.2</b> Comparison with confidence intervals</a></li>
<li class="chapter" data-level="7.3.3" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#only-one-test"><i class="fa fa-check"></i><b>7.3.3</b> “There is only one test”</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#ht-interpretation"><i class="fa fa-check"></i><b>7.4</b> Interpreting hypothesis tests</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#trial"><i class="fa fa-check"></i><b>7.4.1</b> Two possible outcomes</a></li>
<li class="chapter" data-level="7.4.2" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#types-of-errors"><i class="fa fa-check"></i><b>7.4.2</b> Types of errors</a></li>
<li class="chapter" data-level="7.4.3" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#choosing-alpha"><i class="fa fa-check"></i><b>7.4.3</b> How do we choose alpha?</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#ht-case-study"><i class="fa fa-check"></i><b>7.5</b> Case study: Do living lizards have longer horns than dead lizards?</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#imdb-data"><i class="fa fa-check"></i><b>7.5.1</b> Horned lizards dataset</a></li>
<li class="chapter" data-level="7.5.2" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#sampling-scenario-1"><i class="fa fa-check"></i><b>7.5.2</b> Sampling scenario</a></li>
<li class="chapter" data-level="7.5.3" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#conducting-the-hypothesis-test"><i class="fa fa-check"></i><b>7.5.3</b> Conducting the hypothesis test</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#theory-hypo"><i class="fa fa-check"></i><b>7.6</b> Theory-based hypothesis tests</a>
<ul>
<li class="chapter" data-level="" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#two-sample-t-statistic"><i class="fa fa-check"></i>Two-sample t-statistic</a></li>
<li class="chapter" data-level="" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#null-distribution"><i class="fa fa-check"></i>Null distribution</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#problems-with-p-values"><i class="fa fa-check"></i><b>7.7</b> Problems with p-values</a></li>
<li class="chapter" data-level="7.8" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#nhst-conclusion"><i class="fa fa-check"></i><b>7.8</b> Conclusion</a>
<ul>
<li class="chapter" data-level="7.8.1" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#additional-resources-5"><i class="fa fa-check"></i><b>7.8.1</b> Additional resources</a></li>
<li class="chapter" data-level="7.8.2" data-path="7-hypothesis-testing.html"><a href="7-hypothesis-testing.html#whats-to-come-6"><i class="fa fa-check"></i><b>7.8.2</b> What’s to come</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Data Modeling with moderndive</b></span></li>
<li class="chapter" data-level="8" data-path="8-regression.html"><a href="8-regression.html"><i class="fa fa-check"></i><b>8</b> Basic Regression</a>
<ul>
<li class="chapter" data-level="" data-path="8-regression.html"><a href="8-regression.html#reg-modeling"><i class="fa fa-check"></i>Modeling for explanation or prediction</a></li>
<li class="chapter" data-level="" data-path="8-regression.html"><a href="8-regression.html#reg-packages"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="8.1" data-path="8-regression.html"><a href="8-regression.html#model1"><i class="fa fa-check"></i><b>8.1</b> One numerical explanatory variable</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="8-regression.html"><a href="8-regression.html#model1EDA"><i class="fa fa-check"></i><b>8.1.1</b> Exploratory data analysis</a></li>
<li class="chapter" data-level="8.1.2" data-path="8-regression.html"><a href="8-regression.html#model1table"><i class="fa fa-check"></i><b>8.1.2</b> Simple linear regression</a></li>
<li class="chapter" data-level="8.1.3" data-path="8-regression.html"><a href="8-regression.html#model1points"><i class="fa fa-check"></i><b>8.1.3</b> Observed/fitted values and residuals</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="8-regression.html"><a href="8-regression.html#model2"><i class="fa fa-check"></i><b>8.2</b> One categorical explanatory variable</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="8-regression.html"><a href="8-regression.html#model2EDA"><i class="fa fa-check"></i><b>8.2.1</b> Exploratory data analysis</a></li>
<li class="chapter" data-level="8.2.2" data-path="8-regression.html"><a href="8-regression.html#model2table"><i class="fa fa-check"></i><b>8.2.2</b> Linear regression</a></li>
<li class="chapter" data-level="8.2.3" data-path="8-regression.html"><a href="8-regression.html#model2points"><i class="fa fa-check"></i><b>8.2.3</b> Observed/fitted values and residuals</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="8-regression.html"><a href="8-regression.html#reg-related-topics"><i class="fa fa-check"></i><b>8.3</b> Related topics</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="8-regression.html"><a href="8-regression.html#correlation-is-not-causation"><i class="fa fa-check"></i><b>8.3.1</b> Correlation is not necessarily causation</a></li>
<li class="chapter" data-level="8.3.2" data-path="8-regression.html"><a href="8-regression.html#leastsquares"><i class="fa fa-check"></i><b>8.3.2</b> Best-fitting line</a></li>
<li class="chapter" data-level="8.3.3" data-path="8-regression.html"><a href="8-regression.html#underthehood"><i class="fa fa-check"></i><b>8.3.3</b> <code>get_regression_x()</code> functions</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="8-regression.html"><a href="8-regression.html#reg-conclusion"><i class="fa fa-check"></i><b>8.4</b> Conclusion</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="8-regression.html"><a href="8-regression.html#whats-to-come-7"><i class="fa fa-check"></i><b>8.4.1</b> What’s to come?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html"><i class="fa fa-check"></i><b>9</b> Inference for Regression</a>
<ul>
<li class="chapter" data-level="" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#inf-packages"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="9.1" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#regression-refresher"><i class="fa fa-check"></i><b>9.1</b> Regression refresher</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#lion-age-and-nose-coloration"><i class="fa fa-check"></i><b>9.1.1</b> Lion age and nose coloration</a></li>
<li class="chapter" data-level="9.1.2" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#sampling-scenario-2"><i class="fa fa-check"></i><b>9.1.2</b> Sampling scenario</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#regression-interp"><i class="fa fa-check"></i><b>9.2</b> Interpreting regression tables</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#regression-se"><i class="fa fa-check"></i><b>9.2.1</b> Standard error</a></li>
<li class="chapter" data-level="9.2.2" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#regression-test-statistic"><i class="fa fa-check"></i><b>9.2.2</b> Test statistic</a></li>
<li class="chapter" data-level="9.2.3" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#p-value"><i class="fa fa-check"></i><b>9.2.3</b> p-value</a></li>
<li class="chapter" data-level="9.2.4" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#confidence-interval"><i class="fa fa-check"></i><b>9.2.4</b> Confidence interval</a></li>
<li class="chapter" data-level="9.2.5" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#regression-table-computation"><i class="fa fa-check"></i><b>9.2.5</b> How does R compute the table?</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#regression-conditions"><i class="fa fa-check"></i><b>9.3</b> Conditions for inference for regression</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#residuals-refresher"><i class="fa fa-check"></i><b>9.3.1</b> Residuals refresher</a></li>
<li class="chapter" data-level="9.3.2" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#linearity-of-relationship"><i class="fa fa-check"></i><b>9.3.2</b> Linearity of relationship</a></li>
<li class="chapter" data-level="9.3.3" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#independence-of-residuals"><i class="fa fa-check"></i><b>9.3.3</b> Independence of residuals</a></li>
<li class="chapter" data-level="9.3.4" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#normality-of-residuals"><i class="fa fa-check"></i><b>9.3.4</b> Normality of residuals</a></li>
<li class="chapter" data-level="9.3.5" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#equality-of-variance"><i class="fa fa-check"></i><b>9.3.5</b> Equality of variance</a></li>
<li class="chapter" data-level="9.3.6" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#what-is-the-conclusion"><i class="fa fa-check"></i><b>9.3.6</b> What’s the conclusion?</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#infer-regression"><i class="fa fa-check"></i><b>9.4</b> Simulation-based inference for regression</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#confidence-interval-for-slope"><i class="fa fa-check"></i><b>9.4.1</b> Confidence interval for slope</a></li>
<li class="chapter" data-level="9.4.2" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#hypothesis-test-for-slope"><i class="fa fa-check"></i><b>9.4.2</b> Hypothesis test for slope</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#theory-regression"><i class="fa fa-check"></i><b>9.5</b> Theory-based inference for regression</a></li>
<li class="chapter" data-level="9.6" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#inference-conclusion"><i class="fa fa-check"></i><b>9.6</b> Conclusion</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#summary-of-statistical-inference"><i class="fa fa-check"></i><b>9.6.1</b> Summary of statistical inference</a></li>
<li class="chapter" data-level="9.6.2" data-path="9-inference-for-regression.html"><a href="9-inference-for-regression.html#whats-to-come-8"><i class="fa fa-check"></i><b>9.6.2</b> What’s to come</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="10-multiple-regression.html"><a href="10-multiple-regression.html"><i class="fa fa-check"></i><b>10</b> Multiple Regression</a>
<ul>
<li class="chapter" data-level="" data-path="10-multiple-regression.html"><a href="10-multiple-regression.html#mult-reg-packages"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="10.1" data-path="10-multiple-regression.html"><a href="10-multiple-regression.html#model4"><i class="fa fa-check"></i><b>10.1</b> One numerical and one categorical explanatory variable</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="10-multiple-regression.html"><a href="10-multiple-regression.html#model4EDA"><i class="fa fa-check"></i><b>10.1.1</b> Exploratory data analysis</a></li>
<li class="chapter" data-level="10.1.2" data-path="10-multiple-regression.html"><a href="10-multiple-regression.html#model4interactiontable"><i class="fa fa-check"></i><b>10.1.2</b> Interaction model</a></li>
<li class="chapter" data-level="10.1.3" data-path="10-multiple-regression.html"><a href="10-multiple-regression.html#model4table"><i class="fa fa-check"></i><b>10.1.3</b> Parallel slopes model</a></li>
<li class="chapter" data-level="10.1.4" data-path="10-multiple-regression.html"><a href="10-multiple-regression.html#model4points"><i class="fa fa-check"></i><b>10.1.4</b> Observed/fitted values and residuals</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="10-multiple-regression.html"><a href="10-multiple-regression.html#model3"><i class="fa fa-check"></i><b>10.2</b> Two categorical explanatory variables</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="10-multiple-regression.html"><a href="10-multiple-regression.html#model3EDA"><i class="fa fa-check"></i><b>10.2.1</b> Exploratory data analysis</a></li>
<li class="chapter" data-level="10.2.2" data-path="10-multiple-regression.html"><a href="10-multiple-regression.html#model3table"><i class="fa fa-check"></i><b>10.2.2</b> Regression lines</a></li>
<li class="chapter" data-level="10.2.3" data-path="10-multiple-regression.html"><a href="10-multiple-regression.html#model3points"><i class="fa fa-check"></i><b>10.2.3</b> Observed/fitted values and residuals</a></li>
<li class="chapter" data-level="10.2.4" data-path="10-multiple-regression.html"><a href="10-multiple-regression.html#which-model-without-or-with-interaction-fits-the-data-better"><i class="fa fa-check"></i><b>10.2.4</b> Which model, without or with interaction, fits the data better?</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="10-multiple-regression.html"><a href="10-multiple-regression.html#mult-reg-related-topics"><i class="fa fa-check"></i><b>10.3</b> Related topics</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="10-multiple-regression.html"><a href="10-multiple-regression.html#model-selection"><i class="fa fa-check"></i><b>10.3.1</b> Model selection using visualizations</a></li>
<li class="chapter" data-level="10.3.2" data-path="10-multiple-regression.html"><a href="10-multiple-regression.html#rsquared"><i class="fa fa-check"></i><b>10.3.2</b> Model selection using R-squared</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="10-multiple-regression.html"><a href="10-multiple-regression.html#mult-reg-conclusion"><i class="fa fa-check"></i><b>10.4</b> Conclusion</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="10-multiple-regression.html"><a href="10-multiple-regression.html#whats-to-come-9"><i class="fa fa-check"></i><b>10.4.1</b> What’s to come?</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>IV Conclusion</b></span></li>
<li class="chapter" data-level="11" data-path="11-thinking-with-data.html"><a href="11-thinking-with-data.html"><i class="fa fa-check"></i><b>11</b> Tell Your Story with Data</a>
<ul>
<li class="chapter" data-level="11.1" data-path="11-thinking-with-data.html"><a href="11-thinking-with-data.html#review"><i class="fa fa-check"></i><b>11.1</b> Review</a></li>
<li class="chapter" data-level="11.2" data-path="11-thinking-with-data.html"><a href="11-thinking-with-data.html#data-journalism"><i class="fa fa-check"></i><b>11.2</b> Case study: Effective data storytelling</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="11-thinking-with-data.html"><a href="11-thinking-with-data.html#us-births-in-1999"><i class="fa fa-check"></i><b>11.2.1</b> US Births in 1999</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="11-thinking-with-data.html"><a href="11-thinking-with-data.html#concluding-remarks"><i class="fa fa-check"></i>Concluding remarks</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="A-appendixA.html"><a href="A-appendixA.html"><i class="fa fa-check"></i><b>A</b> Statistical Background</a>
<ul>
<li class="chapter" data-level="A.1" data-path="A-appendixA.html"><a href="A-appendixA.html#appendix-stat-terms"><i class="fa fa-check"></i><b>A.1</b> Basic statistical terms</a>
<ul>
<li class="chapter" data-level="A.1.1" data-path="A-appendixA.html"><a href="A-appendixA.html#mean"><i class="fa fa-check"></i><b>A.1.1</b> Mean</a></li>
<li class="chapter" data-level="A.1.2" data-path="A-appendixA.html"><a href="A-appendixA.html#median"><i class="fa fa-check"></i><b>A.1.2</b> Median</a></li>
<li class="chapter" data-level="A.1.3" data-path="A-appendixA.html"><a href="A-appendixA.html#appendix-sd-variance"><i class="fa fa-check"></i><b>A.1.3</b> Standard deviation and variance</a></li>
<li class="chapter" data-level="A.1.4" data-path="A-appendixA.html"><a href="A-appendixA.html#five-number-summary"><i class="fa fa-check"></i><b>A.1.4</b> Five-number summary</a></li>
<li class="chapter" data-level="A.1.5" data-path="A-appendixA.html"><a href="A-appendixA.html#distribution"><i class="fa fa-check"></i><b>A.1.5</b> Distribution</a></li>
<li class="chapter" data-level="A.1.6" data-path="A-appendixA.html"><a href="A-appendixA.html#outliers"><i class="fa fa-check"></i><b>A.1.6</b> Outliers</a></li>
</ul></li>
<li class="chapter" data-level="A.2" data-path="A-appendixA.html"><a href="A-appendixA.html#appendix-normal-curve"><i class="fa fa-check"></i><b>A.2</b> Normal distribution</a></li>
<li class="chapter" data-level="A.3" data-path="A-appendixA.html"><a href="A-appendixA.html#appendix-log10-transformations"><i class="fa fa-check"></i><b>A.3</b> log10 transformations</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="B-appendixB.html"><a href="B-appendixB.html"><i class="fa fa-check"></i><b>B</b> Inference Examples</a>
<ul>
<li class="chapter" data-level="" data-path="B-appendixB.html"><a href="B-appendixB.html#needed-packages-1"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="B.1" data-path="B-appendixB.html"><a href="B-appendixB.html#inference-mind-map"><i class="fa fa-check"></i><b>B.1</b> Inference mind map</a></li>
<li class="chapter" data-level="B.2" data-path="B-appendixB.html"><a href="B-appendixB.html#one-mean"><i class="fa fa-check"></i><b>B.2</b> One mean</a>
<ul>
<li class="chapter" data-level="B.2.1" data-path="B-appendixB.html"><a href="B-appendixB.html#problem-statement"><i class="fa fa-check"></i><b>B.2.1</b> Problem statement</a></li>
<li class="chapter" data-level="B.2.2" data-path="B-appendixB.html"><a href="B-appendixB.html#competing-hypotheses"><i class="fa fa-check"></i><b>B.2.2</b> Competing hypotheses</a></li>
<li class="chapter" data-level="B.2.3" data-path="B-appendixB.html"><a href="B-appendixB.html#exploring-the-sample-data"><i class="fa fa-check"></i><b>B.2.3</b> Exploring the sample data</a></li>
<li class="chapter" data-level="B.2.4" data-path="B-appendixB.html"><a href="B-appendixB.html#non-traditional-methods"><i class="fa fa-check"></i><b>B.2.4</b> Non-traditional methods</a></li>
<li class="chapter" data-level="B.2.5" data-path="B-appendixB.html"><a href="B-appendixB.html#traditional-methods"><i class="fa fa-check"></i><b>B.2.5</b> Traditional methods</a></li>
<li class="chapter" data-level="B.2.6" data-path="B-appendixB.html"><a href="B-appendixB.html#comparing-results"><i class="fa fa-check"></i><b>B.2.6</b> Comparing results</a></li>
</ul></li>
<li class="chapter" data-level="B.3" data-path="B-appendixB.html"><a href="B-appendixB.html#one-proportion"><i class="fa fa-check"></i><b>B.3</b> One proportion</a>
<ul>
<li class="chapter" data-level="B.3.1" data-path="B-appendixB.html"><a href="B-appendixB.html#problem-statement-1"><i class="fa fa-check"></i><b>B.3.1</b> Problem statement</a></li>
<li class="chapter" data-level="B.3.2" data-path="B-appendixB.html"><a href="B-appendixB.html#competing-hypotheses-1"><i class="fa fa-check"></i><b>B.3.2</b> Competing hypotheses</a></li>
<li class="chapter" data-level="B.3.3" data-path="B-appendixB.html"><a href="B-appendixB.html#exploring-the-sample-data-1"><i class="fa fa-check"></i><b>B.3.3</b> Exploring the sample data</a></li>
<li class="chapter" data-level="B.3.4" data-path="B-appendixB.html"><a href="B-appendixB.html#non-traditional-methods-1"><i class="fa fa-check"></i><b>B.3.4</b> Non-traditional methods</a></li>
<li class="chapter" data-level="B.3.5" data-path="B-appendixB.html"><a href="B-appendixB.html#traditional-methods-1"><i class="fa fa-check"></i><b>B.3.5</b> Traditional methods</a></li>
<li class="chapter" data-level="B.3.6" data-path="B-appendixB.html"><a href="B-appendixB.html#comparing-results-1"><i class="fa fa-check"></i><b>B.3.6</b> Comparing results</a></li>
</ul></li>
<li class="chapter" data-level="B.4" data-path="B-appendixB.html"><a href="B-appendixB.html#two-proportions"><i class="fa fa-check"></i><b>B.4</b> Two proportions</a>
<ul>
<li class="chapter" data-level="B.4.1" data-path="B-appendixB.html"><a href="B-appendixB.html#problem-statement-2"><i class="fa fa-check"></i><b>B.4.1</b> Problem statement</a></li>
<li class="chapter" data-level="B.4.2" data-path="B-appendixB.html"><a href="B-appendixB.html#competing-hypotheses-2"><i class="fa fa-check"></i><b>B.4.2</b> Competing hypotheses</a></li>
<li class="chapter" data-level="B.4.3" data-path="B-appendixB.html"><a href="B-appendixB.html#exploring-the-sample-data-2"><i class="fa fa-check"></i><b>B.4.3</b> Exploring the sample data</a></li>
<li class="chapter" data-level="B.4.4" data-path="B-appendixB.html"><a href="B-appendixB.html#non-traditional-methods-2"><i class="fa fa-check"></i><b>B.4.4</b> Non-traditional methods</a></li>
<li class="chapter" data-level="B.4.5" data-path="B-appendixB.html"><a href="B-appendixB.html#traditional-methods-2"><i class="fa fa-check"></i><b>B.4.5</b> Traditional methods</a></li>
<li class="chapter" data-level="B.4.6" data-path="B-appendixB.html"><a href="B-appendixB.html#test-statistic-2"><i class="fa fa-check"></i><b>B.4.6</b> Test statistic</a></li>
<li class="chapter" data-level="B.4.7" data-path="B-appendixB.html"><a href="B-appendixB.html#state-conclusion-2"><i class="fa fa-check"></i><b>B.4.7</b> State conclusion</a></li>
<li class="chapter" data-level="B.4.8" data-path="B-appendixB.html"><a href="B-appendixB.html#comparing-results-2"><i class="fa fa-check"></i><b>B.4.8</b> Comparing results</a></li>
</ul></li>
<li class="chapter" data-level="B.5" data-path="B-appendixB.html"><a href="B-appendixB.html#two-means-independent-samples"><i class="fa fa-check"></i><b>B.5</b> Two means (independent samples)</a>
<ul>
<li class="chapter" data-level="B.5.1" data-path="B-appendixB.html"><a href="B-appendixB.html#problem-statement-3"><i class="fa fa-check"></i><b>B.5.1</b> Problem statement</a></li>
<li class="chapter" data-level="B.5.2" data-path="B-appendixB.html"><a href="B-appendixB.html#competing-hypotheses-3"><i class="fa fa-check"></i><b>B.5.2</b> Competing hypotheses</a></li>
<li class="chapter" data-level="B.5.3" data-path="B-appendixB.html"><a href="B-appendixB.html#exploring-the-sample-data-3"><i class="fa fa-check"></i><b>B.5.3</b> Exploring the sample data</a></li>
<li class="chapter" data-level="B.5.4" data-path="B-appendixB.html"><a href="B-appendixB.html#non-traditional-methods-3"><i class="fa fa-check"></i><b>B.5.4</b> Non-traditional methods</a></li>
<li class="chapter" data-level="B.5.5" data-path="B-appendixB.html"><a href="B-appendixB.html#traditional-methods-3"><i class="fa fa-check"></i><b>B.5.5</b> Traditional methods</a></li>
<li class="chapter" data-level="B.5.6" data-path="B-appendixB.html"><a href="B-appendixB.html#test-statistic-3"><i class="fa fa-check"></i><b>B.5.6</b> Test statistic</a></li>
<li class="chapter" data-level="B.5.7" data-path="B-appendixB.html"><a href="B-appendixB.html#compute-p-value-1"><i class="fa fa-check"></i><b>B.5.7</b> Compute <span class="math inline">\(p\)</span>-value</a></li>
<li class="chapter" data-level="B.5.8" data-path="B-appendixB.html"><a href="B-appendixB.html#state-conclusion-3"><i class="fa fa-check"></i><b>B.5.8</b> State conclusion</a></li>
<li class="chapter" data-level="B.5.9" data-path="B-appendixB.html"><a href="B-appendixB.html#comparing-results-3"><i class="fa fa-check"></i><b>B.5.9</b> Comparing results</a></li>
</ul></li>
<li class="chapter" data-level="B.6" data-path="B-appendixB.html"><a href="B-appendixB.html#two-means-paired-samples"><i class="fa fa-check"></i><b>B.6</b> Two means (paired samples)</a>
<ul>
<li class="chapter" data-level="" data-path="B-appendixB.html"><a href="B-appendixB.html#problem-statement-4"><i class="fa fa-check"></i>Problem statement</a></li>
<li class="chapter" data-level="B.6.1" data-path="B-appendixB.html"><a href="B-appendixB.html#competing-hypotheses-4"><i class="fa fa-check"></i><b>B.6.1</b> Competing hypotheses</a></li>
<li class="chapter" data-level="B.6.2" data-path="B-appendixB.html"><a href="B-appendixB.html#exploring-the-sample-data-4"><i class="fa fa-check"></i><b>B.6.2</b> Exploring the sample data</a></li>
<li class="chapter" data-level="B.6.3" data-path="B-appendixB.html"><a href="B-appendixB.html#non-traditional-methods-4"><i class="fa fa-check"></i><b>B.6.3</b> Non-traditional methods</a></li>
<li class="chapter" data-level="B.6.4" data-path="B-appendixB.html"><a href="B-appendixB.html#traditional-methods-4"><i class="fa fa-check"></i><b>B.6.4</b> Traditional methods</a></li>
<li class="chapter" data-level="B.6.5" data-path="B-appendixB.html"><a href="B-appendixB.html#comparing-results-4"><i class="fa fa-check"></i><b>B.6.5</b> Comparing results</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="C" data-path="C-appendixC.html"><a href="C-appendixC.html"><i class="fa fa-check"></i><b>C</b> Tips and Tricks</a>
<ul>
<li class="chapter" data-level="" data-path="C-appendixC.html"><a href="C-appendixC.html#needed-packages-2"><i class="fa fa-check"></i>Needed packages</a></li>
<li class="chapter" data-level="C.1" data-path="C-appendixC.html"><a href="C-appendixC.html#data-wrangling"><i class="fa fa-check"></i><b>C.1</b> Data wrangling</a>
<ul>
<li class="chapter" data-level="C.1.1" data-path="C-appendixC.html"><a href="C-appendixC.html#appendix-missing-values"><i class="fa fa-check"></i><b>C.1.1</b> Dealing with missing values</a></li>
<li class="chapter" data-level="C.1.2" data-path="C-appendixC.html"><a href="C-appendixC.html#appendix-reordering-bars"><i class="fa fa-check"></i><b>C.1.2</b> Reordering bars in a barplot</a></li>
<li class="chapter" data-level="C.1.3" data-path="C-appendixC.html"><a href="C-appendixC.html#appendix-money-on-axis"><i class="fa fa-check"></i><b>C.1.3</b> Showing money on an axis</a></li>
<li class="chapter" data-level="C.1.4" data-path="C-appendixC.html"><a href="C-appendixC.html#appendix-changing-values"><i class="fa fa-check"></i><b>C.1.4</b> Changing values inside cells</a></li>
<li class="chapter" data-level="C.1.5" data-path="C-appendixC.html"><a href="C-appendixC.html#appendix-convert-numerical-categorical"><i class="fa fa-check"></i><b>C.1.5</b> Converting a numerical variable to a categorical one</a></li>
<li class="chapter" data-level="C.1.6" data-path="C-appendixC.html"><a href="C-appendixC.html#appendix-prop"><i class="fa fa-check"></i><b>C.1.6</b> Computing proportions</a></li>
<li class="chapter" data-level="C.1.7" data-path="C-appendixC.html"><a href="C-appendixC.html#appendix-commas"><i class="fa fa-check"></i><b>C.1.7</b> Dealing with %, commas, and $</a></li>
</ul></li>
<li class="chapter" data-level="C.2" data-path="C-appendixC.html"><a href="C-appendixC.html#interactive-graphics"><i class="fa fa-check"></i><b>C.2</b> Interactive graphics</a>
<ul>
<li class="chapter" data-level="C.2.1" data-path="C-appendixC.html"><a href="C-appendixC.html#interactive-linegraphs"><i class="fa fa-check"></i><b>C.2.1</b> Interactive linegraphs</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Modern Biological Data Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<html>
<img src='https://moderndive.com/wide_format.png' alt="ModernDive">
</html>
<div id="multiple-regression" class="section level1 hasAnchor" number="10">
<h1><span class="header-section-number">Chapter 10</span> Multiple Regression<a href="10-multiple-regression.html#multiple-regression" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In Chapter <a href="8-regression.html#regression">8</a> we introduced ideas related to modeling for explanation, in particular that the goal of modeling is to make explicit the relationship between some outcome variable <span class="math inline">\(y\)</span> and some explanatory variable <span class="math inline">\(x\)</span>. While there are many approaches to modeling, we focused on one particular technique: <em>linear regression</em>, one of the most commonly used and easy-to-understand approaches to modeling. Furthermore to keep things simple, we only considered models with one explanatory <span class="math inline">\(x\)</span> variable that was either numerical in Section <a href="8-regression.html#model1">8.1</a> or categorical in Section <a href="8-regression.html#model2">8.2</a>.</p>
<p>In this chapter on multiple regression, we’ll start considering models that include more than one explanatory variable <span class="math inline">\(x\)</span>. You can imagine when trying to model a particular outcome variable, like proportion of the lion nose that is black as in Section <a href="8-regression.html#model1">8.1</a> or life expectancy as in Section <a href="8-regression.html#model2">8.2</a>, that it would be useful to include more than just one explanatory variable’s worth of information.</p>
<p>Since our regression models will now consider more than one explanatory variable, the interpretation of the associated effect of any one explanatory variable must be made in conjunction with the other explanatory variables included in your model. Let’s begin!</p>
<div class="review">
<p>
<strong><em>Chapter Learning Objectives</em></strong>
</p>
<p>
<em>At the end of this chapter, you should be able to…</em><br />
* Fully interpret a multiple linear regression table for multiple
regression.<br />
* Use available evidence to determine if an interaction or parallel
slopes model is more appropriate.<br />
* Use a mathematical formula for multiple linear regression to compute
the fitted value for given explanatory values.<br />
</p>
</div>
<div id="mult-reg-packages" class="section level3 unnumbered hasAnchor">
<h3>Needed packages<a href="10-multiple-regression.html#mult-reg-packages" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s load all the packages needed for this chapter (this assumes you’ve already installed them). Recall from our discussion in Section <a href="4-tidy.html#tidyverse-package">4.3</a> that loading the <code>tidyverse</code> package by running <code>library(tidyverse)</code> loads the following commonly used data science packages all at once:</p>
<ul>
<li><code>ggplot2</code> for data visualization</li>
<li><code>dplyr</code> for data wrangling</li>
<li><code>tidyr</code> for converting data to “tidy” format</li>
<li><code>readr</code> for importing spreadsheet data into R</li>
<li>As well as the more advanced <code>purrr</code>, <code>tibble</code>, <code>stringr</code>, and <code>forcats</code> packages</li>
</ul>
<p>If needed, read Section <a href="1-getting-started.html#packages">1.3</a> for information on how to install and load R packages.</p>
<div class="sourceCode" id="cb400"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb400-1"><a href="10-multiple-regression.html#cb400-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb400-2"><a href="10-multiple-regression.html#cb400-2" tabindex="-1"></a><span class="fu">library</span>(moderndive)</span>
<span id="cb400-3"><a href="10-multiple-regression.html#cb400-3" tabindex="-1"></a><span class="fu">library</span>(skimr)</span>
<span id="cb400-4"><a href="10-multiple-regression.html#cb400-4" tabindex="-1"></a><span class="fu">library</span>(abd)</span></code></pre></div>
</div>
<div id="model4" class="section level2 hasAnchor" number="10.1">
<h2><span class="header-section-number">10.1</span> One numerical and one categorical explanatory variable<a href="10-multiple-regression.html#model4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Previously we looked at the relationship between age and nose coloration (proportion black) of male lions in Section <a href="8-regression.html#model1">8.1</a>. The variable <code>proportion.black</code> was the numerical outcome variable <span class="math inline">\(y\)</span>, and the variable <code>age</code> was the numerical explanatory <span class="math inline">\(x\)</span> variable.</p>
<p>In this section, we are going to consider a different model. Rather than a single explanatory variable, we’ll now include two different explanatory variables. In this example, we’ll look at the relationship between tooth growth and vitamin C intake in guinea pigs. Could it be that increasing levels of vitamin C stimulate tooth growth? Or could it instead be that increasing levels reduce tooth growth? Are there differences in tooth growth depending on the method used to deliver vitamin C?</p>
<p>We’ll answer these questions by modeling the relationship between these variables using <em>multiple regression</em>, where we have:</p>
<ol style="list-style-type: decimal">
<li>A numerical outcome variable <span class="math inline">\(y\)</span>, <code>len</code>, the length of odontoblasts, the cells responsible for tooth growth, and</li>
<li>Two explanatory variables:
<ol style="list-style-type: decimal">
<li>A numerical explanatory variable <span class="math inline">\(x_1\)</span>, <code>dose</code>, the dose of vitamin C, in milligrams/day.</li>
<li>A categorical explanatory variable <span class="math inline">\(x_2\)</span>, <code>supp</code>, the delivery method, either as orange juice (<code>OJ</code>) or ascorbic acid (<code>VC</code>).</li>
</ol></li>
</ol>
<div id="model4EDA" class="section level3 hasAnchor" number="10.1.1">
<h3><span class="header-section-number">10.1.1</span> Exploratory data analysis<a href="10-multiple-regression.html#model4EDA" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Our dataset is called <code>ToothGrowth</code> and included in R’s <strong>datasets</strong> package. Recall the three common steps in an exploratory data analysis we saw in Subsection <a href="8-regression.html#model1EDA">8.1.1</a>:</p>
<ol style="list-style-type: decimal">
<li>Looking at the raw data values.</li>
<li>Computing summary statistics.</li>
<li>Creating data visualizations.</li>
</ol>
<p>Let’s first look at the raw data values by either looking at <code>ToothGrowth</code> using RStudio’s spreadsheet viewer or by using the <code>glimpse()</code> function from the <code>dplyr</code> package:</p>
<div class="sourceCode" id="cb401"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb401-1"><a href="10-multiple-regression.html#cb401-1" tabindex="-1"></a><span class="fu">glimpse</span>(ToothGrowth)</span></code></pre></div>
<pre><code>Rows: 60
Columns: 3
$ len  &lt;dbl&gt; 4.2, 11.5, 7.3, 5.8, 6.4, 10.0, 11.2, 11.2, 5.2, 7.0, 16.5, 16.5,…
$ supp &lt;fct&gt; VC, VC, VC, VC, VC, VC, VC, VC, VC, VC, VC, VC, VC, VC, VC, VC, V…
$ dose &lt;dbl&gt; 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 1.0, 1.0, 1.0, …</code></pre>
<p>Let’s also display a random sample of 5 rows of the 60 rows corresponding to different courses in Table <a href="10-multiple-regression.html#tab:model4-data-preview">10.1</a>. Remember due to the random nature of the sampling, you will likely end up with a different subset of 5 rows.</p>
<div class="sourceCode" id="cb403"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb403-1"><a href="10-multiple-regression.html#cb403-1" tabindex="-1"></a>ToothGrowth <span class="sc">%&gt;%</span> <span class="fu">sample_n</span>(<span class="at">size =</span> <span class="dv">5</span>)</span></code></pre></div>
<table class="table" style="font-size: 16px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:model4-data-preview">TABLE 10.1: </span>A random sample of 5 of the 60 data rows
</caption>
<thead>
<tr>
<th style="text-align:right;">
len
</th>
<th style="text-align:left;">
supp
</th>
<th style="text-align:right;">
dose
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
8.2
</td>
<td style="text-align:left;">
OJ
</td>
<td style="text-align:right;">
0.5
</td>
</tr>
<tr>
<td style="text-align:right;">
4.2
</td>
<td style="text-align:left;">
VC
</td>
<td style="text-align:right;">
0.5
</td>
</tr>
<tr>
<td style="text-align:right;">
20.0
</td>
<td style="text-align:left;">
OJ
</td>
<td style="text-align:right;">
1.0
</td>
</tr>
<tr>
<td style="text-align:right;">
21.5
</td>
<td style="text-align:left;">
VC
</td>
<td style="text-align:right;">
2.0
</td>
</tr>
<tr>
<td style="text-align:right;">
27.3
</td>
<td style="text-align:left;">
OJ
</td>
<td style="text-align:right;">
1.0
</td>
</tr>
</tbody>
</table>
<p>Now that we’ve looked at the raw values in our <code>ToothGrowth</code> data frame and got a sense of the data, let’s compute summary statistics. As we did in our exploratory data analyses in Sections <a href="8-regression.html#model1EDA">8.1.1</a> and <a href="8-regression.html#model2EDA">8.2.1</a>, let’s use the <code>skim()</code> function from the <code>skimr</code> package:</p>
<div class="sourceCode" id="cb404"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb404-1"><a href="10-multiple-regression.html#cb404-1" tabindex="-1"></a>ToothGrowth <span class="sc">%&gt;%</span> <span class="fu">skim</span>()</span></code></pre></div>
<table style="width: auto;" class="table table-condensed">
<caption>
<span id="tab:unnamed-chunk-434">TABLE 10.2: </span>Data summary
</caption>
<tbody>
<tr>
<td style="text-align:left;">
Name
</td>
<td style="text-align:left;">
Piped data
</td>
</tr>
<tr>
<td style="text-align:left;">
Number of rows
</td>
<td style="text-align:left;">
60
</td>
</tr>
<tr>
<td style="text-align:left;">
Number of columns
</td>
<td style="text-align:left;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
_______________________
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Column type frequency:
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
factor
</td>
<td style="text-align:left;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:left;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
________________________
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Group variables
</td>
<td style="text-align:left;">
None
</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: factor</strong></p>
<table>
<thead>
<tr>
<th style="text-align:left;">
skim_variable
</th>
<th style="text-align:right;">
n_missing
</th>
<th style="text-align:right;">
complete_rate
</th>
<th style="text-align:left;">
ordered
</th>
<th style="text-align:right;">
n_unique
</th>
<th style="text-align:left;">
top_counts
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
supp
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
OJ: 30, VC: 30
</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table>
<thead>
<tr>
<th style="text-align:left;">
skim_variable
</th>
<th style="text-align:right;">
n_missing
</th>
<th style="text-align:right;">
complete_rate
</th>
<th style="text-align:right;">
mean
</th>
<th style="text-align:right;">
sd
</th>
<th style="text-align:right;">
p0
</th>
<th style="text-align:right;">
p25
</th>
<th style="text-align:right;">
p50
</th>
<th style="text-align:right;">
p75
</th>
<th style="text-align:right;">
p100
</th>
<th style="text-align:left;">
hist
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
len
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
18.81
</td>
<td style="text-align:right;">
7.65
</td>
<td style="text-align:right;">
4.2
</td>
<td style="text-align:right;">
13.1
</td>
<td style="text-align:right;">
19.2
</td>
<td style="text-align:right;">
25.3
</td>
<td style="text-align:right;">
33.9
</td>
<td style="text-align:left;">
▅▃▅▇▂
</td>
</tr>
<tr>
<td style="text-align:left;">
dose
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.17
</td>
<td style="text-align:right;">
0.63
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:right;">
2.0
</td>
<td style="text-align:right;">
2.0
</td>
<td style="text-align:left;">
▇▇▁▁▇
</td>
</tr>
</tbody>
</table>
<p>Observe that we have no missing data, that there are 30 guinea pigs given orange juice and 30 guinea pigs given ascorbic acid, and that the average vitamin C dose is 1.17.</p>
<p>Furthermore, let’s compute the correlation coefficient between our two numerical variables: <code>len</code> and <code>dose</code>. Recall from Subsection <a href="8-regression.html#model1EDA">8.1.1</a> that correlation coefficients only exist between numerical variables. We observe that they are “clearly positively” correlated.</p>
<div class="sourceCode" id="cb405"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb405-1"><a href="10-multiple-regression.html#cb405-1" tabindex="-1"></a>ToothGrowth <span class="sc">%&gt;%</span> </span>
<span id="cb405-2"><a href="10-multiple-regression.html#cb405-2" tabindex="-1"></a>  <span class="fu">get_correlation</span>(<span class="at">formula =</span> len <span class="sc">~</span> dose)</span></code></pre></div>
<pre><code>    cor
1 0.803</code></pre>
<p>Let’s now perform the last of the three common steps in an exploratory data analysis: creating data visualizations. Given that the outcome variable <code>len</code> and explanatory variable <code>dose</code> are both numerical, we’ll use a scatterplot to display their relationship. How can we incorporate the categorical variable <code>supp</code>, however? By <code>mapping</code> the variable <code>supp</code> to the <code>color</code> aesthetic, thereby creating a <em>colored</em> scatterplot. The following code is similar to the code that created the scatterplot of proportion black nose over lion age in Figure <a href="8-regression.html#fig:numxplot1">8.3</a>, but with <code>color = supp</code> added to the <code>aes()</code>thetic mapping.</p>
<div class="sourceCode" id="cb407"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb407-1"><a href="10-multiple-regression.html#cb407-1" tabindex="-1"></a><span class="fu">ggplot</span>(ToothGrowth, <span class="fu">aes</span>(<span class="at">x =</span> dose, <span class="at">y =</span> len, <span class="at">color =</span> supp)) <span class="sc">+</span></span>
<span id="cb407-2"><a href="10-multiple-regression.html#cb407-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb407-3"><a href="10-multiple-regression.html#cb407-3" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Dose&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Tooth length&quot;</span>, <span class="at">color =</span> <span class="st">&quot;Supplement&quot;</span>) <span class="sc">+</span></span>
<span id="cb407-4"><a href="10-multiple-regression.html#cb407-4" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:numxcatxplot1"></span>
<img src="ModernDive_files/figure-html/numxcatxplot1-1.png" alt="Colored scatterplot of relationship of tooth length and dose." width="\textwidth" />
<p class="caption">
FIGURE 10.1: Colored scatterplot of relationship of tooth length and dose.
</p>
</div>
<p>In the resulting Figure <a href="10-multiple-regression.html#fig:numxcatxplot1">10.1</a>, observe that <code>ggplot()</code> assigns a default in red/blue color scheme to the points and to the lines associated with the two levels of <code>supp</code>: <code>OJ</code> and <code>VC</code>. Furthermore, the <code>geom_smooth(method = "lm", se = FALSE)</code> layer automatically fits a different regression line for each group.</p>
<p>We notice an interesting trend. While both regression lines are positively sloped with dose levels (i.e., guinea pigs receiving higher doses of vitamin C tend to have longer teeth), the slope for dose for the VC guinea pigs is <em>more</em> positive.</p>
</div>
<div id="model4interactiontable" class="section level3 hasAnchor" number="10.1.2">
<h3><span class="header-section-number">10.1.2</span> Interaction model<a href="10-multiple-regression.html#model4interactiontable" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s now quantify the relationship of our outcome variable <span class="math inline">\(y\)</span> and the two explanatory variables using one type of multiple regression model known as an <em>interaction model</em>. We’ll explain where the term “interaction” comes from at the end of this section.</p>
<p>In particular, we’ll write out the equation of the two regression lines in Figure <a href="10-multiple-regression.html#fig:numxcatxplot1">10.1</a> using the values from a regression table. Before we do this, however, let’s go over a brief refresher of regression when you have a categorical explanatory variable <span class="math inline">\(x\)</span>.</p>
<p>Recall in Subsection <a href="8-regression.html#model2table">8.2.2</a> we fit a regression model for countries’ life expectancies as a function of which continent the country was in. In other words, we had a numerical outcome variable <span class="math inline">\(y\)</span> = <code>lifeExp</code> and a categorical explanatory variable <span class="math inline">\(x\)</span> = <code>continent</code> which had 5 levels: <code>Africa</code>, <code>Americas</code>, <code>Asia</code>, <code>Europe</code>, and <code>Oceania</code>. Let’s re-display the regression table you saw in Table <a href="8-regression.html#tab:catxplot4b">8.8</a>:</p>
<table class="table" style="font-size: 16px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:unnamed-chunk-437">TABLE 10.3: </span>Regression table for life expectancy as a function of continent
</caption>
<thead>
<tr>
<th style="text-align:left;">
term
</th>
<th style="text-align:right;">
estimate
</th>
<th style="text-align:right;">
std_error
</th>
<th style="text-align:right;">
statistic
</th>
<th style="text-align:right;">
p_value
</th>
<th style="text-align:right;">
lower_ci
</th>
<th style="text-align:right;">
upper_ci
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
intercept
</td>
<td style="text-align:right;">
54.8
</td>
<td style="text-align:right;">
1.02
</td>
<td style="text-align:right;">
53.45
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
52.8
</td>
<td style="text-align:right;">
56.8
</td>
</tr>
<tr>
<td style="text-align:left;">
continent: Americas
</td>
<td style="text-align:right;">
18.8
</td>
<td style="text-align:right;">
1.80
</td>
<td style="text-align:right;">
10.45
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
15.2
</td>
<td style="text-align:right;">
22.4
</td>
</tr>
<tr>
<td style="text-align:left;">
continent: Asia
</td>
<td style="text-align:right;">
15.9
</td>
<td style="text-align:right;">
1.65
</td>
<td style="text-align:right;">
9.68
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
12.7
</td>
<td style="text-align:right;">
19.2
</td>
</tr>
<tr>
<td style="text-align:left;">
continent: Europe
</td>
<td style="text-align:right;">
22.8
</td>
<td style="text-align:right;">
1.70
</td>
<td style="text-align:right;">
13.47
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
19.5
</td>
<td style="text-align:right;">
26.2
</td>
</tr>
<tr>
<td style="text-align:left;">
continent: Oceania
</td>
<td style="text-align:right;">
25.9
</td>
<td style="text-align:right;">
5.33
</td>
<td style="text-align:right;">
4.86
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
15.4
</td>
<td style="text-align:right;">
36.5
</td>
</tr>
</tbody>
</table>
<p>Recall our interpretation of the <code>estimate</code> column. Since <code>Africa</code> was the “baseline for comparison” group, the <code>intercept</code> term corresponds to the mean life expectancy for all countries in Africa of 54.8 years. The other four values of <code>estimate</code> correspond to “offsets” relative to the baseline group. So, for example, the “offset” corresponding to the Americas is +18.8 as compared to the baseline for comparison group Africa. In other words, the average life expectancy for countries in the Americas is 18.8 years <em>higher</em>. Thus the mean life expectancy for all countries in the Americas is 54.8 + 18.8 = 73.6. The same interpretation holds for Asia, Europe, and Oceania.</p>
<p>Going back to our multiple regression model for tooth <code>len</code>gth using <code>dose</code> and <code>supp</code>lement in Figure <a href="10-multiple-regression.html#fig:numxcatxplot1">10.1</a>, we generate the regression table using the same two-step approach from Chapter <a href="8-regression.html#regression">8</a>: we first “fit” the model using the <code>lm()</code> “linear model” function and then we apply the <code>get_regression_table()</code> function. This time, however, our model formula won’t be of the form <code>y ~ x</code>, but rather of the form <code>y ~ x1 * x2</code>. In other words, our two explanatory variables <code>x1</code> and <code>x2</code> are separated by a <code>*</code> sign:</p>
<div class="sourceCode" id="cb408"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb408-1"><a href="10-multiple-regression.html#cb408-1" tabindex="-1"></a><span class="co"># Fit regression model:</span></span>
<span id="cb408-2"><a href="10-multiple-regression.html#cb408-2" tabindex="-1"></a>len_model_interaction <span class="ot">&lt;-</span> <span class="fu">lm</span>(len <span class="sc">~</span> dose <span class="sc">*</span> supp, <span class="at">data =</span> ToothGrowth)</span>
<span id="cb408-3"><a href="10-multiple-regression.html#cb408-3" tabindex="-1"></a></span>
<span id="cb408-4"><a href="10-multiple-regression.html#cb408-4" tabindex="-1"></a><span class="co"># Get regression table:</span></span>
<span id="cb408-5"><a href="10-multiple-regression.html#cb408-5" tabindex="-1"></a><span class="fu">get_regression_table</span>(len_model_interaction)</span></code></pre></div>
<table class="table" style="font-size: 16px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:regtable-interaction">TABLE 10.4: </span>Regression table for interaction model
</caption>
<thead>
<tr>
<th style="text-align:left;">
term
</th>
<th style="text-align:right;">
estimate
</th>
<th style="text-align:right;">
std_error
</th>
<th style="text-align:right;">
statistic
</th>
<th style="text-align:right;">
p_value
</th>
<th style="text-align:right;">
lower_ci
</th>
<th style="text-align:right;">
upper_ci
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
intercept
</td>
<td style="text-align:right;">
11.55
</td>
<td style="text-align:right;">
1.58
</td>
<td style="text-align:right;">
7.30
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
8.382
</td>
<td style="text-align:right;">
14.72
</td>
</tr>
<tr>
<td style="text-align:left;">
dose
</td>
<td style="text-align:right;">
7.81
</td>
<td style="text-align:right;">
1.20
</td>
<td style="text-align:right;">
6.53
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
5.417
</td>
<td style="text-align:right;">
10.21
</td>
</tr>
<tr>
<td style="text-align:left;">
supp: VC
</td>
<td style="text-align:right;">
-8.26
</td>
<td style="text-align:right;">
2.24
</td>
<td style="text-align:right;">
-3.69
</td>
<td style="text-align:right;">
0.001
</td>
<td style="text-align:right;">
-12.735
</td>
<td style="text-align:right;">
-3.77
</td>
</tr>
<tr>
<td style="text-align:left;">
dose:suppVC
</td>
<td style="text-align:right;">
3.90
</td>
<td style="text-align:right;">
1.69
</td>
<td style="text-align:right;">
2.31
</td>
<td style="text-align:right;">
0.025
</td>
<td style="text-align:right;">
0.518
</td>
<td style="text-align:right;">
7.29
</td>
</tr>
</tbody>
</table>
<p>Looking at the regression table output in Table <a href="10-multiple-regression.html#tab:regtable-interaction">10.4</a>, there are four rows of values in the <code>estimate</code> column. While it is not immediately apparent, using these four values we can write out the equations of both lines in Figure <a href="10-multiple-regression.html#fig:numxcatxplot1">10.1</a>. First, since the word <code>OJ</code> comes alphabetically before <code>VC</code>, the orange juice supplement is the “baseline for comparison” group. Thus, <code>intercept</code> is the intercept <em>for only the orange juice recipients</em>.</p>
<p>This holds similarly for <code>dose</code>. It is the slope for dose <em>for only the OJ recipients</em>. Thus, the red regression line in Figure <a href="10-multiple-regression.html#fig:numxcatxplot1">10.1</a> has an intercept of 11.55 and slope for dose of 7.81.</p>
<p>What about the intercept and slope for dose of the ascorbic acid recipients in the blue line in Figure <a href="10-multiple-regression.html#fig:numxcatxplot1">10.1</a>? This is where our notion of “offsets” comes into play once again.</p>
<p>The value for <code>suppVC</code> of -8.26 is not the intercept for the ascorbic acid recipients, but rather the <em>offset</em> in intercept for these guinea pigs relative to orange juice recipients. The intercept for the ascorbic acid recipients is <code>intercept + suppVC</code> = 11.55 + (-8.26) = 3.29.</p>
<p>Similarly, <code>dose:suppVC</code> = 3.904 is not the slope for dose for the ascorbic acid recipients, but rather the <em>offset</em> in slope for those guinea pigs. Therefore, the slope for dose for the ascorbic acid recipients is <code>dose + dose:suppVC</code> <span class="math inline">\(= 7.81 + 3.904 = 11.714\)</span>. Thus, the blue regression line in Figure <a href="10-multiple-regression.html#fig:numxcatxplot1">10.1</a> has intercept 3.29 and slope for <code>dose</code> of 11.714. Let’s summarize these values in Table <a href="10-multiple-regression.html#tab:interaction-summary">10.5</a> and focus on the two slopes for <code>dose</code>:</p>
<table class="table" style="font-size: 16px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:interaction-summary">TABLE 10.5: </span>Comparison of intercepts and slopes for interaction model
</caption>
<thead>
<tr>
<th style="text-align:left;">
Supplement
</th>
<th style="text-align:right;">
Intercept
</th>
<th style="text-align:right;">
Slope for dose
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Orange juice
</td>
<td style="text-align:right;">
11.55
</td>
<td style="text-align:right;">
7.81
</td>
</tr>
<tr>
<td style="text-align:left;">
Ascorbic acid
</td>
<td style="text-align:right;">
3.29
</td>
<td style="text-align:right;">
11.71
</td>
</tr>
</tbody>
</table>
<p>Since the slope for dose for the orange recipients was 7.81, it means that on average, a guinea pig who receives one unit more would have a tooth length that is 7.81 units <strong>higher</strong>. For the ascorbic acid recipients, however, the corresponding associated increase was on average 11.714 units. While both slopes for dose were positive, the slope for dose for the <code>VC</code> recipients is <em>more positive</em>. This is consistent with our observation from Figure <a href="10-multiple-regression.html#fig:numxcatxplot1">10.1</a>, that this model is suggesting that dose impacts tooth length for ascorbic acid (VC) recipients more than for orange juice recipients.</p>
<p>Let’s now write the equation for our regression lines, which we can use to compute our fitted values <span class="math inline">\(\widehat{y} = \widehat{\text{len}}\)</span>.</p>
<!--
Note: Even though markdown preview of the following LaTeX looks garbled, it
comes out correct in the HTML output.
-->
<p><span class="math display">\[
\begin{aligned}
\widehat{y} = \widehat{\text{len}} &amp;= b_0 + b_{\text{dose}} \cdot \text{dose} + b_{\text{VC}} \cdot \mathbb{1}_{\text{is VC}}(x) + b_{\text{dose,VC}} \cdot \text{dose} \cdot \mathbb{1}_{\text{is VC}}(x)\\
&amp;= 11.55 + 7.81 \cdot \text{dose} - 8.26 \cdot \mathbb{1}_{\text{is VC}}(x) + 3.904 \cdot \text{dose} \cdot \mathbb{1}_{\text{is VC}}(x)
\end{aligned}
\]</span></p>
<p>Whoa! That’s even more daunting than the equation you saw for the life expectancy as a function of continent in Subsection <a href="8-regression.html#model2table">8.2.2</a>! However, if you recall what an “indicator function” does, the equation simplifies greatly. In the previous equation, we have one indicator function of interest:</p>
<p><span class="math display">\[
\mathbb{1}_{\text{is VC}}(x) = \left\{
\begin{array}{ll}
1 &amp; \text{if } \text{supp } x \text{ is VC} \\
0 &amp; \text{otherwise}\end{array}
\right.
\]</span></p>
<p>Second, let’s match coefficients in the previous equation with values in the <code>estimate</code> column in our regression table in Table <a href="10-multiple-regression.html#tab:regtable-interaction">10.4</a>:</p>
<ol style="list-style-type: decimal">
<li><span class="math inline">\(b_0\)</span> is the <code>intercept</code> = 11.55 for the orange juice recipients</li>
<li><span class="math inline">\(b_{\text{dose}}\)</span> is the slope for <code>dose</code> = 7.81 for the orange juice recipients</li>
<li><span class="math inline">\(b_{\text{VC}}\)</span> is the offset in intercept = -8.26 for the ascorbic acid (VC) recipients</li>
<li><span class="math inline">\(b_{\text{dose,VC}}\)</span> is the offset in slope for dose = 3.904 for the ascorbic acid (VC) recipients</li>
</ol>
<p>Let’s put this all together and compute the fitted value <span class="math inline">\(\widehat{y} = \widehat{\text{len}}\)</span> for orange juice recipients. Since for orange juice recipients <span class="math inline">\(\mathbb{1}_{\text{is VC}}(x)\)</span> = 0, the previous equation becomes</p>
<p><span class="math display">\[
\begin{aligned}
\widehat{y} = \widehat{\text{len}} &amp;= 11.55 + 7.81 \cdot \text{dose} - 8.26 \cdot 0 + 3.904 \cdot \text{dose} \cdot 0\\
&amp;= 11.55 + 7.81 \cdot \text{dose} - 0 + 0\\
&amp;= 11.55 + 7.81 \cdot \text{dose}\\
\end{aligned}
\]</span></p>
<p>which is the equation of the red regression line in Figure <a href="10-multiple-regression.html#fig:numxcatxplot1">10.1</a> corresponding to the orange juice recipients in Table <a href="10-multiple-regression.html#tab:interaction-summary">10.5</a>. Correspondingly, since for ascorbic acid (VC) recipients <span class="math inline">\(\mathbb{1}_{\text{is VC}}(x)\)</span> = 1, the previous equation becomes</p>
<p><span class="math display">\[
\begin{aligned}
\widehat{y} = \widehat{\text{len}} &amp;= 11.55 + 7.81 \cdot \text{dose} - 8.26 + 3.904 \cdot \text{dose}\\
&amp;= (11.55 - 8.26) + (r slope_OJ` + 3.904) * \text{dose}\\
&amp;= 3.29 + 11.714 \cdot \text{dose}\\
\end{aligned}
\]</span></p>
<p>which is the equation of the blue regression line in Figure <a href="10-multiple-regression.html#fig:numxcatxplot1">10.1</a> corresponding to the ascorbic acid (VC) recipients in Table <a href="10-multiple-regression.html#tab:interaction-summary">10.5</a>.</p>
<p>Phew! That was a lot of arithmetic! Don’t fret, however, this is as hard as modeling will get in this book. If you’re still a little unsure about using indicator functions and using categorical explanatory variables in a regression model, we <em>highly</em> suggest you re-read Subsection <a href="8-regression.html#model2table">8.2.2</a>. This involves only a single categorical explanatory variable and thus is much simpler.</p>
<p>Before we end this section, we explain why we refer to this type of model as an “interaction model.” The <span class="math inline">\(b_{\text{dose,VC}}\)</span> term in the equation for the fitted value <span class="math inline">\(\widehat{y}\)</span> = <span class="math inline">\(\widehat{\text{len}}\)</span> is what’s known in statistical modeling as an “interaction effect.” The interaction term corresponds to the <code>dose:suppVC</code> = 3.904 in the final row of the regression table in Table <a href="10-multiple-regression.html#tab:regtable-interaction">10.4</a>.</p>
<p>We say there is an interaction effect if the associated effect of one variable <em>depends on the value of another variable</em>. That is to say, the two variables are “interacting” with each other. Here, the associated effect of the variable <code>dose</code> <em>depends</em> on the value of the other variable <code>supp</code>. The difference in slopes for dose of +3.904 of ascorbic acid (VC) recipients relative to orange juice recipients shows this. </p>
<p>Another way of thinking about interaction effects on tooth length is as follows. For a given pig, there might be an associated effect of their dose <em>by itself</em>, there might be an associated effect of their supplement <em>by itself</em>, but when dose and supplement are considered <em>together</em> there might be an <em>additional effect</em> above and beyond the two individual effects.</p>
</div>
<div id="model4table" class="section level3 hasAnchor" number="10.1.3">
<h3><span class="header-section-number">10.1.3</span> Parallel slopes model<a href="10-multiple-regression.html#model4table" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>When creating regression models with one numerical and one categorical explanatory variable, we are not just limited to interaction models as we just saw. Another type of model we can use is known as a <em>parallel slopes</em> model. Unlike interaction models where the regression lines can have different intercepts and different slopes, parallel slopes models still allow for different intercepts but <em>force</em> all lines to have the same slope. The resulting regression lines are thus parallel. Let’s visualize the best-fitting parallel slopes model to <code>ToothGrowth</code>.</p>
<p>Unfortunately, the <code>geom_smooth()</code> function in the <code>ggplot2</code> package does not have a convenient way to plot parallel slopes models. Evgeni Chasnovski thus created a special purpose function called <code>geom_parallel_slopes()</code> that is included in the <code>moderndive</code> package. You won’t find <code>geom_parallel_slopes()</code> in the <code>ggplot2</code> package, so to use it, you will need to load both the <code>ggplot2</code> and <code>moderndive</code> packages. Using this function, let’s now plot the parallel slopes model for tooth length. Notice how the code is identical to the code that produced the visualization of the interaction model in Figure <a href="10-multiple-regression.html#fig:numxcatxplot1">10.1</a>, but now the <code>geom_smooth(method = "lm", se = FALSE)</code> layer is replaced with <code>geom_parallel_slopes(se = FALSE)</code>.</p>
<div class="sourceCode" id="cb409"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb409-1"><a href="10-multiple-regression.html#cb409-1" tabindex="-1"></a><span class="fu">ggplot</span>(ToothGrowth, <span class="fu">aes</span>(<span class="at">x =</span> dose, <span class="at">y =</span> len, <span class="at">color =</span> supp)) <span class="sc">+</span></span>
<span id="cb409-2"><a href="10-multiple-regression.html#cb409-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb409-3"><a href="10-multiple-regression.html#cb409-3" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Dose&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Tooth length&quot;</span>, <span class="at">color =</span> <span class="st">&quot;Supplement type&quot;</span>) <span class="sc">+</span></span>
<span id="cb409-4"><a href="10-multiple-regression.html#cb409-4" tabindex="-1"></a>  <span class="fu">geom_parallel_slopes</span>(<span class="at">se =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:numxcatx-parallel"></span>
<img src="ModernDive_files/figure-html/numxcatx-parallel-1.png" alt="Parallel slopes model of len with dose and supp." width="\textwidth" />
<p class="caption">
FIGURE 10.2: Parallel slopes model of len with dose and supp.
</p>
</div>
<p>Observe in Figure <a href="10-multiple-regression.html#fig:numxcatx-parallel">10.2</a> that we now have parallel lines corresponding to the orange juice and ascorbic acid (VC) recipients, respectively: here they have the same positive slope. This is telling us that guinea pigs who receive higher doses of vitamin C will tend to have longer teeth than guinea pigs who receive less. Furthermore, since the lines are parallel, the associated gain for higher dose is assumed to be the same for both orange juice and ascorbic acid (VC) recipients.</p>
<p>Also observe in Figure <a href="10-multiple-regression.html#fig:numxcatx-parallel">10.2</a> that these two lines have different intercepts as evidenced by the fact that the blue line corresponding to the ascorbic acid (VC) recipients is lower than the red line corresponding to the orange juice recipients. This is telling us that irrespective of dose, orange juice recipients tended to have longer teeth than ascorbic acid (VC) recipients.</p>
<p>In order to obtain the precise numerical values of the two intercepts and the single common slope, we once again “fit” the model using the <code>lm()</code> “linear model” function and then apply the <code>get_regression_table()</code> function. However, unlike the interaction model which had a model formula of the form <code>y ~ x1 * x2</code>, our model formula is now of the form <code>y ~ x1 + x2</code>. In other words, our two explanatory variables <code>x1</code> and <code>x2</code> are separated by a <code>+</code> sign:</p>
<div class="sourceCode" id="cb410"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb410-1"><a href="10-multiple-regression.html#cb410-1" tabindex="-1"></a><span class="co"># Fit regression model:</span></span>
<span id="cb410-2"><a href="10-multiple-regression.html#cb410-2" tabindex="-1"></a>len_model_parallel_slopes <span class="ot">&lt;-</span> <span class="fu">lm</span>(len <span class="sc">~</span> dose <span class="sc">+</span> supp, <span class="at">data =</span> ToothGrowth)</span>
<span id="cb410-3"><a href="10-multiple-regression.html#cb410-3" tabindex="-1"></a><span class="co"># Get regression table:</span></span>
<span id="cb410-4"><a href="10-multiple-regression.html#cb410-4" tabindex="-1"></a><span class="fu">get_regression_table</span>(len_model_parallel_slopes)</span></code></pre></div>
<table class="table" style="font-size: 16px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:regtable-parallel-slopes">TABLE 10.6: </span>Regression table for parallel slopes model
</caption>
<thead>
<tr>
<th style="text-align:left;">
term
</th>
<th style="text-align:right;">
estimate
</th>
<th style="text-align:right;">
std_error
</th>
<th style="text-align:right;">
statistic
</th>
<th style="text-align:right;">
p_value
</th>
<th style="text-align:right;">
lower_ci
</th>
<th style="text-align:right;">
upper_ci
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
intercept
</td>
<td style="text-align:right;">
9.27
</td>
<td style="text-align:right;">
1.282
</td>
<td style="text-align:right;">
7.23
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
6.71
</td>
<td style="text-align:right;">
11.84
</td>
</tr>
<tr>
<td style="text-align:left;">
dose
</td>
<td style="text-align:right;">
9.76
</td>
<td style="text-align:right;">
0.877
</td>
<td style="text-align:right;">
11.13
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
8.01
</td>
<td style="text-align:right;">
11.52
</td>
</tr>
<tr>
<td style="text-align:left;">
supp: VC
</td>
<td style="text-align:right;">
-3.70
</td>
<td style="text-align:right;">
1.094
</td>
<td style="text-align:right;">
-3.38
</td>
<td style="text-align:right;">
0.001
</td>
<td style="text-align:right;">
-5.89
</td>
<td style="text-align:right;">
-1.51
</td>
</tr>
</tbody>
</table>
<p>Similar to the regression table for the interaction model from Table <a href="10-multiple-regression.html#tab:regtable-interaction">10.4</a>, we have an <code>intercept</code> term corresponding to the intercept for the “baseline for comparison” orange juice (OJ) group and a <code>suppVC</code> term corresponding to the <em>offset</em> in intercept for the ascorbic acid (VC) recipients relative to orange juice recipients. In other words, in Figure <a href="10-multiple-regression.html#fig:numxcatx-parallel">10.2</a> the red regression line corresponding to the orange juice recipients has an intercept of 9.27 while the blue regression line corresponding to the ascorbic acid (VC) recipients has an intercept of 9.27 + -3.7 = 5.57.</p>
<p>Unlike in Table <a href="10-multiple-regression.html#tab:regtable-interaction">10.4</a>, however, we now only have a single slope for dose of 9.764. This is because the model dictates that both the orange juice and ascorbic acid (VC) recipients have a common slope for dose. This is telling us that a guinea pig who received a vitamin C dose one unit higher has tooth length that is on average 9.764 units longer. This benefit for receiving a higher vitamin C dose applies equally to both orange juice and ascorbic acid (VC) recipients.</p>
<p>Let’s summarize these values in Table <a href="10-multiple-regression.html#tab:parallel-slopes-summary">10.7</a>, noting the different intercepts but common slopes:</p>
<table class="table" style="font-size: 16px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:parallel-slopes-summary">TABLE 10.7: </span>Comparison of intercepts and slope for parallel slopes model
</caption>
<thead>
<tr>
<th style="text-align:left;">
Supplement
</th>
<th style="text-align:right;">
Intercept
</th>
<th style="text-align:right;">
Slope for dose
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Orange juice (OJ)
</td>
<td style="text-align:right;">
9.27
</td>
<td style="text-align:right;">
9.764
</td>
</tr>
<tr>
<td style="text-align:left;">
Ascorbic acid (VC)
</td>
<td style="text-align:right;">
5.57
</td>
<td style="text-align:right;">
9.764
</td>
</tr>
</tbody>
</table>
<p>Let’s now write the equation for our regression lines, which we can use to compute our fitted values <span class="math inline">\(\widehat{y} = \widehat{\text{len}}\)</span>.</p>
<!--
Note: Even though markdown preview of the following LaTeX looks garbled, it
comes out correct in the HTML output.
-->
<p><span class="math display">\[
\begin{aligned}
\widehat{y} = \widehat{\text{len}} &amp;= b_0 + b_{\text{dose}} \cdot \text{dose} + b_{\text{VC}} \cdot \mathbb{1}_{\text{is VC}}(x)\\
&amp;= 9.27 + 9.764 \cdot \text{dose} + -3.7 \cdot \mathbb{1}_{\text{is VC}}(x)
\end{aligned}
\]</span></p>
<p>Let’s put this all together and compute the fitted value <span class="math inline">\(\widehat{y} = \widehat{\text{len}}\)</span> for orange juice recipients. Since for orange juice recipients the indicator function <span class="math inline">\(\mathbb{1}_{\text{is VC}}(x)\)</span> = 0, the previous equation becomes</p>
<p><span class="math display">\[
\begin{aligned}
\widehat{y} = \widehat{\text{len}} &amp;= 9.27 + 9.764 \cdot \text{dose} + -3.7 \cdot 0\\
&amp;= 9.27 + 9.764 \cdot \text{dose}
\end{aligned}
\]</span></p>
<p>which is the equation of the red regression line in Figure <a href="10-multiple-regression.html#fig:numxcatx-parallel">10.2</a> corresponding to the orange juice recipients. Correspondingly, since for ascorbic acid (VC) recipients the indicator function <span class="math inline">\(\mathbb{1}_{\text{is VC}}(x)\)</span> = 1, the previous equation becomes</p>
<p><span class="math display">\[
\begin{aligned}
\widehat{y} = \widehat{\text{len}} &amp;= 9.27 + 9.764 \cdot \text{dose} + -3.7 \cdot 1\\
&amp;= (9.27 + -3.7) + 9.764 \cdot \text{dose}\\
&amp;= 5.57+ 9.764 \cdot \text{dose}
\end{aligned}
\]</span></p>
<p>which is the equation of the blue regression line in Figure <a href="10-multiple-regression.html#fig:numxcatx-parallel">10.2</a> corresponding to the ascorbic acid (VC) recipients.</p>
<p>Great! We’ve considered both an interaction model and a parallel slopes model for our data. Let’s compare the visualizations for both models side-by-side in Figure <a href="10-multiple-regression.html#fig:numxcatx-comparison">10.3</a>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:numxcatx-comparison"></span>
<img src="ModernDive_files/figure-html/numxcatx-comparison-1.png" alt="Comparison of interaction and parallel slopes models." width="\textwidth" />
<p class="caption">
FIGURE 10.3: Comparison of interaction and parallel slopes models.
</p>
</div>
<p>At this point, you might be asking yourself: “Why would we ever use a parallel slopes model?”. Looking at the left-hand plot in Figure <a href="10-multiple-regression.html#fig:numxcatx-comparison">10.3</a>, the two lines definitely do not appear to be parallel, so why would we <em>force</em> them to be parallel? For this data, we agree! It can easily be argued that the interaction model on the left is more appropriate. However, in the upcoming Subsection <a href="10-multiple-regression.html#model-selection">10.3.1</a> on model selection, we’ll present an example where it can be argued that the case for a parallel slopes model might be stronger.</p>
</div>
<div id="model4points" class="section level3 hasAnchor" number="10.1.4">
<h3><span class="header-section-number">10.1.4</span> Observed/fitted values and residuals<a href="10-multiple-regression.html#model4points" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For brevity’s sake, in this section we’ll only compute the observed values, fitted values, and residuals for the interaction model which we saved in <code>len_model_interaction</code>. You’ll have an opportunity to study the corresponding values for the parallel slopes model in the upcoming <em>Learning check</em>.</p>
<p>Say, you have a guinea pig who receives orange juice of 2 mg/day. What fitted value <span class="math inline">\(\widehat{y}\)</span> = <span class="math inline">\(\widehat{\text{len}}\)</span> would our model yield? Say, you have another guinea pig who receives ascorbic acid of 1 mg/day. What would their fitted value <span class="math inline">\(\widehat{y}\)</span> be?</p>
<p>We answer this question visually first for the orange juice recipient by finding the intersection of the red regression line and the vertical line at <span class="math inline">\(x\)</span> = dose = 2. We mark this value with a large red dot in Figure <a href="10-multiple-regression.html#fig:fitted-values">10.4</a>. Similarly, we can identify the fitted value <span class="math inline">\(\widehat{y}\)</span> = <span class="math inline">\(\widehat{\text{len}}\)</span> for the ascorbic acid recipient by finding the intersection of the blue regression line and the vertical line at <span class="math inline">\(x\)</span> = dose = 1. We mark this value with a large blue dot in Figure <a href="10-multiple-regression.html#fig:fitted-values">10.4</a>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fitted-values"></span>
<img src="ModernDive_files/figure-html/fitted-values-1.png" alt="Fitted values for two supplement doses." width="\textwidth" />
<p class="caption">
FIGURE 10.4: Fitted values for two supplement doses.
</p>
</div>
<p>What are these two values of <span class="math inline">\(\widehat{y}\)</span> = <span class="math inline">\(\widehat{\text{len}}\)</span> precisely? We can use the equations of the two regression lines we computed in Subsection <a href="10-multiple-regression.html#model4interactiontable">10.1.2</a>, which in turn were based on values from the regression table in Table <a href="10-multiple-regression.html#tab:regtable-interaction">10.4</a>:</p>
<ul>
<li>For all orange juice recipients: <span class="math inline">\(\widehat{y} = \widehat{\text{len}} = 11.55 + 7.81 \cdot \text{dose}\)</span></li>
<li>For all ascorbic acid (VC) recipients: <span class="math inline">\(\widehat{y} = \widehat{\text{len}} = 3.29 + 11.714 \cdot \text{dose}\)</span></li>
</ul>
<p>So our fitted values would be: <span class="math inline">\(11.55 - -7.81 \cdot 2 = 27.17\)</span> and <span class="math inline">\(3.29 + 11.714 \cdot 1 = 15.00\)</span>, respectively.</p>
<p>Now what if we want the fitted values not just for these two guinea pigs, but for all 60 guinea pigs included in the <code>ToothGrowth</code> data frame? Doing this by hand would be long and tedious! This is where the <code>get_regression_points()</code> function from the <code>moderndive</code> package can help: it will quickly automate the above calculations for all 60 guinea pigs. We present a preview of the first 5 rows for each supplement type out of 60 in Table <a href="10-multiple-regression.html#tab:model4-points-table">10.8</a>.</p>
<div class="sourceCode" id="cb411"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb411-1"><a href="10-multiple-regression.html#cb411-1" tabindex="-1"></a>regression_points <span class="ot">&lt;-</span> <span class="fu">get_regression_points</span>(len_model_interaction)</span>
<span id="cb411-2"><a href="10-multiple-regression.html#cb411-2" tabindex="-1"></a>regression_points <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(supp) <span class="sc">%&gt;%</span> <span class="fu">slice_head</span>(<span class="at">n=</span><span class="dv">5</span>)</span></code></pre></div>
<table class="table" style="font-size: 16px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:model4-points-table">TABLE 10.8: </span>Regression points (First 10 out of 463 courses)
</caption>
<thead>
<tr>
<th style="text-align:right;">
ID
</th>
<th style="text-align:right;">
len
</th>
<th style="text-align:right;">
dose
</th>
<th style="text-align:left;">
supp
</th>
<th style="text-align:right;">
len_hat
</th>
<th style="text-align:right;">
residual
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
31
</td>
<td style="text-align:right;">
15.2
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:left;">
OJ
</td>
<td style="text-align:right;">
15.46
</td>
<td style="text-align:right;">
-0.256
</td>
</tr>
<tr>
<td style="text-align:right;">
32
</td>
<td style="text-align:right;">
21.5
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:left;">
OJ
</td>
<td style="text-align:right;">
15.46
</td>
<td style="text-align:right;">
6.044
</td>
</tr>
<tr>
<td style="text-align:right;">
33
</td>
<td style="text-align:right;">
17.6
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:left;">
OJ
</td>
<td style="text-align:right;">
15.46
</td>
<td style="text-align:right;">
2.144
</td>
</tr>
<tr>
<td style="text-align:right;">
34
</td>
<td style="text-align:right;">
9.7
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:left;">
OJ
</td>
<td style="text-align:right;">
15.46
</td>
<td style="text-align:right;">
-5.756
</td>
</tr>
<tr>
<td style="text-align:right;">
35
</td>
<td style="text-align:right;">
14.5
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:left;">
OJ
</td>
<td style="text-align:right;">
15.46
</td>
<td style="text-align:right;">
-0.956
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4.2
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:left;">
VC
</td>
<td style="text-align:right;">
9.15
</td>
<td style="text-align:right;">
-4.953
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
11.5
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:left;">
VC
</td>
<td style="text-align:right;">
9.15
</td>
<td style="text-align:right;">
2.347
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
7.3
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:left;">
VC
</td>
<td style="text-align:right;">
9.15
</td>
<td style="text-align:right;">
-1.853
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
5.8
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:left;">
VC
</td>
<td style="text-align:right;">
9.15
</td>
<td style="text-align:right;">
-3.353
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
6.4
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:left;">
VC
</td>
<td style="text-align:right;">
9.15
</td>
<td style="text-align:right;">
-2.753
</td>
</tr>
</tbody>
</table>
<p>It turns out that the first five orange juice recipients received 0.5 mg/day of vitamin C. The resulting <span class="math inline">\(\widehat{y}\)</span> = <span class="math inline">\(\widehat{\text{len}}\)</span> fitted values are in the <code>len_hat</code> column. Furthermore, the <code>get_regression_points()</code> function also returns the residuals <span class="math inline">\(y-\widehat{y}\)</span>. Notice, for example, the second and third guinea pigs receiving orange juice had positive residuals, indicating that the actual tooth growth values were greater than their fitted length of 15.46. On the other hand, the first and fourth guinea pigs had negative residuals, indicating that the actual tooth growth values were less than 15.46.</p>
<div class="learncheck">
<p>
<strong><em>Learning check</em></strong>
</p>
</div>
<p><strong>(LC9.1)</strong> Compute the observed values, fitted values, and residuals not for the interaction model as we just did, but rather for the parallel slopes model we saved in <code>len_model_parallel_slopes</code>.</p>
<div class="learncheck">

</div>
</div>
</div>
<div id="model3" class="section level2 hasAnchor" number="10.2">
<h2><span class="header-section-number">10.2</span> Two categorical explanatory variables<a href="10-multiple-regression.html#model3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Let’s now switch gears and consider multiple regression models where instead of one numerical and one categorical explanatory variable, we now have two categorical explanatory variables. The dataset we’ll use is from <em>Analysis of Biological Data</em> by Whitlock and Schluter. Its accompanying <code>abd</code> R package contains the <code>IntertidalAlgae</code> dataset that we’ll use next.</p>
<p>This dataset is from a study looking at the effect of herbivores and height above low tide, and the interaction between these factors, on abundance of a red intertidal alga.</p>
<p>In this section, we’ll fit a regression model where we have</p>
<ol style="list-style-type: decimal">
<li>A numerical outcome variable <span class="math inline">\(y\)</span>, sqrt.area, the square root of the area (in cm<sup>2</sup>) covered by red algae at the experiment’s end, and</li>
<li>Two explanatory variables:
<ol style="list-style-type: decimal">
<li>A categorical explanatory variable <span class="math inline">\(x_1\)</span>, herbivores, referring to the absence or presence of herbivores.</li>
<li>Another categorical explanatory variable <span class="math inline">\(x_2\)</span>, height, referring to the height of the experimental plot relative to the tide levels.</li>
</ol></li>
</ol>
<div id="model3EDA" class="section level3 hasAnchor" number="10.2.1">
<h3><span class="header-section-number">10.2.1</span> Exploratory data analysis<a href="10-multiple-regression.html#model3EDA" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s examine the <code>Intertidal</code> dataset using RStudio’s spreadsheet viewer or <code>glimpse()</code>.</p>
<div class="sourceCode" id="cb412"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb412-1"><a href="10-multiple-regression.html#cb412-1" tabindex="-1"></a><span class="fu">library</span>(abd)</span>
<span id="cb412-2"><a href="10-multiple-regression.html#cb412-2" tabindex="-1"></a><span class="fu">glimpse</span>(IntertidalAlgae)</span></code></pre></div>
<pre><code>Rows: 64
Columns: 3
$ height     &lt;fct&gt; low, low, low, low, low, low, low, low, low, low, low, low,…
$ herbivores &lt;fct&gt; minus, minus, minus, minus, minus, minus, minus, minus, min…
$ sqrt.area  &lt;dbl&gt; 9.406, 34.468, 46.673, 16.642, 24.377, 38.351, 33.777, 61.0…</code></pre>
<p>Furthermore, let’s look at a random sample of five out of the 64 plots in Table <a href="10-multiple-regression.html#tab:model3-data-preview">10.9</a>. Once again, note that due to the random nature of the sampling, you will likely end up with a different subset of five rows.</p>
<div class="sourceCode" id="cb414"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb414-1"><a href="10-multiple-regression.html#cb414-1" tabindex="-1"></a>IntertidalAlgae <span class="sc">%&gt;%</span> <span class="fu">sample_n</span>(<span class="at">size =</span> <span class="dv">5</span>)</span></code></pre></div>
<table class="table" style="font-size: 16px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:model3-data-preview">TABLE 10.9: </span>Random sample of 5 experimental plots
</caption>
<thead>
<tr>
<th style="text-align:left;">
height
</th>
<th style="text-align:left;">
herbivores
</th>
<th style="text-align:right;">
sqrt.area
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
minus
</td>
<td style="text-align:right;">
46.17
</td>
</tr>
<tr>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
minus
</td>
<td style="text-align:right;">
41.79
</td>
</tr>
<tr>
<td style="text-align:left;">
mid
</td>
<td style="text-align:left;">
minus
</td>
<td style="text-align:right;">
45.54
</td>
</tr>
<tr>
<td style="text-align:left;">
low
</td>
<td style="text-align:left;">
plus
</td>
<td style="text-align:right;">
27.64
</td>
</tr>
<tr>
<td style="text-align:left;">
mid
</td>
<td style="text-align:left;">
minus
</td>
<td style="text-align:right;">
3.15
</td>
</tr>
</tbody>
</table>
<p>Now that we’ve looked at the raw values in our <code>IntertidalAlgae</code> data frame and got a sense of the data, let’s move on to the next common step in an exploratory data analysis: computing summary statistics. Let’s use the <code>skim()</code> function from the <code>skimr</code> package:</p>
<div class="sourceCode" id="cb415"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb415-1"><a href="10-multiple-regression.html#cb415-1" tabindex="-1"></a>IntertidalAlgae <span class="sc">%&gt;%</span> <span class="fu">skim</span>()</span></code></pre></div>
<table style="width: auto;" class="table table-condensed">
<caption>
<span id="tab:unnamed-chunk-452">TABLE 10.10: </span>Data summary
</caption>
<tbody>
<tr>
<td style="text-align:left;">
Name
</td>
<td style="text-align:left;">
Piped data
</td>
</tr>
<tr>
<td style="text-align:left;">
Number of rows
</td>
<td style="text-align:left;">
64
</td>
</tr>
<tr>
<td style="text-align:left;">
Number of columns
</td>
<td style="text-align:left;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
_______________________
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Column type frequency:
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
factor
</td>
<td style="text-align:left;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:left;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
________________________
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Group variables
</td>
<td style="text-align:left;">
None
</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: factor</strong></p>
<table>
<thead>
<tr>
<th style="text-align:left;">
skim_variable
</th>
<th style="text-align:right;">
n_missing
</th>
<th style="text-align:right;">
complete_rate
</th>
<th style="text-align:left;">
ordered
</th>
<th style="text-align:right;">
n_unique
</th>
<th style="text-align:left;">
top_counts
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
height
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
low: 32, mid: 32
</td>
</tr>
<tr>
<td style="text-align:left;">
herbivores
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
min: 32, plu: 32
</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table>
<thead>
<tr>
<th style="text-align:left;">
skim_variable
</th>
<th style="text-align:right;">
n_missing
</th>
<th style="text-align:right;">
complete_rate
</th>
<th style="text-align:right;">
mean
</th>
<th style="text-align:right;">
sd
</th>
<th style="text-align:right;">
p0
</th>
<th style="text-align:right;">
p25
</th>
<th style="text-align:right;">
p50
</th>
<th style="text-align:right;">
p75
</th>
<th style="text-align:right;">
p100
</th>
<th style="text-align:left;">
hist
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
sqrt.area
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
22.8
</td>
<td style="text-align:right;">
17.1
</td>
<td style="text-align:right;">
0.71
</td>
<td style="text-align:right;">
5.92
</td>
<td style="text-align:right;">
22.2
</td>
<td style="text-align:right;">
37.2
</td>
<td style="text-align:right;">
61.1
</td>
<td style="text-align:left;">
▇▃▅▆▁
</td>
</tr>
</tbody>
</table>
<p>Observe the summary statistics for the outcome variable <code>sqrt.area</code>: the mean and median sqrt.area are 22.84 and 22.25, respectively, and that 25% of plots had values of 5.92 or less.</p>
<!--Discuss balanced FACTORIAL design here-->
<p>Now let’s look at the explanatory variables <code>herbivores</code> and <code>height</code>. First, let’s visualize the relationship of the outcome variable with each of the two explanatory variables in separate box plots with an overlaid scatterplot to see the individual data points in Figure <a href="10-multiple-regression.html#fig:2numxplot1b">10.5</a>.</p>
<div class="sourceCode" id="cb416"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb416-1"><a href="10-multiple-regression.html#cb416-1" tabindex="-1"></a><span class="fu">ggplot</span>(IntertidalAlgae, <span class="fu">aes</span>(<span class="at">x =</span> herbivores, <span class="at">y =</span> sqrt.area)) <span class="sc">+</span></span>
<span id="cb416-2"><a href="10-multiple-regression.html#cb416-2" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb416-3"><a href="10-multiple-regression.html#cb416-3" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb416-4"><a href="10-multiple-regression.html#cb416-4" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Herbivore treatment&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Square root of area covered&quot;</span>, </span>
<span id="cb416-5"><a href="10-multiple-regression.html#cb416-5" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;Area coverage and herbivore treatment&quot;</span>) </span>
<span id="cb416-6"><a href="10-multiple-regression.html#cb416-6" tabindex="-1"></a></span>
<span id="cb416-7"><a href="10-multiple-regression.html#cb416-7" tabindex="-1"></a><span class="fu">ggplot</span>(IntertidalAlgae, <span class="fu">aes</span>(<span class="at">x =</span> height, <span class="at">y =</span> sqrt.area)) <span class="sc">+</span></span>
<span id="cb416-8"><a href="10-multiple-regression.html#cb416-8" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb416-9"><a href="10-multiple-regression.html#cb416-9" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb416-10"><a href="10-multiple-regression.html#cb416-10" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Height relative to low tide&quot;</span>, </span>
<span id="cb416-11"><a href="10-multiple-regression.html#cb416-11" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Square root of area covered&quot;</span>, </span>
<span id="cb416-12"><a href="10-multiple-regression.html#cb416-12" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;Area coverage and tidal location&quot;</span>) </span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:2numxplot1b"></span>
<img src="ModernDive_files/figure-html/2numxplot1b-1.png" alt="Relationship between red algae coverage and herbivores/height." width="\textwidth" />
<p class="caption">
FIGURE 10.5: Relationship between red algae coverage and herbivores/height.
</p>
</div>
<p>It seems that the herbivore treatment, but not tidal location, has some effect on its own on red algae coverage. With respect to herbivore treatment, the median of <span class="math inline">\(y\)</span> is almost half in the presence of herbivores (<code>plus</code>) as compared to the absence (<code>minus</code>). With respect to height above low tide, the median of <span class="math inline">\(y\)</span> is nearly the same in the low tide group as in the mid tide group.</p>
<p>However, the two plots in Figure <a href="10-multiple-regression.html#fig:2numxplot1b">10.5</a> only focus on the relationship of the outcome variable with each of the two explanatory variables <em>separately</em>. To visualize the <em>joint</em> relationship of all three variables simultaneously, let’s make just a scatterplot and indicate the other explanatory variable by color. Each of the 64 observations in the <code>IntertidalAlgae</code> data frame are marked with a point where</p>
<ol style="list-style-type: decimal">
<li>The numerical outcome variable <span class="math inline">\(y\)</span> <code>sqrt.area</code> is on the vertical axis.</li>
<li>The first categorical explanatory variable <span class="math inline">\(x_1\)</span> <code>herbivores</code> is on the horizontal axis.</li>
<li>The second categorical explanatory variable <span class="math inline">\(x_2\)</span> <code>height</code> is indicated by color.</li>
</ol>
<div class="sourceCode" id="cb417"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb417-1"><a href="10-multiple-regression.html#cb417-1" tabindex="-1"></a><span class="fu">ggplot</span>(IntertidalAlgae, <span class="fu">aes</span>(<span class="at">x =</span> herbivores, <span class="at">y =</span> sqrt.area, </span>
<span id="cb417-2"><a href="10-multiple-regression.html#cb417-2" tabindex="-1"></a>                            <span class="at">color =</span> height, <span class="at">group =</span> height)) <span class="sc">+</span></span>
<span id="cb417-3"><a href="10-multiple-regression.html#cb417-3" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb417-4"><a href="10-multiple-regression.html#cb417-4" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Herbivore treatment&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Square root of area covered&quot;</span>, </span>
<span id="cb417-5"><a href="10-multiple-regression.html#cb417-5" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;Area coverage and herbivore treatment&quot;</span>) <span class="sc">+</span></span>
<span id="cb417-6"><a href="10-multiple-regression.html#cb417-6" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:2numxplot1c"></span>
<img src="ModernDive_files/figure-html/2numxplot1c-1.png" alt="Relationship between red algae coverage and herbivores plus height." width="\textwidth" />
<p class="caption">
FIGURE 10.6: Relationship between red algae coverage and herbivores plus height.
</p>
</div>
<p>Furthermore, we also include the <em>regression lines</em> for each <code>height</code> level (<code>low</code> or <code>mid</code>). Recall from Subsection <a href="8-regression.html#leastsquares">8.3.2</a> that regression lines are “best-fitting” in that of all possible lines we can draw through a cloud of points, the regression line minimizes the <em>sum of squared residuals</em>. This concept also extends to models with two categorical explanatory variables.</p>
<div class="learncheck">
<p>
<strong><em>Learning check</em></strong>
</p>
</div>
<p><strong>(LC9.2)</strong> Prepare a new plot with the same outcome variable <span class="math inline">\(y\)</span> <code>sqrt.area</code> but with the second explanatory variable <span class="math inline">\(x_2\)</span> <code>height</code> on the horizontal axis and the first explanatory variable <span class="math inline">\(x_1\)</span> on the color layers. How does this plot compare with the previous one?</p>
<div class="learncheck">

</div>
</div>
<div id="model3table" class="section level3 hasAnchor" number="10.2.2">
<h3><span class="header-section-number">10.2.2</span> Regression lines<a href="10-multiple-regression.html#model3table" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s now fit a regression model and get the regression table corresponding to the regression line in Figure <a href="10-multiple-regression.html#fig:2numxplot1c">10.6</a>. As we have done throughout Chapter <a href="8-regression.html#regression">8</a> and this chapter, we use our two-step process to obtain the regression table for this model in Table <a href="10-multiple-regression.html#tab:model3-table-output">10.11</a>.</p>
<div class="sourceCode" id="cb418"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb418-1"><a href="10-multiple-regression.html#cb418-1" tabindex="-1"></a><span class="co"># Fit regression model:</span></span>
<span id="cb418-2"><a href="10-multiple-regression.html#cb418-2" tabindex="-1"></a>area_model1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(sqrt.area <span class="sc">~</span> herbivores <span class="sc">*</span> height, <span class="at">data =</span> IntertidalAlgae)</span>
<span id="cb418-3"><a href="10-multiple-regression.html#cb418-3" tabindex="-1"></a><span class="co"># Get regression table:</span></span>
<span id="cb418-4"><a href="10-multiple-regression.html#cb418-4" tabindex="-1"></a><span class="fu">get_regression_table</span>(area_model1)</span></code></pre></div>
<table class="table" style="font-size: 16px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:model3-table-output">TABLE 10.11: </span>Multiple regression table
</caption>
<thead>
<tr>
<th style="text-align:left;">
term
</th>
<th style="text-align:right;">
estimate
</th>
<th style="text-align:right;">
std_error
</th>
<th style="text-align:right;">
statistic
</th>
<th style="text-align:right;">
p_value
</th>
<th style="text-align:right;">
lower_ci
</th>
<th style="text-align:right;">
upper_ci
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
intercept
</td>
<td style="text-align:right;">
32.9
</td>
<td style="text-align:right;">
3.86
</td>
<td style="text-align:right;">
8.54
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
25.2
</td>
<td style="text-align:right;">
40.627
</td>
</tr>
<tr>
<td style="text-align:left;">
herbivores: plus
</td>
<td style="text-align:right;">
-22.5
</td>
<td style="text-align:right;">
5.45
</td>
<td style="text-align:right;">
-4.13
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
-33.4
</td>
<td style="text-align:right;">
-11.604
</td>
</tr>
<tr>
<td style="text-align:left;">
height: mid
</td>
<td style="text-align:right;">
-10.4
</td>
<td style="text-align:right;">
5.45
</td>
<td style="text-align:right;">
-1.91
</td>
<td style="text-align:right;">
0.061
</td>
<td style="text-align:right;">
-21.3
</td>
<td style="text-align:right;">
0.476
</td>
</tr>
<tr>
<td style="text-align:left;">
herbivores: plus:heightmid
</td>
<td style="text-align:right;">
25.6
</td>
<td style="text-align:right;">
7.71
</td>
<td style="text-align:right;">
3.32
</td>
<td style="text-align:right;">
0.002
</td>
<td style="text-align:right;">
10.2
</td>
<td style="text-align:right;">
41.003
</td>
</tr>
</tbody>
</table>
<ol style="list-style-type: decimal">
<li>We first “fit” the linear regression model using the <code>lm(y ~ x1 * x2, data)</code> function and save it in <code>area_model1</code>.</li>
<li>We get the regression table by applying the <code>get_regression_table()</code> function from the <code>moderndive</code> package to <code>area_model1</code>.</li>
</ol>
<p>Let’s interpret the values in the <code>estimate</code> column. First, the <code>intercept</code> value is 32.9, and this will be our base value in comparison to other groups. This <code>intercept</code> represents the mean <code>sqrt.area</code> for a plot who has <code>herbivores</code> absent and <code>height</code> of low tide, and this corresponds to where the red line (<code>low</code>) intersects <span class="math inline">\(x\)</span> = <code>minus</code>.</p>
<p>Second, the <code>herbivoresplus</code> value is -22.5. Taking into account all the other explanatory variables in our model, the addition of <code>herbivores</code>has an associated decrease on average of 22.5 in sqrt.area. <!--Just as we did in Subsection \@ref(model1table), we are cautious *not* to imply causality as we saw in Subsection \@ref(correlation-is-not-causation) that "correlation is not necessarily causation." We do this merely stating there was an *associated* increase. --> We preface our interpretation with the statement, “taking into account all the other explanatory variables in our model.” Here, by all other explanatory variables we mean <code>height</code> and the interaction between <code>height</code> and <code>herbivores</code>. We do this to emphasize that we are now jointly interpreting the associated effect of multiple explanatory variables in the same model at the same time.</p>
<p>Third, <code>heightmid</code> is -10.4 Taking into account all other explanatory variables in our model, plots with a <code>height</code> of <code>mid</code> tide, have an associated sqrt.area decrease of, on average, 10.4 cm. And finally, <code>herbivoresplus:heightmid</code> is 25.6. Taking into account all other explanatory variables in our model, the addition of <code>herbivores</code> <em>and</em> a <code>height</code> of <code>mid</code> tide, have an associated sqrt.area increase of, on average, 25.6 cm.</p>
<p>Putting these results together, the equation of the regression lines for the interaction model to give us fitted values <span class="math inline">\(\widehat{y}\)</span> = <span class="math inline">\(\widehat{\text{sqrt.area}}\)</span> is:</p>
<p><span class="math display">\[
\begin{aligned}
\widehat{y} &amp;= b_0 + b_1 \cdot x_1 +  b_2 \cdot x_2 + b_{\text{1,2}} \cdot x_1 \cdot x_2\\
\widehat{\text{sqrt.area}} &amp;= b_0 + b_{\text{herbivores}} \cdot \mathbb{1}_{\text{is plus}}(x) + b_{\text{height}} \cdot \mathbb{1}_{\text{is mid}}(x) \\
&amp;\text{ } + b_{\text{herbivores,height}} \cdot \mathbb{1}_{\text{is plus}}(x) \cdot \mathbb{1}_{\text{is mid}}(x)\\
&amp;= 32.9 - 22.5 \cdot\mathbb{1}_{\text{is plus}}(x) - 10.4 \cdot\mathbb{1}_{\text{is mid}}(x) \\
&amp;\text{ } + 25.6 \cdot \mathbb{1}_{\text{is plus}}(x) \cdot \mathbb{1}_{\text{is mid}}(x)
\end{aligned}
\]</span></p>
<p>Yes, the equation is again quite daunting, but as we saw above, once you recall what an “indicator function” does, the equation simplifies greatly. In this equation, we now have two indicator functions of interest:</p>
<p><span class="math display">\[
\mathbb{1}_{\text{is plus}}(x) = \left\{
\begin{array}{ll}
1 &amp; \text{if } \text{herbivores } x \text{ is plus} \\
0 &amp; \text{otherwise}\end{array}
\right.
\mathbb{1}_{\text{is mid}}(x) = \left\{
\begin{array}{ll}
1 &amp; \text{if } \text{height } x \text{ is mid} \\
0 &amp; \text{otherwise}\end{array}
\right.
\]</span></p>
<p>Okay, let’s put this all together again and compute the fitted value <span class="math inline">\(\widehat{y} = \widehat{\text{sqrt.area}}\)</span> for red algae minus herbivores and at low level. In this case <span class="math inline">\(\mathbb{1}_{\text{is plus}}(x)\)</span> = 0 and <span class="math inline">\(\mathbb{1}_{\text{is mid}}(x)\)</span> = 0, the previous equation becomes</p>
<p><span class="math display">\[
\begin{aligned}
\widehat{\text{sqrt.area}} &amp;= 32.9 - 22.5 \cdot 0 - 10.4 \cdot0  + 25.6 \cdot 0 \cdot 0 \\
&amp;= 32.9 + 0 + 0 + 0\\
&amp;= 32.9
\end{aligned}
\]</span>
which is the left end of the red regression line in Figure <a href="10-multiple-regression.html#fig:numxcatxplot1">10.1</a> corresponding to the <code>intercept</code> in Table <a href="10-multiple-regression.html#tab:interaction-summary">10.5</a>.</p>
<p>Correspondingly, for red algae plus herbivores and at low level, since <span class="math inline">\(\mathbb{1}_{\text{is plus}}(x)\)</span> = 1 and <span class="math inline">\(\mathbb{1}_{\text{is mid}}(x)\)</span> = 0, the previous equation becomes</p>
<p><span class="math display">\[
\begin{aligned}
\widehat{\text{sqrt.area}} &amp;= 32.9 - 22.5 \cdot 1 - 10.4 \cdot0  + 25.6 \cdot 1 \cdot 0 \\
&amp;= 32.9 - 22.5 + 0 +0 \\
&amp;= 10.4
\end{aligned}
\]</span></p>
<p>which is the right end of the red regression line in Figure <a href="10-multiple-regression.html#fig:numxcatxplot1">10.1</a>.</p>
<p>Moving on, for red algae minus herbivores and at mid level, since <span class="math inline">\(\mathbb{1}_{\text{is plus}}(x)\)</span> = 0 and <span class="math inline">\(\mathbb{1}_{\text{is mid}}(x)\)</span> = 1, the equation becomes</p>
<p><span class="math display">\[
\begin{aligned}
\widehat{\text{sqrt.area}} &amp;= 32.9 - 22.5 \cdot 0 - 10.4 \cdot 1  + 25.6 \cdot 0 \cdot 1 \\
&amp;= 32.9 + 0 - 10.4 + 0\\
&amp;= 22.5
\end{aligned}
\]</span></p>
<p>which is the left end of the blue regression line in Figure <a href="10-multiple-regression.html#fig:numxcatxplot1">10.1</a>.</p>
<p>And finally, for red algae plus herbivores and at mid level, since <span class="math inline">\(\mathbb{1}_{\text{is plus}}(x)\)</span> = 1 and <span class="math inline">\(\mathbb{1}_{\text{is mid}}(x)\)</span> = 1, the equation becomes</p>
<p><span class="math display">\[
\begin{aligned}
\widehat{\text{sqrt.area}} &amp;= 32.9 - 22.5 \cdot 1 - 10.4 \cdot 1  + 25.6 \cdot 1 \cdot 1 \\
&amp;= 32.9 - 22.5 - 10.4 + 25.6\\
&amp;= 25.6
\end{aligned}
\]</span></p>
<p>which is the right end of the blue regression line in Figure <a href="10-multiple-regression.html#fig:numxcatxplot1">10.1</a>.</p>
<p>That was a lot of arithmetic, but you made it! If you’re still a little unsure about using indicator functions and categorical explanatory variables in a regression model, you should re-read Subsection <a href="8-regression.html#model2table">8.2.2</a>.</p>
<p>Recall however in the right-hand plot of Figure <a href="10-multiple-regression.html#fig:2numxplot1b">10.5</a> that when plotting the relationship between <code>sqrt.area</code> and <code>height</code> in isolation, there appeared to be a <em>positive</em> relationship. In the last discussed multiple regression, however, when <em>jointly</em> modeling the relationship between <code>sqrt.area</code>, <code>herbivores</code>, and <code>height</code>, there appears to be a <em>negative</em> relationship of <code>sqrt.area</code> and <code>height</code> as evidenced by the negative offset for <code>height</code> of -10.4. What explains these contradictory results? A phenomenon known as <em>Simpson’s Paradox</em>, whereby overall trends that exist in aggregate either disappear or reverse when the data are broken down into groups.</p>
<div class="learncheck">
<p>
<strong><em>Learning check</em></strong>
</p>
</div>
<p><strong>(LC9.3)</strong> Fit a new simple linear regression for a <em>non-interaction</em> model using <code>lm(sqrt.area ~ herbivores + height, data = IntertidalAlgae)</code>. Get information about the “best-fitting” regression lines from the regression table by applying the <code>get_regression_table()</code> function. How do the regression results compare to those for the interaction model above?</p>
<div class="learncheck">

</div>
</div>
<div id="model3points" class="section level3 hasAnchor" number="10.2.3">
<h3><span class="header-section-number">10.2.3</span> Observed/fitted values and residuals<a href="10-multiple-regression.html#model3points" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s compute all fitted values and residuals for our interaction model using the <code>get_regression_points()</code> function and present only the first two rows of output for each combination of explanatory variables in Table <a href="10-multiple-regression.html#tab:model3-points-table">10.12</a>. Remember that the coordinates of each of the blue points <!--in our 3D scatterplot--> in Figure <a href="10-multiple-regression.html#fig:2numxplot1c">10.6</a> can be found in the <code>height</code>, <code>herbivores</code>, and <code>sqrt.area</code> columns. The fitted values on the regression lines are found in the <code>sqrt.area_hat</code> column and are computed using our equation <!--for the regression plane--> in the previous section:</p>
<p><span class="math display">\[
\begin{aligned}
\widehat{y} = \widehat{\text{sqrt.area}} &amp;= 32.9 - 22.5 \cdot\mathbb{1}_{\text{is plus}}(x) - 10.4 \cdot\mathbb{1}_{\text{is mid}}(x) \\
&amp;\text{ } + 25.6 \cdot \mathbb{1}_{\text{is plus}}(x) \cdot \mathbb{1}_{\text{is mid}}(x)
\end{aligned}
\]</span></p>
<div class="sourceCode" id="cb419"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb419-1"><a href="10-multiple-regression.html#cb419-1" tabindex="-1"></a><span class="fu">get_regression_points</span>(area_model1) <span class="sc">%&gt;%</span> </span>
<span id="cb419-2"><a href="10-multiple-regression.html#cb419-2" tabindex="-1"></a>  <span class="fu">group_by</span>(herbivores, height) <span class="sc">%&gt;%</span> <span class="fu">slice_head</span>(<span class="at">n=</span><span class="dv">2</span>) </span></code></pre></div>
<table class="table" style="font-size: 16px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:model3-points-table">TABLE 10.12: </span>Regression points (First 2 samples of each treatment combination)
</caption>
<thead>
<tr>
<th style="text-align:right;">
ID
</th>
<th style="text-align:right;">
sqrt.area
</th>
<th style="text-align:left;">
herbivores
</th>
<th style="text-align:left;">
height
</th>
<th style="text-align:right;">
sqrt.area_hat
</th>
<th style="text-align:right;">
residual
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
9.406
</td>
<td style="text-align:left;">
minus
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:right;">
32.9
</td>
<td style="text-align:right;">
-23.51
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
34.468
</td>
<td style="text-align:left;">
minus
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:right;">
32.9
</td>
<td style="text-align:right;">
1.55
</td>
</tr>
<tr>
<td style="text-align:right;">
33
</td>
<td style="text-align:right;">
0.707
</td>
<td style="text-align:left;">
minus
</td>
<td style="text-align:left;">
mid
</td>
<td style="text-align:right;">
22.5
</td>
<td style="text-align:right;">
-21.78
</td>
</tr>
<tr>
<td style="text-align:right;">
34
</td>
<td style="text-align:right;">
24.951
</td>
<td style="text-align:left;">
minus
</td>
<td style="text-align:left;">
mid
</td>
<td style="text-align:right;">
22.5
</td>
<td style="text-align:right;">
2.47
</td>
</tr>
<tr>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
11.977
</td>
<td style="text-align:left;">
plus
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:right;">
10.4
</td>
<td style="text-align:right;">
1.57
</td>
</tr>
<tr>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
14.471
</td>
<td style="text-align:left;">
plus
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:right;">
10.4
</td>
<td style="text-align:right;">
4.07
</td>
</tr>
<tr>
<td style="text-align:right;">
49
</td>
<td style="text-align:right;">
0.707
</td>
<td style="text-align:left;">
plus
</td>
<td style="text-align:left;">
mid
</td>
<td style="text-align:right;">
25.6
</td>
<td style="text-align:right;">
-24.84
</td>
</tr>
<tr>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
32.206
</td>
<td style="text-align:left;">
plus
</td>
<td style="text-align:left;">
mid
</td>
<td style="text-align:right;">
25.6
</td>
<td style="text-align:right;">
6.66
</td>
</tr>
</tbody>
</table>
</div>
<div id="which-model-without-or-with-interaction-fits-the-data-better" class="section level3 hasAnchor" number="10.2.4">
<h3><span class="header-section-number">10.2.4</span> Which model, without or with interaction, fits the data better?<a href="10-multiple-regression.html#which-model-without-or-with-interaction-fits-the-data-better" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Above, in Subsection <a href="10-multiple-regression.html#model3table">10.2.2</a>, we fit an interaction linear model to the <code>IntertidalAlgae</code> data and in LC9.3, you fit a non-interaction linear model. To see which linear model better fits the data, let’s compare the mean of the observed <span class="math inline">\(y\)</span> values (Obs) of each of the four groups with their fitted <span class="math inline">\(\widehat{y}\)</span> values for the interaction (Int) and non-interaction (Non) models. Recall that for a linear model, the observed <span class="math inline">\(y\)</span> values for a given value of <span class="math inline">\(x\)</span> are expected to have a normal distribution centered at the mean or fitted <span class="math inline">\(\widehat{y}\)</span> value.</p>
<div class="sourceCode" id="cb420"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb420-1"><a href="10-multiple-regression.html#cb420-1" tabindex="-1"></a>area_model2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(sqrt.area <span class="sc">~</span> herbivores <span class="sc">+</span> height, <span class="at">data =</span> IntertidalAlgae)</span>
<span id="cb420-2"><a href="10-multiple-regression.html#cb420-2" tabindex="-1"></a>means_Obs <span class="ot">&lt;-</span> IntertidalAlgae <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(herbivores, height) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">mean_Obs=</span><span class="fu">mean</span>(sqrt.area))</span>
<span id="cb420-3"><a href="10-multiple-regression.html#cb420-3" tabindex="-1"></a>means_Int <span class="ot">&lt;-</span> <span class="fu">get_regression_points</span>(area_model1) <span class="sc">%&gt;%</span> </span>
<span id="cb420-4"><a href="10-multiple-regression.html#cb420-4" tabindex="-1"></a>  <span class="fu">group_by</span>(herbivores, height) <span class="sc">%&gt;%</span> </span>
<span id="cb420-5"><a href="10-multiple-regression.html#cb420-5" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_hat_Int =</span> <span class="fu">mean</span>(sqrt.area_hat)) </span>
<span id="cb420-6"><a href="10-multiple-regression.html#cb420-6" tabindex="-1"></a>means_Non <span class="ot">&lt;-</span> <span class="fu">get_regression_points</span>(area_model2) <span class="sc">%&gt;%</span> </span>
<span id="cb420-7"><a href="10-multiple-regression.html#cb420-7" tabindex="-1"></a>  <span class="fu">group_by</span>(herbivores, height) <span class="sc">%&gt;%</span> </span>
<span id="cb420-8"><a href="10-multiple-regression.html#cb420-8" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_hat_Non =</span> <span class="fu">mean</span>(sqrt.area_hat)) </span>
<span id="cb420-9"><a href="10-multiple-regression.html#cb420-9" tabindex="-1"></a>means_table <span class="ot">&lt;-</span> means_Obs <span class="sc">%&gt;%</span> <span class="fu">inner_join</span>(means_Int) <span class="sc">%&gt;%</span> <span class="fu">inner_join</span>(means_Non)</span>
<span id="cb420-10"><a href="10-multiple-regression.html#cb420-10" tabindex="-1"></a>means_table</span></code></pre></div>
<table class="table" style="font-size: 16px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:model3-means-table">TABLE 10.13: </span>Observed means compared to fitted means for both models
</caption>
<thead>
<tr>
<th style="text-align:left;">
herbivores
</th>
<th style="text-align:left;">
height
</th>
<th style="text-align:right;">
mean_Obs
</th>
<th style="text-align:right;">
mean_hat_Int
</th>
<th style="text-align:right;">
mean_hat_Non
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
minus
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:right;">
32.9
</td>
<td style="text-align:right;">
32.9
</td>
<td style="text-align:right;">
26.5
</td>
</tr>
<tr>
<td style="text-align:left;">
minus
</td>
<td style="text-align:left;">
mid
</td>
<td style="text-align:right;">
22.5
</td>
<td style="text-align:right;">
22.5
</td>
<td style="text-align:right;">
28.9
</td>
</tr>
<tr>
<td style="text-align:left;">
plus
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:right;">
10.4
</td>
<td style="text-align:right;">
10.4
</td>
<td style="text-align:right;">
16.8
</td>
</tr>
<tr>
<td style="text-align:left;">
plus
</td>
<td style="text-align:left;">
mid
</td>
<td style="text-align:right;">
25.6
</td>
<td style="text-align:right;">
25.6
</td>
<td style="text-align:right;">
19.2
</td>
</tr>
</tbody>
</table>
<p>It’s clear from this table that the predicted (fitted) means for the interaction model (mean_hat_Int) are much closer to the observed mean (mean_Obs) than for the non-interaction model (mean_hat_Non). This is even more apparent when we overlay our scatterplot with the observed and predicted (fitted) means for each model, along with colored crossbars to mark the observed mean values (mean_Obs) for each of the four groups:</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:2numxplot1d"></span>
<img src="ModernDive_files/figure-html/2numxplot1d-1.png" alt="Comparison of interaction and parallel slopes model for red algae coverage." width="\textwidth" />
<p class="caption">
FIGURE 10.7: Comparison of interaction and parallel slopes model for red algae coverage.
</p>
</div>
<p>In both cases examined in this chapter (<code>ToothGrowth</code> and <code>IntertidalAlgae</code>), the interaction model fit the data much better than the non-interaction (parallel slopes) model. You may be wondering if that is always the case, and if so, why do we bother fitting a non-interaction model if its fit is consistently inferior. In the next section, we’ll see that there may be circumstances when it may be more appropriate to use the non-interaction model instead of the interaction model.</p>
</div>
</div>
<div id="mult-reg-related-topics" class="section level2 hasAnchor" number="10.3">
<h2><span class="header-section-number">10.3</span> Related topics<a href="10-multiple-regression.html#mult-reg-related-topics" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="model-selection" class="section level3 hasAnchor" number="10.3.1">
<h3><span class="header-section-number">10.3.1</span> Model selection using visualizations<a href="10-multiple-regression.html#model-selection" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>When would we ever use a parallel slopes (non-interaction) model versus an interaction model? The answer lies in a philosophical principle known as “Occam’s Razor.” It states that, “all other things being equal, simpler solutions are more likely to be correct than complex ones.” When viewed in a modeling framework, Occam’s Razor can be restated as, “all other things being equal, simpler models are to be preferred over complex ones.” In other words, we should only favor the more complex model if the additional complexity is <em>warranted</em>.</p>
<p>Let’s apply this principle to our earlier analysis. Recall that in Sections <a href="10-multiple-regression.html#model4interactiontable">10.1.2</a> and <a href="10-multiple-regression.html#model4table">10.1.3</a> we fit both interaction and parallel slopes models for the outcome variable <span class="math inline">\(y\)</span> (tooth length) using a numerical explanatory variable <span class="math inline">\(x_1\)</span> (dose) and a categorical explanatory variable <span class="math inline">\(x_2\)</span> (supplement type). We compared these models in Figure <a href="10-multiple-regression.html#fig:numxcatx-comparison">10.3</a>, which we display again now.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:recall-parallel-vs-interaction"></span>
<img src="ModernDive_files/figure-html/recall-parallel-vs-interaction-1.png" alt="Previously seen comparison of interaction and parallel slopes models." width="\textwidth" />
<p class="caption">
FIGURE 10.8: Previously seen comparison of interaction and parallel slopes models.
</p>
</div>
<p>You may have asked yourselves at this point, “Why would I force the lines to have parallel slopes (as seen in the right-hand plot) when they clearly have different slopes (as seen in the left-hand plot)?”. With regards to “Occam’s Razor”, recall that the equation for the regression line of the interaction model is “more complex” in that there is an additional <span class="math inline">\(b_{\text{dose,VC}} \cdot \text{dose} \cdot \mathbb{1}_{\text{is VC}}\)</span> interaction term not present in the equation for the parallel slopes model.:</p>
<p><span class="math display">\[
\begin{aligned}
\text{Interaction} &amp;: \widehat{y} = \widehat{\text{len}} = b_0 + b_{\text{dose}} \cdot \text{dose} + b_{\text{VC}} \cdot \mathbb{1}_{\text{is VC}}(x) + \\
&amp; \qquad b_{\text{dose,VC}} \cdot \text{dose} \cdot \mathbb{1}_{\text{is VC}}\\
\text{Parallel slopes} &amp;: \widehat{y} = \widehat{\text{len}} = b_0 + b_{\text{dose}} \cdot \text{dose} + b_{\text{VC}} \cdot \mathbb{1}_{\text{is VC}}(x)
\end{aligned}
\]</span></p>
<p>Or viewed alternatively, the regression table for the interaction model in Table <a href="10-multiple-regression.html#tab:regtable-interaction">10.4</a> has <em>four</em> rows, whereas the regression table for the parallel slopes model in Table <a href="10-multiple-regression.html#tab:regtable-parallel-slopes">10.6</a> has <em>three</em> rows. The question becomes: “Is this additional complexity warranted?”. In this case, it can be argued that this additional complexity is warranted, as evidenced by the two converging regression lines in the left-hand plot of Figure <a href="10-multiple-regression.html#fig:recall-parallel-vs-interaction">10.8</a>.</p>
<p>However, we next consider an example where the additional complexity might <em>not</em> be warranted. The <code>MoleRats</code> dataset included in the <code>moderndive</code> package contains data on energy expenditure in two castes of mole rats. For more details, read the help file for this data by running <code>?MoleRats</code> in the console.</p>
<p>Let’s model the numerical outcome variable <span class="math inline">\(y\)</span>, <code>ln.energy</code>, log-transformed energy expenditure for a given mole rat, as a function of two explanatory variables:</p>
<ol style="list-style-type: decimal">
<li>A numerical explanatory variable <span class="math inline">\(x_1\)</span>, <code>ln.mass</code>, the log-transformed mass of the mole rat and</li>
<li>A categorical explanatory variable <span class="math inline">\(x_2\)</span>, the <code>caste</code> of the rat, either <code>lazy</code> or <code>worker</code>.</li>
</ol>
<p>Let’s create visualizations of both the interaction and parallel slopes model once again and display the output in Figure <a href="10-multiple-regression.html#fig:numxcatx-comparison-2">10.9</a>. Recall from Subsection <a href="10-multiple-regression.html#model4table">10.1.3</a> that the <code>geom_parallel_slopes()</code> function is a special purpose function included in the <code>moderndive</code> package, since the <code>geom_smooth()</code> method in the <code>ggplot2</code> package does not have a convenient way to plot parallel slopes models.</p>
<div class="sourceCode" id="cb421"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb421-1"><a href="10-multiple-regression.html#cb421-1" tabindex="-1"></a><span class="co"># Interaction model</span></span>
<span id="cb421-2"><a href="10-multiple-regression.html#cb421-2" tabindex="-1"></a><span class="fu">ggplot</span>(MoleRats, </span>
<span id="cb421-3"><a href="10-multiple-regression.html#cb421-3" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> ln.mass, <span class="at">y =</span> ln.energy, <span class="at">color =</span> caste)) <span class="sc">+</span></span>
<span id="cb421-4"><a href="10-multiple-regression.html#cb421-4" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb421-5"><a href="10-multiple-regression.html#cb421-5" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb421-6"><a href="10-multiple-regression.html#cb421-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Log body mass&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Log energy expenditure&quot;</span>, </span>
<span id="cb421-7"><a href="10-multiple-regression.html#cb421-7" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">&quot;Caste&quot;</span>, </span>
<span id="cb421-8"><a href="10-multiple-regression.html#cb421-8" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;Interaction model&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb422"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb422-1"><a href="10-multiple-regression.html#cb422-1" tabindex="-1"></a><span class="co"># Parallel slopes model</span></span>
<span id="cb422-2"><a href="10-multiple-regression.html#cb422-2" tabindex="-1"></a><span class="fu">ggplot</span>(MoleRats, </span>
<span id="cb422-3"><a href="10-multiple-regression.html#cb422-3" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> ln.mass, <span class="at">y =</span> ln.energy, <span class="at">color =</span> caste)) <span class="sc">+</span></span>
<span id="cb422-4"><a href="10-multiple-regression.html#cb422-4" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb422-5"><a href="10-multiple-regression.html#cb422-5" tabindex="-1"></a>  <span class="fu">geom_parallel_slopes</span>(<span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb422-6"><a href="10-multiple-regression.html#cb422-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Log body mass&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Log energy expenditure&quot;</span>, </span>
<span id="cb422-7"><a href="10-multiple-regression.html#cb422-7" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">&quot;Caste&quot;</span>, </span>
<span id="cb422-8"><a href="10-multiple-regression.html#cb422-8" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;Parallel slopes model&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:numxcatx-comparison-2"></span>
<img src="ModernDive_files/figure-html/numxcatx-comparison-2-1.png" alt="Comparison of interaction and parallel slopes models for mole rats datasets." width="\textwidth" />
<p class="caption">
FIGURE 10.9: Comparison of interaction and parallel slopes models for mole rats datasets.
</p>
</div>
<p>Look closely at the left-hand plot of Figure <a href="10-multiple-regression.html#fig:numxcatx-comparison-2">10.9</a> corresponding to an interaction model. While the slopes are indeed different, they do not differ <em>by much</em> and are nearly identical. Now compare the left-hand plot with the right-hand plot corresponding to a parallel slopes model. The two models don’t appear all that different. So in this case, it can be argued that the additional complexity of the interaction model is <em>not warranted</em>. Thus following Occam’s Razor, we should prefer the “simpler” parallel slopes model. Let’s explicitly define what “simpler” means in this case. Let’s compare the regression tables for the interaction and parallel slopes models in Tables <a href="10-multiple-regression.html#tab:model2-interaction">10.14</a> and <a href="10-multiple-regression.html#tab:model2-parallel-slopes">10.15</a>.</p>
<div class="sourceCode" id="cb423"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb423-1"><a href="10-multiple-regression.html#cb423-1" tabindex="-1"></a>model_2_interaction <span class="ot">&lt;-</span> <span class="fu">lm</span>(ln.energy <span class="sc">~</span> ln.mass <span class="sc">*</span> caste, </span>
<span id="cb423-2"><a href="10-multiple-regression.html#cb423-2" tabindex="-1"></a>                          <span class="at">data =</span> MoleRats)</span>
<span id="cb423-3"><a href="10-multiple-regression.html#cb423-3" tabindex="-1"></a><span class="fu">get_regression_table</span>(model_2_interaction)</span></code></pre></div>
<table class="table" style="font-size: 16px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:model2-interaction">TABLE 10.14: </span>Interaction model regression table
</caption>
<thead>
<tr>
<th style="text-align:left;">
term
</th>
<th style="text-align:right;">
estimate
</th>
<th style="text-align:right;">
std_error
</th>
<th style="text-align:right;">
statistic
</th>
<th style="text-align:right;">
p_value
</th>
<th style="text-align:right;">
lower_ci
</th>
<th style="text-align:right;">
upper_ci
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
intercept
</td>
<td style="text-align:right;">
1.294
</td>
<td style="text-align:right;">
1.669
</td>
<td style="text-align:right;">
0.775
</td>
<td style="text-align:right;">
0.444
</td>
<td style="text-align:right;">
-2.110
</td>
<td style="text-align:right;">
4.70
</td>
</tr>
<tr>
<td style="text-align:left;">
ln.mass
</td>
<td style="text-align:right;">
0.607
</td>
<td style="text-align:right;">
0.343
</td>
<td style="text-align:right;">
1.771
</td>
<td style="text-align:right;">
0.086
</td>
<td style="text-align:right;">
-0.092
</td>
<td style="text-align:right;">
1.31
</td>
</tr>
<tr>
<td style="text-align:left;">
caste: worker
</td>
<td style="text-align:right;">
-1.571
</td>
<td style="text-align:right;">
1.952
</td>
<td style="text-align:right;">
-0.805
</td>
<td style="text-align:right;">
0.427
</td>
<td style="text-align:right;">
-5.552
</td>
<td style="text-align:right;">
2.41
</td>
</tr>
<tr>
<td style="text-align:left;">
ln.mass:casteworker
</td>
<td style="text-align:right;">
0.419
</td>
<td style="text-align:right;">
0.415
</td>
<td style="text-align:right;">
1.009
</td>
<td style="text-align:right;">
0.321
</td>
<td style="text-align:right;">
-0.427
</td>
<td style="text-align:right;">
1.26
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb424"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb424-1"><a href="10-multiple-regression.html#cb424-1" tabindex="-1"></a>model_2_parallel_slopes <span class="ot">&lt;-</span> <span class="fu">lm</span>(ln.energy <span class="sc">~</span> ln.mass <span class="sc">+</span> caste, </span>
<span id="cb424-2"><a href="10-multiple-regression.html#cb424-2" tabindex="-1"></a>                              <span class="at">data =</span> MoleRats)</span>
<span id="cb424-3"><a href="10-multiple-regression.html#cb424-3" tabindex="-1"></a><span class="fu">get_regression_table</span>(model_2_parallel_slopes)</span></code></pre></div>
<table class="table" style="font-size: 16px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:model2-parallel-slopes">TABLE 10.15: </span>Parallel slopes regression table
</caption>
<thead>
<tr>
<th style="text-align:left;">
term
</th>
<th style="text-align:right;">
estimate
</th>
<th style="text-align:right;">
std_error
</th>
<th style="text-align:right;">
statistic
</th>
<th style="text-align:right;">
p_value
</th>
<th style="text-align:right;">
lower_ci
</th>
<th style="text-align:right;">
upper_ci
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
intercept
</td>
<td style="text-align:right;">
-0.097
</td>
<td style="text-align:right;">
0.942
</td>
<td style="text-align:right;">
-0.103
</td>
<td style="text-align:right;">
0.919
</td>
<td style="text-align:right;">
-2.016
</td>
<td style="text-align:right;">
1.823
</td>
</tr>
<tr>
<td style="text-align:left;">
ln.mass
</td>
<td style="text-align:right;">
0.893
</td>
<td style="text-align:right;">
0.193
</td>
<td style="text-align:right;">
4.625
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.500
</td>
<td style="text-align:right;">
1.286
</td>
</tr>
<tr>
<td style="text-align:left;">
caste: worker
</td>
<td style="text-align:right;">
0.393
</td>
<td style="text-align:right;">
0.146
</td>
<td style="text-align:right;">
2.692
</td>
<td style="text-align:right;">
0.011
</td>
<td style="text-align:right;">
0.096
</td>
<td style="text-align:right;">
0.691
</td>
</tr>
</tbody>
</table>
<p>Observe how the regression table for the interaction model has 1 more rows (4 versus 3). This reflects the additional “complexity” of the interaction model over the parallel slopes model.</p>
<p>Furthermore, note in Table <a href="10-multiple-regression.html#tab:model2-interaction">10.14</a> how the <em>offsets for the slope</em> <code>ln.mass::casteworker</code> being 0.419 is comparable to the standard error of <span class="math inline">\(0.415\)</span>. Most importantly, the 95% confidence interval includes zero (0) meaning that it’s quite plausible that the slope of the two regression lines do not differ. These results are suggesting then that irrespective of caste, the relationship between mass and energy expenditure is not significantly different, as indicated by the p-value of <span class="math inline">\(0.321\)</span>.</p>
<p>What you have just performed is a <em>model selection</em>: choosing which model fits data best among a set of candidate models. The model selection we performed first used the “eyeball test”: qualitatively looking at visualizations to choose a model. We then supplemented this evidence quantitatively by examining the remaining columns of the regression table. In the next subsection, we will use another numerical approach via the <span class="math inline">\(R^2\)</span> (pronounced “R-squared”) value to perform the same model selection.</p>
</div>
<div id="rsquared" class="section level3 hasAnchor" number="10.3.2">
<h3><span class="header-section-number">10.3.2</span> Model selection using R-squared<a href="10-multiple-regression.html#rsquared" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>At the end of the previous section in Figure <a href="10-multiple-regression.html#fig:numxcatx-comparison-2">10.9</a> you compared an interaction model with a parallel slopes model, where both models attempted to explain <span class="math inline">\(y\)</span> = the average energy expenditure of mole rats. In Tables <a href="10-multiple-regression.html#tab:model2-interaction">10.14</a> and <a href="10-multiple-regression.html#tab:model2-parallel-slopes">10.15</a>, we observed that the interaction model was “more complex” in that the regression table had 4 rows versus the 3 rows of the parallel slopes model.</p>
<p>Most importantly however, when comparing the left and right-hand plots of Figure <a href="10-multiple-regression.html#fig:numxcatx-comparison-2">10.9</a>, we observed that the two lines corresponding to lazy and worker mole rats were not that different. Furthermore, this was supported by the values in the <code>ln.mass::casteworker</code> row of the regression table for the interaction model, shown in in Table <a href="10-multiple-regression.html#tab:model2-interaction">10.14</a>. Given the similarity of the two slopes, we stated it could be argued that the “simpler” parallel slopes model should be favored.</p>
<p>In this section, we’ll mimic the model selection we just performed, but this time using a numerical and quantitative approach. Specifically, we’ll use the <span class="math inline">\(R^2\)</span> summary statistic (pronounced “R-squared”), also called the “coefficient of determination”,</p>
<p>Since <span class="math inline">\(R^2\)</span> is calculated using the variance of the observed and the fitted values of <span class="math inline">\(y\)</span>, let’s first review variance. Recall that one summary statistic of the <em>spread</em> (or <em>variation</em>) of a numerical variable is the standard deviation. The variance is merely the standard deviation squared, and it is therefore the average of the squared deviations of each observation from the mean, as you can see with the formula in <a href="A-appendixA.html#appendix-sd-variance">A.1.3</a>. In R, the variance can be computed using the <code>var()</code> summary function within <code>summarize()</code>.</p>
<p>Recall that to get: 1) the observed values <span class="math inline">\(y\)</span>, 2) the fitted values <span class="math inline">\(\widehat{y}\)</span> from a regression model, and 3) the resulting residuals <span class="math inline">\(y - \widehat{y}\)</span> (i.e., deviations from the mean), we can apply the <code>get_regression_points()</code> function with our saved model, in this case <code>model_2_interaction</code>:</p>
<div class="sourceCode" id="cb425"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb425-1"><a href="10-multiple-regression.html#cb425-1" tabindex="-1"></a><span class="fu">get_regression_points</span>(model_2_interaction) </span></code></pre></div>
<pre><code># A tibble: 35 × 6
      ID ln.energy ln.mass caste  ln.energy_hat residual
   &lt;int&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;fct&gt;          &lt;dbl&gt;    &lt;dbl&gt;
 1     1     3.689   3.85  worker         3.671    0.018
 2     2     3.689   3.989 worker         3.813   -0.125
 3     3     3.689   4.111 worker         3.938   -0.25 
 4     4     3.664   4.174 worker         4.004   -0.34 
 5     5     3.871   4.248 worker         4.08    -0.208
 6     6     3.85    4.263 worker         4.094   -0.244
 7     7     3.932   4.344 worker         4.177   -0.245
 8     8     3.689   4.489 worker         4.326   -0.637
 9     9     3.951   4.511 worker         4.349   -0.397
10    10     4.111   3.951 worker         3.775    0.336
# ℹ 25 more rows</code></pre>
<p>Let’s now use the <code>var()</code> summary function within <code>summarize()</code> to compute the variance of these three terms:</p>
<div class="sourceCode" id="cb427"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb427-1"><a href="10-multiple-regression.html#cb427-1" tabindex="-1"></a><span class="fu">get_regression_points</span>(model_2_interaction) <span class="sc">%&gt;%</span> </span>
<span id="cb427-2"><a href="10-multiple-regression.html#cb427-2" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">var_y =</span> <span class="fu">var</span>(ln.energy), </span>
<span id="cb427-3"><a href="10-multiple-regression.html#cb427-3" tabindex="-1"></a>                      <span class="at">var_y_hat =</span> <span class="fu">var</span>(ln.energy_hat), </span>
<span id="cb427-4"><a href="10-multiple-regression.html#cb427-4" tabindex="-1"></a>                      <span class="at">var_residual =</span> <span class="fu">var</span>(residual))</span></code></pre></div>
<pre><code># A tibble: 1 × 3
     var_y var_y_hat var_residual
     &lt;dbl&gt;     &lt;dbl&gt;        &lt;dbl&gt;
1 0.140050 0.0599682    0.0801086</code></pre>
<p>Observe that the variance of <span class="math inline">\(y\)</span> is equal to the variance of <span class="math inline">\(\widehat{y}\)</span> plus the variance of the residuals. But what do these three terms tell us individually?</p>
<p>First, the variance of <span class="math inline">\(y\)</span> (denoted as <span class="math inline">\(var(y)\)</span>) tells us how much do mole rats differ in energy expenditure. The goal of regression modeling is to fit a model that hopefully <em>explains</em> this variation. In other words, we want to understand what factors explain why certain mole rats have high energy expenditures, while others have low expenditures. The variance of <span class="math inline">\(y\)</span> is independent of the model; this is just data. In other words, whether we fit an interaction or parallel slopes model, <span class="math inline">\(var(y)\)</span> remains the same.</p>
<p>Second, the variance of <span class="math inline">\(\widehat{y}\)</span> (denoted as <span class="math inline">\(var(\widehat{y})\)</span>) tells us how much the fitted values from our interaction model vary. That is to say, after accounting for (1) the log mass and (2) caste of a mole rat in an interaction model, how much do our model’s explanations of log energy expenditure vary?</p>
<p>Third, the variance of the residuals tells us how much do “the left-overs” from the model vary. Observe how the points in the left-hand plot of Figure <a href="10-multiple-regression.html#fig:numxcatx-comparison-2">10.9</a> scatter around the two lines. Say instead all the points fell <em>exactly</em> on their corresponding line. Then all residuals would be zero and hence the variance of the residuals would be zero.</p>
<p>We’re now ready to introduce <span class="math inline">\(R^2\)</span>:</p>
<p><span class="math display">\[
R^2 = \frac{var(\widehat{y})}{var(y)}
\]</span></p>
<p>It is <em>the proportion of the spread/variation of the outcome variable <span class="math inline">\(y\)</span> that is explained by our model</em>, where our model’s explanatory power is embedded in the fitted values <span class="math inline">\(\widehat{y}\)</span>. Furthermore, since it can be mathematically proven that <span class="math inline">\(0 \leq var(\widehat{y}) \leq var(y)\)</span> (a fact we leave for an advanced class on regression), we are guaranteed that:</p>
<p><span class="math display">\[
0 \leq R^2 \leq 1
\]</span></p>
<p><span class="math inline">\(R^2\)</span> can be interpreted as follows:</p>
<ol style="list-style-type: decimal">
<li><span class="math inline">\(R^2\)</span> values of 0 tell us that our model explains 0% of the variation in <span class="math inline">\(y\)</span>. Say we fit a model to the mole rats data and obtained <span class="math inline">\(R^2 = 0\)</span>. This would be telling us that the combination of explanatory variables <span class="math inline">\(x\)</span> we used and model form we chose (interaction or parallel slopes) tell us <em>nothing</em> about energy expenditure of a mole rat. The model is a poor fit.</li>
<li><span class="math inline">\(R^2\)</span> values of 1 tell us that our model explains 100% of the variation in <span class="math inline">\(y\)</span>. Say we fit a model to the mole rats data and obtained <span class="math inline">\(R^2 = 1\)</span>. This would be telling us that the combination of explanatory variables <span class="math inline">\(x\)</span> we used and model form we chose (interaction or parallel slopes) tell us <em>everything we need to know</em> about energy expenditure of a mole rat.</li>
</ol>
<p>In practice however, <span class="math inline">\(R^2\)</span> values of 1 almost never occur. Think about it in the context of mole rats. There are an infinite number of factors that influence why certain mole rats expend much energy while others don’t. The idea that a human-designed statistical model can capture all the heterogeneity of all mole rats is bordering on hubris. However, even if such models are not perfect, they may still prove useful in predicting energy expenditure. A general principle of modeling we should keep in mind is a famous quote by eminent statistician George Box: <a href="https://jamesclear.com/all-models-are-wrong">“All models are wrong, but some are useful.”</a></p>
<p>Let’s repeat the above calculations for the parallel slopes model and compare them in Table <a href="10-multiple-regression.html#tab:model2-r-squared">10.16</a>.</p>
<table class="table" style="font-size: 16px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:model2-r-squared">TABLE 10.16: </span>Comparing variances from interaction and parallel slopes models for mole rats data
</caption>
<thead>
<tr>
<th style="text-align:left;">
model
</th>
<th style="text-align:right;">
var_y
</th>
<th style="text-align:right;">
var_y_hat
</th>
<th style="text-align:right;">
var_residual
</th>
<th style="text-align:right;">
r_squared
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Interaction
</td>
<td style="text-align:right;">
0.14
</td>
<td style="text-align:right;">
0.060
</td>
<td style="text-align:right;">
0.080
</td>
<td style="text-align:right;">
0.428
</td>
</tr>
<tr>
<td style="text-align:left;">
Parallel slopes
</td>
<td style="text-align:right;">
0.14
</td>
<td style="text-align:right;">
0.057
</td>
<td style="text-align:right;">
0.083
</td>
<td style="text-align:right;">
0.409
</td>
</tr>
</tbody>
</table>
<p>Observe how the <span class="math inline">\(R^2\)</span> values are near identical at around 0.409 = 40.9%. In other words, the <em>additional complexity</em> of the interaction model barely improves our <span class="math inline">\(R^2\)</span> value by a minimal amount. Thus, we are inclined to favor the “simpler” parallel slopes model.</p>
<p>Now let’s repeat this <span class="math inline">\(R^2\)</span> comparison between interaction and parallel slopes model for our models of <span class="math inline">\(y\)</span> = coverage area of red algae which you visually compared in Figure <a href="10-multiple-regression.html#fig:2numxplot1d">10.7</a>. We compare these values in Table <a href="10-multiple-regression.html#tab:model1-r-squared">10.17</a></p>
<table class="table" style="font-size: 16px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:model1-r-squared">TABLE 10.17: </span>Comparing variances from interaction and parallel slopes models for tooth growth data
</caption>
<thead>
<tr>
<th style="text-align:left;">
model
</th>
<th style="text-align:right;">
var_y
</th>
<th style="text-align:right;">
var_y_hat
</th>
<th style="text-align:right;">
var_residual
</th>
<th style="text-align:right;">
r_squared
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Interaction
</td>
<td style="text-align:right;">
293
</td>
<td style="text-align:right;">
67.0
</td>
<td style="text-align:right;">
227
</td>
<td style="text-align:right;">
0.228
</td>
</tr>
<tr>
<td style="text-align:left;">
Parallel slopes
</td>
<td style="text-align:right;">
293
</td>
<td style="text-align:right;">
25.4
</td>
<td style="text-align:right;">
268
</td>
<td style="text-align:right;">
0.087
</td>
</tr>
</tbody>
</table>
<p>Observe how the <span class="math inline">\(R^2\)</span> values are now very different! In other words, since the <em>additional complexity</em> of the interaction model over the parallel slopes model improves our <span class="math inline">\(R^2\)</span> value by a relatively large amount (0.228 versus 0.087, it could be argued that the additional complexity is warranted.</p>
<p>As a final note, we can also use the third of our <code>get_regression()</code> wrapper functions, <code>get_regression_summaries()</code>, to quickly automate calculating <span class="math inline">\(R^2\)</span> for both the interaction and parallels slopes models, first for the <code>MoleRats</code> data.</p>
<div class="sourceCode" id="cb429"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb429-1"><a href="10-multiple-regression.html#cb429-1" tabindex="-1"></a><span class="co"># R-squared for interaction model:</span></span>
<span id="cb429-2"><a href="10-multiple-regression.html#cb429-2" tabindex="-1"></a><span class="fu">get_regression_summaries</span>(model_2_interaction)</span></code></pre></div>
<pre><code># A tibble: 1 × 9
  r_squared adj_r_squared       mse     rmse sigma statistic p_value    df  nobs
      &lt;dbl&gt;         &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1     0.428         0.372 0.0778555 0.279026 0.296     7.727   0.001     3    35</code></pre>
<div class="sourceCode" id="cb431"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb431-1"><a href="10-multiple-regression.html#cb431-1" tabindex="-1"></a><span class="co"># R-squared for parallel slopes model:</span></span>
<span id="cb431-2"><a href="10-multiple-regression.html#cb431-2" tabindex="-1"></a><span class="fu">get_regression_summaries</span>(model_2_parallel_slopes)</span></code></pre></div>
<pre><code># A tibble: 1 × 9
  r_squared adj_r_squared       mse     rmse sigma statistic p_value    df  nobs
      &lt;dbl&gt;         &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1     0.409         0.372 0.0804143 0.283574 0.297    11.075       0     2    35</code></pre>
<p>In addition to the <span class="math inline">\(R^2\)</span> value for a model, this wrapper function also returns an adjusted-<span class="math inline">\(R^2\)</span> value, which accounts for the additional feature contained in the interaction model. While <span class="math inline">\(R^2\)</span> will always increase as we add additional variables to our model, the adjusted-<span class="math inline">\(R^2\)</span> will only increase if the more complex model is better. You’ll notice that the adjusted-<span class="math inline">\(R^2\)</span> of the interaction and the parallel slopes models for the <code>MoleRats</code> data is identical at 0.372. This indicates that the additional complexity of the model that accounts for an interaction between the two explanatory variables is not any better than the simpler parallel-slopes model.</p>
<p>In contrast when we compare the interaction and parallel slopes models for the <code>IntertidalAlgae</code> data, we see a marked increase in the adjusted-<span class="math inline">\(R^2\)</span> values with the interaction model:</p>
<pre><code># A tibble: 1 × 9
  r_squared adj_r_squared     mse    rmse  sigma statistic p_value    df  nobs
      &lt;dbl&gt;         &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1     0.228          0.19 222.977 14.9324 15.422     5.912   0.001     3    64</code></pre>
<pre><code># A tibble: 1 × 9
  r_squared adj_r_squared     mse    rmse  sigma statistic p_value    df  nobs
      &lt;dbl&gt;         &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1     0.087         0.057 263.867 16.2440 16.639     2.892   0.063     2    64</code></pre>
<!--Remove this section
### Simpson's Paradox {#simpsonsparadox}

Recall in Section \@ref(model3), we saw the two seemingly contradictory results when studying the relationship between `sqrt.area` and `height`. On the one hand, the right hand plot of Figure \@ref(fig:2numxplot1) suggested that the relationship between `sqrt.area` and `height` was *positive*. We re-display this in Figure \@ref(fig:2numxplot1-repeat).

<div class="figure" style="text-align: center">
<img src="ModernDive_files/figure-html/2numxplot1-repeat-1.png" alt="Relationship between credit card sqrt.area and height." width="\textwidth" />
<p class="caption">(\#fig:2numxplot1-repeat)Relationship between credit card sqrt.area and height.</p>
</div>

On the other hand, the multiple regression results in Table \@ref(tab:model3-table-output) suggested that the relationship between `sqrt.area` and `height` was *negative*. We re-display this information in Table \@ref(tab:model3-table-output-repeat).

<table class="table" style="font-size: 16px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">(\#tab:model3-table-output-repeat)Multiple regression table</caption>
 <thead>
  <tr>
   <th style="text-align:left;"> term </th>
   <th style="text-align:right;"> estimate </th>
   <th style="text-align:right;"> std_error </th>
   <th style="text-align:right;"> statistic </th>
   <th style="text-align:right;"> p_value </th>
   <th style="text-align:right;"> lower_ci </th>
   <th style="text-align:right;"> upper_ci </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> intercept </td>
   <td style="text-align:right;"> 32.9 </td>
   <td style="text-align:right;"> 3.86 </td>
   <td style="text-align:right;"> 8.54 </td>
   <td style="text-align:right;"> 0.000 </td>
   <td style="text-align:right;"> 25.2 </td>
   <td style="text-align:right;"> 40.627 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> herbivores: plus </td>
   <td style="text-align:right;"> -22.5 </td>
   <td style="text-align:right;"> 5.45 </td>
   <td style="text-align:right;"> -4.13 </td>
   <td style="text-align:right;"> 0.000 </td>
   <td style="text-align:right;"> -33.4 </td>
   <td style="text-align:right;"> -11.604 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> height: mid </td>
   <td style="text-align:right;"> -10.4 </td>
   <td style="text-align:right;"> 5.45 </td>
   <td style="text-align:right;"> -1.91 </td>
   <td style="text-align:right;"> 0.061 </td>
   <td style="text-align:right;"> -21.3 </td>
   <td style="text-align:right;"> 0.476 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> herbivores: plus:heightmid </td>
   <td style="text-align:right;"> 25.6 </td>
   <td style="text-align:right;"> 7.71 </td>
   <td style="text-align:right;"> 3.32 </td>
   <td style="text-align:right;"> 0.002 </td>
   <td style="text-align:right;"> 10.2 </td>
   <td style="text-align:right;"> 41.003 </td>
  </tr>
</tbody>
</table>

Observe how the offset for `heightmid` is $-10.431$ and, most importantly for now, it is negative. This contradicts our observation in Figure \@ref(fig:2numxplot1-repeat) that the relationship is positive. How can this be? Recall the interpretation of the offset for `heightmid` in the context of a multiple regression model: *taking into account all the other explanatory variables in our model*, for every increase of one unit in `height`, there is an associated decrease of on average \$10.431 in `sqrt.area`.

In other words, while in *isolation*, the relationship between `sqrt.area` and `height` may be positive, when taking into account `area_coverage` as well, this relationship becomes negative. These seemingly paradoxical results are due to a phenomenon aptly named [*Simpson's Paradox*](https://en.wikipedia.org/wiki/Simpson%27s_paradox)\index{Simpson's Paradox}. Simpson's Paradox occurs when trends that exist for the data in aggregate either disappear or reverse when the data are broken down into groups. 

Let's show how Simpson's Paradox manifests itself in the `IntertidalAlgae` data. Let's first visualize the distribution of the numerical explanatory variable `area_coverage` with a histogram in Figure \@ref(fig:credit-limit-quartiles).



The vertical dashed lines are the *quartiles* that cut up the variable `area_coverage` into four equally sized groups. Let's think of these quartiles as converting our numerical variable `area_coverage` into a categorical variable "`area_coverage` bracket" with four levels. This means that

1. 25% of credit limits were between \$0 and \$3088. Let's assign these 100 people to the "low" `area_coverage` bracket.
1. 25% of credit limits were between \$3088 and \$4622. Let's assign these 100 people to the "medium-low" `area_coverage` bracket.
1. 25% of credit limits were between \$4622 and \$5873. Let's assign these 100 people to the "medium-high" `area_coverage` bracket.
1. 25% of credit limits were over \$5873. Let's assign these 100 people to the "high" `area_coverage` bracket.

Now in Figure \@ref(fig:2numxplot4) let's re-display two versions of the scatterplot of `sqrt.area` and `height` from Figure \@ref(fig:2numxplot1-repeat), but with a slight twist:

1. The left-hand plot shows the regular scatterplot and the single regression line, just as you saw in Figure \@ref(fig:2numxplot1-repeat).
1. The right-hand plot shows the *colored scatterplot*, where the color aesthetic is mapped to "`area_coverage` bracket." Furthermore, there are now four separate regression lines.

In other words, the location of the 64 points are the same in both scatterplots, but the right-hand plot shows an additional variable of information: `area_coverage` bracket. 



The left-hand plot of Figure \@ref(fig:2numxplot4) focuses on the relationship between `sqrt.area` and `height` in *aggregate*. It is suggesting that overall there exists a positive relationship between `sqrt.area` and `height`. However, the right-hand plot of Figure \@ref(fig:2numxplot4) focuses on the relationship between `sqrt.area` and `height` *broken down by `area_coverage` bracket*. In other words, we focus on four *separate* relationships between `sqrt.area` and `height`: one for the "low" `area_coverage` bracket, one for the "medium-low" `area_coverage` bracket, and so on. 

Observe in the right-hand plot that the relationship between `sqrt.area` and `height` is clearly negative for the "medium-low" and "medium-high" `area_coverage` brackets, while the relationship is somewhat flat for the "low" `area_coverage` bracket. The only `area_coverage` bracket where the relationship remains positive is for the "high" `area_coverage` bracket. However, this relationship is less positive than in the relationship in aggregate, since the slope is shallower than the slope of the regression line in the left-hand plot. 

In this example of Simpson's Paradox, the `area_coverage` is a *confounding variable* of the relationship between credit card `sqrt.area` and `height`\index{confounding variable} as we defined in Subsection \@ref(correlation-is-not-causation). Thus, `area_coverage` needs to be accounted for in any appropriate model for the relationship between `sqrt.area` and `height`.

-->
</div>
</div>
<div id="mult-reg-conclusion" class="section level2 hasAnchor" number="10.4">
<h2><span class="header-section-number">10.4</span> Conclusion<a href="10-multiple-regression.html#mult-reg-conclusion" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="review">
<p>
<strong><em>Chapter Learning Summary</em></strong>
</p>
<ul>
<li>
Multiple linear regression examines the relationship between a
numerical response variable and multiple explanatory variables, which
may be numerical and/or categorical.<br />
</li>
<li>
There is an interaction effect when the effect of an explanatory
variable on the response variable depends on a second explanatory
variable.<br />
</li>
<li>
Because simpler models are to be preferred (Occam’s razor), a
parallel slopes (or non-#interaction) model is more appropriate if there
is no evidence for an interaction effect.<br />
</li>
<li>
Data visualization, R-squared values and p-values can provide
evidence for an interaction effect.<br />
</li>
</ul>
</div>
<!--
### Additional resources



An R script file of all R code used in this chapter is available [here](scripts/06-multiple-regression.R).
-->
<div id="whats-to-come-9" class="section level3 hasAnchor" number="10.4.1">
<h3><span class="header-section-number">10.4.1</span> What’s to come?<a href="10-multiple-regression.html#whats-to-come-9" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You’ve now concluded the last major part of the book on “Data Modeling with <code>moderndive</code>.” The closing Chapter <a href="11-thinking-with-data.html#thinking-with-data">11</a> concludes this book with a review and short case studies involving real data. You’ll see how the principles in this book can help you become a great storyteller with data!</p>

</div>
</div>
</div>



            </section>

          </div>
        </div>
      </div>
<a href="9-inference-for-regression.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="11-thinking-with-data.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/moderndive/moderndive_book/edit/master/10-multiple-regression.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
